import{e as ee,L as j_}from"./livewire.esm-C819BCfU.js";import{f as G_,m as X_}from"./fetch-Bv7pIKk9.js";import{c as Y_}from"./clipboard-CBCTDmBy.js";import{R as Yb,f as J_}from"./lib.modern-DHFPEOLP.js";const Z_="modulepreload",Q_=function(n){return"/build/"+n},yg={},vg=function(e,t,r){let i=Promise.resolve();if(t&&t.length>0){let s=function(d){return Promise.all(d.map(f=>Promise.resolve(f).then(h=>({status:"fulfilled",value:h}),h=>({status:"rejected",reason:h}))))};document.getElementsByTagName("link");const a=document.querySelector("meta[property=csp-nonce]"),l=(a==null?void 0:a.nonce)||(a==null?void 0:a.getAttribute("nonce"));i=s(t.map(d=>{if(d=Q_(d),d in yg)return;yg[d]=!0;const f=d.endsWith(".css"),h=f?'[rel="stylesheet"]':"";if(document.querySelector(`link[href="${d}"]${h}`))return;const m=document.createElement("link");if(m.rel=f?"stylesheet":Z_,f||(m.as="script"),m.crossOrigin="",m.href=d,l&&m.setAttribute("nonce",l),document.head.appendChild(m),f)return new Promise((g,b)=>{m.addEventListener("load",g),m.addEventListener("error",()=>b(new Error(`Unable to preload CSS for ${d}`)))})}))}function o(s){const a=new Event("vite:preloadError",{cancelable:!0});if(a.payload=s,window.dispatchEvent(a),!a.defaultPrevented)throw s}return i.then(s=>{for(const a of s||[])a.status==="rejected"&&o(a.reason);return e().catch(o)})};typeof window.pusherConfig<"u"?vg(async()=>{const{default:n}=await import("./echo-DL0QqwGZ.js");return{default:n}},[]).then(({default:n})=>{vg(async()=>{const{default:e}=await import("./pusher-DLvW2gch.js").then(t=>t.p);return{default:e}},[]).then(({default:e})=>{window.Pusher=e;let t=window.pusherConfig;window.Echo=new n({broadcaster:"pusher",key:t.key,cluster:t.cluster,wsHost:t.wsHost??`ws-${t.cluster}.pusher.com`,wsPort:t.port??80,wssPort:t.port??443,forceTLS:(t.scheme??"https")==="https",enabledTransports:["ws","wss"]})}).catch(e=>console.log("Failed to load Pusher:",e))}).catch(n=>console.log("Failed to load Echo:",n)):console.log("window.pusherConfig is not defined.");function xg(n,e){var t=Object.keys(n);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(n);e&&(r=r.filter(function(i){return Object.getOwnPropertyDescriptor(n,i).enumerable})),t.push.apply(t,r)}return t}function Br(n){for(var e=1;e<arguments.length;e++){var t=arguments[e]!=null?arguments[e]:{};e%2?xg(Object(t),!0).forEach(function(r){eA(n,r,t[r])}):Object.getOwnPropertyDescriptors?Object.defineProperties(n,Object.getOwnPropertyDescriptors(t)):xg(Object(t)).forEach(function(r){Object.defineProperty(n,r,Object.getOwnPropertyDescriptor(t,r))})}return n}function Nl(n){"@babel/helpers - typeof";return typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?Nl=function(e){return typeof e}:Nl=function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Nl(n)}function eA(n,e,t){return e in n?Object.defineProperty(n,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):n[e]=t,n}function hi(){return hi=Object.assign||function(n){for(var e=1;e<arguments.length;e++){var t=arguments[e];for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&(n[r]=t[r])}return n},hi.apply(this,arguments)}function tA(n,e){if(n==null)return{};var t={},r=Object.keys(n),i,o;for(o=0;o<r.length;o++)i=r[o],!(e.indexOf(i)>=0)&&(t[i]=n[i]);return t}function nA(n,e){if(n==null)return{};var t=tA(n,e),r,i;if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(n);for(i=0;i<o.length;i++)r=o[i],!(e.indexOf(r)>=0)&&Object.prototype.propertyIsEnumerable.call(n,r)&&(t[r]=n[r])}return t}var rA="1.15.2";function li(n){if(typeof window<"u"&&window.navigator)return!!navigator.userAgent.match(n)}var mi=li(/(?:Trident.*rv[ :]?11\.|msie|iemobile|Windows Phone)/i),lu=li(/Edge/i),wg=li(/firefox/i),Oa=li(/safari/i)&&!li(/chrome/i)&&!li(/android/i),Jb=li(/iP(ad|od|hone)/i),Zb=li(/chrome/i)&&li(/android/i),Qb={capture:!1,passive:!1};function ze(n,e,t){n.addEventListener(e,t,!mi&&Qb)}function Le(n,e,t){n.removeEventListener(e,t,!mi&&Qb)}function Xl(n,e){if(e){if(e[0]===">"&&(e=e.substring(1)),n)try{if(n.matches)return n.matches(e);if(n.msMatchesSelector)return n.msMatchesSelector(e);if(n.webkitMatchesSelector)return n.webkitMatchesSelector(e)}catch{return!1}return!1}}function iA(n){return n.host&&n!==document&&n.host.nodeType?n.host:n.parentNode}function br(n,e,t,r){if(n){t=t||document;do{if(e!=null&&(e[0]===">"?n.parentNode===t&&Xl(n,e):Xl(n,e))||r&&n===t)return n;if(n===t)break}while(n=iA(n))}return null}var kg=/\s+/g;function On(n,e,t){if(n&&e)if(n.classList)n.classList[t?"add":"remove"](e);else{var r=(" "+n.className+" ").replace(kg," ").replace(" "+e+" "," ");n.className=(r+(t?" "+e:"")).replace(kg," ")}}function de(n,e,t){var r=n&&n.style;if(r){if(t===void 0)return document.defaultView&&document.defaultView.getComputedStyle?t=document.defaultView.getComputedStyle(n,""):n.currentStyle&&(t=n.currentStyle),e===void 0?t:t[e];!(e in r)&&e.indexOf("webkit")===-1&&(e="-webkit-"+e),r[e]=t+(typeof t=="string"?"":"px")}}function Ss(n,e){var t="";if(typeof n=="string")t=n;else do{var r=de(n,"transform");r&&r!=="none"&&(t=r+" "+t)}while(!e&&(n=n.parentNode));var i=window.DOMMatrix||window.WebKitCSSMatrix||window.CSSMatrix||window.MSCSSMatrix;return i&&new i(t)}function ey(n,e,t){if(n){var r=n.getElementsByTagName(e),i=0,o=r.length;if(t)for(;i<o;i++)t(r[i],i);return r}return[]}function Fr(){var n=document.scrollingElement;return n||document.documentElement}function mt(n,e,t,r,i){if(!(!n.getBoundingClientRect&&n!==window)){var o,s,a,l,d,f,h;if(n!==window&&n.parentNode&&n!==Fr()?(o=n.getBoundingClientRect(),s=o.top,a=o.left,l=o.bottom,d=o.right,f=o.height,h=o.width):(s=0,a=0,l=window.innerHeight,d=window.innerWidth,f=window.innerHeight,h=window.innerWidth),(e||t)&&n!==window&&(i=i||n.parentNode,!mi))do if(i&&i.getBoundingClientRect&&(de(i,"transform")!=="none"||t&&de(i,"position")!=="static")){var m=i.getBoundingClientRect();s-=m.top+parseInt(de(i,"border-top-width")),a-=m.left+parseInt(de(i,"border-left-width")),l=s+o.height,d=a+o.width;break}while(i=i.parentNode);if(r&&n!==window){var g=Ss(i||n),b=g&&g.a,v=g&&g.d;g&&(s/=v,a/=b,h/=b,f/=v,l=s+f,d=a+h)}return{top:s,left:a,bottom:l,right:d,width:h,height:f}}}function Sg(n,e,t){for(var r=$i(n,!0),i=mt(n)[e];r;){var o=mt(r)[t],s=void 0;if(s=i>=o,!s)return r;if(r===Fr())break;r=$i(r,!1)}return!1}function Ms(n,e,t,r){for(var i=0,o=0,s=n.children;o<s.length;){if(s[o].style.display!=="none"&&s[o]!==fe.ghost&&(r||s[o]!==fe.dragged)&&br(s[o],t.draggable,n,!1)){if(i===e)return s[o];i++}o++}return null}function Gh(n,e){for(var t=n.lastElementChild;t&&(t===fe.ghost||de(t,"display")==="none"||e&&!Xl(t,e));)t=t.previousElementSibling;return t||null}function Zn(n,e){var t=0;if(!n||!n.parentNode)return-1;for(;n=n.previousElementSibling;)n.nodeName.toUpperCase()!=="TEMPLATE"&&n!==fe.clone&&(!e||Xl(n,e))&&t++;return t}function Cg(n){var e=0,t=0,r=Fr();if(n)do{var i=Ss(n),o=i.a,s=i.d;e+=n.scrollLeft*o,t+=n.scrollTop*s}while(n!==r&&(n=n.parentNode));return[e,t]}function oA(n,e){for(var t in n)if(n.hasOwnProperty(t)){for(var r in e)if(e.hasOwnProperty(r)&&e[r]===n[t][r])return Number(t)}return-1}function $i(n,e){if(!n||!n.getBoundingClientRect)return Fr();var t=n,r=!1;do if(t.clientWidth<t.scrollWidth||t.clientHeight<t.scrollHeight){var i=de(t);if(t.clientWidth<t.scrollWidth&&(i.overflowX=="auto"||i.overflowX=="scroll")||t.clientHeight<t.scrollHeight&&(i.overflowY=="auto"||i.overflowY=="scroll")){if(!t.getBoundingClientRect||t===document.body)return Fr();if(r||e)return t;r=!0}}while(t=t.parentNode);return Fr()}function sA(n,e){if(n&&e)for(var t in e)e.hasOwnProperty(t)&&(n[t]=e[t]);return n}function sf(n,e){return Math.round(n.top)===Math.round(e.top)&&Math.round(n.left)===Math.round(e.left)&&Math.round(n.height)===Math.round(e.height)&&Math.round(n.width)===Math.round(e.width)}var Ia;function ty(n,e){return function(){if(!Ia){var t=arguments,r=this;t.length===1?n.call(r,t[0]):n.apply(r,t),Ia=setTimeout(function(){Ia=void 0},e)}}}function aA(){clearTimeout(Ia),Ia=void 0}function ny(n,e,t){n.scrollLeft+=e,n.scrollTop+=t}function ry(n){var e=window.Polymer,t=window.jQuery||window.Zepto;return e&&e.dom?e.dom(n).cloneNode(!0):t?t(n).clone(!0)[0]:n.cloneNode(!0)}function iy(n,e,t){var r={};return Array.from(n.children).forEach(function(i){var o,s,a,l;if(!(!br(i,e.draggable,n,!1)||i.animated||i===t)){var d=mt(i);r.left=Math.min((o=r.left)!==null&&o!==void 0?o:1/0,d.left),r.top=Math.min((s=r.top)!==null&&s!==void 0?s:1/0,d.top),r.right=Math.max((a=r.right)!==null&&a!==void 0?a:-1/0,d.right),r.bottom=Math.max((l=r.bottom)!==null&&l!==void 0?l:-1/0,d.bottom)}}),r.width=r.right-r.left,r.height=r.bottom-r.top,r.x=r.left,r.y=r.top,r}var Rn="Sortable"+new Date().getTime();function uA(){var n=[],e;return{captureAnimationState:function(){if(n=[],!!this.options.animation){var r=[].slice.call(this.el.children);r.forEach(function(i){if(!(de(i,"display")==="none"||i===fe.ghost)){n.push({target:i,rect:mt(i)});var o=Br({},n[n.length-1].rect);if(i.thisAnimationDuration){var s=Ss(i,!0);s&&(o.top-=s.f,o.left-=s.e)}i.fromRect=o}})}},addAnimationState:function(r){n.push(r)},removeAnimationState:function(r){n.splice(oA(n,{target:r}),1)},animateAll:function(r){var i=this;if(!this.options.animation){clearTimeout(e),typeof r=="function"&&r();return}var o=!1,s=0;n.forEach(function(a){var l=0,d=a.target,f=d.fromRect,h=mt(d),m=d.prevFromRect,g=d.prevToRect,b=a.rect,v=Ss(d,!0);v&&(h.top-=v.f,h.left-=v.e),d.toRect=h,d.thisAnimationDuration&&sf(m,h)&&!sf(f,h)&&(b.top-h.top)/(b.left-h.left)===(f.top-h.top)/(f.left-h.left)&&(l=cA(b,m,g,i.options)),sf(h,f)||(d.prevFromRect=f,d.prevToRect=h,l||(l=i.options.animation),i.animate(d,b,h,l)),l&&(o=!0,s=Math.max(s,l),clearTimeout(d.animationResetTimer),d.animationResetTimer=setTimeout(function(){d.animationTime=0,d.prevFromRect=null,d.fromRect=null,d.prevToRect=null,d.thisAnimationDuration=null},l),d.thisAnimationDuration=l)}),clearTimeout(e),o?e=setTimeout(function(){typeof r=="function"&&r()},s):typeof r=="function"&&r(),n=[]},animate:function(r,i,o,s){if(s){de(r,"transition",""),de(r,"transform","");var a=Ss(this.el),l=a&&a.a,d=a&&a.d,f=(i.left-o.left)/(l||1),h=(i.top-o.top)/(d||1);r.animatingX=!!f,r.animatingY=!!h,de(r,"transform","translate3d("+f+"px,"+h+"px,0)"),this.forRepaintDummy=lA(r),de(r,"transition","transform "+s+"ms"+(this.options.easing?" "+this.options.easing:"")),de(r,"transform","translate3d(0,0,0)"),typeof r.animated=="number"&&clearTimeout(r.animated),r.animated=setTimeout(function(){de(r,"transition",""),de(r,"transform",""),r.animated=!1,r.animatingX=!1,r.animatingY=!1},s)}}}}function lA(n){return n.offsetWidth}function cA(n,e,t,r){return Math.sqrt(Math.pow(e.top-n.top,2)+Math.pow(e.left-n.left,2))/Math.sqrt(Math.pow(e.top-t.top,2)+Math.pow(e.left-t.left,2))*r.animation}var ss=[],af={initializeByDefault:!0},cu={mount:function(e){for(var t in af)af.hasOwnProperty(t)&&!(t in e)&&(e[t]=af[t]);ss.forEach(function(r){if(r.pluginName===e.pluginName)throw"Sortable: Cannot mount plugin ".concat(e.pluginName," more than once")}),ss.push(e)},pluginEvent:function(e,t,r){var i=this;this.eventCanceled=!1,r.cancel=function(){i.eventCanceled=!0};var o=e+"Global";ss.forEach(function(s){t[s.pluginName]&&(t[s.pluginName][o]&&t[s.pluginName][o](Br({sortable:t},r)),t.options[s.pluginName]&&t[s.pluginName][e]&&t[s.pluginName][e](Br({sortable:t},r)))})},initializePlugins:function(e,t,r,i){ss.forEach(function(a){var l=a.pluginName;if(!(!e.options[l]&&!a.initializeByDefault)){var d=new a(e,t,e.options);d.sortable=e,d.options=e.options,e[l]=d,hi(r,d.defaults)}});for(var o in e.options)if(e.options.hasOwnProperty(o)){var s=this.modifyOption(e,o,e.options[o]);typeof s<"u"&&(e.options[o]=s)}},getEventProperties:function(e,t){var r={};return ss.forEach(function(i){typeof i.eventProperties=="function"&&hi(r,i.eventProperties.call(t[i.pluginName],e))}),r},modifyOption:function(e,t,r){var i;return ss.forEach(function(o){e[o.pluginName]&&o.optionListeners&&typeof o.optionListeners[t]=="function"&&(i=o.optionListeners[t].call(e[o.pluginName],r))}),i}};function dA(n){var e=n.sortable,t=n.rootEl,r=n.name,i=n.targetEl,o=n.cloneEl,s=n.toEl,a=n.fromEl,l=n.oldIndex,d=n.newIndex,f=n.oldDraggableIndex,h=n.newDraggableIndex,m=n.originalEvent,g=n.putSortable,b=n.extraEventProperties;if(e=e||t&&t[Rn],!!e){var v,x=e.options,E="on"+r.charAt(0).toUpperCase()+r.substr(1);window.CustomEvent&&!mi&&!lu?v=new CustomEvent(r,{bubbles:!0,cancelable:!0}):(v=document.createEvent("Event"),v.initEvent(r,!0,!0)),v.to=s||t,v.from=a||t,v.item=i||t,v.clone=o,v.oldIndex=l,v.newIndex=d,v.oldDraggableIndex=f,v.newDraggableIndex=h,v.originalEvent=m,v.pullMode=g?g.lastPutMode:void 0;var A=Br(Br({},b),cu.getEventProperties(r,e));for(var M in A)v[M]=A[M];t&&t.dispatchEvent(v),x[E]&&x[E].call(e,v)}}var fA=["evt"],gn=function(e,t){var r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{},i=r.evt,o=nA(r,fA);cu.pluginEvent.bind(fe)(e,t,Br({dragEl:K,parentEl:ot,ghostEl:ye,rootEl:Qe,nextEl:yo,lastDownEl:Pl,cloneEl:nt,cloneHidden:Fi,dragStarted:xa,putSortable:Nt,activeSortable:fe.active,originalEvent:i,oldIndex:vs,oldDraggableIndex:Na,newIndex:Nn,newDraggableIndex:Mi,hideGhostForTarget:uy,unhideGhostForTarget:ly,cloneNowHidden:function(){Fi=!0},cloneNowShown:function(){Fi=!1},dispatchSortableEvent:function(a){on({sortable:t,name:a,originalEvent:i})}},o))};function on(n){dA(Br({putSortable:Nt,cloneEl:nt,targetEl:K,rootEl:Qe,oldIndex:vs,oldDraggableIndex:Na,newIndex:Nn,newDraggableIndex:Mi},n))}var K,ot,ye,Qe,yo,Pl,nt,Fi,vs,Nn,Na,Mi,dl,Nt,ps=!1,Yl=!1,Jl=[],po,pr,uf,lf,Eg,_g,xa,as,Pa,Fa=!1,fl=!1,Fl,Kt,cf=[],ah=!1,Zl=[],Ec=typeof document<"u",hl=Jb,Ag=lu||mi?"cssFloat":"float",hA=Ec&&!Zb&&!Jb&&"draggable"in document.createElement("div"),oy=function(){if(Ec){if(mi)return!1;var n=document.createElement("x");return n.style.cssText="pointer-events:auto",n.style.pointerEvents==="auto"}}(),sy=function(e,t){var r=de(e),i=parseInt(r.width)-parseInt(r.paddingLeft)-parseInt(r.paddingRight)-parseInt(r.borderLeftWidth)-parseInt(r.borderRightWidth),o=Ms(e,0,t),s=Ms(e,1,t),a=o&&de(o),l=s&&de(s),d=a&&parseInt(a.marginLeft)+parseInt(a.marginRight)+mt(o).width,f=l&&parseInt(l.marginLeft)+parseInt(l.marginRight)+mt(s).width;if(r.display==="flex")return r.flexDirection==="column"||r.flexDirection==="column-reverse"?"vertical":"horizontal";if(r.display==="grid")return r.gridTemplateColumns.split(" ").length<=1?"vertical":"horizontal";if(o&&a.float&&a.float!=="none"){var h=a.float==="left"?"left":"right";return s&&(l.clear==="both"||l.clear===h)?"vertical":"horizontal"}return o&&(a.display==="block"||a.display==="flex"||a.display==="table"||a.display==="grid"||d>=i&&r[Ag]==="none"||s&&r[Ag]==="none"&&d+f>i)?"vertical":"horizontal"},pA=function(e,t,r){var i=r?e.left:e.top,o=r?e.right:e.bottom,s=r?e.width:e.height,a=r?t.left:t.top,l=r?t.right:t.bottom,d=r?t.width:t.height;return i===a||o===l||i+s/2===a+d/2},mA=function(e,t){var r;return Jl.some(function(i){var o=i[Rn].options.emptyInsertThreshold;if(!(!o||Gh(i))){var s=mt(i),a=e>=s.left-o&&e<=s.right+o,l=t>=s.top-o&&t<=s.bottom+o;if(a&&l)return r=i}}),r},ay=function(e){function t(o,s){return function(a,l,d,f){var h=a.options.group.name&&l.options.group.name&&a.options.group.name===l.options.group.name;if(o==null&&(s||h))return!0;if(o==null||o===!1)return!1;if(s&&o==="clone")return o;if(typeof o=="function")return t(o(a,l,d,f),s)(a,l,d,f);var m=(s?a:l).options.group.name;return o===!0||typeof o=="string"&&o===m||o.join&&o.indexOf(m)>-1}}var r={},i=e.group;(!i||Nl(i)!="object")&&(i={name:i}),r.name=i.name,r.checkPull=t(i.pull,!0),r.checkPut=t(i.put),r.revertClone=i.revertClone,e.group=r},uy=function(){!oy&&ye&&de(ye,"display","none")},ly=function(){!oy&&ye&&de(ye,"display","")};Ec&&!Zb&&document.addEventListener("click",function(n){if(Yl)return n.preventDefault(),n.stopPropagation&&n.stopPropagation(),n.stopImmediatePropagation&&n.stopImmediatePropagation(),Yl=!1,!1},!0);var mo=function(e){if(K){e=e.touches?e.touches[0]:e;var t=mA(e.clientX,e.clientY);if(t){var r={};for(var i in e)e.hasOwnProperty(i)&&(r[i]=e[i]);r.target=r.rootEl=t,r.preventDefault=void 0,r.stopPropagation=void 0,t[Rn]._onDragOver(r)}}},gA=function(e){K&&K.parentNode[Rn]._isOutsideThisEl(e.target)};function fe(n,e){if(!(n&&n.nodeType&&n.nodeType===1))throw"Sortable: `el` must be an HTMLElement, not ".concat({}.toString.call(n));this.el=n,this.options=e=hi({},e),n[Rn]=this;var t={group:null,sort:!0,disabled:!1,store:null,handle:null,draggable:/^[uo]l$/i.test(n.nodeName)?">li":">*",swapThreshold:1,invertSwap:!1,invertedSwapThreshold:null,removeCloneOnHide:!0,direction:function(){return sy(n,this.options)},ghostClass:"sortable-ghost",chosenClass:"sortable-chosen",dragClass:"sortable-drag",ignore:"a, img",filter:null,preventOnFilter:!0,animation:0,easing:null,setData:function(s,a){s.setData("Text",a.textContent)},dropBubble:!1,dragoverBubble:!1,dataIdAttr:"data-id",delay:0,delayOnTouchOnly:!1,touchStartThreshold:(Number.parseInt?Number:window).parseInt(window.devicePixelRatio,10)||1,forceFallback:!1,fallbackClass:"sortable-fallback",fallbackOnBody:!1,fallbackTolerance:0,fallbackOffset:{x:0,y:0},supportPointer:fe.supportPointer!==!1&&"PointerEvent"in window&&!Oa,emptyInsertThreshold:5};cu.initializePlugins(this,n,t);for(var r in t)!(r in e)&&(e[r]=t[r]);ay(e);for(var i in this)i.charAt(0)==="_"&&typeof this[i]=="function"&&(this[i]=this[i].bind(this));this.nativeDraggable=e.forceFallback?!1:hA,this.nativeDraggable&&(this.options.touchStartThreshold=1),e.supportPointer?ze(n,"pointerdown",this._onTapStart):(ze(n,"mousedown",this._onTapStart),ze(n,"touchstart",this._onTapStart)),this.nativeDraggable&&(ze(n,"dragover",this),ze(n,"dragenter",this)),Jl.push(this.el),e.store&&e.store.get&&this.sort(e.store.get(this)||[]),hi(this,uA())}fe.prototype={constructor:fe,_isOutsideThisEl:function(e){!this.el.contains(e)&&e!==this.el&&(as=null)},_getDirection:function(e,t){return typeof this.options.direction=="function"?this.options.direction.call(this,e,t,K):this.options.direction},_onTapStart:function(e){if(e.cancelable){var t=this,r=this.el,i=this.options,o=i.preventOnFilter,s=e.type,a=e.touches&&e.touches[0]||e.pointerType&&e.pointerType==="touch"&&e,l=(a||e).target,d=e.target.shadowRoot&&(e.path&&e.path[0]||e.composedPath&&e.composedPath()[0])||l,f=i.filter;if(CA(r),!K&&!(/mousedown|pointerdown/.test(s)&&e.button!==0||i.disabled)&&!d.isContentEditable&&!(!this.nativeDraggable&&Oa&&l&&l.tagName.toUpperCase()==="SELECT")&&(l=br(l,i.draggable,r,!1),!(l&&l.animated)&&Pl!==l)){if(vs=Zn(l),Na=Zn(l,i.draggable),typeof f=="function"){if(f.call(this,e,l,this)){on({sortable:t,rootEl:d,name:"filter",targetEl:l,toEl:r,fromEl:r}),gn("filter",t,{evt:e}),o&&e.cancelable&&e.preventDefault();return}}else if(f&&(f=f.split(",").some(function(h){if(h=br(d,h.trim(),r,!1),h)return on({sortable:t,rootEl:h,name:"filter",targetEl:l,fromEl:r,toEl:r}),gn("filter",t,{evt:e}),!0}),f)){o&&e.cancelable&&e.preventDefault();return}i.handle&&!br(d,i.handle,r,!1)||this._prepareDragStart(e,a,l)}}},_prepareDragStart:function(e,t,r){var i=this,o=i.el,s=i.options,a=o.ownerDocument,l;if(r&&!K&&r.parentNode===o){var d=mt(r);if(Qe=o,K=r,ot=K.parentNode,yo=K.nextSibling,Pl=r,dl=s.group,fe.dragged=K,po={target:K,clientX:(t||e).clientX,clientY:(t||e).clientY},Eg=po.clientX-d.left,_g=po.clientY-d.top,this._lastX=(t||e).clientX,this._lastY=(t||e).clientY,K.style["will-change"]="all",l=function(){if(gn("delayEnded",i,{evt:e}),fe.eventCanceled){i._onDrop();return}i._disableDelayedDragEvents(),!wg&&i.nativeDraggable&&(K.draggable=!0),i._triggerDragStart(e,t),on({sortable:i,name:"choose",originalEvent:e}),On(K,s.chosenClass,!0)},s.ignore.split(",").forEach(function(f){ey(K,f.trim(),df)}),ze(a,"dragover",mo),ze(a,"mousemove",mo),ze(a,"touchmove",mo),ze(a,"mouseup",i._onDrop),ze(a,"touchend",i._onDrop),ze(a,"touchcancel",i._onDrop),wg&&this.nativeDraggable&&(this.options.touchStartThreshold=4,K.draggable=!0),gn("delayStart",this,{evt:e}),s.delay&&(!s.delayOnTouchOnly||t)&&(!this.nativeDraggable||!(lu||mi))){if(fe.eventCanceled){this._onDrop();return}ze(a,"mouseup",i._disableDelayedDrag),ze(a,"touchend",i._disableDelayedDrag),ze(a,"touchcancel",i._disableDelayedDrag),ze(a,"mousemove",i._delayedDragTouchMoveHandler),ze(a,"touchmove",i._delayedDragTouchMoveHandler),s.supportPointer&&ze(a,"pointermove",i._delayedDragTouchMoveHandler),i._dragStartTimer=setTimeout(l,s.delay)}else l()}},_delayedDragTouchMoveHandler:function(e){var t=e.touches?e.touches[0]:e;Math.max(Math.abs(t.clientX-this._lastX),Math.abs(t.clientY-this._lastY))>=Math.floor(this.options.touchStartThreshold/(this.nativeDraggable&&window.devicePixelRatio||1))&&this._disableDelayedDrag()},_disableDelayedDrag:function(){K&&df(K),clearTimeout(this._dragStartTimer),this._disableDelayedDragEvents()},_disableDelayedDragEvents:function(){var e=this.el.ownerDocument;Le(e,"mouseup",this._disableDelayedDrag),Le(e,"touchend",this._disableDelayedDrag),Le(e,"touchcancel",this._disableDelayedDrag),Le(e,"mousemove",this._delayedDragTouchMoveHandler),Le(e,"touchmove",this._delayedDragTouchMoveHandler),Le(e,"pointermove",this._delayedDragTouchMoveHandler)},_triggerDragStart:function(e,t){t=t||e.pointerType=="touch"&&e,!this.nativeDraggable||t?this.options.supportPointer?ze(document,"pointermove",this._onTouchMove):t?ze(document,"touchmove",this._onTouchMove):ze(document,"mousemove",this._onTouchMove):(ze(K,"dragend",this),ze(Qe,"dragstart",this._onDragStart));try{document.selection?Rl(function(){document.selection.empty()}):window.getSelection().removeAllRanges()}catch{}},_dragStarted:function(e,t){if(ps=!1,Qe&&K){gn("dragStarted",this,{evt:t}),this.nativeDraggable&&ze(document,"dragover",gA);var r=this.options;!e&&On(K,r.dragClass,!1),On(K,r.ghostClass,!0),fe.active=this,e&&this._appendGhost(),on({sortable:this,name:"start",originalEvent:t})}else this._nulling()},_emulateDragOver:function(){if(pr){this._lastX=pr.clientX,this._lastY=pr.clientY,uy();for(var e=document.elementFromPoint(pr.clientX,pr.clientY),t=e;e&&e.shadowRoot&&(e=e.shadowRoot.elementFromPoint(pr.clientX,pr.clientY),e!==t);)t=e;if(K.parentNode[Rn]._isOutsideThisEl(e),t)do{if(t[Rn]){var r=void 0;if(r=t[Rn]._onDragOver({clientX:pr.clientX,clientY:pr.clientY,target:e,rootEl:t}),r&&!this.options.dragoverBubble)break}e=t}while(t=t.parentNode);ly()}},_onTouchMove:function(e){if(po){var t=this.options,r=t.fallbackTolerance,i=t.fallbackOffset,o=e.touches?e.touches[0]:e,s=ye&&Ss(ye,!0),a=ye&&s&&s.a,l=ye&&s&&s.d,d=hl&&Kt&&Cg(Kt),f=(o.clientX-po.clientX+i.x)/(a||1)+(d?d[0]-cf[0]:0)/(a||1),h=(o.clientY-po.clientY+i.y)/(l||1)+(d?d[1]-cf[1]:0)/(l||1);if(!fe.active&&!ps){if(r&&Math.max(Math.abs(o.clientX-this._lastX),Math.abs(o.clientY-this._lastY))<r)return;this._onDragStart(e,!0)}if(ye){s?(s.e+=f-(uf||0),s.f+=h-(lf||0)):s={a:1,b:0,c:0,d:1,e:f,f:h};var m="matrix(".concat(s.a,",").concat(s.b,",").concat(s.c,",").concat(s.d,",").concat(s.e,",").concat(s.f,")");de(ye,"webkitTransform",m),de(ye,"mozTransform",m),de(ye,"msTransform",m),de(ye,"transform",m),uf=f,lf=h,pr=o}e.cancelable&&e.preventDefault()}},_appendGhost:function(){if(!ye){var e=this.options.fallbackOnBody?document.body:Qe,t=mt(K,!0,hl,!0,e),r=this.options;if(hl){for(Kt=e;de(Kt,"position")==="static"&&de(Kt,"transform")==="none"&&Kt!==document;)Kt=Kt.parentNode;Kt!==document.body&&Kt!==document.documentElement?(Kt===document&&(Kt=Fr()),t.top+=Kt.scrollTop,t.left+=Kt.scrollLeft):Kt=Fr(),cf=Cg(Kt)}ye=K.cloneNode(!0),On(ye,r.ghostClass,!1),On(ye,r.fallbackClass,!0),On(ye,r.dragClass,!0),de(ye,"transition",""),de(ye,"transform",""),de(ye,"box-sizing","border-box"),de(ye,"margin",0),de(ye,"top",t.top),de(ye,"left",t.left),de(ye,"width",t.width),de(ye,"height",t.height),de(ye,"opacity","0.8"),de(ye,"position",hl?"absolute":"fixed"),de(ye,"zIndex","100000"),de(ye,"pointerEvents","none"),fe.ghost=ye,e.appendChild(ye),de(ye,"transform-origin",Eg/parseInt(ye.style.width)*100+"% "+_g/parseInt(ye.style.height)*100+"%")}},_onDragStart:function(e,t){var r=this,i=e.dataTransfer,o=r.options;if(gn("dragStart",this,{evt:e}),fe.eventCanceled){this._onDrop();return}gn("setupClone",this),fe.eventCanceled||(nt=ry(K),nt.removeAttribute("id"),nt.draggable=!1,nt.style["will-change"]="",this._hideClone(),On(nt,this.options.chosenClass,!1),fe.clone=nt),r.cloneId=Rl(function(){gn("clone",r),!fe.eventCanceled&&(r.options.removeCloneOnHide||Qe.insertBefore(nt,K),r._hideClone(),on({sortable:r,name:"clone"}))}),!t&&On(K,o.dragClass,!0),t?(Yl=!0,r._loopId=setInterval(r._emulateDragOver,50)):(Le(document,"mouseup",r._onDrop),Le(document,"touchend",r._onDrop),Le(document,"touchcancel",r._onDrop),i&&(i.effectAllowed="move",o.setData&&o.setData.call(r,i,K)),ze(document,"drop",r),de(K,"transform","translateZ(0)")),ps=!0,r._dragStartId=Rl(r._dragStarted.bind(r,t,e)),ze(document,"selectstart",r),xa=!0,Oa&&de(document.body,"user-select","none")},_onDragOver:function(e){var t=this.el,r=e.target,i,o,s,a=this.options,l=a.group,d=fe.active,f=dl===l,h=a.sort,m=Nt||d,g,b=this,v=!1;if(ah)return;function x(Oe,Ht){gn(Oe,b,Br({evt:e,isOwner:f,axis:g?"vertical":"horizontal",revert:s,dragRect:i,targetRect:o,canSort:h,fromSortable:m,target:r,completed:A,onMove:function(Je,qt){return pl(Qe,t,K,i,Je,mt(Je),e,qt)},changed:M},Ht))}function E(){x("dragOverAnimationCapture"),b.captureAnimationState(),b!==m&&m.captureAnimationState()}function A(Oe){return x("dragOverCompleted",{insertion:Oe}),Oe&&(f?d._hideClone():d._showClone(b),b!==m&&(On(K,Nt?Nt.options.ghostClass:d.options.ghostClass,!1),On(K,a.ghostClass,!0)),Nt!==b&&b!==fe.active?Nt=b:b===fe.active&&Nt&&(Nt=null),m===b&&(b._ignoreWhileAnimating=r),b.animateAll(function(){x("dragOverAnimationComplete"),b._ignoreWhileAnimating=null}),b!==m&&(m.animateAll(),m._ignoreWhileAnimating=null)),(r===K&&!K.animated||r===t&&!r.animated)&&(as=null),!a.dragoverBubble&&!e.rootEl&&r!==document&&(K.parentNode[Rn]._isOutsideThisEl(e.target),!Oe&&mo(e)),!a.dragoverBubble&&e.stopPropagation&&e.stopPropagation(),v=!0}function M(){Nn=Zn(K),Mi=Zn(K,a.draggable),on({sortable:b,name:"change",toEl:t,newIndex:Nn,newDraggableIndex:Mi,originalEvent:e})}if(e.preventDefault!==void 0&&e.cancelable&&e.preventDefault(),r=br(r,a.draggable,t,!0),x("dragOver"),fe.eventCanceled)return v;if(K.contains(e.target)||r.animated&&r.animatingX&&r.animatingY||b._ignoreWhileAnimating===r)return A(!1);if(Yl=!1,d&&!a.disabled&&(f?h||(s=ot!==Qe):Nt===this||(this.lastPutMode=dl.checkPull(this,d,K,e))&&l.checkPut(this,d,K,e))){if(g=this._getDirection(e,r)==="vertical",i=mt(K),x("dragOverValid"),fe.eventCanceled)return v;if(s)return ot=Qe,E(),this._hideClone(),x("revert"),fe.eventCanceled||(yo?Qe.insertBefore(K,yo):Qe.appendChild(K)),A(!0);var C=Gh(t,a.draggable);if(!C||xA(e,g,this)&&!C.animated){if(C===K)return A(!1);if(C&&t===e.target&&(r=C),r&&(o=mt(r)),pl(Qe,t,K,i,r,o,e,!!r)!==!1)return E(),C&&C.nextSibling?t.insertBefore(K,C.nextSibling):t.appendChild(K),ot=t,M(),A(!0)}else if(C&&vA(e,g,this)){var P=Ms(t,0,a,!0);if(P===K)return A(!1);if(r=P,o=mt(r),pl(Qe,t,K,i,r,o,e,!1)!==!1)return E(),t.insertBefore(K,P),ot=t,M(),A(!0)}else if(r.parentNode===t){o=mt(r);var N=0,W,V=K.parentNode!==t,U=!pA(K.animated&&K.toRect||i,r.animated&&r.toRect||o,g),Q=g?"top":"left",oe=Sg(r,"top","top")||Sg(K,"top","top"),me=oe?oe.scrollTop:void 0;as!==r&&(W=o[Q],Fa=!1,fl=!U&&a.invertSwap||V),N=wA(e,r,o,g,U?1:a.swapThreshold,a.invertedSwapThreshold==null?a.swapThreshold:a.invertedSwapThreshold,fl,as===r);var se;if(N!==0){var Ee=Zn(K);do Ee-=N,se=ot.children[Ee];while(se&&(de(se,"display")==="none"||se===ye))}if(N===0||se===r)return A(!1);as=r,Pa=N;var Me=r.nextElementSibling,he=!1;he=N===1;var we=pl(Qe,t,K,i,r,o,e,he);if(we!==!1)return(we===1||we===-1)&&(he=we===1),ah=!0,setTimeout(yA,30),E(),he&&!Me?t.appendChild(K):r.parentNode.insertBefore(K,he?Me:r),oe&&ny(oe,0,me-oe.scrollTop),ot=K.parentNode,W!==void 0&&!fl&&(Fl=Math.abs(W-mt(r)[Q])),M(),A(!0)}if(t.contains(K))return A(!1)}return!1},_ignoreWhileAnimating:null,_offMoveEvents:function(){Le(document,"mousemove",this._onTouchMove),Le(document,"touchmove",this._onTouchMove),Le(document,"pointermove",this._onTouchMove),Le(document,"dragover",mo),Le(document,"mousemove",mo),Le(document,"touchmove",mo)},_offUpEvents:function(){var e=this.el.ownerDocument;Le(e,"mouseup",this._onDrop),Le(e,"touchend",this._onDrop),Le(e,"pointerup",this._onDrop),Le(e,"touchcancel",this._onDrop),Le(document,"selectstart",this)},_onDrop:function(e){var t=this.el,r=this.options;if(Nn=Zn(K),Mi=Zn(K,r.draggable),gn("drop",this,{evt:e}),ot=K&&K.parentNode,Nn=Zn(K),Mi=Zn(K,r.draggable),fe.eventCanceled){this._nulling();return}ps=!1,fl=!1,Fa=!1,clearInterval(this._loopId),clearTimeout(this._dragStartTimer),uh(this.cloneId),uh(this._dragStartId),this.nativeDraggable&&(Le(document,"drop",this),Le(t,"dragstart",this._onDragStart)),this._offMoveEvents(),this._offUpEvents(),Oa&&de(document.body,"user-select",""),de(K,"transform",""),e&&(xa&&(e.cancelable&&e.preventDefault(),!r.dropBubble&&e.stopPropagation()),ye&&ye.parentNode&&ye.parentNode.removeChild(ye),(Qe===ot||Nt&&Nt.lastPutMode!=="clone")&&nt&&nt.parentNode&&nt.parentNode.removeChild(nt),K&&(this.nativeDraggable&&Le(K,"dragend",this),df(K),K.style["will-change"]="",xa&&!ps&&On(K,Nt?Nt.options.ghostClass:this.options.ghostClass,!1),On(K,this.options.chosenClass,!1),on({sortable:this,name:"unchoose",toEl:ot,newIndex:null,newDraggableIndex:null,originalEvent:e}),Qe!==ot?(Nn>=0&&(on({rootEl:ot,name:"add",toEl:ot,fromEl:Qe,originalEvent:e}),on({sortable:this,name:"remove",toEl:ot,originalEvent:e}),on({rootEl:ot,name:"sort",toEl:ot,fromEl:Qe,originalEvent:e}),on({sortable:this,name:"sort",toEl:ot,originalEvent:e})),Nt&&Nt.save()):Nn!==vs&&Nn>=0&&(on({sortable:this,name:"update",toEl:ot,originalEvent:e}),on({sortable:this,name:"sort",toEl:ot,originalEvent:e})),fe.active&&((Nn==null||Nn===-1)&&(Nn=vs,Mi=Na),on({sortable:this,name:"end",toEl:ot,originalEvent:e}),this.save()))),this._nulling()},_nulling:function(){gn("nulling",this),Qe=K=ot=ye=yo=nt=Pl=Fi=po=pr=xa=Nn=Mi=vs=Na=as=Pa=Nt=dl=fe.dragged=fe.ghost=fe.clone=fe.active=null,Zl.forEach(function(e){e.checked=!0}),Zl.length=uf=lf=0},handleEvent:function(e){switch(e.type){case"drop":case"dragend":this._onDrop(e);break;case"dragenter":case"dragover":K&&(this._onDragOver(e),bA(e));break;case"selectstart":e.preventDefault();break}},toArray:function(){for(var e=[],t,r=this.el.children,i=0,o=r.length,s=this.options;i<o;i++)t=r[i],br(t,s.draggable,this.el,!1)&&e.push(t.getAttribute(s.dataIdAttr)||SA(t));return e},sort:function(e,t){var r={},i=this.el;this.toArray().forEach(function(o,s){var a=i.children[s];br(a,this.options.draggable,i,!1)&&(r[o]=a)},this),t&&this.captureAnimationState(),e.forEach(function(o){r[o]&&(i.removeChild(r[o]),i.appendChild(r[o]))}),t&&this.animateAll()},save:function(){var e=this.options.store;e&&e.set&&e.set(this)},closest:function(e,t){return br(e,t||this.options.draggable,this.el,!1)},option:function(e,t){var r=this.options;if(t===void 0)return r[e];var i=cu.modifyOption(this,e,t);typeof i<"u"?r[e]=i:r[e]=t,e==="group"&&ay(r)},destroy:function(){gn("destroy",this);var e=this.el;e[Rn]=null,Le(e,"mousedown",this._onTapStart),Le(e,"touchstart",this._onTapStart),Le(e,"pointerdown",this._onTapStart),this.nativeDraggable&&(Le(e,"dragover",this),Le(e,"dragenter",this)),Array.prototype.forEach.call(e.querySelectorAll("[draggable]"),function(t){t.removeAttribute("draggable")}),this._onDrop(),this._disableDelayedDragEvents(),Jl.splice(Jl.indexOf(this.el),1),this.el=e=null},_hideClone:function(){if(!Fi){if(gn("hideClone",this),fe.eventCanceled)return;de(nt,"display","none"),this.options.removeCloneOnHide&&nt.parentNode&&nt.parentNode.removeChild(nt),Fi=!0}},_showClone:function(e){if(e.lastPutMode!=="clone"){this._hideClone();return}if(Fi){if(gn("showClone",this),fe.eventCanceled)return;K.parentNode==Qe&&!this.options.group.revertClone?Qe.insertBefore(nt,K):yo?Qe.insertBefore(nt,yo):Qe.appendChild(nt),this.options.group.revertClone&&this.animate(K,nt),de(nt,"display",""),Fi=!1}}};function bA(n){n.dataTransfer&&(n.dataTransfer.dropEffect="move"),n.cancelable&&n.preventDefault()}function pl(n,e,t,r,i,o,s,a){var l,d=n[Rn],f=d.options.onMove,h;return window.CustomEvent&&!mi&&!lu?l=new CustomEvent("move",{bubbles:!0,cancelable:!0}):(l=document.createEvent("Event"),l.initEvent("move",!0,!0)),l.to=e,l.from=n,l.dragged=t,l.draggedRect=r,l.related=i||e,l.relatedRect=o||mt(e),l.willInsertAfter=a,l.originalEvent=s,n.dispatchEvent(l),f&&(h=f.call(d,l,s)),h}function df(n){n.draggable=!1}function yA(){ah=!1}function vA(n,e,t){var r=mt(Ms(t.el,0,t.options,!0)),i=iy(t.el,t.options,ye),o=10;return e?n.clientX<i.left-o||n.clientY<r.top&&n.clientX<r.right:n.clientY<i.top-o||n.clientY<r.bottom&&n.clientX<r.left}function xA(n,e,t){var r=mt(Gh(t.el,t.options.draggable)),i=iy(t.el,t.options,ye),o=10;return e?n.clientX>i.right+o||n.clientY>r.bottom&&n.clientX>r.left:n.clientY>i.bottom+o||n.clientX>r.right&&n.clientY>r.top}function wA(n,e,t,r,i,o,s,a){var l=r?n.clientY:n.clientX,d=r?t.height:t.width,f=r?t.top:t.left,h=r?t.bottom:t.right,m=!1;if(!s){if(a&&Fl<d*i){if(!Fa&&(Pa===1?l>f+d*o/2:l<h-d*o/2)&&(Fa=!0),Fa)m=!0;else if(Pa===1?l<f+Fl:l>h-Fl)return-Pa}else if(l>f+d*(1-i)/2&&l<h-d*(1-i)/2)return kA(e)}return m=m||s,m&&(l<f+d*o/2||l>h-d*o/2)?l>f+d/2?1:-1:0}function kA(n){return Zn(K)<Zn(n)?1:-1}function SA(n){for(var e=n.tagName+n.className+n.src+n.href+n.textContent,t=e.length,r=0;t--;)r+=e.charCodeAt(t);return r.toString(36)}function CA(n){Zl.length=0;for(var e=n.getElementsByTagName("input"),t=e.length;t--;){var r=e[t];r.checked&&Zl.push(r)}}function Rl(n){return setTimeout(n,0)}function uh(n){return clearTimeout(n)}Ec&&ze(document,"touchmove",function(n){(fe.active||ps)&&n.cancelable&&n.preventDefault()});fe.utils={on:ze,off:Le,css:de,find:ey,is:function(e,t){return!!br(e,t,e,!1)},extend:sA,throttle:ty,closest:br,toggleClass:On,clone:ry,index:Zn,nextTick:Rl,cancelNextTick:uh,detectDirection:sy,getChild:Ms};fe.get=function(n){return n[Rn]};fe.mount=function(){for(var n=arguments.length,e=new Array(n),t=0;t<n;t++)e[t]=arguments[t];e[0].constructor===Array&&(e=e[0]),e.forEach(function(r){if(!r.prototype||!r.prototype.constructor)throw"Sortable: Mounted plugin must be a constructor function, not ".concat({}.toString.call(r));r.utils&&(fe.utils=Br(Br({},fe.utils),r.utils)),cu.mount(r)})};fe.create=function(n,e){return new fe(n,e)};fe.version=rA;var dt=[],wa,lh,ch=!1,ff,hf,Ql,ka;function EA(){function n(){this.defaults={scroll:!0,forceAutoScrollFallback:!1,scrollSensitivity:30,scrollSpeed:10,bubbleScroll:!0};for(var e in this)e.charAt(0)==="_"&&typeof this[e]=="function"&&(this[e]=this[e].bind(this))}return n.prototype={dragStarted:function(t){var r=t.originalEvent;this.sortable.nativeDraggable?ze(document,"dragover",this._handleAutoScroll):this.options.supportPointer?ze(document,"pointermove",this._handleFallbackAutoScroll):r.touches?ze(document,"touchmove",this._handleFallbackAutoScroll):ze(document,"mousemove",this._handleFallbackAutoScroll)},dragOverCompleted:function(t){var r=t.originalEvent;!this.options.dragOverBubble&&!r.rootEl&&this._handleAutoScroll(r)},drop:function(){this.sortable.nativeDraggable?Le(document,"dragover",this._handleAutoScroll):(Le(document,"pointermove",this._handleFallbackAutoScroll),Le(document,"touchmove",this._handleFallbackAutoScroll),Le(document,"mousemove",this._handleFallbackAutoScroll)),Tg(),Ll(),aA()},nulling:function(){Ql=lh=wa=ch=ka=ff=hf=null,dt.length=0},_handleFallbackAutoScroll:function(t){this._handleAutoScroll(t,!0)},_handleAutoScroll:function(t,r){var i=this,o=(t.touches?t.touches[0]:t).clientX,s=(t.touches?t.touches[0]:t).clientY,a=document.elementFromPoint(o,s);if(Ql=t,r||this.options.forceAutoScrollFallback||lu||mi||Oa){pf(t,this.options,a,r);var l=$i(a,!0);ch&&(!ka||o!==ff||s!==hf)&&(ka&&Tg(),ka=setInterval(function(){var d=$i(document.elementFromPoint(o,s),!0);d!==l&&(l=d,Ll()),pf(t,i.options,d,r)},10),ff=o,hf=s)}else{if(!this.options.bubbleScroll||$i(a,!0)===Fr()){Ll();return}pf(t,this.options,$i(a,!1),!1)}}},hi(n,{pluginName:"scroll",initializeByDefault:!0})}function Ll(){dt.forEach(function(n){clearInterval(n.pid)}),dt=[]}function Tg(){clearInterval(ka)}var pf=ty(function(n,e,t,r){if(e.scroll){var i=(n.touches?n.touches[0]:n).clientX,o=(n.touches?n.touches[0]:n).clientY,s=e.scrollSensitivity,a=e.scrollSpeed,l=Fr(),d=!1,f;lh!==t&&(lh=t,Ll(),wa=e.scroll,f=e.scrollFn,wa===!0&&(wa=$i(t,!0)));var h=0,m=wa;do{var g=m,b=mt(g),v=b.top,x=b.bottom,E=b.left,A=b.right,M=b.width,C=b.height,P=void 0,N=void 0,W=g.scrollWidth,V=g.scrollHeight,U=de(g),Q=g.scrollLeft,oe=g.scrollTop;g===l?(P=M<W&&(U.overflowX==="auto"||U.overflowX==="scroll"||U.overflowX==="visible"),N=C<V&&(U.overflowY==="auto"||U.overflowY==="scroll"||U.overflowY==="visible")):(P=M<W&&(U.overflowX==="auto"||U.overflowX==="scroll"),N=C<V&&(U.overflowY==="auto"||U.overflowY==="scroll"));var me=P&&(Math.abs(A-i)<=s&&Q+M<W)-(Math.abs(E-i)<=s&&!!Q),se=N&&(Math.abs(x-o)<=s&&oe+C<V)-(Math.abs(v-o)<=s&&!!oe);if(!dt[h])for(var Ee=0;Ee<=h;Ee++)dt[Ee]||(dt[Ee]={});(dt[h].vx!=me||dt[h].vy!=se||dt[h].el!==g)&&(dt[h].el=g,dt[h].vx=me,dt[h].vy=se,clearInterval(dt[h].pid),(me!=0||se!=0)&&(d=!0,dt[h].pid=setInterval((function(){r&&this.layer===0&&fe.active._onTouchMove(Ql);var Me=dt[this.layer].vy?dt[this.layer].vy*a:0,he=dt[this.layer].vx?dt[this.layer].vx*a:0;typeof f=="function"&&f.call(fe.dragged.parentNode[Rn],he,Me,n,Ql,dt[this.layer].el)!=="continue"||ny(dt[this.layer].el,he,Me)}).bind({layer:h}),24))),h++}while(e.bubbleScroll&&m!==l&&(m=$i(m,!1)));ch=d}},30),cy=function(e){var t=e.originalEvent,r=e.putSortable,i=e.dragEl,o=e.activeSortable,s=e.dispatchSortableEvent,a=e.hideGhostForTarget,l=e.unhideGhostForTarget;if(t){var d=r||o;a();var f=t.changedTouches&&t.changedTouches.length?t.changedTouches[0]:t,h=document.elementFromPoint(f.clientX,f.clientY);l(),d&&!d.el.contains(h)&&(s("spill"),this.onSpill({dragEl:i,putSortable:r}))}};function Xh(){}Xh.prototype={startIndex:null,dragStart:function(e){var t=e.oldDraggableIndex;this.startIndex=t},onSpill:function(e){var t=e.dragEl,r=e.putSortable;this.sortable.captureAnimationState(),r&&r.captureAnimationState();var i=Ms(this.sortable.el,this.startIndex,this.options);i?this.sortable.el.insertBefore(t,i):this.sortable.el.appendChild(t),this.sortable.animateAll(),r&&r.animateAll()},drop:cy};hi(Xh,{pluginName:"revertOnSpill"});function Yh(){}Yh.prototype={onSpill:function(e){var t=e.dragEl,r=e.putSortable,i=r||this.sortable;i.captureAnimationState(),t.parentNode&&t.parentNode.removeChild(t),i.animateAll()},drop:cy};hi(Yh,{pluginName:"removeOnSpill"});fe.mount(new EA);fe.mount(Yh,Xh);var _A=fe;function AA(n){n.directive("sort",(e,{value:t,modifiers:r,expression:i},{effect:o,evaluate:s,evaluateLater:a,cleanup:l})=>{if(t==="config"||t==="handle"||t==="group")return;if(t==="key"||t==="item"){if([void 0,null,""].includes(i))return;e._x_sort_key=s(i);return}let d={hideGhost:!r.includes("ghost"),useHandles:!!e.querySelector("[x-sort\\:handle]"),group:IA(e,r)},f=TA(i,a),h=DA(e,r,s),m=MA(e,h,d,(g,b)=>{f(g,b)});l(()=>m.destroy())})}function TA(n,e){if([void 0,null,""].includes(n))return()=>{};let t=e(n);return(r,i)=>{Alpine.dontAutoEvaluateFunctions(()=>{t(o=>{typeof o=="function"&&o(r,i)},{scope:{$key:r,$item:r,$position:i}})})}}function DA(n,e,t){return n.hasAttribute("x-sort:config")?t(n.getAttribute("x-sort:config")):{}}function MA(n,e,t,r){let i,o={animation:150,handle:t.useHandles?"[x-sort\\:handle]":null,group:t.group,filter(s){return n.querySelector("[x-sort\\:item]")?!s.target.closest("[x-sort\\:item]"):!1},onSort(s){if(s.from!==s.to&&s.to!==s.target)return;let a=s.item._x_sort_key,l=s.newIndex;(a!==void 0||a!==null)&&r(a,l)},onStart(){document.body.classList.add("sorting"),i=document.querySelector(".sortable-ghost"),t.hideGhost&&i&&(i.style.opacity="0")},onEnd(){document.body.classList.remove("sorting"),t.hideGhost&&i&&(i.style.opacity="1"),i=void 0,OA(n)}};return new _A(n,{...o,...e})}function OA(n){let e=n.firstChild;for(;e.nextSibling;){if(e.textContent.trim()==="[if ENDBLOCK]><![endif]"){n.append(e);break}e=e.nextSibling}}function IA(n,e){return n.hasAttribute("x-sort:group")?n.getAttribute("x-sort:group"):e.indexOf("group")!==-1?e[e.indexOf("group")+1]:null}var NA=AA;/*! Bundled license information:

sortablejs/modular/sortable.esm.js:
  (**!
   * Sortable 1.15.2
   * @author	RubaXa   <trash@rubaxa.org>
   * @author	owenm    <owen23355@gmail.com>
   * @license MIT
   *)
*/function PA(n){n.directive("intersect",n.skipDuringClone((e,{value:t,expression:r,modifiers:i},{evaluateLater:o,cleanup:s})=>{let a=o(r),l={rootMargin:LA(i),threshold:FA(i)},d=new IntersectionObserver(f=>{f.forEach(h=>{h.isIntersecting!==(t==="leave")&&(a(),i.includes("once")&&d.disconnect())})},l);d.observe(e),s(()=>{d.disconnect()})}))}function FA(n){if(n.includes("full"))return .99;if(n.includes("half"))return .5;if(!n.includes("threshold"))return 0;let e=n[n.indexOf("threshold")+1];return e==="100"?1:e==="0"?0:+`.${e}`}function RA(n){let e=n.match(/^(-?[0-9]+)(px|%)?$/);return e?e[1]+(e[2]||"px"):void 0}function LA(n){const e="margin",t="0px 0px 0px 0px",r=n.indexOf(e);if(r===-1)return t;let i=[];for(let o=1;o<5;o++)i.push(RA(n[r+o]||""));return i=i.filter(o=>o!==void 0),i.length?i.join(" ").trim():t}var BA=PA;/**!
 * Sortable 1.15.6
 * @author	RubaXa   <trash@rubaxa.org>
 * @author	owenm    <owen23355@gmail.com>
 * @license MIT
 */function Dg(n,e){var t=Object.keys(n);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(n);e&&(r=r.filter(function(i){return Object.getOwnPropertyDescriptor(n,i).enumerable})),t.push.apply(t,r)}return t}function $r(n){for(var e=1;e<arguments.length;e++){var t=arguments[e]!=null?arguments[e]:{};e%2?Dg(Object(t),!0).forEach(function(r){$A(n,r,t[r])}):Object.getOwnPropertyDescriptors?Object.defineProperties(n,Object.getOwnPropertyDescriptors(t)):Dg(Object(t)).forEach(function(r){Object.defineProperty(n,r,Object.getOwnPropertyDescriptor(t,r))})}return n}function Bl(n){"@babel/helpers - typeof";return typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?Bl=function(e){return typeof e}:Bl=function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Bl(n)}function $A(n,e,t){return e in n?Object.defineProperty(n,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):n[e]=t,n}function xr(){return xr=Object.assign||function(n){for(var e=1;e<arguments.length;e++){var t=arguments[e];for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&(n[r]=t[r])}return n},xr.apply(this,arguments)}function zA(n,e){if(n==null)return{};var t={},r=Object.keys(n),i,o;for(o=0;o<r.length;o++)i=r[o],!(e.indexOf(i)>=0)&&(t[i]=n[i]);return t}function HA(n,e){if(n==null)return{};var t=zA(n,e),r,i;if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(n);for(i=0;i<o.length;i++)r=o[i],!(e.indexOf(r)>=0)&&Object.prototype.propertyIsEnumerable.call(n,r)&&(t[r]=n[r])}return t}function qA(n){return VA(n)||WA(n)||UA(n)||KA()}function VA(n){if(Array.isArray(n))return dh(n)}function WA(n){if(typeof Symbol<"u"&&n[Symbol.iterator]!=null||n["@@iterator"]!=null)return Array.from(n)}function UA(n,e){if(n){if(typeof n=="string")return dh(n,e);var t=Object.prototype.toString.call(n).slice(8,-1);if(t==="Object"&&n.constructor&&(t=n.constructor.name),t==="Map"||t==="Set")return Array.from(n);if(t==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(t))return dh(n,e)}}function dh(n,e){(e==null||e>n.length)&&(e=n.length);for(var t=0,r=new Array(e);t<e;t++)r[t]=n[t];return r}function KA(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}var jA="1.15.6";function ci(n){if(typeof window<"u"&&window.navigator)return!!navigator.userAgent.match(n)}var gi=ci(/(?:Trident.*rv[ :]?11\.|msie|iemobile|Windows Phone)/i),du=ci(/Edge/i),Mg=ci(/firefox/i),Ra=ci(/safari/i)&&!ci(/chrome/i)&&!ci(/android/i),Jh=ci(/iP(ad|od|hone)/i),dy=ci(/chrome/i)&&ci(/android/i),fy={capture:!1,passive:!1};function Ae(n,e,t){n.addEventListener(e,t,!gi&&fy)}function Se(n,e,t){n.removeEventListener(e,t,!gi&&fy)}function ec(n,e){if(e){if(e[0]===">"&&(e=e.substring(1)),n)try{if(n.matches)return n.matches(e);if(n.msMatchesSelector)return n.msMatchesSelector(e);if(n.webkitMatchesSelector)return n.webkitMatchesSelector(e)}catch{return!1}return!1}}function hy(n){return n.host&&n!==document&&n.host.nodeType?n.host:n.parentNode}function vn(n,e,t,r){if(n){t=t||document;do{if(e!=null&&(e[0]===">"?n.parentNode===t&&ec(n,e):ec(n,e))||r&&n===t)return n;if(n===t)break}while(n=hy(n))}return null}var Og=/\s+/g;function ht(n,e,t){if(n&&e)if(n.classList)n.classList[t?"add":"remove"](e);else{var r=(" "+n.className+" ").replace(Og," ").replace(" "+e+" "," ");n.className=(r+(t?" "+e:"")).replace(Og," ")}}function te(n,e,t){var r=n&&n.style;if(r){if(t===void 0)return document.defaultView&&document.defaultView.getComputedStyle?t=document.defaultView.getComputedStyle(n,""):n.currentStyle&&(t=n.currentStyle),e===void 0?t:t[e];!(e in r)&&e.indexOf("webkit")===-1&&(e="-webkit-"+e),r[e]=t+(typeof t=="string"?"":"px")}}function _o(n,e){var t="";if(typeof n=="string")t=n;else do{var r=te(n,"transform");r&&r!=="none"&&(t=r+" "+t)}while(!e&&(n=n.parentNode));var i=window.DOMMatrix||window.WebKitCSSMatrix||window.CSSMatrix||window.MSCSSMatrix;return i&&new i(t)}function py(n,e,t){if(n){var r=n.getElementsByTagName(e),i=0,o=r.length;if(t)for(;i<o;i++)t(r[i],i);return r}return[]}function Rr(){var n=document.scrollingElement;return n||document.documentElement}function Ye(n,e,t,r,i){if(!(!n.getBoundingClientRect&&n!==window)){var o,s,a,l,d,f,h;if(n!==window&&n.parentNode&&n!==Rr()?(o=n.getBoundingClientRect(),s=o.top,a=o.left,l=o.bottom,d=o.right,f=o.height,h=o.width):(s=0,a=0,l=window.innerHeight,d=window.innerWidth,f=window.innerHeight,h=window.innerWidth),(e||t)&&n!==window&&(i=i||n.parentNode,!gi))do if(i&&i.getBoundingClientRect&&(te(i,"transform")!=="none"||t&&te(i,"position")!=="static")){var m=i.getBoundingClientRect();s-=m.top+parseInt(te(i,"border-top-width")),a-=m.left+parseInt(te(i,"border-left-width")),l=s+o.height,d=a+o.width;break}while(i=i.parentNode);if(r&&n!==window){var g=_o(i||n),b=g&&g.a,v=g&&g.d;g&&(s/=v,a/=b,h/=b,f/=v,l=s+f,d=a+h)}return{top:s,left:a,bottom:l,right:d,width:h,height:f}}}function Ig(n,e,t){for(var r=zi(n,!0),i=Ye(n)[e];r;){var o=Ye(r)[t],s=void 0;if(s=i>=o,!s)return r;if(r===Rr())break;r=zi(r,!1)}return!1}function Os(n,e,t,r){for(var i=0,o=0,s=n.children;o<s.length;){if(s[o].style.display!=="none"&&s[o]!==ce.ghost&&(r||s[o]!==ce.dragged)&&vn(s[o],t.draggable,n,!1)){if(i===e)return s[o];i++}o++}return null}function Zh(n,e){for(var t=n.lastElementChild;t&&(t===ce.ghost||te(t,"display")==="none"||e&&!ec(t,e));)t=t.previousElementSibling;return t||null}function pt(n,e){var t=0;if(!n||!n.parentNode)return-1;for(;n=n.previousElementSibling;)n.nodeName.toUpperCase()!=="TEMPLATE"&&n!==ce.clone&&(!e||ec(n,e))&&t++;return t}function Ng(n){var e=0,t=0,r=Rr();if(n)do{var i=_o(n),o=i.a,s=i.d;e+=n.scrollLeft*o,t+=n.scrollTop*s}while(n!==r&&(n=n.parentNode));return[e,t]}function GA(n,e){for(var t in n)if(n.hasOwnProperty(t)){for(var r in e)if(e.hasOwnProperty(r)&&e[r]===n[t][r])return Number(t)}return-1}function zi(n,e){if(!n||!n.getBoundingClientRect)return Rr();var t=n,r=!1;do if(t.clientWidth<t.scrollWidth||t.clientHeight<t.scrollHeight){var i=te(t);if(t.clientWidth<t.scrollWidth&&(i.overflowX=="auto"||i.overflowX=="scroll")||t.clientHeight<t.scrollHeight&&(i.overflowY=="auto"||i.overflowY=="scroll")){if(!t.getBoundingClientRect||t===document.body)return Rr();if(r||e)return t;r=!0}}while(t=t.parentNode);return Rr()}function XA(n,e){if(n&&e)for(var t in e)e.hasOwnProperty(t)&&(n[t]=e[t]);return n}function mf(n,e){return Math.round(n.top)===Math.round(e.top)&&Math.round(n.left)===Math.round(e.left)&&Math.round(n.height)===Math.round(e.height)&&Math.round(n.width)===Math.round(e.width)}var La;function my(n,e){return function(){if(!La){var t=arguments,r=this;t.length===1?n.call(r,t[0]):n.apply(r,t),La=setTimeout(function(){La=void 0},e)}}}function YA(){clearTimeout(La),La=void 0}function gy(n,e,t){n.scrollLeft+=e,n.scrollTop+=t}function Qh(n){var e=window.Polymer,t=window.jQuery||window.Zepto;return e&&e.dom?e.dom(n).cloneNode(!0):t?t(n).clone(!0)[0]:n.cloneNode(!0)}function Pg(n,e){te(n,"position","absolute"),te(n,"top",e.top),te(n,"left",e.left),te(n,"width",e.width),te(n,"height",e.height)}function gf(n){te(n,"position",""),te(n,"top",""),te(n,"left",""),te(n,"width",""),te(n,"height","")}function by(n,e,t){var r={};return Array.from(n.children).forEach(function(i){var o,s,a,l;if(!(!vn(i,e.draggable,n,!1)||i.animated||i===t)){var d=Ye(i);r.left=Math.min((o=r.left)!==null&&o!==void 0?o:1/0,d.left),r.top=Math.min((s=r.top)!==null&&s!==void 0?s:1/0,d.top),r.right=Math.max((a=r.right)!==null&&a!==void 0?a:-1/0,d.right),r.bottom=Math.max((l=r.bottom)!==null&&l!==void 0?l:-1/0,d.bottom)}}),r.width=r.right-r.left,r.height=r.bottom-r.top,r.x=r.left,r.y=r.top,r}var Bt="Sortable"+new Date().getTime();function JA(){var n=[],e;return{captureAnimationState:function(){if(n=[],!!this.options.animation){var r=[].slice.call(this.el.children);r.forEach(function(i){if(!(te(i,"display")==="none"||i===ce.ghost)){n.push({target:i,rect:Ye(i)});var o=$r({},n[n.length-1].rect);if(i.thisAnimationDuration){var s=_o(i,!0);s&&(o.top-=s.f,o.left-=s.e)}i.fromRect=o}})}},addAnimationState:function(r){n.push(r)},removeAnimationState:function(r){n.splice(GA(n,{target:r}),1)},animateAll:function(r){var i=this;if(!this.options.animation){clearTimeout(e),typeof r=="function"&&r();return}var o=!1,s=0;n.forEach(function(a){var l=0,d=a.target,f=d.fromRect,h=Ye(d),m=d.prevFromRect,g=d.prevToRect,b=a.rect,v=_o(d,!0);v&&(h.top-=v.f,h.left-=v.e),d.toRect=h,d.thisAnimationDuration&&mf(m,h)&&!mf(f,h)&&(b.top-h.top)/(b.left-h.left)===(f.top-h.top)/(f.left-h.left)&&(l=QA(b,m,g,i.options)),mf(h,f)||(d.prevFromRect=f,d.prevToRect=h,l||(l=i.options.animation),i.animate(d,b,h,l)),l&&(o=!0,s=Math.max(s,l),clearTimeout(d.animationResetTimer),d.animationResetTimer=setTimeout(function(){d.animationTime=0,d.prevFromRect=null,d.fromRect=null,d.prevToRect=null,d.thisAnimationDuration=null},l),d.thisAnimationDuration=l)}),clearTimeout(e),o?e=setTimeout(function(){typeof r=="function"&&r()},s):typeof r=="function"&&r(),n=[]},animate:function(r,i,o,s){if(s){te(r,"transition",""),te(r,"transform","");var a=_o(this.el),l=a&&a.a,d=a&&a.d,f=(i.left-o.left)/(l||1),h=(i.top-o.top)/(d||1);r.animatingX=!!f,r.animatingY=!!h,te(r,"transform","translate3d("+f+"px,"+h+"px,0)"),this.forRepaintDummy=ZA(r),te(r,"transition","transform "+s+"ms"+(this.options.easing?" "+this.options.easing:"")),te(r,"transform","translate3d(0,0,0)"),typeof r.animated=="number"&&clearTimeout(r.animated),r.animated=setTimeout(function(){te(r,"transition",""),te(r,"transform",""),r.animated=!1,r.animatingX=!1,r.animatingY=!1},s)}}}}function ZA(n){return n.offsetWidth}function QA(n,e,t,r){return Math.sqrt(Math.pow(e.top-n.top,2)+Math.pow(e.left-n.left,2))/Math.sqrt(Math.pow(e.top-t.top,2)+Math.pow(e.left-t.left,2))*r.animation}var us=[],bf={initializeByDefault:!0},fu={mount:function(e){for(var t in bf)bf.hasOwnProperty(t)&&!(t in e)&&(e[t]=bf[t]);us.forEach(function(r){if(r.pluginName===e.pluginName)throw"Sortable: Cannot mount plugin ".concat(e.pluginName," more than once")}),us.push(e)},pluginEvent:function(e,t,r){var i=this;this.eventCanceled=!1,r.cancel=function(){i.eventCanceled=!0};var o=e+"Global";us.forEach(function(s){t[s.pluginName]&&(t[s.pluginName][o]&&t[s.pluginName][o]($r({sortable:t},r)),t.options[s.pluginName]&&t[s.pluginName][e]&&t[s.pluginName][e]($r({sortable:t},r)))})},initializePlugins:function(e,t,r,i){us.forEach(function(a){var l=a.pluginName;if(!(!e.options[l]&&!a.initializeByDefault)){var d=new a(e,t,e.options);d.sortable=e,d.options=e.options,e[l]=d,xr(r,d.defaults)}});for(var o in e.options)if(e.options.hasOwnProperty(o)){var s=this.modifyOption(e,o,e.options[o]);typeof s<"u"&&(e.options[o]=s)}},getEventProperties:function(e,t){var r={};return us.forEach(function(i){typeof i.eventProperties=="function"&&xr(r,i.eventProperties.call(t[i.pluginName],e))}),r},modifyOption:function(e,t,r){var i;return us.forEach(function(o){e[o.pluginName]&&o.optionListeners&&typeof o.optionListeners[t]=="function"&&(i=o.optionListeners[t].call(e[o.pluginName],r))}),i}};function Sa(n){var e=n.sortable,t=n.rootEl,r=n.name,i=n.targetEl,o=n.cloneEl,s=n.toEl,a=n.fromEl,l=n.oldIndex,d=n.newIndex,f=n.oldDraggableIndex,h=n.newDraggableIndex,m=n.originalEvent,g=n.putSortable,b=n.extraEventProperties;if(e=e||t&&t[Bt],!!e){var v,x=e.options,E="on"+r.charAt(0).toUpperCase()+r.substr(1);window.CustomEvent&&!gi&&!du?v=new CustomEvent(r,{bubbles:!0,cancelable:!0}):(v=document.createEvent("Event"),v.initEvent(r,!0,!0)),v.to=s||t,v.from=a||t,v.item=i||t,v.clone=o,v.oldIndex=l,v.newIndex=d,v.oldDraggableIndex=f,v.newDraggableIndex=h,v.originalEvent=m,v.pullMode=g?g.lastPutMode:void 0;var A=$r($r({},b),fu.getEventProperties(r,e));for(var M in A)v[M]=A[M];t&&t.dispatchEvent(v),x[E]&&x[E].call(e,v)}}var e6=["evt"],bn=function(e,t){var r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{},i=r.evt,o=HA(r,e6);fu.pluginEvent.bind(ce)(e,t,$r({dragEl:j,parentEl:st,ghostEl:ve,rootEl:et,nextEl:vo,lastDownEl:$l,cloneEl:rt,cloneHidden:Ri,dragStarted:Ca,putSortable:Pt,activeSortable:ce.active,originalEvent:i,oldIndex:xs,oldDraggableIndex:Ba,newIndex:Pn,newDraggableIndex:Oi,hideGhostForTarget:wy,unhideGhostForTarget:ky,cloneNowHidden:function(){Ri=!0},cloneNowShown:function(){Ri=!1},dispatchSortableEvent:function(a){sn({sortable:t,name:a,originalEvent:i})}},o))};function sn(n){Sa($r({putSortable:Pt,cloneEl:rt,targetEl:j,rootEl:et,oldIndex:xs,oldDraggableIndex:Ba,newIndex:Pn,newDraggableIndex:Oi},n))}var j,st,ve,et,vo,$l,rt,Ri,xs,Pn,Ba,Oi,ml,Pt,ms=!1,tc=!1,nc=[],go,mr,yf,vf,Fg,Rg,Ca,ls,$a,za=!1,gl=!1,zl,jt,xf=[],fh=!1,rc=[],_c=typeof document<"u",bl=Jh,Lg=du||gi?"cssFloat":"float",t6=_c&&!dy&&!Jh&&"draggable"in document.createElement("div"),yy=function(){if(_c){if(gi)return!1;var n=document.createElement("x");return n.style.cssText="pointer-events:auto",n.style.pointerEvents==="auto"}}(),vy=function(e,t){var r=te(e),i=parseInt(r.width)-parseInt(r.paddingLeft)-parseInt(r.paddingRight)-parseInt(r.borderLeftWidth)-parseInt(r.borderRightWidth),o=Os(e,0,t),s=Os(e,1,t),a=o&&te(o),l=s&&te(s),d=a&&parseInt(a.marginLeft)+parseInt(a.marginRight)+Ye(o).width,f=l&&parseInt(l.marginLeft)+parseInt(l.marginRight)+Ye(s).width;if(r.display==="flex")return r.flexDirection==="column"||r.flexDirection==="column-reverse"?"vertical":"horizontal";if(r.display==="grid")return r.gridTemplateColumns.split(" ").length<=1?"vertical":"horizontal";if(o&&a.float&&a.float!=="none"){var h=a.float==="left"?"left":"right";return s&&(l.clear==="both"||l.clear===h)?"vertical":"horizontal"}return o&&(a.display==="block"||a.display==="flex"||a.display==="table"||a.display==="grid"||d>=i&&r[Lg]==="none"||s&&r[Lg]==="none"&&d+f>i)?"vertical":"horizontal"},n6=function(e,t,r){var i=r?e.left:e.top,o=r?e.right:e.bottom,s=r?e.width:e.height,a=r?t.left:t.top,l=r?t.right:t.bottom,d=r?t.width:t.height;return i===a||o===l||i+s/2===a+d/2},r6=function(e,t){var r;return nc.some(function(i){var o=i[Bt].options.emptyInsertThreshold;if(!(!o||Zh(i))){var s=Ye(i),a=e>=s.left-o&&e<=s.right+o,l=t>=s.top-o&&t<=s.bottom+o;if(a&&l)return r=i}}),r},xy=function(e){function t(o,s){return function(a,l,d,f){var h=a.options.group.name&&l.options.group.name&&a.options.group.name===l.options.group.name;if(o==null&&(s||h))return!0;if(o==null||o===!1)return!1;if(s&&o==="clone")return o;if(typeof o=="function")return t(o(a,l,d,f),s)(a,l,d,f);var m=(s?a:l).options.group.name;return o===!0||typeof o=="string"&&o===m||o.join&&o.indexOf(m)>-1}}var r={},i=e.group;(!i||Bl(i)!="object")&&(i={name:i}),r.name=i.name,r.checkPull=t(i.pull,!0),r.checkPut=t(i.put),r.revertClone=i.revertClone,e.group=r},wy=function(){!yy&&ve&&te(ve,"display","none")},ky=function(){!yy&&ve&&te(ve,"display","")};_c&&!dy&&document.addEventListener("click",function(n){if(tc)return n.preventDefault(),n.stopPropagation&&n.stopPropagation(),n.stopImmediatePropagation&&n.stopImmediatePropagation(),tc=!1,!1},!0);var bo=function(e){if(j){e=e.touches?e.touches[0]:e;var t=r6(e.clientX,e.clientY);if(t){var r={};for(var i in e)e.hasOwnProperty(i)&&(r[i]=e[i]);r.target=r.rootEl=t,r.preventDefault=void 0,r.stopPropagation=void 0,t[Bt]._onDragOver(r)}}},i6=function(e){j&&j.parentNode[Bt]._isOutsideThisEl(e.target)};function ce(n,e){if(!(n&&n.nodeType&&n.nodeType===1))throw"Sortable: `el` must be an HTMLElement, not ".concat({}.toString.call(n));this.el=n,this.options=e=xr({},e),n[Bt]=this;var t={group:null,sort:!0,disabled:!1,store:null,handle:null,draggable:/^[uo]l$/i.test(n.nodeName)?">li":">*",swapThreshold:1,invertSwap:!1,invertedSwapThreshold:null,removeCloneOnHide:!0,direction:function(){return vy(n,this.options)},ghostClass:"sortable-ghost",chosenClass:"sortable-chosen",dragClass:"sortable-drag",ignore:"a, img",filter:null,preventOnFilter:!0,animation:0,easing:null,setData:function(s,a){s.setData("Text",a.textContent)},dropBubble:!1,dragoverBubble:!1,dataIdAttr:"data-id",delay:0,delayOnTouchOnly:!1,touchStartThreshold:(Number.parseInt?Number:window).parseInt(window.devicePixelRatio,10)||1,forceFallback:!1,fallbackClass:"sortable-fallback",fallbackOnBody:!1,fallbackTolerance:0,fallbackOffset:{x:0,y:0},supportPointer:ce.supportPointer!==!1&&"PointerEvent"in window&&(!Ra||Jh),emptyInsertThreshold:5};fu.initializePlugins(this,n,t);for(var r in t)!(r in e)&&(e[r]=t[r]);xy(e);for(var i in this)i.charAt(0)==="_"&&typeof this[i]=="function"&&(this[i]=this[i].bind(this));this.nativeDraggable=e.forceFallback?!1:t6,this.nativeDraggable&&(this.options.touchStartThreshold=1),e.supportPointer?Ae(n,"pointerdown",this._onTapStart):(Ae(n,"mousedown",this._onTapStart),Ae(n,"touchstart",this._onTapStart)),this.nativeDraggable&&(Ae(n,"dragover",this),Ae(n,"dragenter",this)),nc.push(this.el),e.store&&e.store.get&&this.sort(e.store.get(this)||[]),xr(this,JA())}ce.prototype={constructor:ce,_isOutsideThisEl:function(e){!this.el.contains(e)&&e!==this.el&&(ls=null)},_getDirection:function(e,t){return typeof this.options.direction=="function"?this.options.direction.call(this,e,t,j):this.options.direction},_onTapStart:function(e){if(e.cancelable){var t=this,r=this.el,i=this.options,o=i.preventOnFilter,s=e.type,a=e.touches&&e.touches[0]||e.pointerType&&e.pointerType==="touch"&&e,l=(a||e).target,d=e.target.shadowRoot&&(e.path&&e.path[0]||e.composedPath&&e.composedPath()[0])||l,f=i.filter;if(f6(r),!j&&!(/mousedown|pointerdown/.test(s)&&e.button!==0||i.disabled)&&!d.isContentEditable&&!(!this.nativeDraggable&&Ra&&l&&l.tagName.toUpperCase()==="SELECT")&&(l=vn(l,i.draggable,r,!1),!(l&&l.animated)&&$l!==l)){if(xs=pt(l),Ba=pt(l,i.draggable),typeof f=="function"){if(f.call(this,e,l,this)){sn({sortable:t,rootEl:d,name:"filter",targetEl:l,toEl:r,fromEl:r}),bn("filter",t,{evt:e}),o&&e.preventDefault();return}}else if(f&&(f=f.split(",").some(function(h){if(h=vn(d,h.trim(),r,!1),h)return sn({sortable:t,rootEl:h,name:"filter",targetEl:l,fromEl:r,toEl:r}),bn("filter",t,{evt:e}),!0}),f)){o&&e.preventDefault();return}i.handle&&!vn(d,i.handle,r,!1)||this._prepareDragStart(e,a,l)}}},_prepareDragStart:function(e,t,r){var i=this,o=i.el,s=i.options,a=o.ownerDocument,l;if(r&&!j&&r.parentNode===o){var d=Ye(r);if(et=o,j=r,st=j.parentNode,vo=j.nextSibling,$l=r,ml=s.group,ce.dragged=j,go={target:j,clientX:(t||e).clientX,clientY:(t||e).clientY},Fg=go.clientX-d.left,Rg=go.clientY-d.top,this._lastX=(t||e).clientX,this._lastY=(t||e).clientY,j.style["will-change"]="all",l=function(){if(bn("delayEnded",i,{evt:e}),ce.eventCanceled){i._onDrop();return}i._disableDelayedDragEvents(),!Mg&&i.nativeDraggable&&(j.draggable=!0),i._triggerDragStart(e,t),sn({sortable:i,name:"choose",originalEvent:e}),ht(j,s.chosenClass,!0)},s.ignore.split(",").forEach(function(f){py(j,f.trim(),wf)}),Ae(a,"dragover",bo),Ae(a,"mousemove",bo),Ae(a,"touchmove",bo),s.supportPointer?(Ae(a,"pointerup",i._onDrop),!this.nativeDraggable&&Ae(a,"pointercancel",i._onDrop)):(Ae(a,"mouseup",i._onDrop),Ae(a,"touchend",i._onDrop),Ae(a,"touchcancel",i._onDrop)),Mg&&this.nativeDraggable&&(this.options.touchStartThreshold=4,j.draggable=!0),bn("delayStart",this,{evt:e}),s.delay&&(!s.delayOnTouchOnly||t)&&(!this.nativeDraggable||!(du||gi))){if(ce.eventCanceled){this._onDrop();return}s.supportPointer?(Ae(a,"pointerup",i._disableDelayedDrag),Ae(a,"pointercancel",i._disableDelayedDrag)):(Ae(a,"mouseup",i._disableDelayedDrag),Ae(a,"touchend",i._disableDelayedDrag),Ae(a,"touchcancel",i._disableDelayedDrag)),Ae(a,"mousemove",i._delayedDragTouchMoveHandler),Ae(a,"touchmove",i._delayedDragTouchMoveHandler),s.supportPointer&&Ae(a,"pointermove",i._delayedDragTouchMoveHandler),i._dragStartTimer=setTimeout(l,s.delay)}else l()}},_delayedDragTouchMoveHandler:function(e){var t=e.touches?e.touches[0]:e;Math.max(Math.abs(t.clientX-this._lastX),Math.abs(t.clientY-this._lastY))>=Math.floor(this.options.touchStartThreshold/(this.nativeDraggable&&window.devicePixelRatio||1))&&this._disableDelayedDrag()},_disableDelayedDrag:function(){j&&wf(j),clearTimeout(this._dragStartTimer),this._disableDelayedDragEvents()},_disableDelayedDragEvents:function(){var e=this.el.ownerDocument;Se(e,"mouseup",this._disableDelayedDrag),Se(e,"touchend",this._disableDelayedDrag),Se(e,"touchcancel",this._disableDelayedDrag),Se(e,"pointerup",this._disableDelayedDrag),Se(e,"pointercancel",this._disableDelayedDrag),Se(e,"mousemove",this._delayedDragTouchMoveHandler),Se(e,"touchmove",this._delayedDragTouchMoveHandler),Se(e,"pointermove",this._delayedDragTouchMoveHandler)},_triggerDragStart:function(e,t){t=t||e.pointerType=="touch"&&e,!this.nativeDraggable||t?this.options.supportPointer?Ae(document,"pointermove",this._onTouchMove):t?Ae(document,"touchmove",this._onTouchMove):Ae(document,"mousemove",this._onTouchMove):(Ae(j,"dragend",this),Ae(et,"dragstart",this._onDragStart));try{document.selection?Hl(function(){document.selection.empty()}):window.getSelection().removeAllRanges()}catch{}},_dragStarted:function(e,t){if(ms=!1,et&&j){bn("dragStarted",this,{evt:t}),this.nativeDraggable&&Ae(document,"dragover",i6);var r=this.options;!e&&ht(j,r.dragClass,!1),ht(j,r.ghostClass,!0),ce.active=this,e&&this._appendGhost(),sn({sortable:this,name:"start",originalEvent:t})}else this._nulling()},_emulateDragOver:function(){if(mr){this._lastX=mr.clientX,this._lastY=mr.clientY,wy();for(var e=document.elementFromPoint(mr.clientX,mr.clientY),t=e;e&&e.shadowRoot&&(e=e.shadowRoot.elementFromPoint(mr.clientX,mr.clientY),e!==t);)t=e;if(j.parentNode[Bt]._isOutsideThisEl(e),t)do{if(t[Bt]){var r=void 0;if(r=t[Bt]._onDragOver({clientX:mr.clientX,clientY:mr.clientY,target:e,rootEl:t}),r&&!this.options.dragoverBubble)break}e=t}while(t=hy(t));ky()}},_onTouchMove:function(e){if(go){var t=this.options,r=t.fallbackTolerance,i=t.fallbackOffset,o=e.touches?e.touches[0]:e,s=ve&&_o(ve,!0),a=ve&&s&&s.a,l=ve&&s&&s.d,d=bl&&jt&&Ng(jt),f=(o.clientX-go.clientX+i.x)/(a||1)+(d?d[0]-xf[0]:0)/(a||1),h=(o.clientY-go.clientY+i.y)/(l||1)+(d?d[1]-xf[1]:0)/(l||1);if(!ce.active&&!ms){if(r&&Math.max(Math.abs(o.clientX-this._lastX),Math.abs(o.clientY-this._lastY))<r)return;this._onDragStart(e,!0)}if(ve){s?(s.e+=f-(yf||0),s.f+=h-(vf||0)):s={a:1,b:0,c:0,d:1,e:f,f:h};var m="matrix(".concat(s.a,",").concat(s.b,",").concat(s.c,",").concat(s.d,",").concat(s.e,",").concat(s.f,")");te(ve,"webkitTransform",m),te(ve,"mozTransform",m),te(ve,"msTransform",m),te(ve,"transform",m),yf=f,vf=h,mr=o}e.cancelable&&e.preventDefault()}},_appendGhost:function(){if(!ve){var e=this.options.fallbackOnBody?document.body:et,t=Ye(j,!0,bl,!0,e),r=this.options;if(bl){for(jt=e;te(jt,"position")==="static"&&te(jt,"transform")==="none"&&jt!==document;)jt=jt.parentNode;jt!==document.body&&jt!==document.documentElement?(jt===document&&(jt=Rr()),t.top+=jt.scrollTop,t.left+=jt.scrollLeft):jt=Rr(),xf=Ng(jt)}ve=j.cloneNode(!0),ht(ve,r.ghostClass,!1),ht(ve,r.fallbackClass,!0),ht(ve,r.dragClass,!0),te(ve,"transition",""),te(ve,"transform",""),te(ve,"box-sizing","border-box"),te(ve,"margin",0),te(ve,"top",t.top),te(ve,"left",t.left),te(ve,"width",t.width),te(ve,"height",t.height),te(ve,"opacity","0.8"),te(ve,"position",bl?"absolute":"fixed"),te(ve,"zIndex","100000"),te(ve,"pointerEvents","none"),ce.ghost=ve,e.appendChild(ve),te(ve,"transform-origin",Fg/parseInt(ve.style.width)*100+"% "+Rg/parseInt(ve.style.height)*100+"%")}},_onDragStart:function(e,t){var r=this,i=e.dataTransfer,o=r.options;if(bn("dragStart",this,{evt:e}),ce.eventCanceled){this._onDrop();return}bn("setupClone",this),ce.eventCanceled||(rt=Qh(j),rt.removeAttribute("id"),rt.draggable=!1,rt.style["will-change"]="",this._hideClone(),ht(rt,this.options.chosenClass,!1),ce.clone=rt),r.cloneId=Hl(function(){bn("clone",r),!ce.eventCanceled&&(r.options.removeCloneOnHide||et.insertBefore(rt,j),r._hideClone(),sn({sortable:r,name:"clone"}))}),!t&&ht(j,o.dragClass,!0),t?(tc=!0,r._loopId=setInterval(r._emulateDragOver,50)):(Se(document,"mouseup",r._onDrop),Se(document,"touchend",r._onDrop),Se(document,"touchcancel",r._onDrop),i&&(i.effectAllowed="move",o.setData&&o.setData.call(r,i,j)),Ae(document,"drop",r),te(j,"transform","translateZ(0)")),ms=!0,r._dragStartId=Hl(r._dragStarted.bind(r,t,e)),Ae(document,"selectstart",r),Ca=!0,window.getSelection().removeAllRanges(),Ra&&te(document.body,"user-select","none")},_onDragOver:function(e){var t=this.el,r=e.target,i,o,s,a=this.options,l=a.group,d=ce.active,f=ml===l,h=a.sort,m=Pt||d,g,b=this,v=!1;if(fh)return;function x(Oe,Ht){bn(Oe,b,$r({evt:e,isOwner:f,axis:g?"vertical":"horizontal",revert:s,dragRect:i,targetRect:o,canSort:h,fromSortable:m,target:r,completed:A,onMove:function(Je,qt){return yl(et,t,j,i,Je,Ye(Je),e,qt)},changed:M},Ht))}function E(){x("dragOverAnimationCapture"),b.captureAnimationState(),b!==m&&m.captureAnimationState()}function A(Oe){return x("dragOverCompleted",{insertion:Oe}),Oe&&(f?d._hideClone():d._showClone(b),b!==m&&(ht(j,Pt?Pt.options.ghostClass:d.options.ghostClass,!1),ht(j,a.ghostClass,!0)),Pt!==b&&b!==ce.active?Pt=b:b===ce.active&&Pt&&(Pt=null),m===b&&(b._ignoreWhileAnimating=r),b.animateAll(function(){x("dragOverAnimationComplete"),b._ignoreWhileAnimating=null}),b!==m&&(m.animateAll(),m._ignoreWhileAnimating=null)),(r===j&&!j.animated||r===t&&!r.animated)&&(ls=null),!a.dragoverBubble&&!e.rootEl&&r!==document&&(j.parentNode[Bt]._isOutsideThisEl(e.target),!Oe&&bo(e)),!a.dragoverBubble&&e.stopPropagation&&e.stopPropagation(),v=!0}function M(){Pn=pt(j),Oi=pt(j,a.draggable),sn({sortable:b,name:"change",toEl:t,newIndex:Pn,newDraggableIndex:Oi,originalEvent:e})}if(e.preventDefault!==void 0&&e.cancelable&&e.preventDefault(),r=vn(r,a.draggable,t,!0),x("dragOver"),ce.eventCanceled)return v;if(j.contains(e.target)||r.animated&&r.animatingX&&r.animatingY||b._ignoreWhileAnimating===r)return A(!1);if(tc=!1,d&&!a.disabled&&(f?h||(s=st!==et):Pt===this||(this.lastPutMode=ml.checkPull(this,d,j,e))&&l.checkPut(this,d,j,e))){if(g=this._getDirection(e,r)==="vertical",i=Ye(j),x("dragOverValid"),ce.eventCanceled)return v;if(s)return st=et,E(),this._hideClone(),x("revert"),ce.eventCanceled||(vo?et.insertBefore(j,vo):et.appendChild(j)),A(!0);var C=Zh(t,a.draggable);if(!C||u6(e,g,this)&&!C.animated){if(C===j)return A(!1);if(C&&t===e.target&&(r=C),r&&(o=Ye(r)),yl(et,t,j,i,r,o,e,!!r)!==!1)return E(),C&&C.nextSibling?t.insertBefore(j,C.nextSibling):t.appendChild(j),st=t,M(),A(!0)}else if(C&&a6(e,g,this)){var P=Os(t,0,a,!0);if(P===j)return A(!1);if(r=P,o=Ye(r),yl(et,t,j,i,r,o,e,!1)!==!1)return E(),t.insertBefore(j,P),st=t,M(),A(!0)}else if(r.parentNode===t){o=Ye(r);var N=0,W,V=j.parentNode!==t,U=!n6(j.animated&&j.toRect||i,r.animated&&r.toRect||o,g),Q=g?"top":"left",oe=Ig(r,"top","top")||Ig(j,"top","top"),me=oe?oe.scrollTop:void 0;ls!==r&&(W=o[Q],za=!1,gl=!U&&a.invertSwap||V),N=l6(e,r,o,g,U?1:a.swapThreshold,a.invertedSwapThreshold==null?a.swapThreshold:a.invertedSwapThreshold,gl,ls===r);var se;if(N!==0){var Ee=pt(j);do Ee-=N,se=st.children[Ee];while(se&&(te(se,"display")==="none"||se===ve))}if(N===0||se===r)return A(!1);ls=r,$a=N;var Me=r.nextElementSibling,he=!1;he=N===1;var we=yl(et,t,j,i,r,o,e,he);if(we!==!1)return(we===1||we===-1)&&(he=we===1),fh=!0,setTimeout(s6,30),E(),he&&!Me?t.appendChild(j):r.parentNode.insertBefore(j,he?Me:r),oe&&gy(oe,0,me-oe.scrollTop),st=j.parentNode,W!==void 0&&!gl&&(zl=Math.abs(W-Ye(r)[Q])),M(),A(!0)}if(t.contains(j))return A(!1)}return!1},_ignoreWhileAnimating:null,_offMoveEvents:function(){Se(document,"mousemove",this._onTouchMove),Se(document,"touchmove",this._onTouchMove),Se(document,"pointermove",this._onTouchMove),Se(document,"dragover",bo),Se(document,"mousemove",bo),Se(document,"touchmove",bo)},_offUpEvents:function(){var e=this.el.ownerDocument;Se(e,"mouseup",this._onDrop),Se(e,"touchend",this._onDrop),Se(e,"pointerup",this._onDrop),Se(e,"pointercancel",this._onDrop),Se(e,"touchcancel",this._onDrop),Se(document,"selectstart",this)},_onDrop:function(e){var t=this.el,r=this.options;if(Pn=pt(j),Oi=pt(j,r.draggable),bn("drop",this,{evt:e}),st=j&&j.parentNode,Pn=pt(j),Oi=pt(j,r.draggable),ce.eventCanceled){this._nulling();return}ms=!1,gl=!1,za=!1,clearInterval(this._loopId),clearTimeout(this._dragStartTimer),hh(this.cloneId),hh(this._dragStartId),this.nativeDraggable&&(Se(document,"drop",this),Se(t,"dragstart",this._onDragStart)),this._offMoveEvents(),this._offUpEvents(),Ra&&te(document.body,"user-select",""),te(j,"transform",""),e&&(Ca&&(e.cancelable&&e.preventDefault(),!r.dropBubble&&e.stopPropagation()),ve&&ve.parentNode&&ve.parentNode.removeChild(ve),(et===st||Pt&&Pt.lastPutMode!=="clone")&&rt&&rt.parentNode&&rt.parentNode.removeChild(rt),j&&(this.nativeDraggable&&Se(j,"dragend",this),wf(j),j.style["will-change"]="",Ca&&!ms&&ht(j,Pt?Pt.options.ghostClass:this.options.ghostClass,!1),ht(j,this.options.chosenClass,!1),sn({sortable:this,name:"unchoose",toEl:st,newIndex:null,newDraggableIndex:null,originalEvent:e}),et!==st?(Pn>=0&&(sn({rootEl:st,name:"add",toEl:st,fromEl:et,originalEvent:e}),sn({sortable:this,name:"remove",toEl:st,originalEvent:e}),sn({rootEl:st,name:"sort",toEl:st,fromEl:et,originalEvent:e}),sn({sortable:this,name:"sort",toEl:st,originalEvent:e})),Pt&&Pt.save()):Pn!==xs&&Pn>=0&&(sn({sortable:this,name:"update",toEl:st,originalEvent:e}),sn({sortable:this,name:"sort",toEl:st,originalEvent:e})),ce.active&&((Pn==null||Pn===-1)&&(Pn=xs,Oi=Ba),sn({sortable:this,name:"end",toEl:st,originalEvent:e}),this.save()))),this._nulling()},_nulling:function(){bn("nulling",this),et=j=st=ve=vo=rt=$l=Ri=go=mr=Ca=Pn=Oi=xs=Ba=ls=$a=Pt=ml=ce.dragged=ce.ghost=ce.clone=ce.active=null,rc.forEach(function(e){e.checked=!0}),rc.length=yf=vf=0},handleEvent:function(e){switch(e.type){case"drop":case"dragend":this._onDrop(e);break;case"dragenter":case"dragover":j&&(this._onDragOver(e),o6(e));break;case"selectstart":e.preventDefault();break}},toArray:function(){for(var e=[],t,r=this.el.children,i=0,o=r.length,s=this.options;i<o;i++)t=r[i],vn(t,s.draggable,this.el,!1)&&e.push(t.getAttribute(s.dataIdAttr)||d6(t));return e},sort:function(e,t){var r={},i=this.el;this.toArray().forEach(function(o,s){var a=i.children[s];vn(a,this.options.draggable,i,!1)&&(r[o]=a)},this),t&&this.captureAnimationState(),e.forEach(function(o){r[o]&&(i.removeChild(r[o]),i.appendChild(r[o]))}),t&&this.animateAll()},save:function(){var e=this.options.store;e&&e.set&&e.set(this)},closest:function(e,t){return vn(e,t||this.options.draggable,this.el,!1)},option:function(e,t){var r=this.options;if(t===void 0)return r[e];var i=fu.modifyOption(this,e,t);typeof i<"u"?r[e]=i:r[e]=t,e==="group"&&xy(r)},destroy:function(){bn("destroy",this);var e=this.el;e[Bt]=null,Se(e,"mousedown",this._onTapStart),Se(e,"touchstart",this._onTapStart),Se(e,"pointerdown",this._onTapStart),this.nativeDraggable&&(Se(e,"dragover",this),Se(e,"dragenter",this)),Array.prototype.forEach.call(e.querySelectorAll("[draggable]"),function(t){t.removeAttribute("draggable")}),this._onDrop(),this._disableDelayedDragEvents(),nc.splice(nc.indexOf(this.el),1),this.el=e=null},_hideClone:function(){if(!Ri){if(bn("hideClone",this),ce.eventCanceled)return;te(rt,"display","none"),this.options.removeCloneOnHide&&rt.parentNode&&rt.parentNode.removeChild(rt),Ri=!0}},_showClone:function(e){if(e.lastPutMode!=="clone"){this._hideClone();return}if(Ri){if(bn("showClone",this),ce.eventCanceled)return;j.parentNode==et&&!this.options.group.revertClone?et.insertBefore(rt,j):vo?et.insertBefore(rt,vo):et.appendChild(rt),this.options.group.revertClone&&this.animate(j,rt),te(rt,"display",""),Ri=!1}}};function o6(n){n.dataTransfer&&(n.dataTransfer.dropEffect="move"),n.cancelable&&n.preventDefault()}function yl(n,e,t,r,i,o,s,a){var l,d=n[Bt],f=d.options.onMove,h;return window.CustomEvent&&!gi&&!du?l=new CustomEvent("move",{bubbles:!0,cancelable:!0}):(l=document.createEvent("Event"),l.initEvent("move",!0,!0)),l.to=e,l.from=n,l.dragged=t,l.draggedRect=r,l.related=i||e,l.relatedRect=o||Ye(e),l.willInsertAfter=a,l.originalEvent=s,n.dispatchEvent(l),f&&(h=f.call(d,l,s)),h}function wf(n){n.draggable=!1}function s6(){fh=!1}function a6(n,e,t){var r=Ye(Os(t.el,0,t.options,!0)),i=by(t.el,t.options,ve),o=10;return e?n.clientX<i.left-o||n.clientY<r.top&&n.clientX<r.right:n.clientY<i.top-o||n.clientY<r.bottom&&n.clientX<r.left}function u6(n,e,t){var r=Ye(Zh(t.el,t.options.draggable)),i=by(t.el,t.options,ve),o=10;return e?n.clientX>i.right+o||n.clientY>r.bottom&&n.clientX>r.left:n.clientY>i.bottom+o||n.clientX>r.right&&n.clientY>r.top}function l6(n,e,t,r,i,o,s,a){var l=r?n.clientY:n.clientX,d=r?t.height:t.width,f=r?t.top:t.left,h=r?t.bottom:t.right,m=!1;if(!s){if(a&&zl<d*i){if(!za&&($a===1?l>f+d*o/2:l<h-d*o/2)&&(za=!0),za)m=!0;else if($a===1?l<f+zl:l>h-zl)return-$a}else if(l>f+d*(1-i)/2&&l<h-d*(1-i)/2)return c6(e)}return m=m||s,m&&(l<f+d*o/2||l>h-d*o/2)?l>f+d/2?1:-1:0}function c6(n){return pt(j)<pt(n)?1:-1}function d6(n){for(var e=n.tagName+n.className+n.src+n.href+n.textContent,t=e.length,r=0;t--;)r+=e.charCodeAt(t);return r.toString(36)}function f6(n){rc.length=0;for(var e=n.getElementsByTagName("input"),t=e.length;t--;){var r=e[t];r.checked&&rc.push(r)}}function Hl(n){return setTimeout(n,0)}function hh(n){return clearTimeout(n)}_c&&Ae(document,"touchmove",function(n){(ce.active||ms)&&n.cancelable&&n.preventDefault()});ce.utils={on:Ae,off:Se,css:te,find:py,is:function(e,t){return!!vn(e,t,e,!1)},extend:XA,throttle:my,closest:vn,toggleClass:ht,clone:Qh,index:pt,nextTick:Hl,cancelNextTick:hh,detectDirection:vy,getChild:Os,expando:Bt};ce.get=function(n){return n[Bt]};ce.mount=function(){for(var n=arguments.length,e=new Array(n),t=0;t<n;t++)e[t]=arguments[t];e[0].constructor===Array&&(e=e[0]),e.forEach(function(r){if(!r.prototype||!r.prototype.constructor)throw"Sortable: Mounted plugin must be a constructor function, not ".concat({}.toString.call(r));r.utils&&(ce.utils=$r($r({},ce.utils),r.utils)),fu.mount(r)})};ce.create=function(n,e){return new ce(n,e)};ce.version=jA;var ft=[],Ea,ph,mh=!1,kf,Sf,ic,_a;function h6(){function n(){this.defaults={scroll:!0,forceAutoScrollFallback:!1,scrollSensitivity:30,scrollSpeed:10,bubbleScroll:!0};for(var e in this)e.charAt(0)==="_"&&typeof this[e]=="function"&&(this[e]=this[e].bind(this))}return n.prototype={dragStarted:function(t){var r=t.originalEvent;this.sortable.nativeDraggable?Ae(document,"dragover",this._handleAutoScroll):this.options.supportPointer?Ae(document,"pointermove",this._handleFallbackAutoScroll):r.touches?Ae(document,"touchmove",this._handleFallbackAutoScroll):Ae(document,"mousemove",this._handleFallbackAutoScroll)},dragOverCompleted:function(t){var r=t.originalEvent;!this.options.dragOverBubble&&!r.rootEl&&this._handleAutoScroll(r)},drop:function(){this.sortable.nativeDraggable?Se(document,"dragover",this._handleAutoScroll):(Se(document,"pointermove",this._handleFallbackAutoScroll),Se(document,"touchmove",this._handleFallbackAutoScroll),Se(document,"mousemove",this._handleFallbackAutoScroll)),Bg(),ql(),YA()},nulling:function(){ic=ph=Ea=mh=_a=kf=Sf=null,ft.length=0},_handleFallbackAutoScroll:function(t){this._handleAutoScroll(t,!0)},_handleAutoScroll:function(t,r){var i=this,o=(t.touches?t.touches[0]:t).clientX,s=(t.touches?t.touches[0]:t).clientY,a=document.elementFromPoint(o,s);if(ic=t,r||this.options.forceAutoScrollFallback||du||gi||Ra){Cf(t,this.options,a,r);var l=zi(a,!0);mh&&(!_a||o!==kf||s!==Sf)&&(_a&&Bg(),_a=setInterval(function(){var d=zi(document.elementFromPoint(o,s),!0);d!==l&&(l=d,ql()),Cf(t,i.options,d,r)},10),kf=o,Sf=s)}else{if(!this.options.bubbleScroll||zi(a,!0)===Rr()){ql();return}Cf(t,this.options,zi(a,!1),!1)}}},xr(n,{pluginName:"scroll",initializeByDefault:!0})}function ql(){ft.forEach(function(n){clearInterval(n.pid)}),ft=[]}function Bg(){clearInterval(_a)}var Cf=my(function(n,e,t,r){if(e.scroll){var i=(n.touches?n.touches[0]:n).clientX,o=(n.touches?n.touches[0]:n).clientY,s=e.scrollSensitivity,a=e.scrollSpeed,l=Rr(),d=!1,f;ph!==t&&(ph=t,ql(),Ea=e.scroll,f=e.scrollFn,Ea===!0&&(Ea=zi(t,!0)));var h=0,m=Ea;do{var g=m,b=Ye(g),v=b.top,x=b.bottom,E=b.left,A=b.right,M=b.width,C=b.height,P=void 0,N=void 0,W=g.scrollWidth,V=g.scrollHeight,U=te(g),Q=g.scrollLeft,oe=g.scrollTop;g===l?(P=M<W&&(U.overflowX==="auto"||U.overflowX==="scroll"||U.overflowX==="visible"),N=C<V&&(U.overflowY==="auto"||U.overflowY==="scroll"||U.overflowY==="visible")):(P=M<W&&(U.overflowX==="auto"||U.overflowX==="scroll"),N=C<V&&(U.overflowY==="auto"||U.overflowY==="scroll"));var me=P&&(Math.abs(A-i)<=s&&Q+M<W)-(Math.abs(E-i)<=s&&!!Q),se=N&&(Math.abs(x-o)<=s&&oe+C<V)-(Math.abs(v-o)<=s&&!!oe);if(!ft[h])for(var Ee=0;Ee<=h;Ee++)ft[Ee]||(ft[Ee]={});(ft[h].vx!=me||ft[h].vy!=se||ft[h].el!==g)&&(ft[h].el=g,ft[h].vx=me,ft[h].vy=se,clearInterval(ft[h].pid),(me!=0||se!=0)&&(d=!0,ft[h].pid=setInterval((function(){r&&this.layer===0&&ce.active._onTouchMove(ic);var Me=ft[this.layer].vy?ft[this.layer].vy*a:0,he=ft[this.layer].vx?ft[this.layer].vx*a:0;typeof f=="function"&&f.call(ce.dragged.parentNode[Bt],he,Me,n,ic,ft[this.layer].el)!=="continue"||gy(ft[this.layer].el,he,Me)}).bind({layer:h}),24))),h++}while(e.bubbleScroll&&m!==l&&(m=zi(m,!1)));mh=d}},30),Sy=function(e){var t=e.originalEvent,r=e.putSortable,i=e.dragEl,o=e.activeSortable,s=e.dispatchSortableEvent,a=e.hideGhostForTarget,l=e.unhideGhostForTarget;if(t){var d=r||o;a();var f=t.changedTouches&&t.changedTouches.length?t.changedTouches[0]:t,h=document.elementFromPoint(f.clientX,f.clientY);l(),d&&!d.el.contains(h)&&(s("spill"),this.onSpill({dragEl:i,putSortable:r}))}};function ep(){}ep.prototype={startIndex:null,dragStart:function(e){var t=e.oldDraggableIndex;this.startIndex=t},onSpill:function(e){var t=e.dragEl,r=e.putSortable;this.sortable.captureAnimationState(),r&&r.captureAnimationState();var i=Os(this.sortable.el,this.startIndex,this.options);i?this.sortable.el.insertBefore(t,i):this.sortable.el.appendChild(t),this.sortable.animateAll(),r&&r.animateAll()},drop:Sy};xr(ep,{pluginName:"revertOnSpill"});function tp(){}tp.prototype={onSpill:function(e){var t=e.dragEl,r=e.putSortable,i=r||this.sortable;i.captureAnimationState(),t.parentNode&&t.parentNode.removeChild(t),i.animateAll()},drop:Sy};xr(tp,{pluginName:"removeOnSpill"});var be=[],In=[],pa,gr,ma=!1,yn=!1,cs=!1,Ke,ga,vl;function p6(){function n(e){for(var t in this)t.charAt(0)==="_"&&typeof this[t]=="function"&&(this[t]=this[t].bind(this));e.options.avoidImplicitDeselect||(e.options.supportPointer?Ae(document,"pointerup",this._deselectMultiDrag):(Ae(document,"mouseup",this._deselectMultiDrag),Ae(document,"touchend",this._deselectMultiDrag))),Ae(document,"keydown",this._checkKeyDown),Ae(document,"keyup",this._checkKeyUp),this.defaults={selectedClass:"sortable-selected",multiDragKey:null,avoidImplicitDeselect:!1,setData:function(i,o){var s="";be.length&&gr===e?be.forEach(function(a,l){s+=(l?", ":"")+a.textContent}):s=o.textContent,i.setData("Text",s)}}}return n.prototype={multiDragKeyDown:!1,isMultiDrag:!1,delayStartGlobal:function(t){var r=t.dragEl;Ke=r},delayEnded:function(){this.isMultiDrag=~be.indexOf(Ke)},setupClone:function(t){var r=t.sortable,i=t.cancel;if(this.isMultiDrag){for(var o=0;o<be.length;o++)In.push(Qh(be[o])),In[o].sortableIndex=be[o].sortableIndex,In[o].draggable=!1,In[o].style["will-change"]="",ht(In[o],this.options.selectedClass,!1),be[o]===Ke&&ht(In[o],this.options.chosenClass,!1);r._hideClone(),i()}},clone:function(t){var r=t.sortable,i=t.rootEl,o=t.dispatchSortableEvent,s=t.cancel;this.isMultiDrag&&(this.options.removeCloneOnHide||be.length&&gr===r&&($g(!0,i),o("clone"),s()))},showClone:function(t){var r=t.cloneNowShown,i=t.rootEl,o=t.cancel;this.isMultiDrag&&($g(!1,i),In.forEach(function(s){te(s,"display","")}),r(),vl=!1,o())},hideClone:function(t){var r=this;t.sortable;var i=t.cloneNowHidden,o=t.cancel;this.isMultiDrag&&(In.forEach(function(s){te(s,"display","none"),r.options.removeCloneOnHide&&s.parentNode&&s.parentNode.removeChild(s)}),i(),vl=!0,o())},dragStartGlobal:function(t){t.sortable,!this.isMultiDrag&&gr&&gr.multiDrag._deselectMultiDrag(),be.forEach(function(r){r.sortableIndex=pt(r)}),be=be.sort(function(r,i){return r.sortableIndex-i.sortableIndex}),cs=!0},dragStarted:function(t){var r=this,i=t.sortable;if(this.isMultiDrag){if(this.options.sort&&(i.captureAnimationState(),this.options.animation)){be.forEach(function(s){s!==Ke&&te(s,"position","absolute")});var o=Ye(Ke,!1,!0,!0);be.forEach(function(s){s!==Ke&&Pg(s,o)}),yn=!0,ma=!0}i.animateAll(function(){yn=!1,ma=!1,r.options.animation&&be.forEach(function(s){gf(s)}),r.options.sort&&xl()})}},dragOver:function(t){var r=t.target,i=t.completed,o=t.cancel;yn&&~be.indexOf(r)&&(i(!1),o())},revert:function(t){var r=t.fromSortable,i=t.rootEl,o=t.sortable,s=t.dragRect;be.length>1&&(be.forEach(function(a){o.addAnimationState({target:a,rect:yn?Ye(a):s}),gf(a),a.fromRect=s,r.removeAnimationState(a)}),yn=!1,m6(!this.options.removeCloneOnHide,i))},dragOverCompleted:function(t){var r=t.sortable,i=t.isOwner,o=t.insertion,s=t.activeSortable,a=t.parentEl,l=t.putSortable,d=this.options;if(o){if(i&&s._hideClone(),ma=!1,d.animation&&be.length>1&&(yn||!i&&!s.options.sort&&!l)){var f=Ye(Ke,!1,!0,!0);be.forEach(function(m){m!==Ke&&(Pg(m,f),a.appendChild(m))}),yn=!0}if(!i)if(yn||xl(),be.length>1){var h=vl;s._showClone(r),s.options.animation&&!vl&&h&&In.forEach(function(m){s.addAnimationState({target:m,rect:ga}),m.fromRect=ga,m.thisAnimationDuration=null})}else s._showClone(r)}},dragOverAnimationCapture:function(t){var r=t.dragRect,i=t.isOwner,o=t.activeSortable;if(be.forEach(function(a){a.thisAnimationDuration=null}),o.options.animation&&!i&&o.multiDrag.isMultiDrag){ga=xr({},r);var s=_o(Ke,!0);ga.top-=s.f,ga.left-=s.e}},dragOverAnimationComplete:function(){yn&&(yn=!1,xl())},drop:function(t){var r=t.originalEvent,i=t.rootEl,o=t.parentEl,s=t.sortable,a=t.dispatchSortableEvent,l=t.oldIndex,d=t.putSortable,f=d||this.sortable;if(r){var h=this.options,m=o.children;if(!cs)if(h.multiDragKey&&!this.multiDragKeyDown&&this._deselectMultiDrag(),ht(Ke,h.selectedClass,!~be.indexOf(Ke)),~be.indexOf(Ke))be.splice(be.indexOf(Ke),1),pa=null,Sa({sortable:s,rootEl:i,name:"deselect",targetEl:Ke,originalEvent:r});else{if(be.push(Ke),Sa({sortable:s,rootEl:i,name:"select",targetEl:Ke,originalEvent:r}),r.shiftKey&&pa&&s.el.contains(pa)){var g=pt(pa),b=pt(Ke);~g&&~b&&g!==b&&function(){var A,M;b>g?(M=g,A=b):(M=b,A=g+1);for(var C=h.filter;M<A;M++)if(!~be.indexOf(m[M])&&vn(m[M],h.draggable,o,!1)){var P=C&&(typeof C=="function"?C.call(s,r,m[M],s):C.split(",").some(function(N){return vn(m[M],N.trim(),o,!1)}));P||(ht(m[M],h.selectedClass,!0),be.push(m[M]),Sa({sortable:s,rootEl:i,name:"select",targetEl:m[M],originalEvent:r}))}}()}else pa=Ke;gr=f}if(cs&&this.isMultiDrag){if(yn=!1,(o[Bt].options.sort||o!==i)&&be.length>1){var v=Ye(Ke),x=pt(Ke,":not(."+this.options.selectedClass+")");if(!ma&&h.animation&&(Ke.thisAnimationDuration=null),f.captureAnimationState(),!ma&&(h.animation&&(Ke.fromRect=v,be.forEach(function(A){if(A.thisAnimationDuration=null,A!==Ke){var M=yn?Ye(A):v;A.fromRect=M,f.addAnimationState({target:A,rect:M})}})),xl(),be.forEach(function(A){m[x]?o.insertBefore(A,m[x]):o.appendChild(A),x++}),l===pt(Ke))){var E=!1;be.forEach(function(A){if(A.sortableIndex!==pt(A)){E=!0;return}}),E&&(a("update"),a("sort"))}be.forEach(function(A){gf(A)}),f.animateAll()}gr=f}(i===o||d&&d.lastPutMode!=="clone")&&In.forEach(function(A){A.parentNode&&A.parentNode.removeChild(A)})}},nullingGlobal:function(){this.isMultiDrag=cs=!1,In.length=0},destroyGlobal:function(){this._deselectMultiDrag(),Se(document,"pointerup",this._deselectMultiDrag),Se(document,"mouseup",this._deselectMultiDrag),Se(document,"touchend",this._deselectMultiDrag),Se(document,"keydown",this._checkKeyDown),Se(document,"keyup",this._checkKeyUp)},_deselectMultiDrag:function(t){if(!(typeof cs<"u"&&cs)&&gr===this.sortable&&!(t&&vn(t.target,this.options.draggable,this.sortable.el,!1))&&!(t&&t.button!==0))for(;be.length;){var r=be[0];ht(r,this.options.selectedClass,!1),be.shift(),Sa({sortable:this.sortable,rootEl:this.sortable.el,name:"deselect",targetEl:r,originalEvent:t})}},_checkKeyDown:function(t){t.key===this.options.multiDragKey&&(this.multiDragKeyDown=!0)},_checkKeyUp:function(t){t.key===this.options.multiDragKey&&(this.multiDragKeyDown=!1)}},xr(n,{pluginName:"multiDrag",utils:{select:function(t){var r=t.parentNode[Bt];!r||!r.options.multiDrag||~be.indexOf(t)||(gr&&gr!==r&&(gr.multiDrag._deselectMultiDrag(),gr=r),ht(t,r.options.selectedClass,!0),be.push(t))},deselect:function(t){var r=t.parentNode[Bt],i=be.indexOf(t);!r||!r.options.multiDrag||!~i||(ht(t,r.options.selectedClass,!1),be.splice(i,1))}},eventProperties:function(){var t=this,r=[],i=[];return be.forEach(function(o){r.push({multiDragElement:o,index:o.sortableIndex});var s;yn&&o!==Ke?s=-1:yn?s=pt(o,":not(."+t.options.selectedClass+")"):s=pt(o),i.push({multiDragElement:o,index:s})}),{items:qA(be),clones:[].concat(In),oldIndicies:r,newIndicies:i}},optionListeners:{multiDragKey:function(t){return t=t.toLowerCase(),t==="ctrl"?t="Control":t.length>1&&(t=t.charAt(0).toUpperCase()+t.substr(1)),t}}})}function m6(n,e){be.forEach(function(t,r){var i=e.children[t.sortableIndex+(n?Number(r):0)];i?e.insertBefore(t,i):e.appendChild(t)})}function $g(n,e){In.forEach(function(t,r){var i=e.children[t.sortableIndex+(n?Number(r):0)];i?e.insertBefore(t,i):e.appendChild(t)})}function xl(){be.forEach(function(n){n!==Ke&&n.parentNode&&n.parentNode.removeChild(n)})}ce.mount(new h6);ce.mount(tp,ep);function g6(n={show:!1,focusable:!1}){return{show:n.show,focusable:n.focusable,closeModal(){this.show=!1},openModal(){this.show=!0},focusables(){return[...this.$el.querySelectorAll("a, button, input:not([type='hidden']), textarea, select, details, [tabindex]:not([tabindex='-1'])")].filter(t=>!t.hasAttribute("disabled"))},firstFocusable(){return this.focusables()[0]},lastFocusable(){return this.focusables().slice(-1)[0]},nextFocusable(){return this.focusables()[this.nextFocusableIndex()]||this.firstFocusable()},prevFocusable(){return this.focusables()[this.prevFocusableIndex()]||this.lastFocusable()},nextFocusableIndex(){return(this.focusables().indexOf(document.activeElement)+1)%(this.focusables().length+1)},prevFocusableIndex(){return Math.max(0,this.focusables().indexOf(document.activeElement))-1},init(){this.$watch("show",e=>{e?(document.body.classList.add("overflow-y-hidden"),this.focusable!==!1&&setTimeout(()=>this.firstFocusable().focus(),100)):document.body.classList.remove("overflow-y-hidden")})}}}function b6(n={}){return{isShared:n.isShared??!1,limits:n.limits??{},init(){},pushToAiEngines(e){this.aiEngines.push(e)}}}class Cy{constructor(){this.playbackNode=null}async init(e){this.audioContext=new AudioContext({sampleRate:e}),await this.audioContext.audioWorklet.addModule("/themes/default/assets/js/audio/playback-worklet.js"),this.playbackNode=new AudioWorkletNode(this.audioContext,"playback-worklet"),this.playbackNode.connect(this.audioContext.destination)}play(e){this.playbackNode&&this.playbackNode.port.postMessage(e)}clear(){this.playbackNode&&this.playbackNode.port.postMessage(null)}}function Cs(n,e,t,r){function i(o){return o instanceof t?o:new t(function(s){s(o)})}return new(t||(t=Promise))(function(o,s){function a(f){try{d(r.next(f))}catch(h){s(h)}}function l(f){try{d(r.throw(f))}catch(h){s(h)}}function d(f){f.done?o(f.value):i(f.value).then(a,l)}d((r=r.apply(n,[])).next())})}function So(n,e){var t={label:0,sent:function(){if(o[0]&1)throw o[1];return o[1]},trys:[],ops:[]},r,i,o,s=Object.create((typeof Iterator=="function"?Iterator:Object).prototype);return s.next=a(0),s.throw=a(1),s.return=a(2),typeof Symbol=="function"&&(s[Symbol.iterator]=function(){return this}),s;function a(d){return function(f){return l([d,f])}}function l(d){if(r)throw new TypeError("Generator is already executing.");for(;s&&(s=0,d[0]&&(t=0)),t;)try{if(r=1,i&&(o=d[0]&2?i.return:d[0]?i.throw||((o=i.return)&&o.call(i),0):i.next)&&!(o=o.call(i,d[1])).done)return o;switch(i=0,o&&(d=[d[0]&2,o.value]),d[0]){case 0:case 1:o=d;break;case 4:return t.label++,{value:d[1],done:!1};case 5:t.label++,i=d[1],d=[0];continue;case 7:d=t.ops.pop(),t.trys.pop();continue;default:if(o=t.trys,!(o=o.length>0&&o[o.length-1])&&(d[0]===6||d[0]===2)){t=0;continue}if(d[0]===3&&(!o||d[1]>o[0]&&d[1]<o[3])){t.label=d[1];break}if(d[0]===6&&t.label<o[1]){t.label=o[1],o=d;break}if(o&&t.label<o[2]){t.label=o[2],t.ops.push(d);break}o[2]&&t.ops.pop(),t.trys.pop();continue}d=e.call(n,t)}catch(f){d=[6,f],i=0}finally{r=o=0}if(d[0]&5)throw d[1];return{value:d[0]?d[1]:void 0,done:!0}}}function zg(n){var e=typeof Symbol=="function"&&Symbol.iterator,t=e&&n[e],r=0;if(t)return t.call(n);if(n&&typeof n.length=="number")return{next:function(){return n&&r>=n.length&&(n=void 0),{value:n&&n[r++],done:!n}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")}function Ef(n,e){var t=typeof Symbol=="function"&&n[Symbol.iterator];if(!t)return n;var r=t.call(n),i,o=[],s;try{for(;(e===void 0||e-- >0)&&!(i=r.next()).done;)o.push(i.value)}catch(a){s={error:a}}finally{try{i&&!i.done&&(t=r.return)&&t.call(r)}finally{if(s)throw s.error}}return o}function Es(n){return this instanceof Es?(this.v=n,this):new Es(n)}function y6(n,e,t){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var r=t.apply(n,e||[]),i,o=[];return i=Object.create((typeof AsyncIterator=="function"?AsyncIterator:Object).prototype),a("next"),a("throw"),a("return",s),i[Symbol.asyncIterator]=function(){return this},i;function s(g){return function(b){return Promise.resolve(b).then(g,h)}}function a(g,b){r[g]&&(i[g]=function(v){return new Promise(function(x,E){o.push([g,v,x,E])>1||l(g,v)})},b&&(i[g]=b(i[g])))}function l(g,b){try{d(r[g](b))}catch(v){m(o[0][3],v)}}function d(g){g.value instanceof Es?Promise.resolve(g.value.v).then(f,h):m(o[0][2],g)}function f(g){l("next",g)}function h(g){l("throw",g)}function m(g,b){g(b),o.shift(),o.length&&l(o[0][0],o[0][1])}}function v6(n){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var e=n[Symbol.asyncIterator],t;return e?e.call(n):(n=typeof zg=="function"?zg(n):n[Symbol.iterator](),t={},r("next"),r("throw"),r("return"),t[Symbol.asyncIterator]=function(){return this},t);function r(o){t[o]=n[o]&&function(s){return new Promise(function(a,l){s=n[o](s),i(a,l,s.done,s.value)})}}function i(o,s,a,l){Promise.resolve(l).then(function(d){o({value:d,done:a})},s)}}var x6=function(n){return typeof n=="object"&&n!==null&&"type"in n},w6=function(n){return x6(n)&&["error","message","conversation.item.input_audio_transcription.delta","session.created","session.updated","input_audio_buffer.committed","input_audio_buffer.cleared","input_audio_buffer.speech_started","input_audio_buffer.speech_stopped","conversation.item.created","conversation.item.truncated","conversation.item.deleted","conversation.item.input_audio_transcription.completed","conversation.item.input_audio_transcription.failed","response.created","response.done","response.output_item.added","response.output_item.done","response.content_part.added","response.content_part.done","response.text.delta","response.text.done","response.audio_transcript.delta","response.audio_transcript.done","response.audio.delta","response.audio.done","response.function_call_arguments.delta","response.function_call_arguments.done","rate_limits.updated"].includes(n.type)},k6=WebSocket,S6=function(n,e){return n.readyState!==WebSocket.OPEN?Promise.reject(new Error("Socket is not open")):(n.send(e),Promise.resolve())},C6=function(n){return{success:!0,message:n}},E6=function(n){return{success:!1,error:n}},_6=function(n){return n.success},A6=function(){function n(e,t){var r=this;this.closedPromise=void 0,this.messageQueue=[],this.receiverQueue=[],this.done=!1,this.validate=t.validate,this.serialize=t.serialize,this.connectedPromise=new Promise(function(i,o){return Cs(r,void 0,void 0,function(){var s,a,l,d,f=this;return So(this,function(h){switch(h.label){case 0:return e.policy!==void 0?[3,1]:(d=e,[3,3]);case 1:return[4,e.policy(e)];case 2:d=h.sent(),h.label=3;case 3:return s=d,a=s.uri,l=s.protocols,this.socket=new k6(a.toString(),l),this.socket.onopen=function(){f.socket.onmessage=f.getMessageHandler(),f.closedPromise=new Promise(function(m){f.socket.onclose=f.getClosedHandler(m)}),f.socket.onerror=f.handleError,i()},this.socket.onerror=function(m){f.error=m.error,o(m)},[2]}})})})}return n.prototype.handleError=function(e){for(this.error=e.error;this.receiverQueue.length>0;){var t=Ef(this.receiverQueue.shift(),2);t[0];var r=t[1];r(e.error)}},n.prototype.getClosedHandler=function(e){var t=this;return function(r){for(t.done=!0;t.receiverQueue.length>0;){var i=Ef(t.receiverQueue.shift(),2),o=i[0],s=i[1];t.error?s(t.error):o({value:void 0,done:!0})}e()}},n.prototype.getMessageHandler=function(){var e=this;return function(t){var r=e.validate(t);if(_6(r)){var i=r.message;if(e.receiverQueue.length>0){var o=Ef(e.receiverQueue.shift(),2),s=o[0];o[1],s({value:i,done:!1})}else e.messageQueue.push(i)}else e.error=r.error,e.socket.close(1e3,"Unexpected message received")}},n.prototype[Symbol.asyncIterator]=function(){var e=this;return{next:function(){if(e.error)return Promise.reject(e.error);if(e.done)return Promise.resolve({value:void 0,done:!0});if(e.messageQueue.length>0){var t=e.messageQueue.shift();return Promise.resolve({value:t,done:!1})}else return new Promise(function(r,i){e.receiverQueue.push([r,i])})}}},n.prototype.send=function(e){return Cs(this,void 0,void 0,function(){var t;return So(this,function(r){switch(r.label){case 0:return[4,this.connectedPromise];case 1:if(r.sent(),this.error)throw this.error;return t=this.serialize(e),[2,S6(this.socket,t)]}})})},n.prototype.close=function(){return Cs(this,void 0,void 0,function(){return So(this,function(e){switch(e.label){case 0:return[4,this.connectedPromise];case 1:return e.sent(),this.done?[2]:(this.socket.close(),[4,this.closedPromise]);case 2:return e.sent(),[2]}})})},n}();function gh(n){return typeof n=="object"&&n!==null&&"key"in n&&typeof n.key=="string"}function T6(n){return typeof n=="object"&&n!==null&&"getToken"in n&&typeof n.getToken=="function"}var D6=function(n){return gh(n)||T6(n)},M6=function(n){return typeof n=="object"&&n!==null&&"model"in n&&typeof n.model=="string"},O6=function(n){return typeof n=="object"&&n!==null&&"deployment"in n&&typeof n.deployment=="string"},I6=function(){function n(e,t,r){var i=this,o=function(){if(gh(e)&&M6(t))return i.openAISettings(e,t);if(D6(t)&&O6(r))return i.azureOpenAISettings(e,t,r);throw new Error("Invalid combination of arguments to initialize the Realtime client")}();this.client=this.getWebsocket(o)}return n.prototype.azureOpenAISettings=function(e,t,r){var i=this,o=["https://cognitiveservices.azure.com/.default"];return this.requestId=crypto.randomUUID(),e.searchParams.set("api-version","2024-10-01-preview"),e.searchParams.set("x-ms-client-request-id",this.requestId),e.searchParams.set("deployment",r.deployment),e.pathname="openai/realtime",{uri:e,policy:function(s){return Cs(i,void 0,void 0,function(){var a;return So(this,function(l){switch(l.label){case 0:return gh(t)?(s.uri.searchParams.set("api-key",t.key),[3,3]):[3,1];case 1:return[4,t.getToken(o)];case 2:a=l.sent(),s.uri.searchParams.set("Authorization","Bearer ".concat(a.token)),l.label=3;case 3:return[2,s]}})})}}},n.prototype.openAISettings=function(e,t){var r=new URL("wss://api.openai.com/v1/realtime");return r.searchParams.set("model",t.model),{uri:r,protocols:["realtime","openai-insecure-api-key.".concat(e.key),"openai-beta.realtime-v1"]}},n.prototype.getWebsocket=function(e){var t={validate:function(r){r.data;try{var i=JSON.parse(r.data);if(w6(i))return C6(i)}catch{return E6(new Error("Invalid JSON message"))}},serialize:function(r){return JSON.stringify(r)}};return new A6(e,t)},n.prototype.messages=function(){return y6(this,arguments,function(){var t,r,i,o,s,a,l,d,f;return So(this,function(h){switch(h.label){case 0:h.trys.push([0,7,8,13]),t=!0,r=v6(this.client),h.label=1;case 1:return[4,Es(r.next())];case 2:return i=h.sent(),a=i.done,!a?(f=i.value,t=!1,o=f,[4,Es(o)]):[3,6];case 3:return[4,h.sent()];case 4:h.sent(),h.label=5;case 5:return t=!0,[3,1];case 6:return[3,13];case 7:return s=h.sent(),l={error:s},[3,13];case 8:return h.trys.push([8,,11,12]),!t&&!a&&(d=r.return)?[4,Es(d.call(r))]:[3,10];case 9:h.sent(),h.label=10;case 10:return[3,12];case 11:if(l)throw l.error;return[7];case 12:return[7];case 13:return[2]}})})},n.prototype.send=function(e){return Cs(this,void 0,void 0,function(){return So(this,function(t){switch(t.label){case 0:return[4,this.client.send(e)];case 1:return t.sent(),[2]}})})},n.prototype.close=function(){return Cs(this,void 0,void 0,function(){return So(this,function(e){switch(e.label){case 0:return[4,this.client.close()];case 1:return e.sent(),[2]}})})},n}();ee.store("realtimeChatStatus",{active:!1,conversationStarted:!1,setActive(n){this.active=n,this.onActiveChange()},setConversationStarted(n){this.conversationStarted=n,this.onConversationStartedChange()},onActiveChange(){var n,e;document.querySelectorAll(".lqd-realtime-chat-button").forEach(t=>t.classList.toggle("active",this.active)),(e=(n=document.querySelector(".lqd-audio-vis-wrap"))==null?void 0:n.classList)==null||e.toggle("active",this.active)},onConversationStartedChange(){const n=document.querySelector(".chats-wrap");n.classList.toggle("conversation-started",this.conversationStarted),n.classList.toggle("conversation-not-started",!this.conversationStarted),document.querySelectorAll(".lqd-realtime-chat-button").forEach(e=>{e.classList.toggle("conversation-started",this.conversationStarted),e.classList.toggle("conversation-not-started",!this.conversationStarted)})}});const N6=(n,e,t)=>({apiKey:"",recordingActive:!1,buffer:new Uint8Array,wsConnection:null,audioRecorder:null,audioPlayer:null,activeVisulaizer:"idle",audioVisWrap:null,audioVisBars:null,audioVisDotWrap:null,audioVisLoader:null,conversationArea:document.querySelector(".conversation-area"),chatsContainer:document.querySelector(".chats-container"),userBubbleTemplate:document.querySelector("#chat_user_bubble"),aiBubbleTemplate:document.querySelector("#chat_ai_bubble"),lastAiBubble:null,lastUserBubble:null,lastUserQuestion:"",lastAiResponse:"",lastResponseSaved:!1,init(){var r,i,o;this.audioVisWrap=document.querySelector(".lqd-audio-vis-wrap"),this.audioVisBars=(r=this.audioVisWrap)==null?void 0:r.querySelectorAll(".lqd-audio-vis-bar"),this.audioVisDotWrap=(i=this.audioVisWrap)==null?void 0:i.querySelector(".lqd-audio-vis-dot-wrap"),this.audioVisLoader=(o=this.audioVisWrap)==null?void 0:o.querySelector(".lqd-audio-vis-loader"),this.processAudioRecordingBuffer=this.processAudioRecordingBuffer.bind(this)},async start(){if(this.checkBalanceRealtime(!0).then(r=>{r.shouldStop&&(toastr.error(r.errorMsg),this.stop())}),!ee.store("realtimeChatStatus").isActive){ee.store("realtimeChatStatus").setActive(!0),this.switchVisualizers("waiting"),this.wsConnection=new I6({key:atob(n)+atob(e)+atob(t)},{model:"gpt-4o-realtime-preview-2024-12-17"});try{await this.wsConnection.send(this.createConfigMessage())}catch(r){this.stop(),console.error("Error sending initial config message:",r),this.appendToChatBubble("ai","[Connection error]: Unable to send initial config message. Please check your endpoint and authentication details.");return}await Promise.all([this.startRecorder(),this.startPlayer()]).then(()=>{this.handleRealtimeMessages(),this.startBarsVisualizer(),this.startDotVisualizer(),this.switchVisualizers("idle")}).catch(r=>{this.stop(),console.error("Error starting recorder and player:",r),this.appendToChatBubble("ai","[Error]: Unable to start audio recorder and player. Please check your microphone permissions and refresh the page.")})}},stop(){if(!this.lastResponseSaved&&"saveResponseAsync"in window&&this.lastUserQuestion.trim()!==""&&this.lastAiResponse.trim()!==""){const r=this.lastAiBubble.closest(".lqd-chat-ai-bubble");saveResponseAsync(this.lastUserQuestion.trim(),this.lastAiResponse.trim(),document.querySelector("#chat_id").value,"","","","","gpt-4o-realtime-preview-2024-12-17").then(i=>{r==null||r.setAttribute("data-message-id",i.message.id)})}this.resetPlayers(),this.wsConnection&&this.wsConnection.close(),this.switchVisualizers(""),ee.store("realtimeChatStatus").setActive(!1)},async startPlayer(){try{this.audioPlayer=new Cy,await this.audioPlayer.init(24e3)}catch(r){console.error("Error starting audio player:",r)}},async startRecorder(){try{this.audioRecorder=new Yb(this.processAudioRecordingBuffer);const r=await navigator.mediaDevices.getUserMedia({audio:!0,video:!1});await this.audioRecorder.start(r),this.recordingActive=!0}catch(r){console.error("Error starting audio recorder:",r)}},createConfigMessage(){let r={type:"session.update",session:{turn_detection:{type:"server_vad",silence_duration_ms:500},input_audio_transcription:{model:"whisper-1"}}};const i=this.getSystemMessage(),o=this.getTemperature(),s=this.getVoice();return i&&(r.session.instructions=i),isNaN(o)||(r.session.temperature=o),s&&(r.session.voice=s),r},async handleRealtimeMessages(){for await(const r of this.wsConnection.messages())switch(""+r.type,r.type){case"session.created":this.switchVisualizers("idle");break;case"response.content_part.added":this.checkBalanceRealtime().then(i=>{i.shouldStop&&(toastr.error(i.errorMsg),this.stop())}),this.lastAiResponse="",ee.store("realtimeChatStatus").setConversationStarted(!0),this.createChatBubble("ai");break;case"response.audio_transcript.delta":this.lastAiResponse+=r.delta,this.appendToChatBubble("ai",r.delta);break;case"response.audio.delta":{this.switchVisualizers("playing");const i=atob(r.delta),o=Uint8Array.from(i,a=>a.charCodeAt(0)),s=new Int16Array(o.buffer);this.audioPlayer.play(s);break}case"input_audio_buffer.speech_started":{this.createChatBubble("user"),this.switchVisualizers("recording"),this.audioPlayer.clear(),this.lastResponseSaved=!1,setTimeout(()=>{this.lastUserQuestion=""},0);break}case"conversation.item.input_audio_transcription.completed":this.lastUserQuestion+=r.transcript,this.appendToChatBubble("user",r.transcript);break;case"response.output_item.done":break;case"conversation.item.truncated":this.appendToChatBubble("ai","...");break;case"conversation.item.deleted":break;case"response.done":if("saveResponseAsync"in window){const i=this.lastAiBubble.closest(".lqd-chat-ai-bubble");saveResponseAsync(this.lastUserQuestion.trim(),this.lastAiResponse.trim(),document.querySelector("#chat_id").value,"","","","","gpt-4o-realtime-preview-2024-12-17").then(o=>{i==null||i.setAttribute("data-message-id",o.message.id)}),this.lastResponseSaved=!0}"formatString"in window&&this.lastAiBubble&&(this.lastAiBubble.innerHTML=formatString(this.lastAiResponse));break;default:JSON.stringify(r,null,2);break}this.resetPlayers()},combineArray(r){const i=new Uint8Array(this.buffer.length+r.length);i.set(this.buffer),i.set(r,this.buffer.length),this.buffer=i},processAudioRecordingBuffer(r){const i=new Uint8Array(r);if(this.combineArray(i),this.buffer.length>=4800){const o=new Uint8Array(this.buffer.slice(0,4800));this.buffer=new Uint8Array(this.buffer.slice(4800));const s=String.fromCharCode(...o),a=btoa(s);this.recordingActive&&this.wsConnection.send({type:"input_audio_buffer.append",audio:a})}},async resetPlayers(){var r,i;this.recordingActive=!1,(r=this.audioRecorder)==null||r.stop(),(i=this.audioPlayer)==null||i.clear()},getSystemMessage(){return""},getTemperature(){return parseFloat(.8)},getVoice(){return"alloy"},switchVisualizers(r){var i;this.activeVisulaizer=r,(i=this.audioVisWrap)==null||i.setAttribute("data-state",this.activeVisulaizer)},createChatBubble(r){var d;const o=(r==="user"?this.userBubbleTemplate:this.aiBubbleTemplate).content.cloneNode(!0),s=o.querySelector(".chat-content"),a=document.querySelector("#create_canvas_button.active"),l=document.querySelector("#canvas_edit_btn_block");if(this.chatsContainer.appendChild(o),r==="user")this.lastUserBubble=s;else if(this.lastAiBubble=s,a&&l){const f=l.content.cloneNode(!0);(d=s.closest(".chat-content-container"))==null||d.insertAdjacentElement("afterbegin",f.firstElementChild)}this.scrollConversationAreaToBottom()},appendToChatBubble(r,i){const o=r==="user"?this.lastUserBubble:this.lastAiBubble;o?(o.textContent+=i,this.scrollConversationAreaToBottom()):(this.createChatBubble(r),this.appendToChatBubble(r,i))},scrollConversationAreaToBottom(){this.conversationArea.scrollTo({top:this.conversationArea.scrollHeight+200,left:0})},startBarsVisualizer(){var d;if(!((d=this.audioVisBars)!=null&&d.length))return;const r=this.audioPlayer.audioContext.createAnalyser();r.fftSize=4096;const i=r.frequencyBinCount,o=new Uint8Array(i),s=this.audioVisBars.length;this.audioPlayer.playbackNode.connect(r);const a=[[85,150],[150,250],[250,400],[400,600],[600,1e3]];this.barHeights=this.barHeights||new Array(s).fill(0);const l=()=>{r.getByteFrequencyData(o),this.audioVisBars.forEach((f,h)=>{const[m,g]=a[h],b=Math.floor(m/(this.audioPlayer.audioContext.sampleRate/r.fftSize)),v=Math.ceil(g/(this.audioPlayer.audioContext.sampleRate/r.fftSize));let x=0;for(let A=b;A<=v&&A<o.length;A++)o[A]>x&&(x=o[A]);let E=x/255*80;this.barHeights[h]+=(E-this.barHeights[h])*.4,this.barHeights[h]+=(Math.random()-.5)*2,this.barHeights[h]=Math.max(5,Math.min(100,this.barHeights[h])),f.animate([{height:f.style.height},{height:`${this.barHeights[h]}%`}],{duration:30,fill:"forwards",easing:"linear"})}),requestAnimationFrame(l)};l()},startDotVisualizer(){if(!this.audioRecorder||!this.audioVisDotWrap)return;const r=this.audioRecorder.audioContext.createAnalyser();r.fftSize=256;const i=r.frequencyBinCount,o=new Uint8Array(i);this.audioRecorder.getMediaStreamSource().connect(r);const s=this.audioVisDotWrap.querySelector(".lqd-audio-vis-dot");if(!s)return;const a=()=>{r.getByteFrequencyData(o);let l=0;for(let m=0;m<i;m++)l+=o[m];const f=1+l/i/256*1.5,h=Math.max(.2,1-(f-1)/1.5);s.style.transform=`scale(${f})`,s.style.opacity=h.toFixed(2),requestAnimationFrame(a)};a()},checkBalanceRealtime(r=!1){return new Promise(i=>{$.ajax({url:"/dashboard/user/realtime/chat/checkBalance",type:"POST",data:{onStart:r},dataType:"json",success:o=>{const s=o.status!=="success",a=o.message||"";console.log("Try Count:",o==null?void 0:o.tryCount),i({shouldStop:s,errorMsg:a})},error:()=>{i({shouldStop:!0,errorMsg:"An error occurred."})}})})}}),Hg=(n={})=>({prevViews:[],task:!1,currentView:"home",sidebarCollapsed:!1,toolbarCollapsed:!1,modalShow:!1,activeModal:null,activeModalId:null,activeModalIdPrefix:null,currentToolsCat:"primary",tools:n.tools||[],primaryToolKeys:n.primaryToolKeys||[],showImageDetails:!1,zoomLevel:1,reachedMinZoom:!1,reachedMaxZoom:!1,newItems:[],showNotif:!1,editingImageDimensions:{width:0,height:0},painting:!1,brushSize:40,canvasCtx:null,lastUploadingImages:[],uploadingImages:[],promptLibraryShow:!1,promptFilter:"all",searchPromptStr:"",supportMultipleImageTools:["reimagine"],_busy:!1,_template:"",_prompt:"",_selectedTemplateDescription:"",_selectedPromptDescription:"",_selectedTool:"",aiModel:"",_prevEditingImage:{},_editingImage:{},get busy(){return this._busy},set busy(e){this._busy=e},get selectedTemplate(){return this._template.trim()},set selectedTemplate(e){var t;this._template=e,(t=this.$refs.promptInput)==null||t.focus()},get prompt(){return this._prompt},set prompt(e){var t;this._prompt=e.trim(),(t=this.$refs.promptInput)==null||t.focus()},get selectedTemplateDescription(){return this._selectedTemplateDescription},set selectedTemplateDescription(e){this._selectedTemplateDescription!==e&&(this._selectedTemplateDescription=e)},get selectedPromptDescription(){return this._selectedPromptDescription},set selectedPromptDescription(e){this._selectedPromptDescription!==e&&(this._selectedPromptDescription=e)},get selectedTool(){return this._selectedTool},set selectedTool(e){this.aiModel=AIModelsforTool[e],this._selectedTool!==e&&(this._selectedTool=e,this.makeCanvasEditable(this._selectedTool==="sketch_to_image"?{width:1024,height:1024}:{}),!this.selectedToolSupportMultiImagesUpload()&&this.$refs.editorFileInput.files.length&&this.clearImageInputs())},get prevEditingImage(){return this._prevEditingImage},get editingImage(){return this._editingImage},set editingImage(e){this._prevEditingImage=this._editingImage,this._editingImage=e,this.showImageDetails=!1,this.zoomLevel=1,e!=null&&e.output&&fetch(e.output).then(t=>t.blob()).then(t=>{var o,s;const r=new File([t],((s=(o=e.title)==null?void 0:o.split("."))==null?void 0:s.at(0))||"image",{type:t.type}),i=new DataTransfer;i.items.add(r),this.$refs.uploadedImageInput.files=i.files}).catch(t=>{toastr.error("Failed to load image"),console.error("Error creating file from URL:",t)})},init(){this.onViewChange=this.onViewChange.bind(this),this.onZoomLevelChange=this.onZoomLevelChange.bind(this),this.onCreativeSuiteStageInitiated=this.onCreativeSuiteStageInitiated.bind(this),this.makeCanvasEditable=this.makeCanvasEditable.bind(this),this.startPainting=this.startPainting.bind(this),this.stopPainting=this.stopPainting.bind(this),this.paint=this.paint.bind(this),document.documentElement.style.scrollbarGutter="stable",this.$watch("currentView",this.onViewChange),this.$watch("zoomLevel",this.onZoomLevelChange),this.creativeSuite&&this.$watch("creativeSuite.stageInitiated",this.onCreativeSuiteStageInitiated);const e=new URLSearchParams(window.location.search);if(e.has("action")){const t=e.get("action");["merge_face","uncrop","reimagine","remove_background","cleanup","upscale","replace_background","sketch_to_image","remove_text","inpainting","style_transfer","image_relight"].includes(t)&&(this.currentView="editor",this.switchToolsCat({toolKey:t}),this.selectedTool=t)}},switchView(e){var t;if(!((t=this.creativeSuite)!=null&&t.editingTextNode)){if(e==="<"){this.currentView=this.prevViews.pop()||"home";return}this.prevViews.push(this.currentView),this.currentView=e||"home"}},switchSidebarCollapsed(e){if(e!=null){this.sidebarCollapsed=e;return}this.sidebarCollapsed=!this.sidebarCollapsed,this.$nextTick(()=>{this.zoomLevel>1&&this.fitToScreen()}),this.$refs.imageEditorSidebar.addEventListener("transitionend",t=>{t.target!==this.$refs.imageEditorSidebar&&t.propertyName!=="transform"||this.reachedMaxZoom&&this.fitToScreen()})},onViewChange(e){const t=e==="editor";document.documentElement.style.overflow=t?"hidden":""},setActiveModal(e,t="modal"){this.activeModal=e,this.activeModalId=e.id,this.activeModalIdPrefix=t},prevImageModal(){const e=document.querySelector(`.image-result[data-id='${this.activeModalId}'][data-id-prefix=${this.activeModalIdPrefix}]`),t=e==null?void 0:e.previousElementSibling;if(!t)return;const r=JSON.parse(t.getAttribute("data-payload")||{});this.setActiveModal(r,e.getAttribute("data-id-prefix"))},nextImageModal(){const e=document.querySelector(`.image-result[data-id='${this.activeModalId}'][data-id-prefix=${this.activeModalIdPrefix}]`),t=e==null?void 0:e.nextElementSibling;if(!t)return;const r=JSON.parse(t.getAttribute("data-payload")||{});this.setActiveModal(r,e.getAttribute("data-id-prefix"))},getSelectedToolCat(){return this.getToolCat(this.selectedTool)},switchToolsCat(e={}){if(e.cat)return this.currentToolsCat=e.cat;if(e.toolKey)return this.currentToolsCat=this.getToolCat(e.toolKey);if(!e.cat&&!e.toolKey)return this.currentToolsCat=this.currentToolsCat==="primary"?"secondary":"primary"},getToolCat(e){return this.primaryToolKeys.findIndex(t=>t===e)>=0?"primary":"secondary"},selectedToolSupportMultiImagesUpload(){return this.supportMultipleImageTools.includes(this.selectedTool)&&this.aiModel==="openai"},handleDragOver(){this.$refs.dropArea.classList.add("drag-over")},handleDragLeave(){this.$refs.dropArea.classList.remove("drag-over")},handleUploadingMultiImages(e){if(!this.selectedToolSupportMultiImagesUpload())return;const t=Array.from(e),r=Array.from(this.lastUploadingImages),i=new DataTransfer;return r.forEach(o=>{i.items.add(o)}),t.forEach(o=>{if(!o.type.startsWith("image/")){toastr.error("Please upload a valid image file."),this.clearImageInputs();return}r.findIndex(s=>s.name===o.name&&s.size===o.size)===-1&&i.items.add(o)}),this.$refs.editorFileInput.files=i.files,this.$refs.uploadedImageInput.files=i.files,this.lastUploadingImages=i.files,this.uploadingImages=Array.from(i.files).map(o=>({src:URL.createObjectURL(o),name:o.name})),i.files},handleFileChange(e){var r;let t=e.dataTransfer?e.dataTransfer.files:(r=e.target)==null?void 0:r.files;if(this.$refs.dropArea.classList.remove("drag-over"),!!t){if(e.dataTransfer&&(this.$refs.editorFileInput.files=t),t&&!t.length){this.handleUploadingMultiImages(this.lastUploadingImages);return}this.selectedToolSupportMultiImagesUpload()&&(t=this.handleUploadingMultiImages(t)),this.handleFiles(t)}},handleFiles(e){if(!e[0])return;this.selectedToolSupportMultiImagesUpload()||(this.editingImage={output:URL.createObjectURL(e[0]),name:e[0].name});const t=new FormData;t.append("image",e[0]),t.append("reimagine",e[0]),["reimagine"].includes(this.selectedTool)&&(this.$refs.promptInput&&(this.$refs.promptInput.disabled=!0,this.$refs.promptInput.placeholder="Analyzing image... Please wait..."),fetch("/dashboard/user/image-to-prompt",{method:"POST",headers:{"X-CSRF-TOKEN":"{{ csrf_token() }}"},body:t}).then(r=>r.json()).then(r=>{r.status==="success"?this.prompt=r.prompt:toastr.error(r.prompt)}).catch(r=>{console.log("Error:",r)}).finally(()=>{this.$refs.promptInput&&(this.$refs.promptInput.disabled=!1,this.$refs.promptInput.placeholder="Describe your idea or select a pre-defined prompt")}))},resetUploadedImageInput(){this.zoomLevel=1,this.clearImageInputs(),this.selectedTool==="sketch_to_image"&&this.makeCanvasEditable({width:1024,height:1024})},clearImageInputs(){this.lastUploadingImages=[],this.uploadingImages=[],this.editingImage={},this.$refs.editorFileInput.value="",this.$refs.uploadedImageInput.value=""},downloadImage(e,t){const r=document.createElement("a");r.href=e,r.download=t?t.replaceAll(" ","-"):"image",r.click(),r.remove()},getMaxZoom(){const e=this.$refs.editorCanvas,t=e.offsetWidth,r=window.getComputedStyle(e);return 1+(parseFloat(r.marginLeft)+parseFloat(r.marginRight)-20)/t},setZoomLevel(e){const t=this.getMaxZoom();this.zoomLevel=Math.max(.1,Math.min(t,e)),this.reachedMinZoom=this.zoomLevel===.1,this.reachedMaxZoom=this.zoomLevel>=t},zoomIn(){this.setZoomLevel(this.zoomLevel+.1)},zoomOut(){this.setZoomLevel(this.zoomLevel-.1)},fitToScreen(){const e=this.getMaxZoom();this.setZoomLevel(e)},onZoomLevelChange(){const e=this.$refs.editorCanvas;e.style.setProperty("--zoom-level",this.zoomLevel.toFixed(3)),e.style.setProperty("--zoom-offset","0px");const t=window.getComputedStyle(e),r=parseFloat(t.getPropertyValue("--header-h")),o=e.getBoundingClientRect().top+this.$refs.editorCanvasWrap.scrollTop;o<r&&e.style.setProperty("--zoom-offset",`${(o>=0?r-o:r+Math.abs(o)).toFixed(0)}px`)},submitEditorForm(e){this.busy=!0;const t=new FormData(e.target);fetch(e.target.action,{method:"POST",body:t,headers:{Accept:"application/json"}}).then(r=>r.ok?r.json():r.json().then(i=>{throw new Error(i.message||"An unknown error occurred")})).then(r=>{var i,o;if(r.type==="error"){toastr.error(r.message);return}if(((i=r==null?void 0:r.data)==null?void 0:i.status)==="CREATED"||((o=r==null?void 0:r.data)==null?void 0:o.status)==="IN_PROGRESS")this.task=!0,this.getStatus(r.data);else{this.editingImage=r.data,this.newItems.push(r.data),this.showNotif=!0,this.uploadingImages=[],this.selectedTool==="sketch_to_image"&&(this.switchToolsCat({toolKey:this.primaryToolKeys[0]}),this.selectedTool=this.primaryToolKeys[0]);const s=setTimeout(()=>{this.showNotif=!1,clearTimeout(s)},3e3)}}).catch(r=>{console.log(r),toastr.error((r==null?void 0:r.message)||r)}).finally(()=>{this.task||(this.busy=!1)})},async getStatus(e={}){this.busy=!0,fetch("/dashboard/user/advanced-image/editor/"+e.id+"/status",{method:"GET",headers:{Accept:"application/json"}}).then(t=>t.ok?t.json():t.json().then(r=>{throw new Error(r.message||"An unknown error occurred")})).then(t=>{if(t.status==="error")throw new Error(t.message);if(t.data.status==="COMPLETED"){this.task=!1,this.editingImage=t.data,this.newItems.push(t.data),this.showNotif=!0;const r=setTimeout(()=>{this.showNotif=!1,clearTimeout(r)},3e3);this.busy=!1}else setTimeout(()=>{this.getStatus(t.data)},1e3)}).catch(t=>{toastr.error((t==null?void 0:t.message)||t)})},async makeCanvasEditable(e={}){var r;this.editingImageDimensions={width:e.width||this.$refs.editorImagePreview.naturalWidth,height:e.height||this.$refs.editorImagePreview.naturalHeight},await this.$nextTick();const t=this.$refs.editorMaskCanvas;(r=this.canvasCtx)==null||r.reset(),this.canvasCtx=t.getContext("2d"),this.canvasCtx.fillStyle="black",this.canvasCtx.fillRect(0,0,t.width,t.height)},startPainting(e){this.painting=!0,this.painted=!1,this.paint(e)},stopPainting(){if(!this.painted)return;this.painting=!1,this.canvasCtx.beginPath();const e=this.$refs.editorMaskCanvas,t=document.createElement("canvas");t.width=this.editingImageDimensions.width,t.height=this.editingImageDimensions.height,t.getContext("2d").drawImage(e,0,0,t.width,t.height),t.toBlob(i=>{const o=new File([i],"mask.png",{type:"image/png"}),s=new DataTransfer;s.items.add(o),this.$refs[this.selectedTool==="sketch_to_image"?"sketchFileInput":"maskFileInput"].files=s.files,t.remove()},"image/png"),this.painted=!1},paint(e){if(!this.painting)return;const t=this.$refs.editorMaskCanvas,r=t.getBoundingClientRect(),i=(e.clientX-r.left)*(t.width/r.width),o=(e.clientY-r.top)*(t.height/r.height);this.canvasCtx.lineWidth=this.brushSize,this.canvasCtx.opacityTo=7,this.canvasCtx.lineCap="round",this.canvasCtx.strokeStyle="yellow",this.canvasCtx.lineTo(i,o),this.canvasCtx.stroke(),this.canvasCtx.beginPath(),this.canvasCtx.moveTo(i,o),this.painted=!0},setBrushSize(e){e==="-"?e=Math.max(this.brushSize-10,10):e==="+"&&(e=Math.min(this.brushSize+10,100)),this.brushSize=parseInt(e,10)},togglePromptLibraryShow(){this.promptLibraryShow=!this.promptLibraryShow},changePromptFilter(e){e!==this.promptFilter&&(this.promptFilter=e)},setSearchPromptStr(e){this.searchPromptStr=e.trim().toLowerCase()},setPrompt(e){this.prompt=e},focusOnPrompt(){this.$nextTick(()=>this.$refs.promptInput.focus())},onCreativeSuiteStageInitiated(e){e&&_.defer(()=>{this.toolbarCollapsed=!0})}});var wl=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};function P6(n){return n&&n.__esModule&&Object.prototype.hasOwnProperty.call(n,"default")?n.default:n}var Aa={exports:{}};/**
 * @license
 * Lodash <https://lodash.com/>
 * Copyright OpenJS Foundation and other contributors <https://openjsf.org/>
 * Released under MIT license <https://lodash.com/license>
 * Based on Underscore.js 1.8.3 <http://underscorejs.org/LICENSE>
 * Copyright Jeremy Ashkenas, DocumentCloud and Investigative Reporters & Editors
 */var F6=Aa.exports,qg;function R6(){return qg||(qg=1,function(n,e){(function(){var t,r="4.17.21",i=200,o="Unsupported core-js use. Try https://npms.io/search?q=ponyfill.",s="Expected a function",a="Invalid `variable` option passed into `_.template`",l="__lodash_hash_undefined__",d=500,f="__lodash_placeholder__",h=1,m=2,g=4,b=1,v=2,x=1,E=2,A=4,M=8,C=16,P=32,N=64,W=128,V=256,U=512,Q=30,oe="...",me=800,se=16,Ee=1,Me=2,he=3,we=1/0,Oe=9007199254740991,Ht=17976931348623157e292,Dt=NaN,Je=4294967295,qt=Je-1,Kr=Je>>>1,sr=[["ary",W],["bind",x],["bindKey",E],["curry",M],["curryRight",C],["flip",U],["partial",P],["partialRight",N],["rearg",V]],wt="[object Arguments]",cn="[object Array]",bi="[object AsyncFunction]",Zt="[object Boolean]",qn="[object Date]",Sr="[object DOMException]",ar="[object Error]",jr="[object Function]",yi="[object GeneratorFunction]",Vt="[object Map]",Cr="[object Number]",to="[object Null]",Qt="[object Object]",no="[object Promise]",Ho="[object Proxy]",en="[object RegExp]",ct="[object Set]",ur="[object String]",Vn="[object Symbol]",ro="[object Undefined]",Er="[object WeakMap]",qo="[object WeakSet]",_r="[object ArrayBuffer]",lr="[object DataView]",Us="[object Float32Array]",Ks="[object Float64Array]",js="[object Int8Array]",Gs="[object Int16Array]",Xs="[object Int32Array]",R="[object Uint8Array]",J="[object Uint8ClampedArray]",ae="[object Uint16Array]",Re="[object Uint32Array]",Pe=/\b__p \+= '';/g,Mt=/\b(__p \+=) '' \+/g,dn=/(__e\(.*?\)|\b__t\)) \+\n'';/g,Gr=/&(?:amp|lt|gt|quot|#39);/g,Ys=/[&<>"']/g,Xr=RegExp(Gr.source),Js=RegExp(Ys.source),Vo=/<%-([\s\S]+?)%>/g,vi=/<%([\s\S]+?)%>/g,ku=/<%=([\s\S]+?)%>/g,Zs=/\.|\[(?:[^[\]]*|(["'])(?:(?!\1)[^\\]|\\.)*?\1)\]/,Wo=/^\w*$/,S2=/[^.[\]]+|\[(?:(-?\d+(?:\.\d+)?)|(["'])((?:(?!\2)[^\\]|\\.)*?)\2)\]|(?=(?:\.|\[\])(?:\.|\[\]|$))/g,jc=/[\\^$.*+?()[\]{}|]/g,C2=RegExp(jc.source),Gc=/^\s+/,E2=/\s/,_2=/\{(?:\n\/\* \[wrapped with .+\] \*\/)?\n?/,A2=/\{\n\/\* \[wrapped with (.+)\] \*/,T2=/,? & /,D2=/[^\x00-\x2f\x3a-\x40\x5b-\x60\x7b-\x7f]+/g,M2=/[()=,{}\[\]\/\s]/,O2=/\\(\\)?/g,I2=/\$\{([^\\}]*(?:\\.[^\\}]*)*)\}/g,Kp=/\w*$/,N2=/^[-+]0x[0-9a-f]+$/i,P2=/^0b[01]+$/i,F2=/^\[object .+?Constructor\]$/,R2=/^0o[0-7]+$/i,L2=/^(?:0|[1-9]\d*)$/,B2=/[\xc0-\xd6\xd8-\xf6\xf8-\xff\u0100-\u017f]/g,Su=/($^)/,$2=/['\n\r\u2028\u2029\\]/g,Cu="\\ud800-\\udfff",z2="\\u0300-\\u036f",H2="\\ufe20-\\ufe2f",q2="\\u20d0-\\u20ff",jp=z2+H2+q2,Gp="\\u2700-\\u27bf",Xp="a-z\\xdf-\\xf6\\xf8-\\xff",V2="\\xac\\xb1\\xd7\\xf7",W2="\\x00-\\x2f\\x3a-\\x40\\x5b-\\x60\\x7b-\\xbf",U2="\\u2000-\\u206f",K2=" \\t\\x0b\\f\\xa0\\ufeff\\n\\r\\u2028\\u2029\\u1680\\u180e\\u2000\\u2001\\u2002\\u2003\\u2004\\u2005\\u2006\\u2007\\u2008\\u2009\\u200a\\u202f\\u205f\\u3000",Yp="A-Z\\xc0-\\xd6\\xd8-\\xde",Jp="\\ufe0e\\ufe0f",Zp=V2+W2+U2+K2,Xc="[']",j2="["+Cu+"]",Qp="["+Zp+"]",Eu="["+jp+"]",e0="\\d+",G2="["+Gp+"]",t0="["+Xp+"]",n0="[^"+Cu+Zp+e0+Gp+Xp+Yp+"]",Yc="\\ud83c[\\udffb-\\udfff]",X2="(?:"+Eu+"|"+Yc+")",r0="[^"+Cu+"]",Jc="(?:\\ud83c[\\udde6-\\uddff]){2}",Zc="[\\ud800-\\udbff][\\udc00-\\udfff]",Uo="["+Yp+"]",i0="\\u200d",o0="(?:"+t0+"|"+n0+")",Y2="(?:"+Uo+"|"+n0+")",s0="(?:"+Xc+"(?:d|ll|m|re|s|t|ve))?",a0="(?:"+Xc+"(?:D|LL|M|RE|S|T|VE))?",u0=X2+"?",l0="["+Jp+"]?",J2="(?:"+i0+"(?:"+[r0,Jc,Zc].join("|")+")"+l0+u0+")*",Z2="\\d*(?:1st|2nd|3rd|(?![123])\\dth)(?=\\b|[A-Z_])",Q2="\\d*(?:1ST|2ND|3RD|(?![123])\\dTH)(?=\\b|[a-z_])",c0=l0+u0+J2,ew="(?:"+[G2,Jc,Zc].join("|")+")"+c0,tw="(?:"+[r0+Eu+"?",Eu,Jc,Zc,j2].join("|")+")",nw=RegExp(Xc,"g"),rw=RegExp(Eu,"g"),Qc=RegExp(Yc+"(?="+Yc+")|"+tw+c0,"g"),iw=RegExp([Uo+"?"+t0+"+"+s0+"(?="+[Qp,Uo,"$"].join("|")+")",Y2+"+"+a0+"(?="+[Qp,Uo+o0,"$"].join("|")+")",Uo+"?"+o0+"+"+s0,Uo+"+"+a0,Q2,Z2,e0,ew].join("|"),"g"),ow=RegExp("["+i0+Cu+jp+Jp+"]"),sw=/[a-z][A-Z]|[A-Z]{2}[a-z]|[0-9][a-zA-Z]|[a-zA-Z][0-9]|[^a-zA-Z0-9 ]/,aw=["Array","Buffer","DataView","Date","Error","Float32Array","Float64Array","Function","Int8Array","Int16Array","Int32Array","Map","Math","Object","Promise","RegExp","Set","String","Symbol","TypeError","Uint8Array","Uint8ClampedArray","Uint16Array","Uint32Array","WeakMap","_","clearTimeout","isFinite","parseInt","setTimeout"],uw=-1,Xe={};Xe[Us]=Xe[Ks]=Xe[js]=Xe[Gs]=Xe[Xs]=Xe[R]=Xe[J]=Xe[ae]=Xe[Re]=!0,Xe[wt]=Xe[cn]=Xe[_r]=Xe[Zt]=Xe[lr]=Xe[qn]=Xe[ar]=Xe[jr]=Xe[Vt]=Xe[Cr]=Xe[Qt]=Xe[en]=Xe[ct]=Xe[ur]=Xe[Er]=!1;var Ue={};Ue[wt]=Ue[cn]=Ue[_r]=Ue[lr]=Ue[Zt]=Ue[qn]=Ue[Us]=Ue[Ks]=Ue[js]=Ue[Gs]=Ue[Xs]=Ue[Vt]=Ue[Cr]=Ue[Qt]=Ue[en]=Ue[ct]=Ue[ur]=Ue[Vn]=Ue[R]=Ue[J]=Ue[ae]=Ue[Re]=!0,Ue[ar]=Ue[jr]=Ue[Er]=!1;var lw={:"A",:"A",:"A",:"A",:"A",:"A",:"a",:"a",:"a",:"a",:"a",:"a",:"C",:"c",:"D",:"d",:"E",:"E",:"E",:"E",:"e",:"e",:"e",:"e",:"I",:"I",:"I",:"I",:"i",:"i",:"i",:"i",:"N",:"n",:"O",:"O",:"O",:"O",:"O",:"O",:"o",:"o",:"o",:"o",:"o",:"o",:"U",:"U",:"U",:"U",:"u",:"u",:"u",:"u",:"Y",:"y",:"y",:"Ae",:"ae",:"Th",:"th",:"ss",:"A",:"A",:"A",:"a",:"a",:"a",:"C",:"C",:"C",:"C",:"c",:"c",:"c",:"c",:"D",:"D",:"d",:"d",:"E",:"E",:"E",:"E",:"E",:"e",:"e",:"e",:"e",:"e",:"G",:"G",:"G",:"G",:"g",:"g",:"g",:"g",:"H",:"H",:"h",:"h",:"I",:"I",:"I",:"I",:"I",:"i",:"i",:"i",:"i",:"i",:"J",:"j",:"K",:"k",:"k",:"L",:"L",:"L",:"L",:"L",:"l",:"l",:"l",:"l",:"l",:"N",:"N",:"N",:"N",:"n",:"n",:"n",:"n",:"O",:"O",:"O",:"o",:"o",:"o",:"R",:"R",:"R",:"r",:"r",:"r",:"S",:"S",:"S",:"S",:"s",:"s",:"s",:"s",:"T",:"T",:"T",:"t",:"t",:"t",:"U",:"U",:"U",:"U",:"U",:"U",:"u",:"u",:"u",:"u",:"u",:"u",:"W",:"w",:"Y",:"y",:"Y",:"Z",:"Z",:"Z",:"z",:"z",:"z",:"IJ",:"ij",:"Oe",:"oe",:"'n",:"s"},cw={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#39;"},dw={"&amp;":"&","&lt;":"<","&gt;":">","&quot;":'"',"&#39;":"'"},fw={"\\":"\\","'":"'","\n":"n","\r":"r","\u2028":"u2028","\u2029":"u2029"},hw=parseFloat,pw=parseInt,d0=typeof wl=="object"&&wl&&wl.Object===Object&&wl,mw=typeof self=="object"&&self&&self.Object===Object&&self,Ot=d0||mw||Function("return this")(),ed=e&&!e.nodeType&&e,io=ed&&!0&&n&&!n.nodeType&&n,f0=io&&io.exports===ed,td=f0&&d0.process,Wn=function(){try{var O=io&&io.require&&io.require("util").types;return O||td&&td.binding&&td.binding("util")}catch{}}(),h0=Wn&&Wn.isArrayBuffer,p0=Wn&&Wn.isDate,m0=Wn&&Wn.isMap,g0=Wn&&Wn.isRegExp,b0=Wn&&Wn.isSet,y0=Wn&&Wn.isTypedArray;function En(O,L,F){switch(F.length){case 0:return O.call(L);case 1:return O.call(L,F[0]);case 2:return O.call(L,F[0],F[1]);case 3:return O.call(L,F[0],F[1],F[2])}return O.apply(L,F)}function gw(O,L,F,Y){for(var ge=-1,Be=O==null?0:O.length;++ge<Be;){var yt=O[ge];L(Y,yt,F(yt),O)}return Y}function Un(O,L){for(var F=-1,Y=O==null?0:O.length;++F<Y&&L(O[F],F,O)!==!1;);return O}function bw(O,L){for(var F=O==null?0:O.length;F--&&L(O[F],F,O)!==!1;);return O}function v0(O,L){for(var F=-1,Y=O==null?0:O.length;++F<Y;)if(!L(O[F],F,O))return!1;return!0}function xi(O,L){for(var F=-1,Y=O==null?0:O.length,ge=0,Be=[];++F<Y;){var yt=O[F];L(yt,F,O)&&(Be[ge++]=yt)}return Be}function _u(O,L){var F=O==null?0:O.length;return!!F&&Ko(O,L,0)>-1}function nd(O,L,F){for(var Y=-1,ge=O==null?0:O.length;++Y<ge;)if(F(L,O[Y]))return!0;return!1}function Ze(O,L){for(var F=-1,Y=O==null?0:O.length,ge=Array(Y);++F<Y;)ge[F]=L(O[F],F,O);return ge}function wi(O,L){for(var F=-1,Y=L.length,ge=O.length;++F<Y;)O[ge+F]=L[F];return O}function rd(O,L,F,Y){var ge=-1,Be=O==null?0:O.length;for(Y&&Be&&(F=O[++ge]);++ge<Be;)F=L(F,O[ge],ge,O);return F}function yw(O,L,F,Y){var ge=O==null?0:O.length;for(Y&&ge&&(F=O[--ge]);ge--;)F=L(F,O[ge],ge,O);return F}function id(O,L){for(var F=-1,Y=O==null?0:O.length;++F<Y;)if(L(O[F],F,O))return!0;return!1}var vw=od("length");function xw(O){return O.split("")}function ww(O){return O.match(D2)||[]}function x0(O,L,F){var Y;return F(O,function(ge,Be,yt){if(L(ge,Be,yt))return Y=Be,!1}),Y}function Au(O,L,F,Y){for(var ge=O.length,Be=F+(Y?1:-1);Y?Be--:++Be<ge;)if(L(O[Be],Be,O))return Be;return-1}function Ko(O,L,F){return L===L?Nw(O,L,F):Au(O,w0,F)}function kw(O,L,F,Y){for(var ge=F-1,Be=O.length;++ge<Be;)if(Y(O[ge],L))return ge;return-1}function w0(O){return O!==O}function k0(O,L){var F=O==null?0:O.length;return F?ad(O,L)/F:Dt}function od(O){return function(L){return L==null?t:L[O]}}function sd(O){return function(L){return O==null?t:O[L]}}function S0(O,L,F,Y,ge){return ge(O,function(Be,yt,We){F=Y?(Y=!1,Be):L(F,Be,yt,We)}),F}function Sw(O,L){var F=O.length;for(O.sort(L);F--;)O[F]=O[F].value;return O}function ad(O,L){for(var F,Y=-1,ge=O.length;++Y<ge;){var Be=L(O[Y]);Be!==t&&(F=F===t?Be:F+Be)}return F}function ud(O,L){for(var F=-1,Y=Array(O);++F<O;)Y[F]=L(F);return Y}function Cw(O,L){return Ze(L,function(F){return[F,O[F]]})}function C0(O){return O&&O.slice(0,T0(O)+1).replace(Gc,"")}function _n(O){return function(L){return O(L)}}function ld(O,L){return Ze(L,function(F){return O[F]})}function Qs(O,L){return O.has(L)}function E0(O,L){for(var F=-1,Y=O.length;++F<Y&&Ko(L,O[F],0)>-1;);return F}function _0(O,L){for(var F=O.length;F--&&Ko(L,O[F],0)>-1;);return F}function Ew(O,L){for(var F=O.length,Y=0;F--;)O[F]===L&&++Y;return Y}var _w=sd(lw),Aw=sd(cw);function Tw(O){return"\\"+fw[O]}function Dw(O,L){return O==null?t:O[L]}function jo(O){return ow.test(O)}function Mw(O){return sw.test(O)}function Ow(O){for(var L,F=[];!(L=O.next()).done;)F.push(L.value);return F}function cd(O){var L=-1,F=Array(O.size);return O.forEach(function(Y,ge){F[++L]=[ge,Y]}),F}function A0(O,L){return function(F){return O(L(F))}}function ki(O,L){for(var F=-1,Y=O.length,ge=0,Be=[];++F<Y;){var yt=O[F];(yt===L||yt===f)&&(O[F]=f,Be[ge++]=F)}return Be}function Tu(O){var L=-1,F=Array(O.size);return O.forEach(function(Y){F[++L]=Y}),F}function Iw(O){var L=-1,F=Array(O.size);return O.forEach(function(Y){F[++L]=[Y,Y]}),F}function Nw(O,L,F){for(var Y=F-1,ge=O.length;++Y<ge;)if(O[Y]===L)return Y;return-1}function Pw(O,L,F){for(var Y=F+1;Y--;)if(O[Y]===L)return Y;return Y}function Go(O){return jo(O)?Rw(O):vw(O)}function cr(O){return jo(O)?Lw(O):xw(O)}function T0(O){for(var L=O.length;L--&&E2.test(O.charAt(L)););return L}var Fw=sd(dw);function Rw(O){for(var L=Qc.lastIndex=0;Qc.test(O);)++L;return L}function Lw(O){return O.match(Qc)||[]}function Bw(O){return O.match(iw)||[]}var $w=function O(L){L=L==null?Ot:Xo.defaults(Ot.Object(),L,Xo.pick(Ot,aw));var F=L.Array,Y=L.Date,ge=L.Error,Be=L.Function,yt=L.Math,We=L.Object,dd=L.RegExp,zw=L.String,Kn=L.TypeError,Du=F.prototype,Hw=Be.prototype,Yo=We.prototype,Mu=L["__core-js_shared__"],Ou=Hw.toString,Ve=Yo.hasOwnProperty,qw=0,D0=function(){var u=/[^.]+$/.exec(Mu&&Mu.keys&&Mu.keys.IE_PROTO||"");return u?"Symbol(src)_1."+u:""}(),Iu=Yo.toString,Vw=Ou.call(We),Ww=Ot._,Uw=dd("^"+Ou.call(Ve).replace(jc,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$"),Nu=f0?L.Buffer:t,Si=L.Symbol,Pu=L.Uint8Array,M0=Nu?Nu.allocUnsafe:t,Fu=A0(We.getPrototypeOf,We),O0=We.create,I0=Yo.propertyIsEnumerable,Ru=Du.splice,N0=Si?Si.isConcatSpreadable:t,ea=Si?Si.iterator:t,oo=Si?Si.toStringTag:t,Lu=function(){try{var u=co(We,"defineProperty");return u({},"",{}),u}catch{}}(),Kw=L.clearTimeout!==Ot.clearTimeout&&L.clearTimeout,jw=Y&&Y.now!==Ot.Date.now&&Y.now,Gw=L.setTimeout!==Ot.setTimeout&&L.setTimeout,Bu=yt.ceil,$u=yt.floor,fd=We.getOwnPropertySymbols,Xw=Nu?Nu.isBuffer:t,P0=L.isFinite,Yw=Du.join,Jw=A0(We.keys,We),vt=yt.max,Wt=yt.min,Zw=Y.now,Qw=L.parseInt,F0=yt.random,ek=Du.reverse,hd=co(L,"DataView"),ta=co(L,"Map"),pd=co(L,"Promise"),Jo=co(L,"Set"),na=co(L,"WeakMap"),ra=co(We,"create"),zu=na&&new na,Zo={},tk=fo(hd),nk=fo(ta),rk=fo(pd),ik=fo(Jo),ok=fo(na),Hu=Si?Si.prototype:t,ia=Hu?Hu.valueOf:t,R0=Hu?Hu.toString:t;function k(u){if(it(u)&&!xe(u)&&!(u instanceof Ne)){if(u instanceof jn)return u;if(Ve.call(u,"__wrapped__"))return Lm(u)}return new jn(u)}var Qo=function(){function u(){}return function(c){if(!tt(c))return{};if(O0)return O0(c);u.prototype=c;var p=new u;return u.prototype=t,p}}();function qu(){}function jn(u,c){this.__wrapped__=u,this.__actions__=[],this.__chain__=!!c,this.__index__=0,this.__values__=t}k.templateSettings={escape:Vo,evaluate:vi,interpolate:ku,variable:"",imports:{_:k}},k.prototype=qu.prototype,k.prototype.constructor=k,jn.prototype=Qo(qu.prototype),jn.prototype.constructor=jn;function Ne(u){this.__wrapped__=u,this.__actions__=[],this.__dir__=1,this.__filtered__=!1,this.__iteratees__=[],this.__takeCount__=Je,this.__views__=[]}function sk(){var u=new Ne(this.__wrapped__);return u.__actions__=fn(this.__actions__),u.__dir__=this.__dir__,u.__filtered__=this.__filtered__,u.__iteratees__=fn(this.__iteratees__),u.__takeCount__=this.__takeCount__,u.__views__=fn(this.__views__),u}function ak(){if(this.__filtered__){var u=new Ne(this);u.__dir__=-1,u.__filtered__=!0}else u=this.clone(),u.__dir__*=-1;return u}function uk(){var u=this.__wrapped__.value(),c=this.__dir__,p=xe(u),y=c<0,w=p?u.length:0,S=xS(0,w,this.__views__),T=S.start,D=S.end,I=D-T,B=y?D:T-1,z=this.__iteratees__,H=z.length,G=0,ne=Wt(I,this.__takeCount__);if(!p||!y&&w==I&&ne==I)return sm(u,this.__actions__);var ue=[];e:for(;I--&&G<ne;){B+=c;for(var _e=-1,le=u[B];++_e<H;){var Ie=z[_e],Fe=Ie.iteratee,Dn=Ie.type,rn=Fe(le);if(Dn==Me)le=rn;else if(!rn){if(Dn==Ee)continue e;break e}}ue[G++]=le}return ue}Ne.prototype=Qo(qu.prototype),Ne.prototype.constructor=Ne;function so(u){var c=-1,p=u==null?0:u.length;for(this.clear();++c<p;){var y=u[c];this.set(y[0],y[1])}}function lk(){this.__data__=ra?ra(null):{},this.size=0}function ck(u){var c=this.has(u)&&delete this.__data__[u];return this.size-=c?1:0,c}function dk(u){var c=this.__data__;if(ra){var p=c[u];return p===l?t:p}return Ve.call(c,u)?c[u]:t}function fk(u){var c=this.__data__;return ra?c[u]!==t:Ve.call(c,u)}function hk(u,c){var p=this.__data__;return this.size+=this.has(u)?0:1,p[u]=ra&&c===t?l:c,this}so.prototype.clear=lk,so.prototype.delete=ck,so.prototype.get=dk,so.prototype.has=fk,so.prototype.set=hk;function Yr(u){var c=-1,p=u==null?0:u.length;for(this.clear();++c<p;){var y=u[c];this.set(y[0],y[1])}}function pk(){this.__data__=[],this.size=0}function mk(u){var c=this.__data__,p=Vu(c,u);if(p<0)return!1;var y=c.length-1;return p==y?c.pop():Ru.call(c,p,1),--this.size,!0}function gk(u){var c=this.__data__,p=Vu(c,u);return p<0?t:c[p][1]}function bk(u){return Vu(this.__data__,u)>-1}function yk(u,c){var p=this.__data__,y=Vu(p,u);return y<0?(++this.size,p.push([u,c])):p[y][1]=c,this}Yr.prototype.clear=pk,Yr.prototype.delete=mk,Yr.prototype.get=gk,Yr.prototype.has=bk,Yr.prototype.set=yk;function Jr(u){var c=-1,p=u==null?0:u.length;for(this.clear();++c<p;){var y=u[c];this.set(y[0],y[1])}}function vk(){this.size=0,this.__data__={hash:new so,map:new(ta||Yr),string:new so}}function xk(u){var c=tl(this,u).delete(u);return this.size-=c?1:0,c}function wk(u){return tl(this,u).get(u)}function kk(u){return tl(this,u).has(u)}function Sk(u,c){var p=tl(this,u),y=p.size;return p.set(u,c),this.size+=p.size==y?0:1,this}Jr.prototype.clear=vk,Jr.prototype.delete=xk,Jr.prototype.get=wk,Jr.prototype.has=kk,Jr.prototype.set=Sk;function ao(u){var c=-1,p=u==null?0:u.length;for(this.__data__=new Jr;++c<p;)this.add(u[c])}function Ck(u){return this.__data__.set(u,l),this}function Ek(u){return this.__data__.has(u)}ao.prototype.add=ao.prototype.push=Ck,ao.prototype.has=Ek;function dr(u){var c=this.__data__=new Yr(u);this.size=c.size}function _k(){this.__data__=new Yr,this.size=0}function Ak(u){var c=this.__data__,p=c.delete(u);return this.size=c.size,p}function Tk(u){return this.__data__.get(u)}function Dk(u){return this.__data__.has(u)}function Mk(u,c){var p=this.__data__;if(p instanceof Yr){var y=p.__data__;if(!ta||y.length<i-1)return y.push([u,c]),this.size=++p.size,this;p=this.__data__=new Jr(y)}return p.set(u,c),this.size=p.size,this}dr.prototype.clear=_k,dr.prototype.delete=Ak,dr.prototype.get=Tk,dr.prototype.has=Dk,dr.prototype.set=Mk;function L0(u,c){var p=xe(u),y=!p&&ho(u),w=!p&&!y&&Ti(u),S=!p&&!y&&!w&&rs(u),T=p||y||w||S,D=T?ud(u.length,zw):[],I=D.length;for(var B in u)(c||Ve.call(u,B))&&!(T&&(B=="length"||w&&(B=="offset"||B=="parent")||S&&(B=="buffer"||B=="byteLength"||B=="byteOffset")||ti(B,I)))&&D.push(B);return D}function B0(u){var c=u.length;return c?u[Ed(0,c-1)]:t}function Ok(u,c){return nl(fn(u),uo(c,0,u.length))}function Ik(u){return nl(fn(u))}function md(u,c,p){(p!==t&&!fr(u[c],p)||p===t&&!(c in u))&&Zr(u,c,p)}function oa(u,c,p){var y=u[c];(!(Ve.call(u,c)&&fr(y,p))||p===t&&!(c in u))&&Zr(u,c,p)}function Vu(u,c){for(var p=u.length;p--;)if(fr(u[p][0],c))return p;return-1}function Nk(u,c,p,y){return Ci(u,function(w,S,T){c(y,w,p(w),T)}),y}function $0(u,c){return u&&Tr(c,kt(c),u)}function Pk(u,c){return u&&Tr(c,pn(c),u)}function Zr(u,c,p){c=="__proto__"&&Lu?Lu(u,c,{configurable:!0,enumerable:!0,value:p,writable:!0}):u[c]=p}function gd(u,c){for(var p=-1,y=c.length,w=F(y),S=u==null;++p<y;)w[p]=S?t:Yd(u,c[p]);return w}function uo(u,c,p){return u===u&&(p!==t&&(u=u<=p?u:p),c!==t&&(u=u>=c?u:c)),u}function Gn(u,c,p,y,w,S){var T,D=c&h,I=c&m,B=c&g;if(p&&(T=w?p(u,y,w,S):p(u)),T!==t)return T;if(!tt(u))return u;var z=xe(u);if(z){if(T=kS(u),!D)return fn(u,T)}else{var H=Ut(u),G=H==jr||H==yi;if(Ti(u))return lm(u,D);if(H==Qt||H==wt||G&&!w){if(T=I||G?{}:Tm(u),!D)return I?dS(u,Pk(T,u)):cS(u,$0(T,u))}else{if(!Ue[H])return w?u:{};T=SS(u,H,D)}}S||(S=new dr);var ne=S.get(u);if(ne)return ne;S.set(u,T),rg(u)?u.forEach(function(le){T.add(Gn(le,c,p,le,u,S))}):tg(u)&&u.forEach(function(le,Ie){T.set(Ie,Gn(le,c,p,Ie,u,S))});var ue=B?I?Rd:Fd:I?pn:kt,_e=z?t:ue(u);return Un(_e||u,function(le,Ie){_e&&(Ie=le,le=u[Ie]),oa(T,Ie,Gn(le,c,p,Ie,u,S))}),T}function Fk(u){var c=kt(u);return function(p){return z0(p,u,c)}}function z0(u,c,p){var y=p.length;if(u==null)return!y;for(u=We(u);y--;){var w=p[y],S=c[w],T=u[w];if(T===t&&!(w in u)||!S(T))return!1}return!0}function H0(u,c,p){if(typeof u!="function")throw new Kn(s);return fa(function(){u.apply(t,p)},c)}function sa(u,c,p,y){var w=-1,S=_u,T=!0,D=u.length,I=[],B=c.length;if(!D)return I;p&&(c=Ze(c,_n(p))),y?(S=nd,T=!1):c.length>=i&&(S=Qs,T=!1,c=new ao(c));e:for(;++w<D;){var z=u[w],H=p==null?z:p(z);if(z=y||z!==0?z:0,T&&H===H){for(var G=B;G--;)if(c[G]===H)continue e;I.push(z)}else S(c,H,y)||I.push(z)}return I}var Ci=pm(Ar),q0=pm(yd,!0);function Rk(u,c){var p=!0;return Ci(u,function(y,w,S){return p=!!c(y,w,S),p}),p}function Wu(u,c,p){for(var y=-1,w=u.length;++y<w;){var S=u[y],T=c(S);if(T!=null&&(D===t?T===T&&!Tn(T):p(T,D)))var D=T,I=S}return I}function Lk(u,c,p,y){var w=u.length;for(p=ke(p),p<0&&(p=-p>w?0:w+p),y=y===t||y>w?w:ke(y),y<0&&(y+=w),y=p>y?0:og(y);p<y;)u[p++]=c;return u}function V0(u,c){var p=[];return Ci(u,function(y,w,S){c(y,w,S)&&p.push(y)}),p}function It(u,c,p,y,w){var S=-1,T=u.length;for(p||(p=ES),w||(w=[]);++S<T;){var D=u[S];c>0&&p(D)?c>1?It(D,c-1,p,y,w):wi(w,D):y||(w[w.length]=D)}return w}var bd=mm(),W0=mm(!0);function Ar(u,c){return u&&bd(u,c,kt)}function yd(u,c){return u&&W0(u,c,kt)}function Uu(u,c){return xi(c,function(p){return ni(u[p])})}function lo(u,c){c=_i(c,u);for(var p=0,y=c.length;u!=null&&p<y;)u=u[Dr(c[p++])];return p&&p==y?u:t}function U0(u,c,p){var y=c(u);return xe(u)?y:wi(y,p(u))}function tn(u){return u==null?u===t?ro:to:oo&&oo in We(u)?vS(u):IS(u)}function vd(u,c){return u>c}function Bk(u,c){return u!=null&&Ve.call(u,c)}function $k(u,c){return u!=null&&c in We(u)}function zk(u,c,p){return u>=Wt(c,p)&&u<vt(c,p)}function xd(u,c,p){for(var y=p?nd:_u,w=u[0].length,S=u.length,T=S,D=F(S),I=1/0,B=[];T--;){var z=u[T];T&&c&&(z=Ze(z,_n(c))),I=Wt(z.length,I),D[T]=!p&&(c||w>=120&&z.length>=120)?new ao(T&&z):t}z=u[0];var H=-1,G=D[0];e:for(;++H<w&&B.length<I;){var ne=z[H],ue=c?c(ne):ne;if(ne=p||ne!==0?ne:0,!(G?Qs(G,ue):y(B,ue,p))){for(T=S;--T;){var _e=D[T];if(!(_e?Qs(_e,ue):y(u[T],ue,p)))continue e}G&&G.push(ue),B.push(ne)}}return B}function Hk(u,c,p,y){return Ar(u,function(w,S,T){c(y,p(w),S,T)}),y}function aa(u,c,p){c=_i(c,u),u=Im(u,c);var y=u==null?u:u[Dr(Yn(c))];return y==null?t:En(y,u,p)}function K0(u){return it(u)&&tn(u)==wt}function qk(u){return it(u)&&tn(u)==_r}function Vk(u){return it(u)&&tn(u)==qn}function ua(u,c,p,y,w){return u===c?!0:u==null||c==null||!it(u)&&!it(c)?u!==u&&c!==c:Wk(u,c,p,y,ua,w)}function Wk(u,c,p,y,w,S){var T=xe(u),D=xe(c),I=T?cn:Ut(u),B=D?cn:Ut(c);I=I==wt?Qt:I,B=B==wt?Qt:B;var z=I==Qt,H=B==Qt,G=I==B;if(G&&Ti(u)){if(!Ti(c))return!1;T=!0,z=!1}if(G&&!z)return S||(S=new dr),T||rs(u)?Em(u,c,p,y,w,S):bS(u,c,I,p,y,w,S);if(!(p&b)){var ne=z&&Ve.call(u,"__wrapped__"),ue=H&&Ve.call(c,"__wrapped__");if(ne||ue){var _e=ne?u.value():u,le=ue?c.value():c;return S||(S=new dr),w(_e,le,p,y,S)}}return G?(S||(S=new dr),yS(u,c,p,y,w,S)):!1}function Uk(u){return it(u)&&Ut(u)==Vt}function wd(u,c,p,y){var w=p.length,S=w,T=!y;if(u==null)return!S;for(u=We(u);w--;){var D=p[w];if(T&&D[2]?D[1]!==u[D[0]]:!(D[0]in u))return!1}for(;++w<S;){D=p[w];var I=D[0],B=u[I],z=D[1];if(T&&D[2]){if(B===t&&!(I in u))return!1}else{var H=new dr;if(y)var G=y(B,z,I,u,c,H);if(!(G===t?ua(z,B,b|v,y,H):G))return!1}}return!0}function j0(u){if(!tt(u)||AS(u))return!1;var c=ni(u)?Uw:F2;return c.test(fo(u))}function Kk(u){return it(u)&&tn(u)==en}function jk(u){return it(u)&&Ut(u)==ct}function Gk(u){return it(u)&&ul(u.length)&&!!Xe[tn(u)]}function G0(u){return typeof u=="function"?u:u==null?mn:typeof u=="object"?xe(u)?J0(u[0],u[1]):Y0(u):gg(u)}function kd(u){if(!da(u))return Jw(u);var c=[];for(var p in We(u))Ve.call(u,p)&&p!="constructor"&&c.push(p);return c}function Xk(u){if(!tt(u))return OS(u);var c=da(u),p=[];for(var y in u)y=="constructor"&&(c||!Ve.call(u,y))||p.push(y);return p}function Sd(u,c){return u<c}function X0(u,c){var p=-1,y=hn(u)?F(u.length):[];return Ci(u,function(w,S,T){y[++p]=c(w,S,T)}),y}function Y0(u){var c=Bd(u);return c.length==1&&c[0][2]?Mm(c[0][0],c[0][1]):function(p){return p===u||wd(p,u,c)}}function J0(u,c){return zd(u)&&Dm(c)?Mm(Dr(u),c):function(p){var y=Yd(p,u);return y===t&&y===c?Jd(p,u):ua(c,y,b|v)}}function Ku(u,c,p,y,w){u!==c&&bd(c,function(S,T){if(w||(w=new dr),tt(S))Yk(u,c,T,p,Ku,y,w);else{var D=y?y(qd(u,T),S,T+"",u,c,w):t;D===t&&(D=S),md(u,T,D)}},pn)}function Yk(u,c,p,y,w,S,T){var D=qd(u,p),I=qd(c,p),B=T.get(I);if(B){md(u,p,B);return}var z=S?S(D,I,p+"",u,c,T):t,H=z===t;if(H){var G=xe(I),ne=!G&&Ti(I),ue=!G&&!ne&&rs(I);z=I,G||ne||ue?xe(D)?z=D:ut(D)?z=fn(D):ne?(H=!1,z=lm(I,!0)):ue?(H=!1,z=cm(I,!0)):z=[]:ha(I)||ho(I)?(z=D,ho(D)?z=sg(D):(!tt(D)||ni(D))&&(z=Tm(I))):H=!1}H&&(T.set(I,z),w(z,I,y,S,T),T.delete(I)),md(u,p,z)}function Z0(u,c){var p=u.length;if(p)return c+=c<0?p:0,ti(c,p)?u[c]:t}function Q0(u,c,p){c.length?c=Ze(c,function(S){return xe(S)?function(T){return lo(T,S.length===1?S[0]:S)}:S}):c=[mn];var y=-1;c=Ze(c,_n(ie()));var w=X0(u,function(S,T,D){var I=Ze(c,function(B){return B(S)});return{criteria:I,index:++y,value:S}});return Sw(w,function(S,T){return lS(S,T,p)})}function Jk(u,c){return em(u,c,function(p,y){return Jd(u,y)})}function em(u,c,p){for(var y=-1,w=c.length,S={};++y<w;){var T=c[y],D=lo(u,T);p(D,T)&&la(S,_i(T,u),D)}return S}function Zk(u){return function(c){return lo(c,u)}}function Cd(u,c,p,y){var w=y?kw:Ko,S=-1,T=c.length,D=u;for(u===c&&(c=fn(c)),p&&(D=Ze(u,_n(p)));++S<T;)for(var I=0,B=c[S],z=p?p(B):B;(I=w(D,z,I,y))>-1;)D!==u&&Ru.call(D,I,1),Ru.call(u,I,1);return u}function tm(u,c){for(var p=u?c.length:0,y=p-1;p--;){var w=c[p];if(p==y||w!==S){var S=w;ti(w)?Ru.call(u,w,1):Td(u,w)}}return u}function Ed(u,c){return u+$u(F0()*(c-u+1))}function Qk(u,c,p,y){for(var w=-1,S=vt(Bu((c-u)/(p||1)),0),T=F(S);S--;)T[y?S:++w]=u,u+=p;return T}function _d(u,c){var p="";if(!u||c<1||c>Oe)return p;do c%2&&(p+=u),c=$u(c/2),c&&(u+=u);while(c);return p}function Te(u,c){return Vd(Om(u,c,mn),u+"")}function eS(u){return B0(is(u))}function tS(u,c){var p=is(u);return nl(p,uo(c,0,p.length))}function la(u,c,p,y){if(!tt(u))return u;c=_i(c,u);for(var w=-1,S=c.length,T=S-1,D=u;D!=null&&++w<S;){var I=Dr(c[w]),B=p;if(I==="__proto__"||I==="constructor"||I==="prototype")return u;if(w!=T){var z=D[I];B=y?y(z,I,D):t,B===t&&(B=tt(z)?z:ti(c[w+1])?[]:{})}oa(D,I,B),D=D[I]}return u}var nm=zu?function(u,c){return zu.set(u,c),u}:mn,nS=Lu?function(u,c){return Lu(u,"toString",{configurable:!0,enumerable:!1,value:Qd(c),writable:!0})}:mn;function rS(u){return nl(is(u))}function Xn(u,c,p){var y=-1,w=u.length;c<0&&(c=-c>w?0:w+c),p=p>w?w:p,p<0&&(p+=w),w=c>p?0:p-c>>>0,c>>>=0;for(var S=F(w);++y<w;)S[y]=u[y+c];return S}function iS(u,c){var p;return Ci(u,function(y,w,S){return p=c(y,w,S),!p}),!!p}function ju(u,c,p){var y=0,w=u==null?y:u.length;if(typeof c=="number"&&c===c&&w<=Kr){for(;y<w;){var S=y+w>>>1,T=u[S];T!==null&&!Tn(T)&&(p?T<=c:T<c)?y=S+1:w=S}return w}return Ad(u,c,mn,p)}function Ad(u,c,p,y){var w=0,S=u==null?0:u.length;if(S===0)return 0;c=p(c);for(var T=c!==c,D=c===null,I=Tn(c),B=c===t;w<S;){var z=$u((w+S)/2),H=p(u[z]),G=H!==t,ne=H===null,ue=H===H,_e=Tn(H);if(T)var le=y||ue;else B?le=ue&&(y||G):D?le=ue&&G&&(y||!ne):I?le=ue&&G&&!ne&&(y||!_e):ne||_e?le=!1:le=y?H<=c:H<c;le?w=z+1:S=z}return Wt(S,qt)}function rm(u,c){for(var p=-1,y=u.length,w=0,S=[];++p<y;){var T=u[p],D=c?c(T):T;if(!p||!fr(D,I)){var I=D;S[w++]=T===0?0:T}}return S}function im(u){return typeof u=="number"?u:Tn(u)?Dt:+u}function An(u){if(typeof u=="string")return u;if(xe(u))return Ze(u,An)+"";if(Tn(u))return R0?R0.call(u):"";var c=u+"";return c=="0"&&1/u==-1/0?"-0":c}function Ei(u,c,p){var y=-1,w=_u,S=u.length,T=!0,D=[],I=D;if(p)T=!1,w=nd;else if(S>=i){var B=c?null:mS(u);if(B)return Tu(B);T=!1,w=Qs,I=new ao}else I=c?[]:D;e:for(;++y<S;){var z=u[y],H=c?c(z):z;if(z=p||z!==0?z:0,T&&H===H){for(var G=I.length;G--;)if(I[G]===H)continue e;c&&I.push(H),D.push(z)}else w(I,H,p)||(I!==D&&I.push(H),D.push(z))}return D}function Td(u,c){return c=_i(c,u),u=Im(u,c),u==null||delete u[Dr(Yn(c))]}function om(u,c,p,y){return la(u,c,p(lo(u,c)),y)}function Gu(u,c,p,y){for(var w=u.length,S=y?w:-1;(y?S--:++S<w)&&c(u[S],S,u););return p?Xn(u,y?0:S,y?S+1:w):Xn(u,y?S+1:0,y?w:S)}function sm(u,c){var p=u;return p instanceof Ne&&(p=p.value()),rd(c,function(y,w){return w.func.apply(w.thisArg,wi([y],w.args))},p)}function Dd(u,c,p){var y=u.length;if(y<2)return y?Ei(u[0]):[];for(var w=-1,S=F(y);++w<y;)for(var T=u[w],D=-1;++D<y;)D!=w&&(S[w]=sa(S[w]||T,u[D],c,p));return Ei(It(S,1),c,p)}function am(u,c,p){for(var y=-1,w=u.length,S=c.length,T={};++y<w;){var D=y<S?c[y]:t;p(T,u[y],D)}return T}function Md(u){return ut(u)?u:[]}function Od(u){return typeof u=="function"?u:mn}function _i(u,c){return xe(u)?u:zd(u,c)?[u]:Rm(He(u))}var oS=Te;function Ai(u,c,p){var y=u.length;return p=p===t?y:p,!c&&p>=y?u:Xn(u,c,p)}var um=Kw||function(u){return Ot.clearTimeout(u)};function lm(u,c){if(c)return u.slice();var p=u.length,y=M0?M0(p):new u.constructor(p);return u.copy(y),y}function Id(u){var c=new u.constructor(u.byteLength);return new Pu(c).set(new Pu(u)),c}function sS(u,c){var p=c?Id(u.buffer):u.buffer;return new u.constructor(p,u.byteOffset,u.byteLength)}function aS(u){var c=new u.constructor(u.source,Kp.exec(u));return c.lastIndex=u.lastIndex,c}function uS(u){return ia?We(ia.call(u)):{}}function cm(u,c){var p=c?Id(u.buffer):u.buffer;return new u.constructor(p,u.byteOffset,u.length)}function dm(u,c){if(u!==c){var p=u!==t,y=u===null,w=u===u,S=Tn(u),T=c!==t,D=c===null,I=c===c,B=Tn(c);if(!D&&!B&&!S&&u>c||S&&T&&I&&!D&&!B||y&&T&&I||!p&&I||!w)return 1;if(!y&&!S&&!B&&u<c||B&&p&&w&&!y&&!S||D&&p&&w||!T&&w||!I)return-1}return 0}function lS(u,c,p){for(var y=-1,w=u.criteria,S=c.criteria,T=w.length,D=p.length;++y<T;){var I=dm(w[y],S[y]);if(I){if(y>=D)return I;var B=p[y];return I*(B=="desc"?-1:1)}}return u.index-c.index}function fm(u,c,p,y){for(var w=-1,S=u.length,T=p.length,D=-1,I=c.length,B=vt(S-T,0),z=F(I+B),H=!y;++D<I;)z[D]=c[D];for(;++w<T;)(H||w<S)&&(z[p[w]]=u[w]);for(;B--;)z[D++]=u[w++];return z}function hm(u,c,p,y){for(var w=-1,S=u.length,T=-1,D=p.length,I=-1,B=c.length,z=vt(S-D,0),H=F(z+B),G=!y;++w<z;)H[w]=u[w];for(var ne=w;++I<B;)H[ne+I]=c[I];for(;++T<D;)(G||w<S)&&(H[ne+p[T]]=u[w++]);return H}function fn(u,c){var p=-1,y=u.length;for(c||(c=F(y));++p<y;)c[p]=u[p];return c}function Tr(u,c,p,y){var w=!p;p||(p={});for(var S=-1,T=c.length;++S<T;){var D=c[S],I=y?y(p[D],u[D],D,p,u):t;I===t&&(I=u[D]),w?Zr(p,D,I):oa(p,D,I)}return p}function cS(u,c){return Tr(u,$d(u),c)}function dS(u,c){return Tr(u,_m(u),c)}function Xu(u,c){return function(p,y){var w=xe(p)?gw:Nk,S=c?c():{};return w(p,u,ie(y,2),S)}}function es(u){return Te(function(c,p){var y=-1,w=p.length,S=w>1?p[w-1]:t,T=w>2?p[2]:t;for(S=u.length>3&&typeof S=="function"?(w--,S):t,T&&nn(p[0],p[1],T)&&(S=w<3?t:S,w=1),c=We(c);++y<w;){var D=p[y];D&&u(c,D,y,S)}return c})}function pm(u,c){return function(p,y){if(p==null)return p;if(!hn(p))return u(p,y);for(var w=p.length,S=c?w:-1,T=We(p);(c?S--:++S<w)&&y(T[S],S,T)!==!1;);return p}}function mm(u){return function(c,p,y){for(var w=-1,S=We(c),T=y(c),D=T.length;D--;){var I=T[u?D:++w];if(p(S[I],I,S)===!1)break}return c}}function fS(u,c,p){var y=c&x,w=ca(u);function S(){var T=this&&this!==Ot&&this instanceof S?w:u;return T.apply(y?p:this,arguments)}return S}function gm(u){return function(c){c=He(c);var p=jo(c)?cr(c):t,y=p?p[0]:c.charAt(0),w=p?Ai(p,1).join(""):c.slice(1);return y[u]()+w}}function ts(u){return function(c){return rd(pg(hg(c).replace(nw,"")),u,"")}}function ca(u){return function(){var c=arguments;switch(c.length){case 0:return new u;case 1:return new u(c[0]);case 2:return new u(c[0],c[1]);case 3:return new u(c[0],c[1],c[2]);case 4:return new u(c[0],c[1],c[2],c[3]);case 5:return new u(c[0],c[1],c[2],c[3],c[4]);case 6:return new u(c[0],c[1],c[2],c[3],c[4],c[5]);case 7:return new u(c[0],c[1],c[2],c[3],c[4],c[5],c[6])}var p=Qo(u.prototype),y=u.apply(p,c);return tt(y)?y:p}}function hS(u,c,p){var y=ca(u);function w(){for(var S=arguments.length,T=F(S),D=S,I=ns(w);D--;)T[D]=arguments[D];var B=S<3&&T[0]!==I&&T[S-1]!==I?[]:ki(T,I);if(S-=B.length,S<p)return wm(u,c,Yu,w.placeholder,t,T,B,t,t,p-S);var z=this&&this!==Ot&&this instanceof w?y:u;return En(z,this,T)}return w}function bm(u){return function(c,p,y){var w=We(c);if(!hn(c)){var S=ie(p,3);c=kt(c),p=function(D){return S(w[D],D,w)}}var T=u(c,p,y);return T>-1?w[S?c[T]:T]:t}}function ym(u){return ei(function(c){var p=c.length,y=p,w=jn.prototype.thru;for(u&&c.reverse();y--;){var S=c[y];if(typeof S!="function")throw new Kn(s);if(w&&!T&&el(S)=="wrapper")var T=new jn([],!0)}for(y=T?y:p;++y<p;){S=c[y];var D=el(S),I=D=="wrapper"?Ld(S):t;I&&Hd(I[0])&&I[1]==(W|M|P|V)&&!I[4].length&&I[9]==1?T=T[el(I[0])].apply(T,I[3]):T=S.length==1&&Hd(S)?T[D]():T.thru(S)}return function(){var B=arguments,z=B[0];if(T&&B.length==1&&xe(z))return T.plant(z).value();for(var H=0,G=p?c[H].apply(this,B):z;++H<p;)G=c[H].call(this,G);return G}})}function Yu(u,c,p,y,w,S,T,D,I,B){var z=c&W,H=c&x,G=c&E,ne=c&(M|C),ue=c&U,_e=G?t:ca(u);function le(){for(var Ie=arguments.length,Fe=F(Ie),Dn=Ie;Dn--;)Fe[Dn]=arguments[Dn];if(ne)var rn=ns(le),Mn=Ew(Fe,rn);if(y&&(Fe=fm(Fe,y,w,ne)),S&&(Fe=hm(Fe,S,T,ne)),Ie-=Mn,ne&&Ie<B){var lt=ki(Fe,rn);return wm(u,c,Yu,le.placeholder,p,Fe,lt,D,I,B-Ie)}var hr=H?p:this,ii=G?hr[u]:u;return Ie=Fe.length,D?Fe=NS(Fe,D):ue&&Ie>1&&Fe.reverse(),z&&I<Ie&&(Fe.length=I),this&&this!==Ot&&this instanceof le&&(ii=_e||ca(ii)),ii.apply(hr,Fe)}return le}function vm(u,c){return function(p,y){return Hk(p,u,c(y),{})}}function Ju(u,c){return function(p,y){var w;if(p===t&&y===t)return c;if(p!==t&&(w=p),y!==t){if(w===t)return y;typeof p=="string"||typeof y=="string"?(p=An(p),y=An(y)):(p=im(p),y=im(y)),w=u(p,y)}return w}}function Nd(u){return ei(function(c){return c=Ze(c,_n(ie())),Te(function(p){var y=this;return u(c,function(w){return En(w,y,p)})})})}function Zu(u,c){c=c===t?" ":An(c);var p=c.length;if(p<2)return p?_d(c,u):c;var y=_d(c,Bu(u/Go(c)));return jo(c)?Ai(cr(y),0,u).join(""):y.slice(0,u)}function pS(u,c,p,y){var w=c&x,S=ca(u);function T(){for(var D=-1,I=arguments.length,B=-1,z=y.length,H=F(z+I),G=this&&this!==Ot&&this instanceof T?S:u;++B<z;)H[B]=y[B];for(;I--;)H[B++]=arguments[++D];return En(G,w?p:this,H)}return T}function xm(u){return function(c,p,y){return y&&typeof y!="number"&&nn(c,p,y)&&(p=y=t),c=ri(c),p===t?(p=c,c=0):p=ri(p),y=y===t?c<p?1:-1:ri(y),Qk(c,p,y,u)}}function Qu(u){return function(c,p){return typeof c=="string"&&typeof p=="string"||(c=Jn(c),p=Jn(p)),u(c,p)}}function wm(u,c,p,y,w,S,T,D,I,B){var z=c&M,H=z?T:t,G=z?t:T,ne=z?S:t,ue=z?t:S;c|=z?P:N,c&=~(z?N:P),c&A||(c&=-4);var _e=[u,c,w,ne,H,ue,G,D,I,B],le=p.apply(t,_e);return Hd(u)&&Nm(le,_e),le.placeholder=y,Pm(le,u,c)}function Pd(u){var c=yt[u];return function(p,y){if(p=Jn(p),y=y==null?0:Wt(ke(y),292),y&&P0(p)){var w=(He(p)+"e").split("e"),S=c(w[0]+"e"+(+w[1]+y));return w=(He(S)+"e").split("e"),+(w[0]+"e"+(+w[1]-y))}return c(p)}}var mS=Jo&&1/Tu(new Jo([,-0]))[1]==we?function(u){return new Jo(u)}:nf;function km(u){return function(c){var p=Ut(c);return p==Vt?cd(c):p==ct?Iw(c):Cw(c,u(c))}}function Qr(u,c,p,y,w,S,T,D){var I=c&E;if(!I&&typeof u!="function")throw new Kn(s);var B=y?y.length:0;if(B||(c&=-97,y=w=t),T=T===t?T:vt(ke(T),0),D=D===t?D:ke(D),B-=w?w.length:0,c&N){var z=y,H=w;y=w=t}var G=I?t:Ld(u),ne=[u,c,p,y,w,z,H,S,T,D];if(G&&MS(ne,G),u=ne[0],c=ne[1],p=ne[2],y=ne[3],w=ne[4],D=ne[9]=ne[9]===t?I?0:u.length:vt(ne[9]-B,0),!D&&c&(M|C)&&(c&=-25),!c||c==x)var ue=fS(u,c,p);else c==M||c==C?ue=hS(u,c,D):(c==P||c==(x|P))&&!w.length?ue=pS(u,c,p,y):ue=Yu.apply(t,ne);var _e=G?nm:Nm;return Pm(_e(ue,ne),u,c)}function Sm(u,c,p,y){return u===t||fr(u,Yo[p])&&!Ve.call(y,p)?c:u}function Cm(u,c,p,y,w,S){return tt(u)&&tt(c)&&(S.set(c,u),Ku(u,c,t,Cm,S),S.delete(c)),u}function gS(u){return ha(u)?t:u}function Em(u,c,p,y,w,S){var T=p&b,D=u.length,I=c.length;if(D!=I&&!(T&&I>D))return!1;var B=S.get(u),z=S.get(c);if(B&&z)return B==c&&z==u;var H=-1,G=!0,ne=p&v?new ao:t;for(S.set(u,c),S.set(c,u);++H<D;){var ue=u[H],_e=c[H];if(y)var le=T?y(_e,ue,H,c,u,S):y(ue,_e,H,u,c,S);if(le!==t){if(le)continue;G=!1;break}if(ne){if(!id(c,function(Ie,Fe){if(!Qs(ne,Fe)&&(ue===Ie||w(ue,Ie,p,y,S)))return ne.push(Fe)})){G=!1;break}}else if(!(ue===_e||w(ue,_e,p,y,S))){G=!1;break}}return S.delete(u),S.delete(c),G}function bS(u,c,p,y,w,S,T){switch(p){case lr:if(u.byteLength!=c.byteLength||u.byteOffset!=c.byteOffset)return!1;u=u.buffer,c=c.buffer;case _r:return!(u.byteLength!=c.byteLength||!S(new Pu(u),new Pu(c)));case Zt:case qn:case Cr:return fr(+u,+c);case ar:return u.name==c.name&&u.message==c.message;case en:case ur:return u==c+"";case Vt:var D=cd;case ct:var I=y&b;if(D||(D=Tu),u.size!=c.size&&!I)return!1;var B=T.get(u);if(B)return B==c;y|=v,T.set(u,c);var z=Em(D(u),D(c),y,w,S,T);return T.delete(u),z;case Vn:if(ia)return ia.call(u)==ia.call(c)}return!1}function yS(u,c,p,y,w,S){var T=p&b,D=Fd(u),I=D.length,B=Fd(c),z=B.length;if(I!=z&&!T)return!1;for(var H=I;H--;){var G=D[H];if(!(T?G in c:Ve.call(c,G)))return!1}var ne=S.get(u),ue=S.get(c);if(ne&&ue)return ne==c&&ue==u;var _e=!0;S.set(u,c),S.set(c,u);for(var le=T;++H<I;){G=D[H];var Ie=u[G],Fe=c[G];if(y)var Dn=T?y(Fe,Ie,G,c,u,S):y(Ie,Fe,G,u,c,S);if(!(Dn===t?Ie===Fe||w(Ie,Fe,p,y,S):Dn)){_e=!1;break}le||(le=G=="constructor")}if(_e&&!le){var rn=u.constructor,Mn=c.constructor;rn!=Mn&&"constructor"in u&&"constructor"in c&&!(typeof rn=="function"&&rn instanceof rn&&typeof Mn=="function"&&Mn instanceof Mn)&&(_e=!1)}return S.delete(u),S.delete(c),_e}function ei(u){return Vd(Om(u,t,zm),u+"")}function Fd(u){return U0(u,kt,$d)}function Rd(u){return U0(u,pn,_m)}var Ld=zu?function(u){return zu.get(u)}:nf;function el(u){for(var c=u.name+"",p=Zo[c],y=Ve.call(Zo,c)?p.length:0;y--;){var w=p[y],S=w.func;if(S==null||S==u)return w.name}return c}function ns(u){var c=Ve.call(k,"placeholder")?k:u;return c.placeholder}function ie(){var u=k.iteratee||ef;return u=u===ef?G0:u,arguments.length?u(arguments[0],arguments[1]):u}function tl(u,c){var p=u.__data__;return _S(c)?p[typeof c=="string"?"string":"hash"]:p.map}function Bd(u){for(var c=kt(u),p=c.length;p--;){var y=c[p],w=u[y];c[p]=[y,w,Dm(w)]}return c}function co(u,c){var p=Dw(u,c);return j0(p)?p:t}function vS(u){var c=Ve.call(u,oo),p=u[oo];try{u[oo]=t;var y=!0}catch{}var w=Iu.call(u);return y&&(c?u[oo]=p:delete u[oo]),w}var $d=fd?function(u){return u==null?[]:(u=We(u),xi(fd(u),function(c){return I0.call(u,c)}))}:rf,_m=fd?function(u){for(var c=[];u;)wi(c,$d(u)),u=Fu(u);return c}:rf,Ut=tn;(hd&&Ut(new hd(new ArrayBuffer(1)))!=lr||ta&&Ut(new ta)!=Vt||pd&&Ut(pd.resolve())!=no||Jo&&Ut(new Jo)!=ct||na&&Ut(new na)!=Er)&&(Ut=function(u){var c=tn(u),p=c==Qt?u.constructor:t,y=p?fo(p):"";if(y)switch(y){case tk:return lr;case nk:return Vt;case rk:return no;case ik:return ct;case ok:return Er}return c});function xS(u,c,p){for(var y=-1,w=p.length;++y<w;){var S=p[y],T=S.size;switch(S.type){case"drop":u+=T;break;case"dropRight":c-=T;break;case"take":c=Wt(c,u+T);break;case"takeRight":u=vt(u,c-T);break}}return{start:u,end:c}}function wS(u){var c=u.match(A2);return c?c[1].split(T2):[]}function Am(u,c,p){c=_i(c,u);for(var y=-1,w=c.length,S=!1;++y<w;){var T=Dr(c[y]);if(!(S=u!=null&&p(u,T)))break;u=u[T]}return S||++y!=w?S:(w=u==null?0:u.length,!!w&&ul(w)&&ti(T,w)&&(xe(u)||ho(u)))}function kS(u){var c=u.length,p=new u.constructor(c);return c&&typeof u[0]=="string"&&Ve.call(u,"index")&&(p.index=u.index,p.input=u.input),p}function Tm(u){return typeof u.constructor=="function"&&!da(u)?Qo(Fu(u)):{}}function SS(u,c,p){var y=u.constructor;switch(c){case _r:return Id(u);case Zt:case qn:return new y(+u);case lr:return sS(u,p);case Us:case Ks:case js:case Gs:case Xs:case R:case J:case ae:case Re:return cm(u,p);case Vt:return new y;case Cr:case ur:return new y(u);case en:return aS(u);case ct:return new y;case Vn:return uS(u)}}function CS(u,c){var p=c.length;if(!p)return u;var y=p-1;return c[y]=(p>1?"& ":"")+c[y],c=c.join(p>2?", ":" "),u.replace(_2,`{
/* [wrapped with `+c+`] */
`)}function ES(u){return xe(u)||ho(u)||!!(N0&&u&&u[N0])}function ti(u,c){var p=typeof u;return c=c??Oe,!!c&&(p=="number"||p!="symbol"&&L2.test(u))&&u>-1&&u%1==0&&u<c}function nn(u,c,p){if(!tt(p))return!1;var y=typeof c;return(y=="number"?hn(p)&&ti(c,p.length):y=="string"&&c in p)?fr(p[c],u):!1}function zd(u,c){if(xe(u))return!1;var p=typeof u;return p=="number"||p=="symbol"||p=="boolean"||u==null||Tn(u)?!0:Wo.test(u)||!Zs.test(u)||c!=null&&u in We(c)}function _S(u){var c=typeof u;return c=="string"||c=="number"||c=="symbol"||c=="boolean"?u!=="__proto__":u===null}function Hd(u){var c=el(u),p=k[c];if(typeof p!="function"||!(c in Ne.prototype))return!1;if(u===p)return!0;var y=Ld(p);return!!y&&u===y[0]}function AS(u){return!!D0&&D0 in u}var TS=Mu?ni:of;function da(u){var c=u&&u.constructor,p=typeof c=="function"&&c.prototype||Yo;return u===p}function Dm(u){return u===u&&!tt(u)}function Mm(u,c){return function(p){return p==null?!1:p[u]===c&&(c!==t||u in We(p))}}function DS(u){var c=sl(u,function(y){return p.size===d&&p.clear(),y}),p=c.cache;return c}function MS(u,c){var p=u[1],y=c[1],w=p|y,S=w<(x|E|W),T=y==W&&p==M||y==W&&p==V&&u[7].length<=c[8]||y==(W|V)&&c[7].length<=c[8]&&p==M;if(!(S||T))return u;y&x&&(u[2]=c[2],w|=p&x?0:A);var D=c[3];if(D){var I=u[3];u[3]=I?fm(I,D,c[4]):D,u[4]=I?ki(u[3],f):c[4]}return D=c[5],D&&(I=u[5],u[5]=I?hm(I,D,c[6]):D,u[6]=I?ki(u[5],f):c[6]),D=c[7],D&&(u[7]=D),y&W&&(u[8]=u[8]==null?c[8]:Wt(u[8],c[8])),u[9]==null&&(u[9]=c[9]),u[0]=c[0],u[1]=w,u}function OS(u){var c=[];if(u!=null)for(var p in We(u))c.push(p);return c}function IS(u){return Iu.call(u)}function Om(u,c,p){return c=vt(c===t?u.length-1:c,0),function(){for(var y=arguments,w=-1,S=vt(y.length-c,0),T=F(S);++w<S;)T[w]=y[c+w];w=-1;for(var D=F(c+1);++w<c;)D[w]=y[w];return D[c]=p(T),En(u,this,D)}}function Im(u,c){return c.length<2?u:lo(u,Xn(c,0,-1))}function NS(u,c){for(var p=u.length,y=Wt(c.length,p),w=fn(u);y--;){var S=c[y];u[y]=ti(S,p)?w[S]:t}return u}function qd(u,c){if(!(c==="constructor"&&typeof u[c]=="function")&&c!="__proto__")return u[c]}var Nm=Fm(nm),fa=Gw||function(u,c){return Ot.setTimeout(u,c)},Vd=Fm(nS);function Pm(u,c,p){var y=c+"";return Vd(u,CS(y,PS(wS(y),p)))}function Fm(u){var c=0,p=0;return function(){var y=Zw(),w=se-(y-p);if(p=y,w>0){if(++c>=me)return arguments[0]}else c=0;return u.apply(t,arguments)}}function nl(u,c){var p=-1,y=u.length,w=y-1;for(c=c===t?y:c;++p<c;){var S=Ed(p,w),T=u[S];u[S]=u[p],u[p]=T}return u.length=c,u}var Rm=DS(function(u){var c=[];return u.charCodeAt(0)===46&&c.push(""),u.replace(S2,function(p,y,w,S){c.push(w?S.replace(O2,"$1"):y||p)}),c});function Dr(u){if(typeof u=="string"||Tn(u))return u;var c=u+"";return c=="0"&&1/u==-1/0?"-0":c}function fo(u){if(u!=null){try{return Ou.call(u)}catch{}try{return u+""}catch{}}return""}function PS(u,c){return Un(sr,function(p){var y="_."+p[0];c&p[1]&&!_u(u,y)&&u.push(y)}),u.sort()}function Lm(u){if(u instanceof Ne)return u.clone();var c=new jn(u.__wrapped__,u.__chain__);return c.__actions__=fn(u.__actions__),c.__index__=u.__index__,c.__values__=u.__values__,c}function FS(u,c,p){(p?nn(u,c,p):c===t)?c=1:c=vt(ke(c),0);var y=u==null?0:u.length;if(!y||c<1)return[];for(var w=0,S=0,T=F(Bu(y/c));w<y;)T[S++]=Xn(u,w,w+=c);return T}function RS(u){for(var c=-1,p=u==null?0:u.length,y=0,w=[];++c<p;){var S=u[c];S&&(w[y++]=S)}return w}function LS(){var u=arguments.length;if(!u)return[];for(var c=F(u-1),p=arguments[0],y=u;y--;)c[y-1]=arguments[y];return wi(xe(p)?fn(p):[p],It(c,1))}var BS=Te(function(u,c){return ut(u)?sa(u,It(c,1,ut,!0)):[]}),$S=Te(function(u,c){var p=Yn(c);return ut(p)&&(p=t),ut(u)?sa(u,It(c,1,ut,!0),ie(p,2)):[]}),zS=Te(function(u,c){var p=Yn(c);return ut(p)&&(p=t),ut(u)?sa(u,It(c,1,ut,!0),t,p):[]});function HS(u,c,p){var y=u==null?0:u.length;return y?(c=p||c===t?1:ke(c),Xn(u,c<0?0:c,y)):[]}function qS(u,c,p){var y=u==null?0:u.length;return y?(c=p||c===t?1:ke(c),c=y-c,Xn(u,0,c<0?0:c)):[]}function VS(u,c){return u&&u.length?Gu(u,ie(c,3),!0,!0):[]}function WS(u,c){return u&&u.length?Gu(u,ie(c,3),!0):[]}function US(u,c,p,y){var w=u==null?0:u.length;return w?(p&&typeof p!="number"&&nn(u,c,p)&&(p=0,y=w),Lk(u,c,p,y)):[]}function Bm(u,c,p){var y=u==null?0:u.length;if(!y)return-1;var w=p==null?0:ke(p);return w<0&&(w=vt(y+w,0)),Au(u,ie(c,3),w)}function $m(u,c,p){var y=u==null?0:u.length;if(!y)return-1;var w=y-1;return p!==t&&(w=ke(p),w=p<0?vt(y+w,0):Wt(w,y-1)),Au(u,ie(c,3),w,!0)}function zm(u){var c=u==null?0:u.length;return c?It(u,1):[]}function KS(u){var c=u==null?0:u.length;return c?It(u,we):[]}function jS(u,c){var p=u==null?0:u.length;return p?(c=c===t?1:ke(c),It(u,c)):[]}function GS(u){for(var c=-1,p=u==null?0:u.length,y={};++c<p;){var w=u[c];y[w[0]]=w[1]}return y}function Hm(u){return u&&u.length?u[0]:t}function XS(u,c,p){var y=u==null?0:u.length;if(!y)return-1;var w=p==null?0:ke(p);return w<0&&(w=vt(y+w,0)),Ko(u,c,w)}function YS(u){var c=u==null?0:u.length;return c?Xn(u,0,-1):[]}var JS=Te(function(u){var c=Ze(u,Md);return c.length&&c[0]===u[0]?xd(c):[]}),ZS=Te(function(u){var c=Yn(u),p=Ze(u,Md);return c===Yn(p)?c=t:p.pop(),p.length&&p[0]===u[0]?xd(p,ie(c,2)):[]}),QS=Te(function(u){var c=Yn(u),p=Ze(u,Md);return c=typeof c=="function"?c:t,c&&p.pop(),p.length&&p[0]===u[0]?xd(p,t,c):[]});function e3(u,c){return u==null?"":Yw.call(u,c)}function Yn(u){var c=u==null?0:u.length;return c?u[c-1]:t}function t3(u,c,p){var y=u==null?0:u.length;if(!y)return-1;var w=y;return p!==t&&(w=ke(p),w=w<0?vt(y+w,0):Wt(w,y-1)),c===c?Pw(u,c,w):Au(u,w0,w,!0)}function n3(u,c){return u&&u.length?Z0(u,ke(c)):t}var r3=Te(qm);function qm(u,c){return u&&u.length&&c&&c.length?Cd(u,c):u}function i3(u,c,p){return u&&u.length&&c&&c.length?Cd(u,c,ie(p,2)):u}function o3(u,c,p){return u&&u.length&&c&&c.length?Cd(u,c,t,p):u}var s3=ei(function(u,c){var p=u==null?0:u.length,y=gd(u,c);return tm(u,Ze(c,function(w){return ti(w,p)?+w:w}).sort(dm)),y});function a3(u,c){var p=[];if(!(u&&u.length))return p;var y=-1,w=[],S=u.length;for(c=ie(c,3);++y<S;){var T=u[y];c(T,y,u)&&(p.push(T),w.push(y))}return tm(u,w),p}function Wd(u){return u==null?u:ek.call(u)}function u3(u,c,p){var y=u==null?0:u.length;return y?(p&&typeof p!="number"&&nn(u,c,p)?(c=0,p=y):(c=c==null?0:ke(c),p=p===t?y:ke(p)),Xn(u,c,p)):[]}function l3(u,c){return ju(u,c)}function c3(u,c,p){return Ad(u,c,ie(p,2))}function d3(u,c){var p=u==null?0:u.length;if(p){var y=ju(u,c);if(y<p&&fr(u[y],c))return y}return-1}function f3(u,c){return ju(u,c,!0)}function h3(u,c,p){return Ad(u,c,ie(p,2),!0)}function p3(u,c){var p=u==null?0:u.length;if(p){var y=ju(u,c,!0)-1;if(fr(u[y],c))return y}return-1}function m3(u){return u&&u.length?rm(u):[]}function g3(u,c){return u&&u.length?rm(u,ie(c,2)):[]}function b3(u){var c=u==null?0:u.length;return c?Xn(u,1,c):[]}function y3(u,c,p){return u&&u.length?(c=p||c===t?1:ke(c),Xn(u,0,c<0?0:c)):[]}function v3(u,c,p){var y=u==null?0:u.length;return y?(c=p||c===t?1:ke(c),c=y-c,Xn(u,c<0?0:c,y)):[]}function x3(u,c){return u&&u.length?Gu(u,ie(c,3),!1,!0):[]}function w3(u,c){return u&&u.length?Gu(u,ie(c,3)):[]}var k3=Te(function(u){return Ei(It(u,1,ut,!0))}),S3=Te(function(u){var c=Yn(u);return ut(c)&&(c=t),Ei(It(u,1,ut,!0),ie(c,2))}),C3=Te(function(u){var c=Yn(u);return c=typeof c=="function"?c:t,Ei(It(u,1,ut,!0),t,c)});function E3(u){return u&&u.length?Ei(u):[]}function _3(u,c){return u&&u.length?Ei(u,ie(c,2)):[]}function A3(u,c){return c=typeof c=="function"?c:t,u&&u.length?Ei(u,t,c):[]}function Ud(u){if(!(u&&u.length))return[];var c=0;return u=xi(u,function(p){if(ut(p))return c=vt(p.length,c),!0}),ud(c,function(p){return Ze(u,od(p))})}function Vm(u,c){if(!(u&&u.length))return[];var p=Ud(u);return c==null?p:Ze(p,function(y){return En(c,t,y)})}var T3=Te(function(u,c){return ut(u)?sa(u,c):[]}),D3=Te(function(u){return Dd(xi(u,ut))}),M3=Te(function(u){var c=Yn(u);return ut(c)&&(c=t),Dd(xi(u,ut),ie(c,2))}),O3=Te(function(u){var c=Yn(u);return c=typeof c=="function"?c:t,Dd(xi(u,ut),t,c)}),I3=Te(Ud);function N3(u,c){return am(u||[],c||[],oa)}function P3(u,c){return am(u||[],c||[],la)}var F3=Te(function(u){var c=u.length,p=c>1?u[c-1]:t;return p=typeof p=="function"?(u.pop(),p):t,Vm(u,p)});function Wm(u){var c=k(u);return c.__chain__=!0,c}function R3(u,c){return c(u),u}function rl(u,c){return c(u)}var L3=ei(function(u){var c=u.length,p=c?u[0]:0,y=this.__wrapped__,w=function(S){return gd(S,u)};return c>1||this.__actions__.length||!(y instanceof Ne)||!ti(p)?this.thru(w):(y=y.slice(p,+p+(c?1:0)),y.__actions__.push({func:rl,args:[w],thisArg:t}),new jn(y,this.__chain__).thru(function(S){return c&&!S.length&&S.push(t),S}))});function B3(){return Wm(this)}function $3(){return new jn(this.value(),this.__chain__)}function z3(){this.__values__===t&&(this.__values__=ig(this.value()));var u=this.__index__>=this.__values__.length,c=u?t:this.__values__[this.__index__++];return{done:u,value:c}}function H3(){return this}function q3(u){for(var c,p=this;p instanceof qu;){var y=Lm(p);y.__index__=0,y.__values__=t,c?w.__wrapped__=y:c=y;var w=y;p=p.__wrapped__}return w.__wrapped__=u,c}function V3(){var u=this.__wrapped__;if(u instanceof Ne){var c=u;return this.__actions__.length&&(c=new Ne(this)),c=c.reverse(),c.__actions__.push({func:rl,args:[Wd],thisArg:t}),new jn(c,this.__chain__)}return this.thru(Wd)}function W3(){return sm(this.__wrapped__,this.__actions__)}var U3=Xu(function(u,c,p){Ve.call(u,p)?++u[p]:Zr(u,p,1)});function K3(u,c,p){var y=xe(u)?v0:Rk;return p&&nn(u,c,p)&&(c=t),y(u,ie(c,3))}function j3(u,c){var p=xe(u)?xi:V0;return p(u,ie(c,3))}var G3=bm(Bm),X3=bm($m);function Y3(u,c){return It(il(u,c),1)}function J3(u,c){return It(il(u,c),we)}function Z3(u,c,p){return p=p===t?1:ke(p),It(il(u,c),p)}function Um(u,c){var p=xe(u)?Un:Ci;return p(u,ie(c,3))}function Km(u,c){var p=xe(u)?bw:q0;return p(u,ie(c,3))}var Q3=Xu(function(u,c,p){Ve.call(u,p)?u[p].push(c):Zr(u,p,[c])});function eC(u,c,p,y){u=hn(u)?u:is(u),p=p&&!y?ke(p):0;var w=u.length;return p<0&&(p=vt(w+p,0)),ll(u)?p<=w&&u.indexOf(c,p)>-1:!!w&&Ko(u,c,p)>-1}var tC=Te(function(u,c,p){var y=-1,w=typeof c=="function",S=hn(u)?F(u.length):[];return Ci(u,function(T){S[++y]=w?En(c,T,p):aa(T,c,p)}),S}),nC=Xu(function(u,c,p){Zr(u,p,c)});function il(u,c){var p=xe(u)?Ze:X0;return p(u,ie(c,3))}function rC(u,c,p,y){return u==null?[]:(xe(c)||(c=c==null?[]:[c]),p=y?t:p,xe(p)||(p=p==null?[]:[p]),Q0(u,c,p))}var iC=Xu(function(u,c,p){u[p?0:1].push(c)},function(){return[[],[]]});function oC(u,c,p){var y=xe(u)?rd:S0,w=arguments.length<3;return y(u,ie(c,4),p,w,Ci)}function sC(u,c,p){var y=xe(u)?yw:S0,w=arguments.length<3;return y(u,ie(c,4),p,w,q0)}function aC(u,c){var p=xe(u)?xi:V0;return p(u,al(ie(c,3)))}function uC(u){var c=xe(u)?B0:eS;return c(u)}function lC(u,c,p){(p?nn(u,c,p):c===t)?c=1:c=ke(c);var y=xe(u)?Ok:tS;return y(u,c)}function cC(u){var c=xe(u)?Ik:rS;return c(u)}function dC(u){if(u==null)return 0;if(hn(u))return ll(u)?Go(u):u.length;var c=Ut(u);return c==Vt||c==ct?u.size:kd(u).length}function fC(u,c,p){var y=xe(u)?id:iS;return p&&nn(u,c,p)&&(c=t),y(u,ie(c,3))}var hC=Te(function(u,c){if(u==null)return[];var p=c.length;return p>1&&nn(u,c[0],c[1])?c=[]:p>2&&nn(c[0],c[1],c[2])&&(c=[c[0]]),Q0(u,It(c,1),[])}),ol=jw||function(){return Ot.Date.now()};function pC(u,c){if(typeof c!="function")throw new Kn(s);return u=ke(u),function(){if(--u<1)return c.apply(this,arguments)}}function jm(u,c,p){return c=p?t:c,c=u&&c==null?u.length:c,Qr(u,W,t,t,t,t,c)}function Gm(u,c){var p;if(typeof c!="function")throw new Kn(s);return u=ke(u),function(){return--u>0&&(p=c.apply(this,arguments)),u<=1&&(c=t),p}}var Kd=Te(function(u,c,p){var y=x;if(p.length){var w=ki(p,ns(Kd));y|=P}return Qr(u,y,c,p,w)}),Xm=Te(function(u,c,p){var y=x|E;if(p.length){var w=ki(p,ns(Xm));y|=P}return Qr(c,y,u,p,w)});function Ym(u,c,p){c=p?t:c;var y=Qr(u,M,t,t,t,t,t,c);return y.placeholder=Ym.placeholder,y}function Jm(u,c,p){c=p?t:c;var y=Qr(u,C,t,t,t,t,t,c);return y.placeholder=Jm.placeholder,y}function Zm(u,c,p){var y,w,S,T,D,I,B=0,z=!1,H=!1,G=!0;if(typeof u!="function")throw new Kn(s);c=Jn(c)||0,tt(p)&&(z=!!p.leading,H="maxWait"in p,S=H?vt(Jn(p.maxWait)||0,c):S,G="trailing"in p?!!p.trailing:G);function ne(lt){var hr=y,ii=w;return y=w=t,B=lt,T=u.apply(ii,hr),T}function ue(lt){return B=lt,D=fa(Ie,c),z?ne(lt):T}function _e(lt){var hr=lt-I,ii=lt-B,bg=c-hr;return H?Wt(bg,S-ii):bg}function le(lt){var hr=lt-I,ii=lt-B;return I===t||hr>=c||hr<0||H&&ii>=S}function Ie(){var lt=ol();if(le(lt))return Fe(lt);D=fa(Ie,_e(lt))}function Fe(lt){return D=t,G&&y?ne(lt):(y=w=t,T)}function Dn(){D!==t&&um(D),B=0,y=I=w=D=t}function rn(){return D===t?T:Fe(ol())}function Mn(){var lt=ol(),hr=le(lt);if(y=arguments,w=this,I=lt,hr){if(D===t)return ue(I);if(H)return um(D),D=fa(Ie,c),ne(I)}return D===t&&(D=fa(Ie,c)),T}return Mn.cancel=Dn,Mn.flush=rn,Mn}var mC=Te(function(u,c){return H0(u,1,c)}),gC=Te(function(u,c,p){return H0(u,Jn(c)||0,p)});function bC(u){return Qr(u,U)}function sl(u,c){if(typeof u!="function"||c!=null&&typeof c!="function")throw new Kn(s);var p=function(){var y=arguments,w=c?c.apply(this,y):y[0],S=p.cache;if(S.has(w))return S.get(w);var T=u.apply(this,y);return p.cache=S.set(w,T)||S,T};return p.cache=new(sl.Cache||Jr),p}sl.Cache=Jr;function al(u){if(typeof u!="function")throw new Kn(s);return function(){var c=arguments;switch(c.length){case 0:return!u.call(this);case 1:return!u.call(this,c[0]);case 2:return!u.call(this,c[0],c[1]);case 3:return!u.call(this,c[0],c[1],c[2])}return!u.apply(this,c)}}function yC(u){return Gm(2,u)}var vC=oS(function(u,c){c=c.length==1&&xe(c[0])?Ze(c[0],_n(ie())):Ze(It(c,1),_n(ie()));var p=c.length;return Te(function(y){for(var w=-1,S=Wt(y.length,p);++w<S;)y[w]=c[w].call(this,y[w]);return En(u,this,y)})}),jd=Te(function(u,c){var p=ki(c,ns(jd));return Qr(u,P,t,c,p)}),Qm=Te(function(u,c){var p=ki(c,ns(Qm));return Qr(u,N,t,c,p)}),xC=ei(function(u,c){return Qr(u,V,t,t,t,c)});function wC(u,c){if(typeof u!="function")throw new Kn(s);return c=c===t?c:ke(c),Te(u,c)}function kC(u,c){if(typeof u!="function")throw new Kn(s);return c=c==null?0:vt(ke(c),0),Te(function(p){var y=p[c],w=Ai(p,0,c);return y&&wi(w,y),En(u,this,w)})}function SC(u,c,p){var y=!0,w=!0;if(typeof u!="function")throw new Kn(s);return tt(p)&&(y="leading"in p?!!p.leading:y,w="trailing"in p?!!p.trailing:w),Zm(u,c,{leading:y,maxWait:c,trailing:w})}function CC(u){return jm(u,1)}function EC(u,c){return jd(Od(c),u)}function _C(){if(!arguments.length)return[];var u=arguments[0];return xe(u)?u:[u]}function AC(u){return Gn(u,g)}function TC(u,c){return c=typeof c=="function"?c:t,Gn(u,g,c)}function DC(u){return Gn(u,h|g)}function MC(u,c){return c=typeof c=="function"?c:t,Gn(u,h|g,c)}function OC(u,c){return c==null||z0(u,c,kt(c))}function fr(u,c){return u===c||u!==u&&c!==c}var IC=Qu(vd),NC=Qu(function(u,c){return u>=c}),ho=K0(function(){return arguments}())?K0:function(u){return it(u)&&Ve.call(u,"callee")&&!I0.call(u,"callee")},xe=F.isArray,PC=h0?_n(h0):qk;function hn(u){return u!=null&&ul(u.length)&&!ni(u)}function ut(u){return it(u)&&hn(u)}function FC(u){return u===!0||u===!1||it(u)&&tn(u)==Zt}var Ti=Xw||of,RC=p0?_n(p0):Vk;function LC(u){return it(u)&&u.nodeType===1&&!ha(u)}function BC(u){if(u==null)return!0;if(hn(u)&&(xe(u)||typeof u=="string"||typeof u.splice=="function"||Ti(u)||rs(u)||ho(u)))return!u.length;var c=Ut(u);if(c==Vt||c==ct)return!u.size;if(da(u))return!kd(u).length;for(var p in u)if(Ve.call(u,p))return!1;return!0}function $C(u,c){return ua(u,c)}function zC(u,c,p){p=typeof p=="function"?p:t;var y=p?p(u,c):t;return y===t?ua(u,c,t,p):!!y}function Gd(u){if(!it(u))return!1;var c=tn(u);return c==ar||c==Sr||typeof u.message=="string"&&typeof u.name=="string"&&!ha(u)}function HC(u){return typeof u=="number"&&P0(u)}function ni(u){if(!tt(u))return!1;var c=tn(u);return c==jr||c==yi||c==bi||c==Ho}function eg(u){return typeof u=="number"&&u==ke(u)}function ul(u){return typeof u=="number"&&u>-1&&u%1==0&&u<=Oe}function tt(u){var c=typeof u;return u!=null&&(c=="object"||c=="function")}function it(u){return u!=null&&typeof u=="object"}var tg=m0?_n(m0):Uk;function qC(u,c){return u===c||wd(u,c,Bd(c))}function VC(u,c,p){return p=typeof p=="function"?p:t,wd(u,c,Bd(c),p)}function WC(u){return ng(u)&&u!=+u}function UC(u){if(TS(u))throw new ge(o);return j0(u)}function KC(u){return u===null}function jC(u){return u==null}function ng(u){return typeof u=="number"||it(u)&&tn(u)==Cr}function ha(u){if(!it(u)||tn(u)!=Qt)return!1;var c=Fu(u);if(c===null)return!0;var p=Ve.call(c,"constructor")&&c.constructor;return typeof p=="function"&&p instanceof p&&Ou.call(p)==Vw}var Xd=g0?_n(g0):Kk;function GC(u){return eg(u)&&u>=-9007199254740991&&u<=Oe}var rg=b0?_n(b0):jk;function ll(u){return typeof u=="string"||!xe(u)&&it(u)&&tn(u)==ur}function Tn(u){return typeof u=="symbol"||it(u)&&tn(u)==Vn}var rs=y0?_n(y0):Gk;function XC(u){return u===t}function YC(u){return it(u)&&Ut(u)==Er}function JC(u){return it(u)&&tn(u)==qo}var ZC=Qu(Sd),QC=Qu(function(u,c){return u<=c});function ig(u){if(!u)return[];if(hn(u))return ll(u)?cr(u):fn(u);if(ea&&u[ea])return Ow(u[ea]());var c=Ut(u),p=c==Vt?cd:c==ct?Tu:is;return p(u)}function ri(u){if(!u)return u===0?u:0;if(u=Jn(u),u===we||u===-1/0){var c=u<0?-1:1;return c*Ht}return u===u?u:0}function ke(u){var c=ri(u),p=c%1;return c===c?p?c-p:c:0}function og(u){return u?uo(ke(u),0,Je):0}function Jn(u){if(typeof u=="number")return u;if(Tn(u))return Dt;if(tt(u)){var c=typeof u.valueOf=="function"?u.valueOf():u;u=tt(c)?c+"":c}if(typeof u!="string")return u===0?u:+u;u=C0(u);var p=P2.test(u);return p||R2.test(u)?pw(u.slice(2),p?2:8):N2.test(u)?Dt:+u}function sg(u){return Tr(u,pn(u))}function eE(u){return u?uo(ke(u),-9007199254740991,Oe):u===0?u:0}function He(u){return u==null?"":An(u)}var tE=es(function(u,c){if(da(c)||hn(c)){Tr(c,kt(c),u);return}for(var p in c)Ve.call(c,p)&&oa(u,p,c[p])}),ag=es(function(u,c){Tr(c,pn(c),u)}),cl=es(function(u,c,p,y){Tr(c,pn(c),u,y)}),nE=es(function(u,c,p,y){Tr(c,kt(c),u,y)}),rE=ei(gd);function iE(u,c){var p=Qo(u);return c==null?p:$0(p,c)}var oE=Te(function(u,c){u=We(u);var p=-1,y=c.length,w=y>2?c[2]:t;for(w&&nn(c[0],c[1],w)&&(y=1);++p<y;)for(var S=c[p],T=pn(S),D=-1,I=T.length;++D<I;){var B=T[D],z=u[B];(z===t||fr(z,Yo[B])&&!Ve.call(u,B))&&(u[B]=S[B])}return u}),sE=Te(function(u){return u.push(t,Cm),En(ug,t,u)});function aE(u,c){return x0(u,ie(c,3),Ar)}function uE(u,c){return x0(u,ie(c,3),yd)}function lE(u,c){return u==null?u:bd(u,ie(c,3),pn)}function cE(u,c){return u==null?u:W0(u,ie(c,3),pn)}function dE(u,c){return u&&Ar(u,ie(c,3))}function fE(u,c){return u&&yd(u,ie(c,3))}function hE(u){return u==null?[]:Uu(u,kt(u))}function pE(u){return u==null?[]:Uu(u,pn(u))}function Yd(u,c,p){var y=u==null?t:lo(u,c);return y===t?p:y}function mE(u,c){return u!=null&&Am(u,c,Bk)}function Jd(u,c){return u!=null&&Am(u,c,$k)}var gE=vm(function(u,c,p){c!=null&&typeof c.toString!="function"&&(c=Iu.call(c)),u[c]=p},Qd(mn)),bE=vm(function(u,c,p){c!=null&&typeof c.toString!="function"&&(c=Iu.call(c)),Ve.call(u,c)?u[c].push(p):u[c]=[p]},ie),yE=Te(aa);function kt(u){return hn(u)?L0(u):kd(u)}function pn(u){return hn(u)?L0(u,!0):Xk(u)}function vE(u,c){var p={};return c=ie(c,3),Ar(u,function(y,w,S){Zr(p,c(y,w,S),y)}),p}function xE(u,c){var p={};return c=ie(c,3),Ar(u,function(y,w,S){Zr(p,w,c(y,w,S))}),p}var wE=es(function(u,c,p){Ku(u,c,p)}),ug=es(function(u,c,p,y){Ku(u,c,p,y)}),kE=ei(function(u,c){var p={};if(u==null)return p;var y=!1;c=Ze(c,function(S){return S=_i(S,u),y||(y=S.length>1),S}),Tr(u,Rd(u),p),y&&(p=Gn(p,h|m|g,gS));for(var w=c.length;w--;)Td(p,c[w]);return p});function SE(u,c){return lg(u,al(ie(c)))}var CE=ei(function(u,c){return u==null?{}:Jk(u,c)});function lg(u,c){if(u==null)return{};var p=Ze(Rd(u),function(y){return[y]});return c=ie(c),em(u,p,function(y,w){return c(y,w[0])})}function EE(u,c,p){c=_i(c,u);var y=-1,w=c.length;for(w||(w=1,u=t);++y<w;){var S=u==null?t:u[Dr(c[y])];S===t&&(y=w,S=p),u=ni(S)?S.call(u):S}return u}function _E(u,c,p){return u==null?u:la(u,c,p)}function AE(u,c,p,y){return y=typeof y=="function"?y:t,u==null?u:la(u,c,p,y)}var cg=km(kt),dg=km(pn);function TE(u,c,p){var y=xe(u),w=y||Ti(u)||rs(u);if(c=ie(c,4),p==null){var S=u&&u.constructor;w?p=y?new S:[]:tt(u)?p=ni(S)?Qo(Fu(u)):{}:p={}}return(w?Un:Ar)(u,function(T,D,I){return c(p,T,D,I)}),p}function DE(u,c){return u==null?!0:Td(u,c)}function ME(u,c,p){return u==null?u:om(u,c,Od(p))}function OE(u,c,p,y){return y=typeof y=="function"?y:t,u==null?u:om(u,c,Od(p),y)}function is(u){return u==null?[]:ld(u,kt(u))}function IE(u){return u==null?[]:ld(u,pn(u))}function NE(u,c,p){return p===t&&(p=c,c=t),p!==t&&(p=Jn(p),p=p===p?p:0),c!==t&&(c=Jn(c),c=c===c?c:0),uo(Jn(u),c,p)}function PE(u,c,p){return c=ri(c),p===t?(p=c,c=0):p=ri(p),u=Jn(u),zk(u,c,p)}function FE(u,c,p){if(p&&typeof p!="boolean"&&nn(u,c,p)&&(c=p=t),p===t&&(typeof c=="boolean"?(p=c,c=t):typeof u=="boolean"&&(p=u,u=t)),u===t&&c===t?(u=0,c=1):(u=ri(u),c===t?(c=u,u=0):c=ri(c)),u>c){var y=u;u=c,c=y}if(p||u%1||c%1){var w=F0();return Wt(u+w*(c-u+hw("1e-"+((w+"").length-1))),c)}return Ed(u,c)}var RE=ts(function(u,c,p){return c=c.toLowerCase(),u+(p?fg(c):c)});function fg(u){return Zd(He(u).toLowerCase())}function hg(u){return u=He(u),u&&u.replace(B2,_w).replace(rw,"")}function LE(u,c,p){u=He(u),c=An(c);var y=u.length;p=p===t?y:uo(ke(p),0,y);var w=p;return p-=c.length,p>=0&&u.slice(p,w)==c}function BE(u){return u=He(u),u&&Js.test(u)?u.replace(Ys,Aw):u}function $E(u){return u=He(u),u&&C2.test(u)?u.replace(jc,"\\$&"):u}var zE=ts(function(u,c,p){return u+(p?"-":"")+c.toLowerCase()}),HE=ts(function(u,c,p){return u+(p?" ":"")+c.toLowerCase()}),qE=gm("toLowerCase");function VE(u,c,p){u=He(u),c=ke(c);var y=c?Go(u):0;if(!c||y>=c)return u;var w=(c-y)/2;return Zu($u(w),p)+u+Zu(Bu(w),p)}function WE(u,c,p){u=He(u),c=ke(c);var y=c?Go(u):0;return c&&y<c?u+Zu(c-y,p):u}function UE(u,c,p){u=He(u),c=ke(c);var y=c?Go(u):0;return c&&y<c?Zu(c-y,p)+u:u}function KE(u,c,p){return p||c==null?c=0:c&&(c=+c),Qw(He(u).replace(Gc,""),c||0)}function jE(u,c,p){return(p?nn(u,c,p):c===t)?c=1:c=ke(c),_d(He(u),c)}function GE(){var u=arguments,c=He(u[0]);return u.length<3?c:c.replace(u[1],u[2])}var XE=ts(function(u,c,p){return u+(p?"_":"")+c.toLowerCase()});function YE(u,c,p){return p&&typeof p!="number"&&nn(u,c,p)&&(c=p=t),p=p===t?Je:p>>>0,p?(u=He(u),u&&(typeof c=="string"||c!=null&&!Xd(c))&&(c=An(c),!c&&jo(u))?Ai(cr(u),0,p):u.split(c,p)):[]}var JE=ts(function(u,c,p){return u+(p?" ":"")+Zd(c)});function ZE(u,c,p){return u=He(u),p=p==null?0:uo(ke(p),0,u.length),c=An(c),u.slice(p,p+c.length)==c}function QE(u,c,p){var y=k.templateSettings;p&&nn(u,c,p)&&(c=t),u=He(u),c=cl({},c,y,Sm);var w=cl({},c.imports,y.imports,Sm),S=kt(w),T=ld(w,S),D,I,B=0,z=c.interpolate||Su,H="__p += '",G=dd((c.escape||Su).source+"|"+z.source+"|"+(z===ku?I2:Su).source+"|"+(c.evaluate||Su).source+"|$","g"),ne="//# sourceURL="+(Ve.call(c,"sourceURL")?(c.sourceURL+"").replace(/\s/g," "):"lodash.templateSources["+ ++uw+"]")+`
`;u.replace(G,function(le,Ie,Fe,Dn,rn,Mn){return Fe||(Fe=Dn),H+=u.slice(B,Mn).replace($2,Tw),Ie&&(D=!0,H+=`' +
__e(`+Ie+`) +
'`),rn&&(I=!0,H+=`';
`+rn+`;
__p += '`),Fe&&(H+=`' +
((__t = (`+Fe+`)) == null ? '' : __t) +
'`),B=Mn+le.length,le}),H+=`';
`;var ue=Ve.call(c,"variable")&&c.variable;if(!ue)H=`with (obj) {
`+H+`
}
`;else if(M2.test(ue))throw new ge(a);H=(I?H.replace(Pe,""):H).replace(Mt,"$1").replace(dn,"$1;"),H="function("+(ue||"obj")+`) {
`+(ue?"":`obj || (obj = {});
`)+"var __t, __p = ''"+(D?", __e = _.escape":"")+(I?`, __j = Array.prototype.join;
function print() { __p += __j.call(arguments, '') }
`:`;
`)+H+`return __p
}`;var _e=mg(function(){return Be(S,ne+"return "+H).apply(t,T)});if(_e.source=H,Gd(_e))throw _e;return _e}function e_(u){return He(u).toLowerCase()}function t_(u){return He(u).toUpperCase()}function n_(u,c,p){if(u=He(u),u&&(p||c===t))return C0(u);if(!u||!(c=An(c)))return u;var y=cr(u),w=cr(c),S=E0(y,w),T=_0(y,w)+1;return Ai(y,S,T).join("")}function r_(u,c,p){if(u=He(u),u&&(p||c===t))return u.slice(0,T0(u)+1);if(!u||!(c=An(c)))return u;var y=cr(u),w=_0(y,cr(c))+1;return Ai(y,0,w).join("")}function i_(u,c,p){if(u=He(u),u&&(p||c===t))return u.replace(Gc,"");if(!u||!(c=An(c)))return u;var y=cr(u),w=E0(y,cr(c));return Ai(y,w).join("")}function o_(u,c){var p=Q,y=oe;if(tt(c)){var w="separator"in c?c.separator:w;p="length"in c?ke(c.length):p,y="omission"in c?An(c.omission):y}u=He(u);var S=u.length;if(jo(u)){var T=cr(u);S=T.length}if(p>=S)return u;var D=p-Go(y);if(D<1)return y;var I=T?Ai(T,0,D).join(""):u.slice(0,D);if(w===t)return I+y;if(T&&(D+=I.length-D),Xd(w)){if(u.slice(D).search(w)){var B,z=I;for(w.global||(w=dd(w.source,He(Kp.exec(w))+"g")),w.lastIndex=0;B=w.exec(z);)var H=B.index;I=I.slice(0,H===t?D:H)}}else if(u.indexOf(An(w),D)!=D){var G=I.lastIndexOf(w);G>-1&&(I=I.slice(0,G))}return I+y}function s_(u){return u=He(u),u&&Xr.test(u)?u.replace(Gr,Fw):u}var a_=ts(function(u,c,p){return u+(p?" ":"")+c.toUpperCase()}),Zd=gm("toUpperCase");function pg(u,c,p){return u=He(u),c=p?t:c,c===t?Mw(u)?Bw(u):ww(u):u.match(c)||[]}var mg=Te(function(u,c){try{return En(u,t,c)}catch(p){return Gd(p)?p:new ge(p)}}),u_=ei(function(u,c){return Un(c,function(p){p=Dr(p),Zr(u,p,Kd(u[p],u))}),u});function l_(u){var c=u==null?0:u.length,p=ie();return u=c?Ze(u,function(y){if(typeof y[1]!="function")throw new Kn(s);return[p(y[0]),y[1]]}):[],Te(function(y){for(var w=-1;++w<c;){var S=u[w];if(En(S[0],this,y))return En(S[1],this,y)}})}function c_(u){return Fk(Gn(u,h))}function Qd(u){return function(){return u}}function d_(u,c){return u==null||u!==u?c:u}var f_=ym(),h_=ym(!0);function mn(u){return u}function ef(u){return G0(typeof u=="function"?u:Gn(u,h))}function p_(u){return Y0(Gn(u,h))}function m_(u,c){return J0(u,Gn(c,h))}var g_=Te(function(u,c){return function(p){return aa(p,u,c)}}),b_=Te(function(u,c){return function(p){return aa(u,p,c)}});function tf(u,c,p){var y=kt(c),w=Uu(c,y);p==null&&!(tt(c)&&(w.length||!y.length))&&(p=c,c=u,u=this,w=Uu(c,kt(c)));var S=!(tt(p)&&"chain"in p)||!!p.chain,T=ni(u);return Un(w,function(D){var I=c[D];u[D]=I,T&&(u.prototype[D]=function(){var B=this.__chain__;if(S||B){var z=u(this.__wrapped__),H=z.__actions__=fn(this.__actions__);return H.push({func:I,args:arguments,thisArg:u}),z.__chain__=B,z}return I.apply(u,wi([this.value()],arguments))})}),u}function y_(){return Ot._===this&&(Ot._=Ww),this}function nf(){}function v_(u){return u=ke(u),Te(function(c){return Z0(c,u)})}var x_=Nd(Ze),w_=Nd(v0),k_=Nd(id);function gg(u){return zd(u)?od(Dr(u)):Zk(u)}function S_(u){return function(c){return u==null?t:lo(u,c)}}var C_=xm(),E_=xm(!0);function rf(){return[]}function of(){return!1}function __(){return{}}function A_(){return""}function T_(){return!0}function D_(u,c){if(u=ke(u),u<1||u>Oe)return[];var p=Je,y=Wt(u,Je);c=ie(c),u-=Je;for(var w=ud(y,c);++p<u;)c(p);return w}function M_(u){return xe(u)?Ze(u,Dr):Tn(u)?[u]:fn(Rm(He(u)))}function O_(u){var c=++qw;return He(u)+c}var I_=Ju(function(u,c){return u+c},0),N_=Pd("ceil"),P_=Ju(function(u,c){return u/c},1),F_=Pd("floor");function R_(u){return u&&u.length?Wu(u,mn,vd):t}function L_(u,c){return u&&u.length?Wu(u,ie(c,2),vd):t}function B_(u){return k0(u,mn)}function $_(u,c){return k0(u,ie(c,2))}function z_(u){return u&&u.length?Wu(u,mn,Sd):t}function H_(u,c){return u&&u.length?Wu(u,ie(c,2),Sd):t}var q_=Ju(function(u,c){return u*c},1),V_=Pd("round"),W_=Ju(function(u,c){return u-c},0);function U_(u){return u&&u.length?ad(u,mn):0}function K_(u,c){return u&&u.length?ad(u,ie(c,2)):0}return k.after=pC,k.ary=jm,k.assign=tE,k.assignIn=ag,k.assignInWith=cl,k.assignWith=nE,k.at=rE,k.before=Gm,k.bind=Kd,k.bindAll=u_,k.bindKey=Xm,k.castArray=_C,k.chain=Wm,k.chunk=FS,k.compact=RS,k.concat=LS,k.cond=l_,k.conforms=c_,k.constant=Qd,k.countBy=U3,k.create=iE,k.curry=Ym,k.curryRight=Jm,k.debounce=Zm,k.defaults=oE,k.defaultsDeep=sE,k.defer=mC,k.delay=gC,k.difference=BS,k.differenceBy=$S,k.differenceWith=zS,k.drop=HS,k.dropRight=qS,k.dropRightWhile=VS,k.dropWhile=WS,k.fill=US,k.filter=j3,k.flatMap=Y3,k.flatMapDeep=J3,k.flatMapDepth=Z3,k.flatten=zm,k.flattenDeep=KS,k.flattenDepth=jS,k.flip=bC,k.flow=f_,k.flowRight=h_,k.fromPairs=GS,k.functions=hE,k.functionsIn=pE,k.groupBy=Q3,k.initial=YS,k.intersection=JS,k.intersectionBy=ZS,k.intersectionWith=QS,k.invert=gE,k.invertBy=bE,k.invokeMap=tC,k.iteratee=ef,k.keyBy=nC,k.keys=kt,k.keysIn=pn,k.map=il,k.mapKeys=vE,k.mapValues=xE,k.matches=p_,k.matchesProperty=m_,k.memoize=sl,k.merge=wE,k.mergeWith=ug,k.method=g_,k.methodOf=b_,k.mixin=tf,k.negate=al,k.nthArg=v_,k.omit=kE,k.omitBy=SE,k.once=yC,k.orderBy=rC,k.over=x_,k.overArgs=vC,k.overEvery=w_,k.overSome=k_,k.partial=jd,k.partialRight=Qm,k.partition=iC,k.pick=CE,k.pickBy=lg,k.property=gg,k.propertyOf=S_,k.pull=r3,k.pullAll=qm,k.pullAllBy=i3,k.pullAllWith=o3,k.pullAt=s3,k.range=C_,k.rangeRight=E_,k.rearg=xC,k.reject=aC,k.remove=a3,k.rest=wC,k.reverse=Wd,k.sampleSize=lC,k.set=_E,k.setWith=AE,k.shuffle=cC,k.slice=u3,k.sortBy=hC,k.sortedUniq=m3,k.sortedUniqBy=g3,k.split=YE,k.spread=kC,k.tail=b3,k.take=y3,k.takeRight=v3,k.takeRightWhile=x3,k.takeWhile=w3,k.tap=R3,k.throttle=SC,k.thru=rl,k.toArray=ig,k.toPairs=cg,k.toPairsIn=dg,k.toPath=M_,k.toPlainObject=sg,k.transform=TE,k.unary=CC,k.union=k3,k.unionBy=S3,k.unionWith=C3,k.uniq=E3,k.uniqBy=_3,k.uniqWith=A3,k.unset=DE,k.unzip=Ud,k.unzipWith=Vm,k.update=ME,k.updateWith=OE,k.values=is,k.valuesIn=IE,k.without=T3,k.words=pg,k.wrap=EC,k.xor=D3,k.xorBy=M3,k.xorWith=O3,k.zip=I3,k.zipObject=N3,k.zipObjectDeep=P3,k.zipWith=F3,k.entries=cg,k.entriesIn=dg,k.extend=ag,k.extendWith=cl,tf(k,k),k.add=I_,k.attempt=mg,k.camelCase=RE,k.capitalize=fg,k.ceil=N_,k.clamp=NE,k.clone=AC,k.cloneDeep=DC,k.cloneDeepWith=MC,k.cloneWith=TC,k.conformsTo=OC,k.deburr=hg,k.defaultTo=d_,k.divide=P_,k.endsWith=LE,k.eq=fr,k.escape=BE,k.escapeRegExp=$E,k.every=K3,k.find=G3,k.findIndex=Bm,k.findKey=aE,k.findLast=X3,k.findLastIndex=$m,k.findLastKey=uE,k.floor=F_,k.forEach=Um,k.forEachRight=Km,k.forIn=lE,k.forInRight=cE,k.forOwn=dE,k.forOwnRight=fE,k.get=Yd,k.gt=IC,k.gte=NC,k.has=mE,k.hasIn=Jd,k.head=Hm,k.identity=mn,k.includes=eC,k.indexOf=XS,k.inRange=PE,k.invoke=yE,k.isArguments=ho,k.isArray=xe,k.isArrayBuffer=PC,k.isArrayLike=hn,k.isArrayLikeObject=ut,k.isBoolean=FC,k.isBuffer=Ti,k.isDate=RC,k.isElement=LC,k.isEmpty=BC,k.isEqual=$C,k.isEqualWith=zC,k.isError=Gd,k.isFinite=HC,k.isFunction=ni,k.isInteger=eg,k.isLength=ul,k.isMap=tg,k.isMatch=qC,k.isMatchWith=VC,k.isNaN=WC,k.isNative=UC,k.isNil=jC,k.isNull=KC,k.isNumber=ng,k.isObject=tt,k.isObjectLike=it,k.isPlainObject=ha,k.isRegExp=Xd,k.isSafeInteger=GC,k.isSet=rg,k.isString=ll,k.isSymbol=Tn,k.isTypedArray=rs,k.isUndefined=XC,k.isWeakMap=YC,k.isWeakSet=JC,k.join=e3,k.kebabCase=zE,k.last=Yn,k.lastIndexOf=t3,k.lowerCase=HE,k.lowerFirst=qE,k.lt=ZC,k.lte=QC,k.max=R_,k.maxBy=L_,k.mean=B_,k.meanBy=$_,k.min=z_,k.minBy=H_,k.stubArray=rf,k.stubFalse=of,k.stubObject=__,k.stubString=A_,k.stubTrue=T_,k.multiply=q_,k.nth=n3,k.noConflict=y_,k.noop=nf,k.now=ol,k.pad=VE,k.padEnd=WE,k.padStart=UE,k.parseInt=KE,k.random=FE,k.reduce=oC,k.reduceRight=sC,k.repeat=jE,k.replace=GE,k.result=EE,k.round=V_,k.runInContext=O,k.sample=uC,k.size=dC,k.snakeCase=XE,k.some=fC,k.sortedIndex=l3,k.sortedIndexBy=c3,k.sortedIndexOf=d3,k.sortedLastIndex=f3,k.sortedLastIndexBy=h3,k.sortedLastIndexOf=p3,k.startCase=JE,k.startsWith=ZE,k.subtract=W_,k.sum=U_,k.sumBy=K_,k.template=QE,k.times=D_,k.toFinite=ri,k.toInteger=ke,k.toLength=og,k.toLower=e_,k.toNumber=Jn,k.toSafeInteger=eE,k.toString=He,k.toUpper=t_,k.trim=n_,k.trimEnd=r_,k.trimStart=i_,k.truncate=o_,k.unescape=s_,k.uniqueId=O_,k.upperCase=a_,k.upperFirst=Zd,k.each=Um,k.eachRight=Km,k.first=Hm,tf(k,function(){var u={};return Ar(k,function(c,p){Ve.call(k.prototype,p)||(u[p]=c)}),u}(),{chain:!1}),k.VERSION=r,Un(["bind","bindKey","curry","curryRight","partial","partialRight"],function(u){k[u].placeholder=k}),Un(["drop","take"],function(u,c){Ne.prototype[u]=function(p){p=p===t?1:vt(ke(p),0);var y=this.__filtered__&&!c?new Ne(this):this.clone();return y.__filtered__?y.__takeCount__=Wt(p,y.__takeCount__):y.__views__.push({size:Wt(p,Je),type:u+(y.__dir__<0?"Right":"")}),y},Ne.prototype[u+"Right"]=function(p){return this.reverse()[u](p).reverse()}}),Un(["filter","map","takeWhile"],function(u,c){var p=c+1,y=p==Ee||p==he;Ne.prototype[u]=function(w){var S=this.clone();return S.__iteratees__.push({iteratee:ie(w,3),type:p}),S.__filtered__=S.__filtered__||y,S}}),Un(["head","last"],function(u,c){var p="take"+(c?"Right":"");Ne.prototype[u]=function(){return this[p](1).value()[0]}}),Un(["initial","tail"],function(u,c){var p="drop"+(c?"":"Right");Ne.prototype[u]=function(){return this.__filtered__?new Ne(this):this[p](1)}}),Ne.prototype.compact=function(){return this.filter(mn)},Ne.prototype.find=function(u){return this.filter(u).head()},Ne.prototype.findLast=function(u){return this.reverse().find(u)},Ne.prototype.invokeMap=Te(function(u,c){return typeof u=="function"?new Ne(this):this.map(function(p){return aa(p,u,c)})}),Ne.prototype.reject=function(u){return this.filter(al(ie(u)))},Ne.prototype.slice=function(u,c){u=ke(u);var p=this;return p.__filtered__&&(u>0||c<0)?new Ne(p):(u<0?p=p.takeRight(-u):u&&(p=p.drop(u)),c!==t&&(c=ke(c),p=c<0?p.dropRight(-c):p.take(c-u)),p)},Ne.prototype.takeRightWhile=function(u){return this.reverse().takeWhile(u).reverse()},Ne.prototype.toArray=function(){return this.take(Je)},Ar(Ne.prototype,function(u,c){var p=/^(?:filter|find|map|reject)|While$/.test(c),y=/^(?:head|last)$/.test(c),w=k[y?"take"+(c=="last"?"Right":""):c],S=y||/^find/.test(c);w&&(k.prototype[c]=function(){var T=this.__wrapped__,D=y?[1]:arguments,I=T instanceof Ne,B=D[0],z=I||xe(T),H=function(Ie){var Fe=w.apply(k,wi([Ie],D));return y&&G?Fe[0]:Fe};z&&p&&typeof B=="function"&&B.length!=1&&(I=z=!1);var G=this.__chain__,ne=!!this.__actions__.length,ue=S&&!G,_e=I&&!ne;if(!S&&z){T=_e?T:new Ne(this);var le=u.apply(T,D);return le.__actions__.push({func:rl,args:[H],thisArg:t}),new jn(le,G)}return ue&&_e?u.apply(this,D):(le=this.thru(H),ue?y?le.value()[0]:le.value():le)})}),Un(["pop","push","shift","sort","splice","unshift"],function(u){var c=Du[u],p=/^(?:push|sort|unshift)$/.test(u)?"tap":"thru",y=/^(?:pop|shift)$/.test(u);k.prototype[u]=function(){var w=arguments;if(y&&!this.__chain__){var S=this.value();return c.apply(xe(S)?S:[],w)}return this[p](function(T){return c.apply(xe(T)?T:[],w)})}}),Ar(Ne.prototype,function(u,c){var p=k[c];if(p){var y=p.name+"";Ve.call(Zo,y)||(Zo[y]=[]),Zo[y].push({name:c,func:p})}}),Zo[Yu(t,E).name]=[{name:"wrapper",func:t}],Ne.prototype.clone=sk,Ne.prototype.reverse=ak,Ne.prototype.value=uk,k.prototype.at=L3,k.prototype.chain=B3,k.prototype.commit=$3,k.prototype.next=z3,k.prototype.plant=q3,k.prototype.reverse=V3,k.prototype.toJSON=k.prototype.valueOf=k.prototype.value=W3,k.prototype.first=k.prototype.head,ea&&(k.prototype[ea]=H3),k},Xo=$w();io?((io.exports=Xo)._=Xo,ed._=Xo):Ot._=Xo}).call(F6)}(Aa,Aa.exports)),Aa.exports}var Fn=R6();const L6=({assetsUrl:n=""})=>({stage:null,layer:null,selectionTransformer:null,stageInitiated:!1,activePanel:null,showWelcomeScreen:!0,layersSearchString:"",layersSortable:null,selectedGroupChildNodes:[],selectionColors:{fill:"hsla(205,90%,48%,0.15)",stroke:"hsl(205,90%,48%)"},fetchedAssets:[],prevViews:[],currentView:"home",currentDocId:null,currentDocName:null,updatingName:null,aiTasksQueue:[],activeTool:null,activeFillTab:"color",editingTextNode:null,editingTextarea:null,container:null,konvajsContent:null,containerDimensions:{x:0,y:0,width:0,height:0},konvajsContentDimensions:{x:0,y:0,width:0,height:0},selectedFont:"",fontsSearchString:"",newItems:[],lqdFontPreview:[],googleFontsList:[],showingGoogleFonts:[],fontsPaginationCurrent:20,fontsPaginationLimit:20,loadingFontPreviewQueue:[],adaptiveResize:!0,prevStageWidth:null,prevStageHeight:null,busy:!1,maxZoom:200,minZoom:20,zoomOffsetX:0,zoomOffsetY:0,zoomLevel:100,isSpacePressed:!1,isPanning:!1,reachedMinZoom:!1,reachedMaxZoom:!1,activeTooltipDropdown:null,guidelineOffset:5,placeholderImage:`${n}/img/misc/placeholder-1.jpg`,templatesList:[],loadingTemplates:!0,loadingTemplatesFailed:!1,promptLibraryShow:!1,promptFilter:"all",searchPromptStr:"",prompt:"",history:[],historyPointer:-1,maxHistoryLength:30,historyListeners:["fill","fillLinearGradientStartPoint","fillLinearGradientStartPointX","fillLinearGradientStartPointY","fillLinearGradientEndPoint","fillLinearGradientEndPointX","fillLinearGradientEndPointY","fillLinearGradientColorStops","fillRadialGradientStartPoint","fillRadialGradientStartPointX","fillRadialGradientStartPointY","fillRadialGradientEndPoint","fillRadialGradientEndPointX","fillRadialGradientEndPointY","fillRadialGradientStartRadius","fillRadialGradientEndRadius","fillRadialGradientColorStops","stroke","strokeWidth","lineJoin","lineCap","shadowColor","shadowBlur","shadowOffset","shadowOffsetX","shadowOffsetY","shadowOpacity","shadowEnabled","dash","x","y","width","height","opacity","scale","scaleX","scaleY","rotation","offset","offsetX","offsetY","fontFamily","fontSize","fontStyle","fontVariant","textDecoration","text","align","verticalAlign","padding","lineHeight","wrap","ellipsis","image","crop","blurRadius","skew","skewX","skewY","sides","numPoints","innerRadius","outerRadius","angle"],get creativeSuite(){return this.$data},get nodes(){var e;return((e=this.layer)==null?void 0:e.getChildren(t=>{const r=t.name(),i=t.getType();return(i==="Shape"||i==="Group")&&!["lqd-cs-guide-line","lqd-cs-highlighter","lqd-cs-selection-transformer","lqd-cs-selection-rectangle"].includes(r)}))??[]},get selectedNodes(){var e;return((e=this.selectionTransformer)==null?void 0:e.nodes())??[]},set selectedNodes(e={nodes:[],ids:[],event:{}}){let t=e.nodes||[],r=e.ids||[],i=e.event||{},o=i.metaKey||i.ctrlKey,s=i.shiftKey;if(r.length&&!t.length&&(t=this.nodes.filter(a=>r.includes(a.id()))),t==="all"&&(t=this.nodes),s){let a=[...this.selectedNodes];t.forEach(l=>{const d=a.findIndex(f=>f.id()===l.id());d!==-1?a.splice(d,1):a.push(l)}),t=a.filter(l=>!l.findAncestors("Group").some(h=>h.getChildren(m=>m.id()===l.id())))}o||t.forEach(a=>{const l=a.findAncestors("Group"),d=l.length;l.forEach((f,h)=>{d>1&&h===0||!t.find(m=>m.id()===f.id())&&!this.selectedGroupChildNodes.find(m=>m.id()===a.id())&&(t.push(f),t=t.filter(m=>m.id()!==a.id()))})}),this.selectedGroupChildNodes.forEach(a=>{const d=a.findAncestors("Group").some(m=>t.some(g=>g.id()===m.id())),h=t.filter(m=>m.getClassName()==="Group").find(m=>m.findOne(`#${a.id()}`));(!t.find(m=>m.id()===a.id())||d||h)&&(a.draggable(!1),this.selectedGroupChildNodes=this.selectedGroupChildNodes.filter(m=>m.id()!==a.id()))}),t=t.filter(a=>!a.getAttr("locked")),this.selectionTransformer.nodes(t),this.selectionTransformer.zIndex(this.nodes.length+1),this.$dispatch("nodes-selected",{nodes:this.selectedNodes,nodesCount:this.selectedNodes.length,selectedNodesRect:this.selectedNodesRect})},get selectedNodesRect(){return this.selectedNodes.length?this.selectionTransformer.getClientRect():{x:0,y:0}},get selectedNodesProps(){const e=this.selectedNodes;if(!e.length)return{};const t=e[0],r=e.find(g=>g.getClassName()==="Rect"),i=e.find(g=>g.getClassName()==="Image"),o=e.find(g=>g.getClassName()==="RegularPolygon"),s=e.find(g=>g.getClassName()==="Star"),a=e.find(g=>g.getClassName()==="Ring"),l=e.find(g=>g.getClassName()==="Arc"),d=e.find(g=>g.getClassName()==="Wedge"),f=e.find(g=>g.getClassName()==="Text"),h=e.find(g=>g.getClassName()==="TextPath"),m={x:t.x(),y:t.y(),rotation:t.rotation(),width:t.width(),height:t.height(),opacity:t.opacity(),fill:t.fill(),fillPatternX:t.fillPatternX()??0,fillPatternY:t.fillPatternY()??0,fillPatternScaleX:t.fillPatternScaleX()??0,fillPatternScaleY:t.fillPatternScaleY()??0,fillPatternRepeat:t.fillPatternRepeat(),cornerRadius:((r==null?void 0:r.cornerRadius())||(i==null?void 0:i.cornerRadius()))??0,sides:(o==null?void 0:o.sides())??0,numPoints:(s==null?void 0:s.numPoints())??0,innerRadius:((s==null?void 0:s.innerRadius())||(a==null?void 0:a.innerRadius())||(l==null?void 0:l.innerRadius()))??0,outerRadius:((s==null?void 0:s.outerRadius())||(a==null?void 0:a.outerRadius())||(l==null?void 0:l.outerRadius()))??0,angle:((l==null?void 0:l.angle())||(d==null?void 0:d.angle()))??0,fontFamily:((f==null?void 0:f.fontFamily())||(h==null?void 0:h.fontFamily()))??"",fontSize:((f==null?void 0:f.fontSize())||(h==null?void 0:h.fontSize()))??0,fontStyle:((f==null?void 0:f.fontStyle())||(h==null?void 0:h.fontStyle()))??"normal 400",textDecoration:((f==null?void 0:f.textDecoration())||(h==null?void 0:h.textDecoration()))??"",lineHeight:f==null?void 0:f.lineHeight(),letterSpacing:((f==null?void 0:f.letterSpacing())||(h==null?void 0:h.letterSpacing()))??0,align:((f==null?void 0:f.align())||(h==null?void 0:h.align()))??"",stroke:t.stroke()??"",strokeWidth:t.strokeWidth()??0,dash:t.dash()??0,blurRadius:t.blurRadius()??null,skewX:t.skewX()??null,skewY:t.skewY()??null,globalCompositeOperation:t.globalCompositeOperation()??null};return Object.fromEntries(Object.entries(m).map(([g,b])=>{const x=e.every(E=>this.isPropertyNotApplicableToNodeType(g,E.getClassName())?!0:E[g]()===b)?this.formatPropertyValue(g,b):magicai_localize.mixed;return[g,x]}))},set selectedNodesProps(e={x:null,y:null,rotation:null,width:null,height:null,scaleX:null,scaleY:null,opacity:null,fill:null,fillPatternX:null,fillPatternY:null,fillPatternScaleX:null,fillPatternScaleY:null,fillPatternRepeat:null,cornerRadius:null,sides:null,numPoints:null,innerRadius:null,outerRadius:null,angle:null,fontFamily:null,fontSize:null,fontStyle:null,textDecoration:null,lineHeight:null,letterSpacing:null,align:null,stroke:null,strokeWidth:null,dash:null,blurRadius:null,skewX:null,skewY:null,globalCompositeOperation:null,useRelativeValue:!1}){const t=this.selectedNodes.length>1||e.useRelativeValue,r=["x","y","rotation","width","height","scaleX","scaleY","opacity","fill","fillPatternX","fillPatternY","fillPatternScaleX","fillPatternScaleY","fillPatternRepeat","cornerRadius","sides","numPoints","innerRadius","outerRadius","angle","fontFamily","fontSize","fontStyle","textDecoration","lineHeight","letterSpacing","align","stroke","strokeWidth","dash","blurRadius","skewX","skewY","globalCompositeOperation"];this.selectedNodes.forEach(i=>{const o=i.getClassName();r.forEach(s=>{if(e[s]==null||this.isPropertyNotApplicableToNodeType(s,o))return;const a=i[s==="fontWeight"?"fontStyle":s](),l=!isNaN(parseInt(a)),d=l&&e[s]==="flip"?a*-1:e[s],f=l?parseFloat(d):d;let h=l&&t?a+f:f;if(s==="fontStyle"){const m=(a??"").split(" ");let g=m[0]??"normal",b=m[1]??"400";isNaN(parseInt(e[s]))?g=e[s]:b=e[s],h=`${g} ${b}`}if(s==="rotation"&&["Rect","Text","TextPath","Image"].includes(o)){let m=(h%360+360)%360;m>180&&(m-=360),h=m;const{x:g,y:b,rotation:v}=this.rotateNodeAroundCenter(i,h);i.rotation(v),i.x(g),i.y(b);return}switch(s){case"width":case"height":case"cornerRadius":case"innerRadius":case"outerRadius":h=Math.max(0,h);break;case"sides":case"numPoints":h=Math.max(3,h);break;case"angle":h=Math.max(0,Math.min(360,h));break;case"opacity":h=Math.max(0,Math.min(1,h));break}i[s](h)})})},init(){this.googleFontsList=window.lqdGoogleFontsList,this.beforeUnloadHandler=this.beforeUnloadHandler.bind(this),this.positionTooltip=this.positionTooltip.bind(this),this.handleEditinTextareaOutsideClick=this.handleEditinTextareaOutsideClick.bind(this),this.removeEditingTextarea=this.removeEditingTextarea.bind(this),this.setEditingTextareaTextAndRemove=this.setEditingTextareaTextAndRemove.bind(this),this.addToHistory=Fn.debounce(this.addToHistory.bind(this),250,{leading:!1,trailing:!0}),this.loadGoogleFontPreview=Fn.throttle(this.loadGoogleFontPreview.bind(this),300,{leading:!1}),this.resizeStage=Fn.throttle(this.resizeStage.bind(this),50),this.onWindowResize=Fn.throttle(this.onWindowResize.bind(this),250),this.showingGoogleFonts=this.googleFontsList.slice(0,this.fontsPaginationLimit),this.$watch("selectedFont",e=>{this.$dispatch("font-selected",{font:e})}),this.$watch("nodes.length",e=>{this.beforeUnloadListened||(e>0?this.addBeforeUnloadListener():this.removeBeforeUnloadListener())}),this.$watch("[zoomLevel, zoomOffsetX, zoomOffsetY]",()=>{this.positionTooltip(),this.positionEditingTextarea(),this.updateSelectionTransformerStroke()}),this.$watch("currentView",e=>{document.body.classList.toggle("overflow-hidden",["editor","gallery"].includes(e))}),this.initiateStage()},initiateStage(e={width:720,height:720}){const t=this.isMobile(),r=e.width??720,i=e.height??720;if(this.$refs.editorCanvasContainer===null){console.error("Creative Suite canvas was not found");return}if(this.stageInitiated||this.stage){console.warn("Creative Suite canvas was already initiated");return}this.stage=new Konva.Stage({container:this.$refs.editorCanvasContainer,width:r,height:i,name:"lqd-cs-stage",draggable:!1}),this.selectionTransformer=new Konva.Transformer({keepRatio:!1,borderStroke:this.selectionColors.stroke,anchorSize:t?10:6,rotationSnaps:[0,45,90,135,180,225,270,315,360],rotationSnapTolerance:5,rotateAnchorOffset:t?50:30,ignoreStroke:!0,flipEnabled:!1,id:"lqd-cs-selection-transformer",name:"lqd-cs-selection-transformer"}),this.selectionRectangle=new Konva.Rect({fill:this.selectionColors.fill,stroke:this.selectionColors.stroke,strokeWidth:1,visible:!1,id:"lqd-cs-selection-rectangle",name:"lqd-cs-selection-rectangle"}),this.layer=new Konva.Layer({name:"lqd-cs-layer-main"}),this.layer.add(this.selectionTransformer),this.layer.add(this.selectionRectangle),this.stage.add(this.layer),this.container=this.stage.container(),this.konvajsContent=this.container.querySelector(".konvajs-content"),this.container.tabIndex=1,this.container.focus(),this.setContainerDimensions(),this.selectionTransformerEvents(),this.handleSelectionRectangle(),this.initLayers(),this.stageEvents(),this.containerEvents(),this.handlePanAndZoom(),this.initNodesSnap(),this.positionTooltip(),this.handleWindowResize(),this.stageInitiated=!0},setContainerDimensions(){this.containerDimensions={x:this.container.offsetLeft,y:this.container.offsetTop,width:this.container.clientWidth,height:this.container.offsetHeight},this.konvajsContentDimensions={x:this.konvajsContent.offsetLeft,y:this.konvajsContent.offsetTop,width:this.konvajsContent.clientWidth,height:this.konvajsContent.offsetHeight}},handleSelectionRectangle(){let e,t,r,i,o=this.layer.getChildren().length;function s(a){if(!(!this.selectionRectangle.visible()||this.isPanning||this.isSpacePressed)){Fn.defer(()=>{this.selectionRectangle.visible(!1)});var l=this.selectionRectangle.getClientRect(),d=this.nodes.filter(f=>Konva.Util.haveIntersection(l,f.getClientRect()));this.selectedNodes={nodes:d,event:a}}}this.stage.on("mousedown",a=>{var d;if(this.isPanning||this.isSpacePressed||((d=a.touches)==null?void 0:d.length)>=2)return;const l=a.target;l._id===this.stage._id?(o=this.layer.getChildren().length,e=this.stage.getPointerPosition().x,t=this.stage.getPointerPosition().y,r=this.stage.getPointerPosition().x,i=this.stage.getPointerPosition().y,this.selectionRectangle.setAttrs({x:e,y:t,width:0,height:0,visible:!0,zIndex:o-1})):this.nodes.find(f=>f.id()===l.id())&&!this.selectedNodes.find(f=>f.id()===l.id())&&(this.selectedNodes={nodes:[l],event:a.evt})}),this.stage.on("mousemove",a=>{var l;!this.selectionRectangle.visible()||this.isPanning||this.isSpacePressed||((l=a.touches)==null?void 0:l.length)>=2||(r=this.stage.getPointerPosition().x,i=this.stage.getPointerPosition().y,this.selectionRectangle.setAttrs({x:Math.min(e,r),y:Math.min(t,i),width:Math.abs(r-e),height:Math.abs(i-t),zIndex:o-1}))}),window.addEventListener("mouseup",s.bind(this)),this.stage.on("dblclick dbltap",a=>{let l=a.target;if(l._id===this.stage._id)return;const d=l.findAncestors("Group");d.length&&(d.length>1&&(l=d[0]),l.draggable(!0),this.selectedGroupChildNodes.push(l),this.selectedNodes={nodes:[l],event:a.evt})}),this.stage.on("click tap",a=>{const l=a.target;if(!(a.evt.shiftKey||this.selectionRectangle.visible()&&this.selectionRectangle.width()>0&&this.selectionRectangle.height()>0)){if(l._id===this.stage._id){this.selectedNodes.length&&(this.selectedNodes={});return}this.selectedNodes={nodes:[l],event:a.evt}}}),this.container.addEventListener("keydown",a=>{const l=a.key;if(!l||this.editingTextNode)return;const d=a.ctrlKey||a.metaKey,f=a.shiftKey;let h=1;switch(d&&(h=.1),f&&(h=10),l){case"Backspace":a.preventDefault(),this.destroySelectedNodes();break;case"ArrowUp":a.preventDefault(),this.selectedNodesProps={y:-h,useRelativeValue:!0},this.positionTooltip();break;case"ArrowDown":a.preventDefault(),this.selectedNodesProps={y:h,useRelativeValue:!0},this.positionTooltip();break;case"ArrowLeft":a.preventDefault(),this.selectedNodesProps={x:-h,useRelativeValue:!0},this.positionTooltip();break;case"ArrowRight":a.preventDefault(),this.selectedNodesProps={x:h,useRelativeValue:!0},this.positionTooltip();break;case"a":a.preventDefault(),d&&(this.selectedNodes={nodes:"all"});break}}),this.konvajsContent.addEventListener("dragover",a=>{a.preventDefault()}),this.konvajsContent.addEventListener("drop",a=>{a.preventDefault(),this.stage.setPointersPositions(a);const l=JSON.parse(a.dataTransfer.getData("data")??"{}");if(!l.type)return;let{x:d,y:f}=this.stage.getPointerPosition();const h=this.addNodeToStage({type:l.type,attrs:{...l.attrs},beforeAdd:m=>{const g=m.getClassName(),b=g==="Rect"||g==="Path",v=m.getClientRect();m.setAttrs({x:d-(b?v.width/2:0),y:f-(b?v.height/2:0)})}});this.selectedNodes={nodes:[h]}})},stageEvents(){this.stage.on("click tap",()=>{this.setActiveTooltipDropdown(null)}),this.stage.on("dragmove",e=>{const t=e.target;if(t.name()==="lqd-cs-stage"){t.x(0),t.y(0);return}}),this.stage.on("widthChange heightChange",this.addToHistory)},containerEvents(){const e=t=>{t.target===this.container&&this.selectedNodes.length&&(this.selectedNodes={})};this.container.addEventListener("click",e.bind(this)),this.container.addEventListener("tap",e.bind(this)),this.container.addEventListener("keydown",t=>{(t.ctrlKey||t.metaKey)&&t.key==="z"&&!t.shiftKey&&(t.preventDefault(),this.undo()),((t.ctrlKey||t.metaKey)&&t.shiftKey&&t.key==="z"||(t.ctrlKey||t.metaKey)&&t.key==="y")&&(t.preventDefault(),this.redo())})},selectionTransformerEvents(){function e(r,i,o){const s=r.getClassName();if(["Rect","Image","Text"].includes(s))r.width(r.width()*i),r.height(r.height()*o),r.scaleX(1),r.scaleY(1);else if(s==="Circle"||s==="RegularPolygon"){const a=r.radius(),l=(i+o)/2;r.radius(a*l),r.scaleX(1),r.scaleY(1)}else s==="Ellipse"&&(r.radiusX(r.radiusX()*i),r.radiusY(r.radiusY()*o),r.scaleX(1),r.scaleY(1))}function t(r,i,o){r.getChildren().forEach(s=>{const a=s.getClassName(),{x:l,y:d}=s.position();if(s.position({x:l*i,y:d*o}),a==="Group"){const f=s.scaleX()*i,h=s.scaleY()*o;s.scaleX(1),s.scaleY(1),t(s,f,h)}else e(s,i*s.scaleX(),o*s.scaleY())})}this.selectionTransformer.on("transform",()=>{this.selectedNodes.forEach(i=>{const o=i.getClassName(),s=i.scaleX(),a=i.scaleY();if(o==="Group"){i.scaleX(1),i.scaleY(1),t(i,s,a);return}e(i,s,a)})})},createNode(e={type:null,attrs:{}}){var a;if(!this.stageInitiated)return;if(!Konva[e.type]){console.error(`Konva does not support the type "${e.type}"`);return}const t=this.generateNameByType(e.type),r=this.stage.width(),i=this.stage.height(),o={x:r/2,y:i/2,fill:Konva.Util.getRandomColor(),stroke:"",strokeWidth:0,draggable:!0,strokeScaleEnabled:!1,text:((a=e.attrs)==null?void 0:a.text)||magicai_localize.double_click_to_edit,fontSize:30,fontStyle:"normal 400",id:`${t.toLowerCase().replace(/\s+/g,"-")}-${Date.now()}`,name:t,perfectDrawEnabled:!1,offset:{x:0,y:0},...e.attrs},s=new Konva[e.type](o);return o.x==="left"&&s.x(0),o.x==="center"&&s.x((r-s.width())/2),o.x==="right"&&s.x(r-s.width()),o.y==="top"&&s.y(0),o.y==="middle"&&s.y((i-s.height())/2),o.y==="bottom"&&s.y(i-s.height()),e.type==="Group"&&this.addGroupHighlighter(s),["Text","TextPath"].includes(e.type)&&this.handleTextEdit(s),e.type==="Image"&&(o.fillSource?this.fetchedAssets.includes(o.fillSource)||o.fillSource===this.placeholderImage?this.setNodeFillPattern({node:s,url:o.fillSource}):this.handleUploadImage(s,o.fillSource):this.setNodeFillPattern({node:s,url:this.placeholderImage})),s.on("heightChange widthChange innerRadiusChange outerRadiusChange radiusChange radiusXChange radiusYChange",()=>{this.handleFillCover(s)}),s.on(this.historyListeners.map(l=>l+="Change").join(" "),this.addToHistory),s},addNodeToStage(e={type:"Ellipse",attrs:{},beforeAdd:null,node:null,addHistory:!0}){if(!this.stageInitiated)return;const t=e.node||this.createNode(e),r=e.addHistory??!0;return e.beforeAdd&&typeof e.beforeAdd=="function"&&e.beforeAdd.call(this,t),this.showWelcomeScreen=!1,this.layer.add(t),this.selectedNodes={nodes:[t]},r&&this.addToHistory(),t},addGroupHighlighter(e){const t=new Konva.Transformer({id:`highlighter-${e.id()}`,name:"lqd-cs-highlighter",enabledAnchors:[],rotateEnabled:!1,borderStroke:this.selectionColors.stroke,draggable:!1});e.setAttr("highlighter",t.id()),this.layer.add(t)},handleHighlighterVisibility(e){let t="",r="",i=e;e.on("mouseover",o=>{const s=o.evt.ctrlKey||o.evt.metaKey,l=e.findAncestors("Group").at(-1);if(!s&&l&&(i=l),i.getType()==="Group"&&s)return;const d=this.layer.findOne(`#highlighter-${i.id()}`),f=this.selectedNodes.find(h=>h.id()===i.id());t=e.stroke(),r=e.strokeWidth(),f||(d&&d.nodes([i]),i.stroke(this.selectionColors.stroke),i.strokeWidth(r??2))}),e.on("mouseout",()=>{const o=i.getAttr("highlighter");o&&this.layer.findOne(`#${o}`).nodes([]),i.stroke(t),i.strokeWidth(r),i=e})},applyFilters(e,t){t.blurRadius?(e.clearCache(),e.cache(),e.filters([Konva.Filters.Blur])):!t.blurRadius&&!e.blurRadius()&&e.isCached()&&e.clearCache()},handleTextEdit(e){e.off("dblclick.editText dbltap.editText"),e.on("dblclick.editText dbltap.editText",()=>{if(e.getAttr("aiTaskInProgress"))return toastr.warn("An AI task is in progress. please wait until it's done.");e.hide(),this.selectionTransformer.hide(),this.editingTextarea=document.createElement("textarea"),this.container.insertAdjacentElement("afterend",this.editingTextarea),this.editingTextarea.classList.add("absolute","border-none","p-0","m-0","overflow-hidden","bg-transparent","outline-none","resize-none","whitespace-pre","origin-top-left","placeholder:text-transparent"),this.editingTextNode=e;const t=e.fontStyle().split(" "),r=this.editingTextNode.text();let i=t[0],o=t[1];isNaN(parseInt(i))||(i=null,o=i),this.editingTextarea.style.fontFamily=e.fontFamily(),this.editingTextarea.style.textAlign=e.align(),this.editingTextarea.style.color=e.fill().toString(),this.editingTextarea.style.transformOrigin="top left",this.editingTextarea.style.textDecoration=e.textDecoration(),this.editingTextarea.value=e.text(),this.editingTextarea.placeholder=this.editingTextarea.value,i&&(this.editingTextarea.style.fontStyle=i),o&&(this.editingTextarea.style.fontWeight=o),this.editingTextarea.focus(),this.editingTextarea.select(),this.positionEditingTextarea(),this.editingTextarea.addEventListener("keydown",s=>{if(this.editingTextarea){if(s.key==="Enter"&&!s.shiftKey){this.setEditingTextareaTextAndRemove();return}if(s.key==="Escape"){this.setEditingTextareaTextAndRemove(r);return}this.editingTextarea.placeholder=this.editingTextarea.value,this.editingTextarea.style.height="auto",this.editingTextarea.style.height=this.editingTextarea.scrollHeight+e.fontSize()+"px"}}),this.$nextTick(()=>{this.editingTextarea.addEventListener("focusout",this.setEditingTextareaTextAndRemove),window.addEventListener("click",this.handleEditinTextareaOutsideClick),window.addEventListener("tap",this.handleEditinTextareaOutsideClick)})}),e.on("fontFamilyChange fontSizeChange fontStyleChange textDecorationChange lineHeightChange letterSpacingChange",({newVal:t,type:r})=>{if(t==null||r==null||!this.editingTextarea)return;const i=r.replace("Change","");let o=t;(i==="letterSpacing"||i==="fontSize")&&(o+="px"),this.editingTextarea.style[i]=o})},handleEditinTextareaOutsideClick(e){this.editingTextNode&&e.target!==this.editingTextarea&&this.setEditingTextareaTextAndRemove(this.editingTextarea.value)},removeEditingTextarea(){var e;!this.editingTextNode||!this.editingTextarea||(this.editingTextarea.removeEventListener("focusout",this.setEditingTextareaTextAndRemove),(e=this.editingTextarea)==null||e.remove(),window.removeEventListener("click",this.handleEditinTextareaOutsideClick),window.removeEventListener("tap",this.handleEditinTextareaOutsideClick),this.editingTextNode.show(),this.selectionTransformer.show(),this.selectionTransformer.forceUpdate(),this.editingTextNode=null,this.editingTextarea=null)},setEditingTextareaTextAndRemove(e){var t;!this.editingTextarea||!this.editingTextNode||(typeof e!="string"&&(e=((t=this.editingTextarea)==null?void 0:t.value)??""),this.editingTextNode.text(e),this.removeEditingTextarea())},positionEditingTextarea(){if(!this.editingTextNode)return;const e=this.editingTextNode.getClientRect(),t=this.zoomLevel/100,r={x:e.x*t,y:e.y*t},i=this.konvajsContent.getBoundingClientRect(),o=this.editingTextNode.rotation(),a=this.editingTextNode.getClassName()==="TextPath",l=this.isMobile()?16:10;a&&(r.x+=e.width/2*t,r.y+=e.height/2*t),this.editingTextarea.style.width="auto",this.editingTextarea.style.height="auto",this.editingTextarea.style.top=Math.max(0,i.top+r.y)+"px",this.editingTextarea.style.left=Math.max(0,i.left+r.x)+"px",this.editingTextarea.style.fontSize=Math.max(l,this.editingTextNode.fontSize()*t)+"px",this.editingTextarea.style.letterSpacing=this.editingTextNode.letterSpacing()*t+"px",this.editingTextarea.style.lineHeight=a?"1.2":this.editingTextNode.lineHeight().toString(),this.$nextTick(()=>{this.editingTextarea.style.width=(a?this.stage.width():this.editingTextNode.width())*t+"px",this.editingTextarea.style.height=this.editingTextarea.scrollHeight+this.editingTextNode.fontSize()*this.editingTextNode.lineHeight()+"px"}),o&&!a&&(this.editingTextarea.style.transform=`rotate(${o}deg)`)},updateSelectionTransformerStroke(){const t=100/this.zoomLevel,r=1*Math.min(3,Math.max(.5,t)),o=6*Math.min(3,Math.max(.5,t));this.selectionTransformer.borderStrokeWidth(r),this.selectionTransformer.anchorSize(o)},getNodesFromOptions(e={ids:[],nodes:[],id:null,node:null}){var r,i,o;let t=[];return(r=e.nodes)!=null&&r.length?e.nodes==="all"?t=this.nodes:t=e.nodes:(i=e.ids)!=null&&i.length?t=this.nodes.filter(s=>e.ids.includes(s.id())):e.id?t=[this.nodes.find(s=>s.id()===e.id)]:e.node&&(this.nodes.find(s=>{var a;return s.id()===((a=e.node)==null?void 0:a.id())})?t=[e.node]:console.warn("Could not find the node: ",((o=e.node)==null?void 0:o.id())??"Unknown node ID")),t},deselectNodes(e){const t=this.getNodesFromOptions(e).map(r=>r.id());this.selectedNodes={nodes:this.selectedNodes.filter(r=>!t.includes(r.id()))}},removeNodes(e){const t=this.getNodesFromOptions(e);this.deselectNodes({nodes:t}),t.forEach(r=>r.remove())},destroyNodes(e){const t=this.getNodesFromOptions(e);this.deselectNodes({nodes:t}),t.forEach(r=>r.destroy()),this.nodes.length||(this.showWelcomeScreen=!0)},destroySelectedNodes(){this.destroyNodes({nodes:this.selectedNodes})},cloneSelectedNodes(){const e=this.selectedNodes.map(t=>{const r=this.generateNameByType(t.getClassName());return t.clone({x:t.x()+20,y:t.y()+20,name:r,id:`${r.toLowerCase().replace(/\s+/g,"-")}-${Date.now()}`})});e.filter(t=>["Text","TextPath"].includes(t.getClassName())).forEach(t=>this.handleTextEdit(t)),this.layer.add(...e),this.selectedNodes={nodes:e}},groupSelectedNodes(){const e=this.selectedNodes;if(!e.length)return;this.generateNameByType("Group");const t=this.addNodeToStage({type:"Group",attrs:{x:0,y:0,width:null,height:null,fill:null,draggable:!0}});e.forEach(r=>{t.add(r),r.draggable(!1)}),this.layer.add(t),this.addGroupHighlighter(t),this.selectedNodes={nodes:[t]}},ungroupSelectedNodes(){const e=this.selectedNodes;if(!e.length)return;e.filter(r=>r.getType()==="Group").forEach(r=>{const i=r.getChildren(),o=r.findAncestors("Group"),s=o==null?void 0:o.at(0),a=r.id(),l=r.getAttr("highlighter"),d=[];i.forEach(f=>{f.findAncestors("Group").length<=1&&d.push(f)}),d.forEach(f=>{const h=f.getAbsolutePosition(s??this.stage),m=f.rotation(),g=r.rotation(),b=(m+g)%360;f.moveTo(s??this.layer),f.position(h),f.rotation(b),f.draggable(!s)}),this.destroyNodes({ids:[a,l]}),this.selectedNodes={nodes:d}})},getNodesByType(e){return e?this.nodes.filter(t=>t.getClassName()===e):[]},generateNameByType(e){var o;if(!e)return"Node 0";const t=this.getNodesByType(e),r=t.length;return`${((o=t[0])==null?void 0:o.getClassName())||e} ${r+1}`},moveNode(e){this.selectedNodes.forEach(t=>t[e]())},initLayers(){const t=(navigator.userAgentData?navigator.userAgentData.platform.includes("macOS"):navigator.platform.includes("Mac"))?"Meta":"Control";this.layersSortable=ce.create(this.$refs.layers,{multiDrag:!0,selectedClass:"selected",multiDragKey:t,animation:150,draggable:".lqd-cs-layer",filter:".lqd-cs-layers-list-template",onSelect:r=>{const i=r.originalEvent.target,o=r.items.map(s=>s.dataset.id);this.selectedNodes={ids:o},this.elementIsFocusable(i)||this.$nextTick(()=>{this.container.focus()})},onEnd:()=>{const r=[...this.nodes],i=this.selectedNodes,o=this.layersSortable.toArray();r.sort((s,a)=>{const l=o.indexOf(s.id());return o.indexOf(a.id())-l}),Fn.defer(()=>this.removeNodes({nodes:"all"})),Fn.defer(()=>{this.layer.add(...r),this.selectedNodes={nodes:i}})}})},alignSelectedNodes(e){const t=this.selectedNodes;if(t.length===1){const i=t[0],o=i.getClientRect(),s=this.stage.width(),a=this.stage.height(),l=i.x(),d=i.y();switch(e){case"left":i.x(l-o.x);break;case"center":i.x(l-o.x+(s-o.width)/2);break;case"right":i.x(l-o.x+s-o.width);break;case"top":i.y(d-o.y);break;case"middle":i.y(d-o.y+(a-o.height)/2);break;case"bottom":i.y(d-o.y+a-o.height);break}return}const r=t.reduce((i,o)=>{const s=o.getClientRect();return{left:Math.min(i.left,s.x),right:Math.max(i.right,s.x+s.width),top:Math.min(i.top,s.y),bottom:Math.max(i.bottom,s.y+s.height),centerX:(i.left+i.right)/2,centerY:(i.top+i.bottom)/2}},{left:1/0,right:-1/0,top:1/0,bottom:-1/0,centerX:0,centerY:0});r.centerX=(r.left+r.right)/2,r.centerY=(r.top+r.bottom)/2,t.forEach(i=>{const o=i.getClientRect(),s=i.x(),a=i.y();switch(e){case"left":i.x(s-(o.x-r.left));break;case"center":i.x(s+(r.centerX-(o.x+o.width/2)));break;case"right":i.x(s+(r.right-(o.x+o.width)));break;case"top":i.y(a-(o.y-r.top));break;case"middle":i.y(a+(r.centerY-(o.y+o.height/2)));break;case"bottom":i.y(a+(r.bottom-(o.y+o.height)));break}})},rotatePoint({x:e,y:t},r){const i=Math.cos(r),o=Math.sin(r);return{x:e*i-t*o,y:t*i+e*o}},rotateNodeAroundCenter(e,t){const r={x:-e.width()/2,y:-e.height()/2},i=this.rotatePoint(r,Konva.getAngle(e.rotation())),o=this.rotatePoint(r,Konva.getAngle(t)),s=o.x-i.x,a=o.y-i.y,l=e.x()+s,d=e.y()+a;return{rotation:t,x:l,y:d}},isPropertyNotApplicableToNodeType(e,t){return e==="cornerRadius"&&!["Rect","Image"].includes(t)||e==="sides"&&t!=="RegularPolygon"||e==="numPoints"&&t!=="Star"||e==="innerRadius"&&!["Star","Ring","Arc"].includes(t)||e==="outerRadius"&&!["Star","Ring","Arc"].includes(t)||e==="angle"&&!["Arc","Wedge"].includes(t)||["fontSize","fontFamily","fontSize","fontStyle","fontWeight","textDecoration","letterSpacing","align"].includes(e)&&!["Text","TextPath"].includes(t)||e==="lineHeight"&&t!=="Text"},formatPropertyValue(e,t){return typeof t=="number"?e==="opacity"?t.toFixed(2):Number.isInteger(t)?t:t.toFixed(1):e==="fontStyle"&&t==="normal"?400:t},handleFillCover(e){e.getAttr("fillCover")&&this.applyFillCover(e)},async handleUploadImage(e,t){if(t)return fetch(t).then(i=>i.blob()).then(async i=>{const o=new File([i],"image",{type:i.type}),s=await this.uploadImage({file:o,node:e});await this.setNodeFillPattern({node:e,url:s.url})}).catch(i=>{toastr.error("Failed to load image"),console.error("Error creating file from URL:",i)});const r=document.createElement("input");r.type="file",r.accept="image/*",r.style.display="none",document.body.appendChild(r),r.addEventListener("cancel",async i=>{!i.target.files[0]&&!e.fillPatternImage()&&this.destroyNodes({nodes:[e]})}),r.addEventListener("change",async i=>{const o=await this.uploadImage({event:i,node:e});await this.setNodeFillPattern({node:e,url:o.url}),this.activeFillTab="image",this.$nextTick(()=>{document.body.removeChild(r)})}),r.click()},async uploadImage({node:e,event:t,file:r}){if(t&&!r&&(r=t.target.files[0]),!r||!e)return;if(!r.type.startsWith("image/")){toastr.error("Please upload a valid image file");return}const i=new FormData;return i.append("image",r),(await(await fetch("/dashboard/user/creative-suite/image/upload",{method:"POST",body:i,headers:{Accept:"application/json"}})).json()).data},async setNodeFillPattern({node:e,url:t,setSize:r=!0}){const i=new Image;return new Promise((o,s)=>{i.onload=()=>{e.fillPatternImage(i),e.fillPriority("pattern"),e.setAttr("fillImageWidth",i.naturalWidth),e.setAttr("fillImageHeight",i.naturalHeight),e.setAttr("fillSource",i.src),e.setAttr("fillCover",!0),this.applyFillCover(e),o(i),this.fetchedAssets.includes(t)||this.fetchedAssets.push(t)},i.onerror=function(a){s(a)},i.src=t})},removeFillPattern(){const e=this.selectedNodes[0];e.fillPatternImage(null),e.fillPriority("color"),this.$refs.selectedNodeFillPatternInput&&(this.$refs.selectedNodeFillPatternInput.value=""),e.setAttr("fillImageWidth",null),e.setAttr("fillImageHeight",null),e.setAttr("fillSource",null),e.setAttr("fillCover",null),e.setAttr("fillAlign",null)},getFillCoverProps(e){const t=e.getAttr("fillAlign")??"center-middle",r=e.getClassName(),i=e.getClientRect(),o=e.getAttr("fillImageWidth")??i.width,s=e.getAttr("fillImageHeight")??i.height;let a,l,d=!1;r==="Circle"?a=l=e.radius()*2:r==="Ellipse"?(a=e.radiusX()*2,l=e.radiusY()*2):["Rect","Image","Text"].includes(r)?(a=e.width(),l=e.height()):(a=i.width,l=i.height,d=!0);const f=o/s,h=a/l;let m,g;h>=f?(m=a/o,g=a/f/s):(m=l*f/o,g=l/s);const b=o*m,v=s*g;let x=0,E=0;return d||!["Rect","Image","Text"].includes(r)?(t.includes("left")?x=-a/2:t.includes("center")?x=-b/2:t.includes("right")&&(x=-b+a/2),t.includes("top")?E=-l/2:t.includes("middle")?E=-v/2:t.includes("bottom")&&(E=-v+l/2)):(t.includes("left")?x=0:t.includes("center")?x=(a-b)/2:t.includes("right")&&(x=a-b),t.includes("top")?E=0:t.includes("middle")?E=(l-v)/2:t.includes("bottom")&&(E=l-v)),r==="Path"&&d&&(x+=i.x,E+=i.y),{offsetX:x,offsetY:E,scaleX:m,scaleY:g}},applyFillCover(e){if(e=e??this.selectedNodes[0],!e)return;e.setAttr("fillPatternRepeat","no-repeat");const t=this.getFillCoverProps(e);e.setAttrs({fillPatternX:t.offsetX,fillPatternY:t.offsetY,fillPatternScaleX:t.scaleX,fillPatternScaleY:t.scaleY})},onFontsSearchInput(){const e=this.$event.target.value.trim();if(!e){this.fontsPaginationCurrent=this.fontsPaginationLimit,this.showingGoogleFonts=this.googleFontsList.slice(0,this.fontsPaginationLimit);return}this.showingGoogleFonts=this.googleFontsList.filter(t=>t.toLowerCase().includes(e.toLowerCase()))},loadMoreFonts(){this.fontsPaginationCurrent+=this.fontsPaginationLimit,this.showingGoogleFonts=this.googleFontsList.slice(0,this.fontsPaginationCurrent)},addToGoogleFontLoadQueue(e,t=!1){if(!(t&&this.lqdFontPreview.includes(e))){if(!t)return this.loadGoogleFontFull(e);this.loadingFontPreviewQueue.push(e),this.loadGoogleFontPreview(e),this.lqdFontPreview.push(e)}},loadGoogleFontPreview(){if(!this.loadingFontPreviewQueue.length)return;const e=this.loadingFontPreviewQueue.map(i=>`family=${i}`).join("&").replaceAll(" ","+"),t=encodeURIComponent(this.loadingFontPreviewQueue.join("")),r=`https://fonts.googleapis.com/css2?${e}&display=swap&text=${t}`;this.createFontLink(r),this.loadingFontPreviewQueue=[]},async loadGoogleFontFull(e){const t=`https://fonts.googleapis.com/css2?family=${e.replaceAll(/ /g,"+")}:wght@400;500;600;700;800;900&display=swap`;this.createFontLink(t),document.fonts.ready.finally(()=>{this.selectedNodes.find(r=>["Text","TextPath"].includes(r.getClassName()))&&this.selectionTransformer.forceUpdate()})},createFontLink(e){const t=document.createElement("link");t.href=e,t.rel="stylesheet",t.type="text/css",document.head.appendChild(t)},handleStageResize({width:e,height:t,preserveAspectRatio:r=!1}){if(e==null&&t==null)return;const i=parseInt(this.stage.width(),10),o=parseInt(this.stage.height(),10);let s=e??i,a=t??o;if(r&&i&&o){const l=i/o;if(e&&!t)a=s/l;else if(!e&&t)s=a*l;else if(e&&t){const d=s/a;d>l?s=a*l:d<l&&(a=s/l)}}this.prevStageWidth=i,this.prevStageHeight=o,this.resizeStage(s,a)},resizeStage(e,t){this.stage.width(e),this.stage.height(t),this.container.style.width=e+"px",this.container.style.height=t+"px";const r=e/(this.prevStageWidth??1),i=t/(this.prevStageHeight??1);if(this.adaptiveResize&&this.prevStageWidth>0&&this.prevStageHeight>0){const s=e>this.prevStageWidth||t>this.prevStageHeight?Math.max(r,i):Math.min(r,i);this.nodes.forEach(a=>{a.x(a.x()*r),a.y(a.y()*i);const l=a.getClassName();if(a.width&&a.height){const d=a.width(),f=a.height();a.width(d*s),a.height(f*s)}if(l==="Circle"&&a.radius(a.radius()*s),l==="Ellipse"){const d=a.radiusX(),f=a.radiusY();a.radiusX(d*s),a.radiusY(f*s)}l==="RegularPolygon"&&a.radius(a.radius()*s),l==="Star"&&(a.innerRadius(a.innerRadius()*s),a.outerRadius(a.outerRadius()*s)),(l==="Text"||l==="TextPath")&&a.fontSize(a.fontSize()*s),a.fillPatternImage&&a.fillPatternScaleX&&a.fillPatternScaleY&&(a.fillPatternScaleX(a.fillPatternScaleX()*s),a.fillPatternScaleY(a.fillPatternScaleY()*s))}),Fn.defer(()=>{this.selectionTransformer.forceUpdate(),this.fitToScreen(),this.setContainerDimensions()})}},switchView(e){if(!(this.editingTextNode||this.tool)){if(e==="<"){this.currentView=this.prevViews.pop()||"home";return}this.prevViews.push(this.currentView),this.currentView=e||"home"}},getZoomPadding(){const e=getComputedStyle(this.$el),t=15,r=parseInt(e.getPropertyValue("--sidebar-w")??0,10)+t,i=parseInt(e.getPropertyValue("--header-h")??0,10)+t;return{x:r,y:i}},getFitToScreenZoom(){const e=this.getZoomPadding(),t=(this.container.clientWidth-e.x)/(this.konvajsContent.clientWidth*(this.zoomLevel/100)),r=(this.container.clientHeight-e.y)/(this.konvajsContent.clientHeight*(this.zoomLevel/100)),i=Math.min(t,r)*100;return Math.max(this.minZoom,Math.min(this.maxZoom,i))},setZoomLevel(e){this.zoomLevel=Math.max(this.minZoom,Math.min(this.maxZoom,e)),this.reachedMinZoom=this.zoomLevel===this.minZoom,this.reachedMaxZoom=this.zoomLevel>=this.maxZoom},zoomIn(){this.setZoomLevel(this.zoomLevel+10)},zoomOut(){this.setZoomLevel(this.zoomLevel-10)},fitToScreen(){const e=this.getFitToScreenZoom();this.setZoomLevel(e);const t=this.getZoomPadding();this.zoomOffsetX=t.x/2,this.zoomOffsetY=t.y/2},positionTooltip(){if(!this.selectedNodes.length)return;const e=this.konvajsContent.getBoundingClientRect(),t=this.selectedNodesRect,r=this.zoomLevel/100,i=e.left+t.x*r+t.width*r/2,o=e.top+t.y*r-40,a=this.$refs.tooltip.getBoundingClientRect().height,l=Math.max(e.left,Math.min(i,e.right)),d=Math.max(e.top-a/2,Math.min(o,e.bottom-a/2));this._tooltipAnimationFrame||(this._tooltipAnimationFrame=requestAnimationFrame(()=>{this.$refs.tooltip.style.left=`${l}px`,this.$refs.tooltip.style.top=`${d}px`,this._tooltipAnimationFrame=null}))},handlePanAndZoom(){let e={x:0,y:0},t=0,r={x:0,y:0},i={x:0,y:0},o={x:0,y:0};const s=x=>{if(this.showWelcomeScreen)return;x.preventDefault();const E=this.konvajsContent.getBoundingClientRect(),A=x.clientX-E.left,M=x.clientY-E.top;if(x.metaKey||x.ctrlKey){const P=(x.deltaY<0?1:-1)*2,N=Math.max(this.minZoom,Math.min(this.maxZoom,this.zoomLevel+P)),W=N/this.zoomLevel;this.setZoomLevel(N);const V={x:E.width/2,y:E.height/2},U={x:(A-V.x)/this.zoomLevel,y:(M-V.y)/this.zoomLevel};this.zoomOffsetX-=U.x*(W-1),this.zoomOffsetY-=U.y*(W-1)}else{const C=this.zoomLevel/15;this.zoomOffsetX-=x.deltaX/C,this.zoomOffsetY-=x.deltaY/C}},a=x=>{this.docActiveElementIsWritable()||x.code==="Space"&&!x.repeat&&!this.isSpacePressed&&!this.showWelcomeScreen&&(this.isSpacePressed=!0,document.body.classList.add("is-panning"),this.container.classList.add("is-panning"),document.activeElement&&document.activeElement!==document.body&&document.activeElement.blur(),this.container.focus(),x.preventDefault())},l=x=>{this.docActiveElementIsWritable()||x.code==="Space"&&(this.isSpacePressed=!1,this.isPanning=!1,document.body.classList.remove("is-panning","is-panning-active"),this.container.classList.remove("is-panning","is-panning-active"))},d=x=>{this.docActiveElementIsWritable()||this.isSpacePressed&&x.button===0&&!this.showWelcomeScreen&&(this.isPanning=!0,e={x:x.clientX,y:x.clientY},document.body.classList.add("is-panning-active"),this.container.classList.add("is-panning-active"),document.activeElement&&document.activeElement!==document.body&&document.activeElement.blur(),this.container.focus(),x.stopPropagation(),x.preventDefault())},f=x=>{if(!this.docActiveElementIsWritable()&&this.isPanning){const E=x.clientX-e.x,A=x.clientY-e.y;e={x:x.clientX,y:x.clientY},this.zoomOffsetX+=E/(this.zoomLevel/15),this.zoomOffsetY+=A/(this.zoomLevel/15),x.preventDefault(),x.stopPropagation()}},h=()=>{this.docActiveElementIsWritable()||this.isPanning&&(this.isPanning=!1,document.body.classList.remove("is-panning-active"),this.container.classList.remove("is-panning-active"))},m=()=>{this.docActiveElementIsWritable()||this.isPanning&&(this.isPanning=!1,document.body.classList.remove("is-panning-active"),this.container.classList.remove("is-panning-active"))},g=x=>{const E=x.touches;if(this.showWelcomeScreen||E.length<2)return;const A=E[0],M=E[1];A&&M&&this.stage.stopDrag(!1),t=Math.hypot(M.clientX-A.clientX,M.clientY-A.clientY);const C=this.konvajsContent.getBoundingClientRect();r={x:(A.clientX+M.clientX)/2-C.left,y:(A.clientY+M.clientY)/2-C.top},i={x:(A.clientX+M.clientX)/2,y:(A.clientY+M.clientY)/2},o={x:this.zoomOffsetX,y:this.zoomOffsetY}},b=x=>{const E=x.touches;if(!(this.showWelcomeScreen||E.length<2)&&(x.preventDefault(),E.length===2)){const A=E[0],M=E[1];if(A&&M){const C={x:(A.clientX+M.clientX)/2,y:(A.clientY+M.clientY)/2},P=C.x-i.x,N=C.y-i.y;this.zoomOffsetX=o.x+P/(this.zoomLevel/15),this.zoomOffsetY=o.y+N/(this.zoomLevel/15);const W=Math.hypot(M.clientX-A.clientX,M.clientY-A.clientY),V=W/t;if(t>0&&V!==1){const U=this.konvajsContent.getBoundingClientRect(),Q={x:(A.clientX+M.clientX)/2-U.left,y:(A.clientY+M.clientY)/2-U.top},oe=Math.max(this.minZoom,Math.min(this.maxZoom,this.zoomLevel*V)),me=this.zoomLevel,Ee=oe/me;this.setZoomLevel(oe);const Me=U.width/2,he=U.height/2,we=(r.x-Me)/me,Oe=(r.y-he)/me;this.zoomOffsetX-=we*(Ee-1),this.zoomOffsetY-=Oe*(Ee-1),t=W,r=Q}}}},v=x=>{this.showWelcomeScreen||(t=0,r={x:0,y:0},this.stage.draggable(!0))};this.container.addEventListener("wheel",s,{passive:!1}),this.container.addEventListener("mousedown",d),this.container.addEventListener("touchstart",g),this.container.addEventListener("touchmove",b),this.container.addEventListener("touchend",v),this.container.addEventListener("touchcancel",v),document.addEventListener("keydown",a),document.addEventListener("keyup",l),document.addEventListener("mousemove",f),document.addEventListener("mouseup",h),document.addEventListener("mouseleave",m),window.addEventListener("resize",this.positionTooltip),this.selectionTransformer.on("transform",this.positionTooltip),document.addEventListener("nodes-selected",this.positionTooltip)},initNodesSnap(){let e=this.nodes,t=[];const r=()=>{var a=[0,this.stage.width()/2,this.stage.width()],l=[0,this.stage.height()/2,this.stage.height()];return e.forEach(d=>{if(!this.selectionTransformer.nodes().find(h=>h.id()===d.id())){var f=d.getClientRect();a.push([f.x,f.x+f.width,f.x+f.width/2]),l.push([f.y,f.y+f.height,f.y+f.height/2])}}),{vertical:a.flat(),horizontal:l.flat()}},i=()=>{const a=this.selectionTransformer.getClientRect(),l=this.selectionTransformer.absolutePosition();return a.height=a.height-this.selectionTransformer.rotateAnchorOffset(),a.y=a.y+this.selectionTransformer.rotateAnchorOffset(),{vertical:[{guide:Math.round(a.x),offset:Math.round(l.x-a.x),snap:"start"},{guide:Math.round(a.x+a.width/2),offset:Math.round(l.x-a.x-a.width/2),snap:"center"},{guide:Math.round(a.x+a.width),offset:Math.round(l.x-a.x-a.width),snap:"end"}],horizontal:[{guide:Math.round(a.y),offset:Math.round(l.y-a.y),snap:"start"},{guide:Math.round(a.y+a.height/2),offset:Math.round(l.y-a.y-a.height/2),snap:"center"},{guide:Math.round(a.y+a.height),offset:Math.round(l.y-a.y-a.height),snap:"end"}]}},o=(a,l)=>{var d=[],f=[];a.vertical.forEach(b=>{l.vertical.forEach(v=>{var x=Math.abs(b-v.guide);x<this.guidelineOffset&&d.push({lineGuide:b,diff:x,snap:v.snap,offset:v.offset})})}),a.horizontal.forEach(b=>{l.horizontal.forEach(v=>{var x=Math.abs(b-v.guide);x<this.guidelineOffset&&f.push({lineGuide:b,diff:x,snap:v.snap,offset:v.offset})})});var h=[],m=d.sort((b,v)=>b.diff-v.diff)[0],g=f.sort((b,v)=>b.diff-v.diff)[0];return m&&h.push({lineGuide:m.lineGuide,offset:m.offset,orientation:"V",snap:m.snap}),g&&h.push({lineGuide:g.lineGuide,offset:g.offset,orientation:"H",snap:g.snap}),h},s=a=>{a.forEach(l=>{const d=l.orientation==="H";var f=new Konva.Line({points:d?[-6e3,0,6e3,0]:[0,-6e3,0,6e3],stroke:this.selectionColors.stroke,strokeWidth:1,name:"lqd-cs-guide-line",dash:[4,6]});this.layer.add(f),f.absolutePosition({x:d?0:l.lineGuide,y:d?l.lineGuide:0})})};this.selectionTransformer.on("dragstart",()=>{e=this.nodes,t=[];const a=this.selectionTransformer.absolutePosition();this.selectedNodes.forEach(l=>{const d=l.absolutePosition();t.push({id:l.id(),xDiff:d.x-a.x,yDiff:d.y-a.y})})}),this.selectionTransformer.on("dragmove",a=>{this.layer.find(".lqd-cs-guide-line").forEach(m=>m.destroy());var l=r(),d=i(),f=o(l,d);if(!f.length){this.positionTooltip();return}s(f);const h={...this.selectionTransformer.absolutePosition()};f.forEach(m=>{switch(m.orientation){case"V":{h.x=m.lineGuide+m.offset;break}case"H":{h.y=m.lineGuide+m.offset;break}}}),this.selectionTransformer.absolutePosition(h),this.selectedNodes.forEach(m=>{const g=t.find(b=>b.id===m.id());g&&m.absolutePosition({x:h.x+g.xDiff,y:h.y+g.yDiff})}),this.positionTooltip()}),this.layer.on("dragend",()=>{this.layer.find(".lqd-cs-guide-line").forEach(a=>a.destroy())})},addToHistory(){this.history.length>this.maxHistoryLength-1&&this.history.shift(),this.historyPointer!==this.history.length-1&&(this.history=this.history.slice(0,this.historyPointer+1)),this.history.push({stage:{width:this.stage.width(),height:this.stage.height()},zoom:{zoomOffsetX:this.zoomOffsetX,zoomOffsetY:this.zoomOffsetY,zoomLevel:this.zoomLevel},nodes:this.nodes.map(e=>e.toJSON()),selectedNodeIds:this.selectedNodes.map(e=>e.id())}),this.historyPointer=Math.min(this.history.length-1,this.historyPointer+1)},undo(){this.historyPointer!==-1&&(this.historyPointer=Math.max(-1,this.historyPointer-1),this.applyHistory())},redo(){this.historyPointer!==this.history.length-1&&(this.historyPointer=Math.min(this.history.length-1,this.historyPointer+1),this.applyHistory())},applyHistory(){var o,s,a;if(this.historyPointer===-1)return this.destroyNodes({nodes:"all"});const e=this.history[this.historyPointer];if(!e)return;const t=this.stage.width(),r=this.stage.height();let i=!1;(o=e.stage)!=null&&o.width&&e.stage.width!==t&&(this.stage.width(e.stage.width),i=!0),(s=e.stage)!=null&&s.height&&e.stage.height!==r&&(this.stage.height(e.stage.height),i=!0),i&&e.zoom&&this.$nextTick(()=>{this.fitToScreen()}),this.destroyNodes({nodes:"all"}),(a=e.nodes)==null||a.forEach(l=>{try{const d=Konva.Node.create(l),f=d.getClassName(),h=d.getAttrs();this.addNodeToStage({type:f,attrs:h,addHistory:!1}),d.destroy(),e.selectedNodeIds&&(this.selectedNodes={ids:e.selectedNodeIds})}catch(d){console.error("Error creating node:",d)}})},downloadImage(){if(this.stage){this.busy=!0;try{const e=this.selectionTransformer.visible();this.selectionTransformer.visible(!1);const t=document.createElement("div");t.style.position="absolute",t.style.zIndex="-1",t.style.opacity="0",t.style.width=`${this.stage.width()}px`,t.style.height=`${this.stage.height()}px`,document.body.appendChild(t);const r=new Konva.Stage({container:t,width:this.stage.width(),height:this.stage.height(),background:"white"}),i=this.layer.clone();i.find("#lqd-cs-selection-transformer, #lqd-cs-selection-rectangle").forEach(o=>{o.remove()}),r.add(i),r.toDataURL({mimeType:"image/png",quality:1,pixelRatio:2,callback:o=>{const s=document.createElement("a");s.download=`canvas-export-${new Date().getTime()}.png`,s.href=o,document.body.appendChild(s),s.click(),document.body.removeChild(s),document.body.removeChild(t),r.destroy(),this.selectionTransformer.visible(e),this.busy=!1}})}catch(e){console.error("Error exporting image:",e),this.busy=!1,this.selectionTransformer.visible(!0)}}},resetCanvas(){this.nodes.length&&confirm(magicai_localize.all_your_current_edits_will_be_lost__are_you_sure_)&&(this.resetHistory(),this.destroyNodes({nodes:"all"}),this.fitToScreen(),this.currentDocId=null,this.currentDocName=null)},resetHistory(){this.history=[],this.historyPointer=-1},beforeUnloadHandler(e){if(this.nodes.length>0){const t=magicai_localize.you_have_unsaved_changes__are_you_sure_you_want_to_leave_;return e.preventDefault(),e.returnValue=t,t}},addBeforeUnloadListener(){this.beforeUnloadListened=!0,window.addEventListener("beforeunload",this.beforeUnloadHandler)},removeBeforeUnloadListener(){this.beforeUnloadListened=!1,window.removeEventListener("beforeunload",this.beforeUnloadHandler)},handleExport(){if(!(!this.stage||!this.nodes.length))try{const e=this.getExportData(),t="data:text/json;charset=utf-8,"+encodeURIComponent(JSON.stringify(e)),r=document.createElement("a");r.setAttribute("href",t),r.setAttribute("download",`canvas-export-${new Date().getTime()}.json`),document.body.appendChild(r),r.click(),r.remove(),toastr.success("Canvas exported successfully")}catch(e){console.error("Error exporting canvas:",e),toastr.error("Failed to export canvas")}},getExportData(){const e=this.nodes.map(t=>t.toJSON());return{name:this.currentDocName||"Untitled Document",stage:{width:this.stage.width(),height:this.stage.height()},nodes:e}},handleImport(){const e=document.createElement("input");e.type="file",e.accept=".json",e.style.display="none",e.addEventListener("change",t=>{const r=t.target.files[0];if(!r)return;const i=new FileReader;i.onload=o=>{try{const s=JSON.parse(o.target.result);this.importData({data:s}),this.currentView!=="editor"&&this.switchView("editor"),toastr.success("Canvas imported successfully")}catch(s){console.error("Error importing canvas:",s),toastr.error("Failed to import canvas")}},i.readAsText(r),e.remove()}),document.body.appendChild(e),e.click()},importData({data:e,docId:t=null,switchToEditor:r=!0}){if(!e.nodes||!Array.isArray(e.nodes))throw new Error("Invalid file format");(!this.nodes.length||this.nodes.length&&confirm(magicai_localize.all_your_current_edits_will_be_lost__are_you_sure_))&&(this.destroyNodes({nodes:"all"}),e.name&&(this.currentDocName=e.name),e.stage&&this.handleStageResize({width:e.stage.width,height:e.stage.height}),e.nodes.forEach(i=>{try{const o=Konva.Node.create(i),s=o.getClassName(),a=o.getAttrs();this.addNodeToStage({type:s,attrs:a,addHistory:!1,beforeAdd:l=>{a.fontFamily&&this.loadGoogleFontFull(a.fontFamily),s==="Group"&&o.getChildren().forEach(f=>{f.draggable(!1),l.add(f.clone())})}}),o.destroy()}catch(o){console.error("Error creating node:",o)}}),this.resetHistory(),this.currentDocId=t,r&&this.currentView!=="editor"&&this.switchView("editor"))},async loadTemplatesList(e){if(e==null)return;this.loadingTemplates=!0,this.loadingTemplatesFailed=!1;const r=await(await fetch(e)).json();if(this.loadingTemplates=!1,!(r instanceof Array)||!r.length){this.loadingTemplatesFailed=!0,toastr.error(magicai_localize.could_not_fetch_templates_list_please_try_again||"Could not fetch templates list. Please try again.");return}this.templatesList=r},loadTemplate(e){if(e==null)return;const t=this.templatesList.find(r=>r.id==e);if(!t)return toastr.error(magicai_localize.could_not_fetch_template_data_please_try_again||"Could not fetch template data. Please try again.");this.importData({data:t.data})},async saveDocument(){const e=this.getExportData(),t=new FormData,r=document.createElement("div");r.style.position="absolute",r.style.zIndex="-1",r.style.opacity="0",r.style.width=`${this.stage.width()}px`,r.style.height=`${this.stage.height()}px`,document.body.appendChild(r);const i=new Konva.Stage({container:r,width:this.stage.width(),height:this.stage.height(),background:"white"}),o=this.layer.clone();o.find("#lqd-cs-selection-transformer, #lqd-cs-selection-rectangle").forEach(a=>{a.remove()}),i.add(o);const s=await i.toBlob({mimeType:"image/png",quality:.7,pixelRatio:Math.min(2,Math.max(1,720/Math.min(720,i.width())))});document.body.removeChild(r),i.destroy(),t.append("payload",JSON.stringify(e)),t.append("preview",new File([s],"preview.png",{type:"image/png"})),this.currentDocId!=null&&t.append("id",this.currentDocId),this.currentDocName&&t.append("name",this.currentDocName);try{const a=await fetch("/dashboard/user/creative-suite/document",{method:"POST",body:t,headers:{Accept:"application/json"}});if(!a.ok)throw new Error(`HTTP error! status: ${a.status}`);const l=await a.json();if(l.status==="error"){toastr.error(l.message||magicai_localize.error_saving_document);return}if(l.data.id){const d=document.querySelectorAll(`.lqd-cs-doc-item[data-id="${l.data.id}"]`);this.currentDocId=l.data.id,d.length?d.forEach(f=>f.querySelector("img").src=l.data.preview_url):this.newItems.push(l.data)}this.removeBeforeUnloadListener(),toastr.success(magicai_localize.saved_succesfully)}catch(a){toastr.error("Upload failed:",a)}},async duplicateDocument(e){if(!e)return;const t=new FormData;t.append("id",e);try{const r=await fetch("/dashboard/user/creative-suite/document/duplicate",{method:"POST",body:t,headers:{Accept:"application/json"}});if(!r.ok)throw new Error(`HTTP error! status: ${r.status}`);const i=await r.json();if(i.status==="error"){toastr.error(i.message||magicai_localize.error_saving_document);return}i.data&&(document.querySelector(`.lqd-cs-doc-item[data-id="${i.data.id}"]`)||this.newItems.push(i.data),toastr.success(magicai_localize.duplicated_the_document_successfully))}catch(r){toastr.error("Upload failed:",r)}},async deleteDocument(e){var r;if(!e)return;const t=new FormData;t.append("id",e);try{const i=await fetch("/dashboard/user/creative-suite/document/delete",{method:"POST",body:t,headers:{Accept:"application/json"}});if(!i.ok)throw new Error(`HTTP error! status: ${i.status}`);const o=await i.json();if(o.status==="error"){toastr.error(o.message||magicai_localize.error_saving_document);return}o.status==="success"&&((r=document.querySelectorAll(`.lqd-cs-doc-item[data-id="${e}"]`))==null||r.forEach(s=>s.remove()),toastr.success(magicai_localize.document_deleted_successfully))}catch(i){toastr.error("Upload failed:",i)}},async loadDocument(e){if(e)try{const t=await fetch(`/dashboard/user/creative-suite/document/${e}`);if(!t.ok)throw new Error(`HTTP error! status: ${t.status}`);const r=await t.json();if(!r.data.payload)return;this.importData({data:JSON.parse(r.data.payload),docId:r.data.id}),this.currentDocName=r.data.name,this.$nextTick(()=>{this.positionTooltip()})}catch(t){console.error("Upload failed:",t)}},async updateDocumentName(e){const t=new FormData(e.target);if(t.get("id")){this.updatingName=!0;try{const r=await fetch("/dashboard/user/creative-suite/document/name",{method:"POST",body:t,headers:{Accept:"application/json"}});if(!r.ok)throw new Error(`HTTP error! status: ${r.status}`);const i=await r.json();if(i.status==="error"){toastr.error(responseData.message||magicai_localize.error_saving_document);return}document.querySelectorAll(`.lqd-cs-doc-item[data-id="${i.id}"]`).forEach(s=>{const a=s.querySelector("h5");a&&(a.innerText=i.name)}),toastr.success(magicai_localize.name_updated_successfully)}catch(r){toastr.error("Updating name failed:",r)}finally{this.updatingName=!1}}},handleWindowResize(){window.addEventListener("resize",this.onWindowResize)},onWindowResize(){this.setContainerDimensions()},setActiveTooltipDropdown(e){if(!e||this.activeTooltipDropdown===e)return this.activeTooltipDropdown=null;this.activeTooltipDropdown=e},elementIsFocusable(e,t=[]){if(!e||!(e instanceof HTMLElement))return;const r=["INPUT","BUTTON","TEXTAREA","SELECT","A"];return Fn.difference(r,t).includes(e.tagName)},docActiveElementIsWritable(){return document.activeElement&&["TEXTAREA","INPUT"].includes(document.activeElement.tagName)},async aiTextAction({prompt:e=""}){if(!e.trim())return;const t=this.selectedNodes.filter(r=>r.getClassName()==="Text");t.length&&t.forEach(async r=>{const i=`request-${r.id()}`,o=new FormData;o.append("lock_key",i),o.append("prompt",e),o.append("content",r.text()),this.aiTasksQueue.push(i),r.setAttr("aiTaskInProgress",!0);const s=await fetch("/dashboard/user/openai/update-writing",{method:"POST",body:o,headers:{Accept:"application/json"}});this.aiTasksQueue=this.aiTasksQueue.filter(l=>l===i),r.setAttr("aiTaskInProgress",!1);const a=await s.json();if(a.type==="error"){toastr.error(a.message);return}a.result&&r.text(a.result)})},async aiImageAction(e){const t=this.selectedNodes.filter(r=>r.getClassName()==="Image"||r.fillPatternImage());t.length&&t.forEach(async r=>{var m,g;const i=`request-${r.id()}`,o=new FormData(e.target),s=Math.min(720,r.width()),a=Math.min(720,r.getAttr("fillImageWidth")??720),l=await r.toBlob({pixelRatio:Math.min(2,Math.max(1,a/s))}),d=new File([l],"image",{type:l.type});o.append("lock_key",i),o.append("uploaded_image",d),this.aiTasksQueue.push(i),r.setAttr("aiTaskInProgress",!0);const f=await fetch(e.target.action,{method:"POST",body:o,headers:{Accept:"application/json"}});if(this.aiTasksQueue=this.aiTasksQueue.filter(b=>b===i),r.setAttr("aiTaskInProgress",!1),!f.ok)return f.json().then(b=>{toastr.error(b.message||"An unknown error occurred")});const h=await f.json();if(h.type==="error"){toastr.error(h.message);return}((m=h==null?void 0:h.data)==null?void 0:m.status)==="CREATED"||((g=h==null?void 0:h.data)==null?void 0:g.status)==="IN_PROGRESS"?this.getAIImageStatus(h.data,r,i):this.onAIImageProcessDone(h.data,r,i)})},async getAIImageStatus(e={},t,r){const i=await fetch("/dashboard/user/advanced-image/editor/"+e.id+"/status",{method:"GET",headers:{Accept:"application/json"}});if(!i.ok)return i.json().then(s=>{toastr.error(s.message||"An unknown error occurred")});const o=await i.json();if(o.status==="error")return toastr.error(o.message);o.data.status==="COMPLETED"?this.onAIImageProcessDone(o.data,t,r):setTimeout(()=>{this.getAIImageStatus(o.data,t,r)},1e3)},onAIImageProcessDone(e,t,r){console.log(e)},isMobile(){return window.innerWidth<768},togglePromptLibraryShow(){this.promptLibraryShow=!this.promptLibraryShow},changePromptFilter(e){e!==this.promptFilter&&(this.promptFilter=e)},setSearchPromptStr(e){this.searchPromptStr=e.trim().toLowerCase()},setPrompt(e){this.prompt=e},focusOnPrompt(){this.$nextTick(()=>{var e;(e=this.$refs.promptInput)==null||e.focus(),this.dropdownOpen=!0})}});var B6=Object.defineProperty,Ey=(n,e)=>{for(var t in e)B6(n,t,{get:e[t],enumerable:!0})},$6={};Ey($6,{lerp:()=>Ay,makeCurveEasings:()=>Dy,pointOnCurve:()=>Ty,scaleSpreadArray:()=>z6,shuffleArray:()=>_y});function _y(n,e=Math.random){const t=[...n];let r=t.length,i;for(;r!=0;)i=Math.floor(e()*r),r--,[t[r],t[i]]=[t[i],t[r]];return t}var Ay=(n,e,t)=>e+n*(t-e),z6=(n,e,t=Ay)=>{if(!n||n.length<2)throw new Error("valuesToFill array must have at least two values.");if(e<n.length)throw new Error("Target size must be greater than or equal to the valuesToFill array length.");const r=e-n.length,i=n.map(o=>[o]);for(let o=0;o<r;o++)i[o%(n.length-1)].push(null);for(let o=0;o<i.length-1;o++){const s=i[o],a=i[o+1],l=s[0],d=a[0];for(let f=1;f<s.length;f++){const h=f/s.length;s[f]=t(h,l,d)}}return i.flat()},Ty=(n,e)=>t=>{const r=Math.PI/2,i=r/1,o=t;let s=0,a=0;if(n==="lam"){const l=o*r,d=2/(2+20*e),f=Math.cos(l),h=Math.sin(l);s=Math.sign(f)*Math.abs(f)**d,a=Math.sign(h)*Math.abs(h)**d}else if(n==="arc")a=Math.cos(-Math.PI/2+t*i+e),s=Math.sin(Math.PI/2+t*i-e);else if(n==="pow")s=Math.pow(1-o,1-e),a=Math.pow(o,1-e);else if(n==="powY")s=Math.pow(1-o,e),a=Math.pow(o,1-e);else if(n==="powX")s=Math.pow(o,e),a=Math.pow(o,1-e);else if(typeof n=="function"){const[l,d]=n(t,e);s=l,a=d}else throw new Error(`pointOnCurve() curveAccent parameter is expected to be "lam" | "arc" | "pow" | "powY" | "powX" or a function but \`${n}\` given.`);return{x:s,y:a}},Dy=(n,e)=>{const t=Ty(n,e);return{sEasing:r=>t(r).x,lEasing:r=>t(r).y}},bh={};Ey(bh,{colorHarmonies:()=>q6,colorToCSS:()=>U6,harveyHue:()=>H6,hsv2hsl:()=>My,normalizeHue:()=>$e,uniqueRandomHues:()=>V6});function $e(n){return(n%360+360)%360}function H6(n){if(n=$e(n)/360,n===1||n===0)return n;n=1+n%1;const e=1/6,t=n%e/e*Math.PI/2,[r,i]=[e*Math.cos(t),e*Math.sin(t)],o=Math.floor(n*6);return[i,1/3-r,1/3+i,2/3-r,2/3+i,1-r][o%6]*360}var q6={complementary:n=>[$e(n),$e(n+180)],splitComplementary:n=>[$e(n),$e(n+150),$e(n-150)],triadic:n=>[$e(n),$e(n+120),$e(n+240)],tetradic:n=>[$e(n),$e(n+90),$e(n+180),$e(n+270)],monochromatic:n=>[$e(n),$e(n)],doubleComplementary:n=>[$e(n),$e(n+180),$e(n+30),$e(n+210)],compound:n=>[$e(n),$e(n+180),$e(n+60),$e(n+240)],analogous:n=>[$e(n),$e(n+30),$e(n+60),$e(n+90),$e(n+120),$e(n+150)]};function V6({startHue:n=0,total:e=9,minHueDiffAngle:t=60,rndFn:r=Math.random}={}){t=Math.min(t,360/e);const i=n||r()*360,o=Array.from({length:Math.round(360/t)},(a,l)=>(i+l*t)%360);let s=_y(o,r);return s.length>e&&(s=s.slice(0,e)),s}var My=([n,e,t])=>{const r=t-t*e/2,i=Math.min(r,1-r),o=i===0?0:(t-r)/i;return[n,o,r]},W6={oklch:n=>[n[2]*100+"%",n[1]*100+"%",n[0]],lch:n=>[n[2]*100+"%",n[1]*100+"%",n[0]],hsl:n=>[n[0],n[1]*100+"%",n[2]*100+"%"],hsv:n=>{const[e,t,r]=My(n);return[e,t*100+"%",r*100+"%"]}},U6=(n,e="oklch")=>`${e==="hsv"?"hsl":e}(${W6[e](n).join(" ")})`;function yh({total:n=9,hStart:e=Math.random()*360,hStartCenter:t=.5,hEasing:r=h=>h,hCycles:i=1,sRange:o=[.4,.35],sEasing:s=h=>Math.pow(h,2),lRange:a=[Math.random()*.1,.9],lEasing:l=h=>Math.pow(h,1.5),transformFn:d=([h,m,g])=>[h,m,g],hueList:f}={}){const h=a[1]-a[0],m=o[1]-o[0],g=f&&f.length>0?f.length:n;return Array.from({length:g},(b,v)=>{const x=v/(g-1),E=1/g,A=f?f[v]:$e(e+(1-r(x,E)-t)*(360*i)),M=o[0]+m*s(x,E),C=a[0]+h*l(x,E);return d([A,M,C],v)})}var K6=({total:n=9,hStart:e=Math.random()*360,hStartCenter:t=.5,hCycles:r=1,sRange:i=[.4,.35],lRange:o=[Math.random()*.1,.9],hueList:s,curveMethod:a="lam",curveAccent:l=.5,transformFn:d=([f,h,m])=>[f,h,m]}={})=>{const{sEasing:f,lEasing:h}=Dy(a,l);return yh({total:n,hStart:e,hStartCenter:t,hCycles:r,sRange:i,lRange:o,sEasing:f,lEasing:h,transformFn:d,hueList:s})};function j6(){return{options:{},styleTag:document.querySelector("#lqd-customizer-style"),darkMode:document.body.classList.contains("theme-dark"),rootStyles:null,styleString:"",lqdFontPreview:[],googleFontsList:[],showingGoogleFonts:[],fontsPaginationCurrent:20,fontsPaginationLimit:20,loadingFontPreviewQueue:[],localStorageKey:"lqdCustomizerStyle",cssSelectors:{light:":root",dark:".theme-dark"},init(){const n=document.body.getAttribute("data-theme");this.localStorageKey=n+":"+this.localStorageKey,this.onImportStyles=_.throttle(this.onImportStyles.bind(this),300,{leading:!1}),this.loadGoogleFontPreview=_.throttle(this.loadGoogleFontPreview.bind(this),300,{leading:!1}),this.options=window.lqdCustomizerOptions,this.googleFontsList=window.lqdGoogleFontsList,this.currentEdits=this.readFromLocalStorage();const e=document.body.classList.contains("theme-dark");this.rootStyles=getComputedStyle(e?document.body:document.documentElement),Object.entries(this.options).forEach(([t])=>{this.options[t].type==="color"&&(this.options[t].values={},this.options[t].values.light={},this.options[t].values.dark={})}),this.$watch("$store.darkMode.on",t=>{this.darkMode=t,this.rootStyles=getComputedStyle(t?document.body:document.documentElement)}),this.$watch("options",this.updateOutputs.bind(this)),this.showingGoogleFonts=this.googleFontsList.slice(0,this.fontsPaginationLimit),this.currentEdits&&this.onImportStyles(this.currentEdits)},setStyleStrings(){let n="",e="";if(Object.entries(this.options).forEach(([t,r])=>{var l,d;const i=r.type==="font",o=r.cssVar;let s=r.value,a=null;(l=r.values)!=null&&l.light&&(s=r.values.light.twHsl),(d=r.values)!=null&&d.dark&&(a=r.values.dark.twHsl),s&&(n+=`	${o}: ${i?`'${s}'`:s};
`),a&&(e+=`	${o}: ${a};
`)}),!n.length&&!e.length)return this.styleString="";this.styleString=`${this.cssSelectors.light} {
${n}}`,e.length&&(this.styleString+=`
${this.cssSelectors.dark} {
${e}}`)},updateOutputs(){this.setStyleStrings(),this.fillStyleTag(),this.writeToLocalStorage()},fillStyleTag(){if(!this.styleTag)return console.error("Style tag not found");this.styleTag.innerText=this.styleString.replace(/[\n\t]/g,"")},onColorInput({key:n,color:e,manipulations:t=[],assosiatedKeys:r=[]}){var s;if(((s=this.options[n])==null?void 0:s.type)!=="color")return;const i=this.parseColor({color:e,format:["twHsl","hex"],manipulations:t}),o=this.darkMode?"dark":"light";this.options[n].values[o]={twHsl:i.twHsl,hex:i.hex},r.length&&r.forEach(({key:a,color:l,manipulations:d})=>{this.onColorInput({key:a,color:l||e,manipulations:d})})},parseColor({color:n,format:e="hsl",manipulations:t=[]}){const r=typeof n=="string";let i=r?n.trim():n;r&&(/^--[\w-]+$/.test(n)&&(i=this.rootStyles.getPropertyValue(n).trim()),/\S+\s+\S+/.test(i)&&!i.startsWith("hsl")&&(i=`hsl(${i})`));let o=tinycolor(i);if(t.length&&t.forEach(({type:s,value:a,condition:l})=>{if(!(l==="lightMode"&&this.darkMode||l==="darkMode"&&!this.darkMode)){if(s==="autoBlackWhite")return o=o.getLuminance()>=.4?tinycolor("#000"):tinycolor("#fff");o=o[s](a)}}),Array.isArray(e)){const s={};return e.forEach(a=>{s[a]=this.getColorString(o,a)}),s}return this.getColorString(o,e)},getColorString(n,e="hsl"){if(e==="colorObj")return n;if(e==="twHsl"){const t=n.toHsl();return`${Math.ceil(t.h)} ${Math.ceil(t.s*100)}% ${Math.ceil(t.l*100)}%${t.a&&t.a!==1?` / ${Math.ceil(t.a*100)}%`:""}`}return n.toString(e)},randomColors(){const n=tinycolor.random();let e=[.25,1],t=[1,.05];this.darkMode&&(e[1]=.7,t=t.reverse());const r=yh({total:7,hStart:n.toHsl().h,hStartCenter:0,hCycles:.75,hEasing:(he,we)=>he+(-we+Math.random()*we*2)*.5,sRange:e,lRange:t,sEasing:(he,we)=>he+(-we+Math.random()*we*2)*.5,lEasing:(he,we)=>he+(-we+Math.random()*we*2)*.5}),i=K6({hueList:bh.colorHarmonies.splitComplementary(n.toHsl().h),sRange:e.reverse(),lRange:t.reverse(),curveMethod:"arc",curveAccent:.01}),o=yh({hueList:bh.uniqueRandomHues({startHue:0,total:4,minDistance:90}),sRange:[.5,.9],lRange:[.5,.9]}),s=Math.floor(r.length/2),a=r[s],l=r[s-1],d=r[s+1],f=r[0],h=r[r.length-1],m=r[1],g=Math.floor(i.length/2),b=i[i.length-1],v=i[0],x=i[g],E=o[0],A=o[1],M=o[2],C=tinycolor({h:a[0],s:a[1],l:a[2]}),P=tinycolor({h:l[0],s:Math.min(1,l[1]),l:Math.min(1,l[2])}),N=tinycolor({h:d[0],s:Math.min(1,d[1]),l:Math.min(1,d[2])}),W=tinycolor({h:h[0],s:Math.min(1,h[1]),l:Math.min(1,h[2])}),V=tinycolor({h:f[0],s:Math.min(1,f[1]),l:Math.min(1,f[2])}).desaturate(this.darkMode?30:0),U=tinycolor({h:m[0],s:Math.min(1,m[1]),l:Math.min(1,m[2])}).desaturate(20).setAlpha(.55),Q=tinycolor({h:b[0],s:Math.min(1,b[1]),l:Math.min(1,b[2])}).desaturate(this.darkMode?30:0),oe=tinycolor({h:v[0],s:Math.min(1,v[1]),l:Math.min(1,v[2])}),me=tinycolor({h:x[0],s:Math.min(1,x[1]),l:Math.min(1,x[2])})[this.darkMode?"lighten":"darken"](30),se=tinycolor({h:E[0],s:Math.min(1,E[1]),l:Math.min(1,E[2])}),Ee=tinycolor({h:A[0],s:Math.min(1,A[1]),l:Math.min(1,A[2])}),Me=tinycolor({h:M[0],s:Math.min(1,M[1]),l:Math.min(1,M[2])});this.onColorInput({key:"colorMainPrimary",color:C,assosiatedKeys:[{key:"colorMainPrimaryForeground",manipulations:[{type:"autoBlackWhite"}]}]}),this.onColorInput({key:"colorMainSecondary",color:P,assosiatedKeys:[{key:"colorMainSecondaryForeground",manipulations:[{type:"autoBlackWhite"}]}]}),this.onColorInput({key:"colorMainAccent",color:N,assosiatedKeys:[{key:"colorMainAccentForeground",manipulations:[{type:"autoBlackWhite"}]}]}),this.onColorInput({key:"colorMainForeground",color:W,assosiatedKeys:[{key:"colorMainHeadingForeground",manipulations:[{type:"darken",value:22,condition:"lightMode"},{type:"lighten",value:30,condition:"darkMode"},{type:"desaturate",value:7,condition:"lightMode"},{type:"desaturate",value:30,condition:"darkMode"}]}]}),this.onColorInput({key:"colorMainBackground",color:V}),this.onColorInput({key:"colorMainBorder",color:U}),this.onColorInput({key:"colorNavbarBackground",color:Q}),this.onColorInput({key:"colorNavbarForeground",color:oe}),this.onColorInput({key:"colorNavbarActiveBackground",color:me,assosiatedKeys:[{key:"colorNavbarActiveForeground"},{key:"colorNavbarHoverForeground"},{key:"colorNavbarHoverBackground"}]}),this.onColorInput({key:"colorMainGradientFrom",color:se}),this.onColorInput({key:"colorMainGradientVia",color:Ee}),this.onColorInput({key:"colorMainGradientTo",color:Me})},addToGoogleFontLoadQueue(n,e=!1){if(!(e&&this.lqdFontPreview.includes(n))){if(!e)return this.loadGoogleFontFull(n);this.loadingFontPreviewQueue.push(n),this.loadGoogleFontPreview(n),this.lqdFontPreview.push(n)}},loadGoogleFontPreview(){if(!this.loadingFontPreviewQueue.length)return;const n=this.loadingFontPreviewQueue.map(r=>`family=${r}`).join("&").replaceAll(" ","+"),e=encodeURIComponent(this.loadingFontPreviewQueue.join("")),t=`https://fonts.googleapis.com/css2?${n}&display=swap&text=${e}`;this.createLink(t),this.loadingFontPreviewQueue=[]},loadGoogleFontFull(n){const e=`https://fonts.googleapis.com/css2?family=${n.replaceAll(/ /g,"+")}&display=swap`;this.createLink(e)},createLink(n){const e=document.createElement("link");e.href=n,e.rel="stylesheet",e.type="text/css",document.head.appendChild(e)},onImportStyles(n){if(!n)return;let e=n.trim();const t={},r=/([\w\s\.\:\-\#]+)\s*\{([^}]*)\}/g;let i;for(;(i=r.exec(e))!==null;){const o=i[1].trim(),s=i[2].trim().split(";").filter(Boolean);t[o]=t[o]||[];for(const a of s){const l=a.indexOf(":");if(l>0){const d=a.slice(0,l).trim(),f=a.slice(l+1).trim();d&&f&&t[o].push({property:d,value:f})}}}Object.entries(this.options).forEach(([o,s])=>{const a=s.cssVar;Object.entries(this.cssSelectors).forEach(([l,d])=>{var m;const f=(m=t[d])==null?void 0:m.find(g=>g.property===a);if(!f)return;const h=this.sanitizeCssValue(f.value);if(s.type==="color"){const g=this.parseColor({color:h,format:["twHsl","hex"]});this.options[o].values[l].twHsl=g.twHsl,this.options[o].values[l].hex=g.hex}else if(s.type==="font"){const g=h.replace(/['"]/g,"");this.options[o].value=g,this.addToGoogleFontLoadQueue(g)}else this.options[o].value=h})})},sanitizeCssValue(n){if(!n)return"";n=n.replace(/javascript:/gi,"").replace(/expression\(/gi,"").replace(/eval\(/gi,"").replace(/url\(/gi,"").replace(/data:/gi,""),n=n.replace(/[^\w\s,.#:;%\/\-+()[\]@!~="'*]/g,"");const e=(n.match(/'/g)||[]).length,t=(n.match(/"/g)||[]).length;return e%2!==0&&(n=n.replace(/'/g,"")),t%2!==0&&(n=n.replace(/"/g,"")),n},resetStyles(){Object.entries(this.options).forEach(([n,e])=>{e.type==="color"?(this.options[n].values.light={},this.options[n].values.dark={}):e.type==="font"?this.options[n].value="":this.options[n].value=""})},readFromLocalStorage(){let n=localStorage.getItem(this.localStorageKey);return n||(n=this.styleTag.textContent),n},writeToLocalStorage(){const n=this.styleString.replace(/[\n\t]/g,"");if(!n){this.emptyLocalStorage();return}localStorage.setItem(this.localStorageKey,n)},emptyLocalStorage(){localStorage.removeItem(this.localStorageKey)},saveAndClose(){this.setBackEnd(this.styleString??"")},discardChanges(){var e,t;!(((t=(e=this.currentEdits)==null?void 0:e.replace(/[\n\t]/g,""))==null?void 0:t.trim())??"").length&&this.resetStyles(),this.emptyLocalStorage(),this.setBackEnd("",!0)},async setBackEnd(n="",e=!1){const t={};Object.entries(this.options).forEach(([o,s])=>{s.type==="font"&&(t[o]=s.value)});const r=await fetch("/dashboard/admin/live-customizer",{method:"POST",headers:{Accept:"application/json","Content-Type":"application/json"},body:JSON.stringify({style:n,fonts:t,clear:e})});let i=await r.json();if(!r.ok){toastr.error("Error uploading the customizer styles");return}if(i.status==="success"){toastr.success(i.message),setTimeout(()=>{this.emptyLocalStorage(),window.location.reload()},1e3);return}toastr.error(i.message??"Error uploading the customizer styles")}}}function G6(n){return{dropdownOpen:!1,selectedFont:"",searchString:"",init(){this.$watch("selectedFont",e=>{this.options[n].value=e})},onSearchInput(){const e=this.$event.target.value.trim();if(!e){this.fontsPaginationCurrent=this.fontsPaginationLimit,this.showingGoogleFonts=this.googleFontsList.slice(0,this.fontsPaginationLimit);return}this.showingGoogleFonts=this.googleFontsList.filter(t=>t.toLowerCase().includes(e.toLowerCase()))},loadMoreFonts(){this.fontsPaginationCurrent+=this.fontsPaginationLimit,this.showingGoogleFonts=this.googleFontsList.slice(0,this.fontsPaginationCurrent)}}}ee.store("realtimeChatStatus",{active:!1,conversationStarted:!1,setActive(n){this.active=n,this.onActiveChange()},setConversationStarted(n){this.conversationStarted=n,this.onConversationStartedChange()},onActiveChange(){var n,e;document.querySelectorAll(".lqd-realtime-chat-button").forEach(t=>t.classList.toggle("active",this.active)),(e=(n=document.querySelector(".lqd-audio-vis-wrap"))==null?void 0:n.classList)==null||e.toggle("active",this.active)},onConversationStartedChange(){const n=document.querySelector(".chats-wrap");n.classList.toggle("conversation-started",this.conversationStarted),n.classList.toggle("conversation-not-started",!this.conversationStarted),document.querySelectorAll(".lqd-realtime-chat-button").forEach(e=>{e.classList.toggle("conversation-started",this.conversationStarted),e.classList.toggle("conversation-not-started",!this.conversationStarted)})}});const X6=n=>({agentId:n,recordingActive:!1,buffer:new Uint8Array,conversation:null,audioRecorder:null,audioPlayer:null,activeVisulaizer:"idle",audioVisWrap:null,audioVisBars:null,audioVisDotWrap:null,audioVisLoader:null,conversationArea:document.querySelector(".conversation-area"),chatsContainer:document.querySelector(".chats-container"),userBubbleTemplate:document.querySelector("#chat_user_bubble"),aiBubbleTemplate:document.querySelector("#chat_ai_bubble"),lastAiBubble:null,lastUserBubble:null,lastUserQuestion:"",lastAiResponse:"",lastResponseSaved:!1,init(){var e,t,r;this.audioVisWrap=document.querySelector(".lqd-audio-vis-wrap"),this.audioVisBars=(e=this.audioVisWrap)==null?void 0:e.querySelectorAll(".lqd-audio-vis-bar"),this.audioVisDotWrap=(t=this.audioVisWrap)==null?void 0:t.querySelector(".lqd-audio-vis-dot-wrap"),this.audioVisLoader=(r=this.audioVisWrap)==null?void 0:r.querySelector(".lqd-audio-vis-loader"),this.processAudioRecordingBuffer=this.processAudioRecordingBuffer.bind(this)},async start(){if(ee.store("realtimeChatStatus").isActive)return;ee.store("realtimeChatStatus").setActive(!0),this.switchVisualizers("waiting");const e=await this.checkBalance(!0);if(e.shouldStop){toastr.error(e.errorMsg),this.stop();return}this.conversation=await J_.startSession({agentId:this.agentId,onConnect:async()=>{await Promise.all([this.startRecorder(),this.startPlayer()]).then(()=>{this.startBarsVisualizer(),this.startDotVisualizer(),this.switchVisualizers("idle"),ee.store("realtimeChatStatus").setConversationStarted(!0)}).catch(t=>{this.stop(),console.error("Error starting recorder and player:",t),this.appendToChatBubble("ai","[Error]: Unable to start audio recorder and player. Please check your microphone permissions and refresh the page.")})},onDisconnect:()=>{var t;this.disconnectHandle((t=this.conversation)==null?void 0:t.connection),this.stop()},onModeChange:t=>{this.checkBalance().then(r=>{if(r.shouldStop){this.stop(),toastr.error(r.errorMsg);return}})},onMessage:t=>{t.source=="ai"?(this.createChatBubble("ai"),this.appendToChatBubble("ai",t.message),this.lastAiResponse=t.message,"saveResponseAsync"in window&&(saveResponseAsync(this.lastUserQuestion.trim(),this.lastAiResponse.trim(),document.querySelector("#chat_id").value,"","","","","elevenlabs-voice-chatbot"),this.lastResponseSaved=!0),"formatString"in window&&this.lastAiBubble&&(this.lastAiBubble.innerHTML=formatString(this.lastAiResponse)),this.lastAiResponse=this.lastUserQuestion=""):(this.createChatBubble("user"),this.appendToChatBubble("user",t.message),this.lastUserQuestion+=" "+t.message,this.lastResponseSaved=!1)},onError:t=>{console.error("Error:",t),this.stop()}})},async stop(){!this.lastResponseSaved&&"saveResponseAsync"in window&&this.lastUserQuestion.trim()!==""&&this.lastAiResponse.trim()!==""&&saveResponseAsync(this.lastUserQuestion.trim(),this.lastAiResponse.trim(),document.querySelector("#chat_id").value,"","","","","elevenlabs-voice-chatbot"),this.resetPlayers(),this.conversation&&(await this.conversation.endSession(),this.conversation=null),this.switchVisualizers(""),ee.store("realtimeChatStatus").setActive(!1)},async startPlayer(){try{this.audioPlayer=new Cy,await this.audioPlayer.init(24e3)}catch(e){console.error("Error starting audio player:",e)}},async startRecorder(){try{this.audioRecorder=new Yb(this.processAudioRecordingBuffer);const e=await navigator.mediaDevices.getUserMedia({audio:!0,video:!1});await this.audioRecorder.start(e),this.recordingActive=!0}catch(e){console.error("Error starting audio recorder:",e)}},combineArray(e){const t=new Uint8Array(this.buffer.length+e.length);t.set(this.buffer),t.set(e,this.buffer.length),this.buffer=t},processAudioRecordingBuffer(e){const t=new Uint8Array(e);if(this.combineArray(t),this.buffer.length>=4800){const r=new Uint8Array(this.buffer.slice(0,4800));this.buffer=new Uint8Array(this.buffer.slice(4800));const i=String.fromCharCode(...r);btoa(i)}},async resetPlayers(){var e,t;this.recordingActive=!1,(e=this.audioRecorder)==null||e.stop(),(t=this.audioPlayer)==null||t.clear()},getSystemMessage(){return""},getTemperature(){return parseFloat(.8)},getVoice(){return"alloy"},switchVisualizers(e){var t;this.activeVisulaizer=e,(t=this.audioVisWrap)==null||t.setAttribute("data-state",this.activeVisulaizer)},createChatBubble(e){const r=(e==="user"?this.userBubbleTemplate:this.aiBubbleTemplate).content.cloneNode(!0),i=r.querySelector(".chat-content");this.chatsContainer.appendChild(r),e==="user"?this.lastUserBubble=i:this.lastAiBubble=i,this.scrollConversationAreaToBottom()},appendToChatBubble(e,t){const r=e==="user"?this.lastUserBubble:this.lastAiBubble;r?(r.textContent+=t,this.scrollConversationAreaToBottom()):(this.createChatBubble(e),this.appendToChatBubble(e,t))},scrollConversationAreaToBottom(){this.conversationArea.scrollTo({top:this.conversationArea.scrollHeight+200,left:0})},startBarsVisualizer(){var a;if(!((a=this.audioVisBars)!=null&&a.length))return;const e=this.audioPlayer.audioContext.createAnalyser();e.fftSize=4096;const t=e.frequencyBinCount,r=new Uint8Array(t),i=this.audioVisBars.length;this.audioPlayer.playbackNode.connect(e);const o=[[85,150],[150,250],[250,400],[400,600],[600,1e3]];this.barHeights=this.barHeights||new Array(i).fill(0);const s=()=>{e.getByteFrequencyData(r),this.audioVisBars.forEach((l,d)=>{const[f,h]=o[d],m=Math.floor(f/(this.audioPlayer.audioContext.sampleRate/e.fftSize)),g=Math.ceil(h/(this.audioPlayer.audioContext.sampleRate/e.fftSize));let b=0;for(let x=m;x<=g&&x<r.length;x++)r[x]>b&&(b=r[x]);let v=b/255*80;this.barHeights[d]+=(v-this.barHeights[d])*.4,this.barHeights[d]+=(Math.random()-.5)*2,this.barHeights[d]=Math.max(5,Math.min(100,this.barHeights[d])),l.animate([{height:l.style.height},{height:`${this.barHeights[d]}%`}],{duration:30,fill:"forwards",easing:"linear"})}),requestAnimationFrame(s)};s()},startDotVisualizer(){if(!this.audioRecorder||!this.audioVisDotWrap)return;const e=this.audioRecorder.audioContext.createAnalyser();e.fftSize=256;const t=e.frequencyBinCount,r=new Uint8Array(t);this.audioRecorder.getMediaStreamSource().connect(e);const i=this.audioVisDotWrap.querySelector(".lqd-audio-vis-dot");if(!i)return;const o=()=>{e.getByteFrequencyData(r);let s=0;for(let f=0;f<t;f++)s+=r[f];const l=1+s/t/256*1.5,d=Math.max(.2,1-(l-1)/1.5);i.style.transform=`scale(${l})`,i.style.opacity=d.toFixed(2),requestAnimationFrame(o)};o()},checkBalance(e=!1){return new Promise(t=>{$.ajax({url:"/dashboard/admin/voice-chatbot/check-balance",type:"POST",data:{onStart:e},dataType:"json",success:r=>{const i=r.status!=="success",o=r.message||"";t({shouldStop:i,errorMsg:o})},error:()=>{t({shouldStop:!0,errorMsg:"An error occurred."})}})})},disconnectHandle(e){var t,r;((t=e==null?void 0:e.disconnectionDetails)==null?void 0:t.reason)=="error"&&(toastr.error("Something went wrong. Please contact support for assistance"),console.error((r=e==null?void 0:e.disconnectionDetails)==null?void 0:r.message))}});function Ft(n){this.content=n}Ft.prototype={constructor:Ft,find:function(n){for(var e=0;e<this.content.length;e+=2)if(this.content[e]===n)return e;return-1},get:function(n){var e=this.find(n);return e==-1?void 0:this.content[e+1]},update:function(n,e,t){var r=t&&t!=n?this.remove(t):this,i=r.find(n),o=r.content.slice();return i==-1?o.push(t||n,e):(o[i+1]=e,t&&(o[i]=t)),new Ft(o)},remove:function(n){var e=this.find(n);if(e==-1)return this;var t=this.content.slice();return t.splice(e,2),new Ft(t)},addToStart:function(n,e){return new Ft([n,e].concat(this.remove(n).content))},addToEnd:function(n,e){var t=this.remove(n).content.slice();return t.push(n,e),new Ft(t)},addBefore:function(n,e,t){var r=this.remove(e),i=r.content.slice(),o=r.find(n);return i.splice(o==-1?i.length:o,0,e,t),new Ft(i)},forEach:function(n){for(var e=0;e<this.content.length;e+=2)n(this.content[e],this.content[e+1])},prepend:function(n){return n=Ft.from(n),n.size?new Ft(n.content.concat(this.subtract(n).content)):this},append:function(n){return n=Ft.from(n),n.size?new Ft(this.subtract(n).content.concat(n.content)):this},subtract:function(n){var e=this;n=Ft.from(n);for(var t=0;t<n.content.length;t+=2)e=e.remove(n.content[t]);return e},toObject:function(){var n={};return this.forEach(function(e,t){n[e]=t}),n},get size(){return this.content.length>>1}};Ft.from=function(n){if(n instanceof Ft)return n;var e=[];if(n)for(var t in n)e.push(t,n[t]);return new Ft(e)};function Oy(n,e,t){for(let r=0;;r++){if(r==n.childCount||r==e.childCount)return n.childCount==e.childCount?null:t;let i=n.child(r),o=e.child(r);if(i==o){t+=i.nodeSize;continue}if(!i.sameMarkup(o))return t;if(i.isText&&i.text!=o.text){for(let s=0;i.text[s]==o.text[s];s++)t++;return t}if(i.content.size||o.content.size){let s=Oy(i.content,o.content,t+1);if(s!=null)return s}t+=i.nodeSize}}function Iy(n,e,t,r){for(let i=n.childCount,o=e.childCount;;){if(i==0||o==0)return i==o?null:{a:t,b:r};let s=n.child(--i),a=e.child(--o),l=s.nodeSize;if(s==a){t-=l,r-=l;continue}if(!s.sameMarkup(a))return{a:t,b:r};if(s.isText&&s.text!=a.text){let d=0,f=Math.min(s.text.length,a.text.length);for(;d<f&&s.text[s.text.length-d-1]==a.text[a.text.length-d-1];)d++,t--,r--;return{a:t,b:r}}if(s.content.size||a.content.size){let d=Iy(s.content,a.content,t-1,r-1);if(d)return d}t-=l,r-=l}}class q{constructor(e,t){if(this.content=e,this.size=t||0,t==null)for(let r=0;r<e.length;r++)this.size+=e[r].nodeSize}nodesBetween(e,t,r,i=0,o){for(let s=0,a=0;a<t;s++){let l=this.content[s],d=a+l.nodeSize;if(d>e&&r(l,i+a,o||null,s)!==!1&&l.content.size){let f=a+1;l.nodesBetween(Math.max(0,e-f),Math.min(l.content.size,t-f),r,i+f)}a=d}}descendants(e){this.nodesBetween(0,this.size,e)}textBetween(e,t,r,i){let o="",s=!0;return this.nodesBetween(e,t,(a,l)=>{let d=a.isText?a.text.slice(Math.max(e,l)-l,t-l):a.isLeaf?i?typeof i=="function"?i(a):i:a.type.spec.leafText?a.type.spec.leafText(a):"":"";a.isBlock&&(a.isLeaf&&d||a.isTextblock)&&r&&(s?s=!1:o+=r),o+=d},0),o}append(e){if(!e.size)return this;if(!this.size)return e;let t=this.lastChild,r=e.firstChild,i=this.content.slice(),o=0;for(t.isText&&t.sameMarkup(r)&&(i[i.length-1]=t.withText(t.text+r.text),o=1);o<e.content.length;o++)i.push(e.content[o]);return new q(i,this.size+e.size)}cut(e,t=this.size){if(e==0&&t==this.size)return this;let r=[],i=0;if(t>e)for(let o=0,s=0;s<t;o++){let a=this.content[o],l=s+a.nodeSize;l>e&&((s<e||l>t)&&(a.isText?a=a.cut(Math.max(0,e-s),Math.min(a.text.length,t-s)):a=a.cut(Math.max(0,e-s-1),Math.min(a.content.size,t-s-1))),r.push(a),i+=a.nodeSize),s=l}return new q(r,i)}cutByIndex(e,t){return e==t?q.empty:e==0&&t==this.content.length?this:new q(this.content.slice(e,t))}replaceChild(e,t){let r=this.content[e];if(r==t)return this;let i=this.content.slice(),o=this.size+t.nodeSize-r.nodeSize;return i[e]=t,new q(i,o)}addToStart(e){return new q([e].concat(this.content),this.size+e.nodeSize)}addToEnd(e){return new q(this.content.concat(e),this.size+e.nodeSize)}eq(e){if(this.content.length!=e.content.length)return!1;for(let t=0;t<this.content.length;t++)if(!this.content[t].eq(e.content[t]))return!1;return!0}get firstChild(){return this.content.length?this.content[0]:null}get lastChild(){return this.content.length?this.content[this.content.length-1]:null}get childCount(){return this.content.length}child(e){let t=this.content[e];if(!t)throw new RangeError("Index "+e+" out of range for "+this);return t}maybeChild(e){return this.content[e]||null}forEach(e){for(let t=0,r=0;t<this.content.length;t++){let i=this.content[t];e(i,r,t),r+=i.nodeSize}}findDiffStart(e,t=0){return Oy(this,e,t)}findDiffEnd(e,t=this.size,r=e.size){return Iy(this,e,t,r)}findIndex(e,t=-1){if(e==0)return kl(0,e);if(e==this.size)return kl(this.content.length,e);if(e>this.size||e<0)throw new RangeError(`Position ${e} outside of fragment (${this})`);for(let r=0,i=0;;r++){let o=this.child(r),s=i+o.nodeSize;if(s>=e)return s==e||t>0?kl(r+1,s):kl(r,i);i=s}}toString(){return"<"+this.toStringInner()+">"}toStringInner(){return this.content.join(", ")}toJSON(){return this.content.length?this.content.map(e=>e.toJSON()):null}static fromJSON(e,t){if(!t)return q.empty;if(!Array.isArray(t))throw new RangeError("Invalid input for Fragment.fromJSON");return new q(t.map(e.nodeFromJSON))}static fromArray(e){if(!e.length)return q.empty;let t,r=0;for(let i=0;i<e.length;i++){let o=e[i];r+=o.nodeSize,i&&o.isText&&e[i-1].sameMarkup(o)?(t||(t=e.slice(0,i)),t[t.length-1]=o.withText(t[t.length-1].text+o.text)):t&&t.push(o)}return new q(t||e,r)}static from(e){if(!e)return q.empty;if(e instanceof q)return e;if(Array.isArray(e))return this.fromArray(e);if(e.attrs)return new q([e],e.nodeSize);throw new RangeError("Can not convert "+e+" to a Fragment"+(e.nodesBetween?" (looks like multiple versions of prosemirror-model were loaded)":""))}}q.empty=new q([],0);const _f={index:0,offset:0};function kl(n,e){return _f.index=n,_f.offset=e,_f}function oc(n,e){if(n===e)return!0;if(!(n&&typeof n=="object")||!(e&&typeof e=="object"))return!1;let t=Array.isArray(n);if(Array.isArray(e)!=t)return!1;if(t){if(n.length!=e.length)return!1;for(let r=0;r<n.length;r++)if(!oc(n[r],e[r]))return!1}else{for(let r in n)if(!(r in e)||!oc(n[r],e[r]))return!1;for(let r in e)if(!(r in n))return!1}return!0}let qe=class vh{constructor(e,t){this.type=e,this.attrs=t}addToSet(e){let t,r=!1;for(let i=0;i<e.length;i++){let o=e[i];if(this.eq(o))return e;if(this.type.excludes(o.type))t||(t=e.slice(0,i));else{if(o.type.excludes(this.type))return e;!r&&o.type.rank>this.type.rank&&(t||(t=e.slice(0,i)),t.push(this),r=!0),t&&t.push(o)}}return t||(t=e.slice()),r||t.push(this),t}removeFromSet(e){for(let t=0;t<e.length;t++)if(this.eq(e[t]))return e.slice(0,t).concat(e.slice(t+1));return e}isInSet(e){for(let t=0;t<e.length;t++)if(this.eq(e[t]))return!0;return!1}eq(e){return this==e||this.type==e.type&&oc(this.attrs,e.attrs)}toJSON(){let e={type:this.type.name};for(let t in this.attrs){e.attrs=this.attrs;break}return e}static fromJSON(e,t){if(!t)throw new RangeError("Invalid input for Mark.fromJSON");let r=e.marks[t.type];if(!r)throw new RangeError(`There is no mark type ${t.type} in this schema`);let i=r.create(t.attrs);return r.checkAttrs(i.attrs),i}static sameSet(e,t){if(e==t)return!0;if(e.length!=t.length)return!1;for(let r=0;r<e.length;r++)if(!e[r].eq(t[r]))return!1;return!0}static setFrom(e){if(!e||Array.isArray(e)&&e.length==0)return vh.none;if(e instanceof vh)return[e];let t=e.slice();return t.sort((r,i)=>r.type.rank-i.type.rank),t}};qe.none=[];class sc extends Error{}class X{constructor(e,t,r){this.content=e,this.openStart=t,this.openEnd=r}get size(){return this.content.size-this.openStart-this.openEnd}insertAt(e,t){let r=Py(this.content,e+this.openStart,t);return r&&new X(r,this.openStart,this.openEnd)}removeBetween(e,t){return new X(Ny(this.content,e+this.openStart,t+this.openStart),this.openStart,this.openEnd)}eq(e){return this.content.eq(e.content)&&this.openStart==e.openStart&&this.openEnd==e.openEnd}toString(){return this.content+"("+this.openStart+","+this.openEnd+")"}toJSON(){if(!this.content.size)return null;let e={content:this.content.toJSON()};return this.openStart>0&&(e.openStart=this.openStart),this.openEnd>0&&(e.openEnd=this.openEnd),e}static fromJSON(e,t){if(!t)return X.empty;let r=t.openStart||0,i=t.openEnd||0;if(typeof r!="number"||typeof i!="number")throw new RangeError("Invalid input for Slice.fromJSON");return new X(q.fromJSON(e,t.content),r,i)}static maxOpen(e,t=!0){let r=0,i=0;for(let o=e.firstChild;o&&!o.isLeaf&&(t||!o.type.spec.isolating);o=o.firstChild)r++;for(let o=e.lastChild;o&&!o.isLeaf&&(t||!o.type.spec.isolating);o=o.lastChild)i++;return new X(e,r,i)}}X.empty=new X(q.empty,0,0);function Ny(n,e,t){let{index:r,offset:i}=n.findIndex(e),o=n.maybeChild(r),{index:s,offset:a}=n.findIndex(t);if(i==e||o.isText){if(a!=t&&!n.child(s).isText)throw new RangeError("Removing non-flat range");return n.cut(0,e).append(n.cut(t))}if(r!=s)throw new RangeError("Removing non-flat range");return n.replaceChild(r,o.copy(Ny(o.content,e-i-1,t-i-1)))}function Py(n,e,t,r){let{index:i,offset:o}=n.findIndex(e),s=n.maybeChild(i);if(o==e||s.isText)return n.cut(0,e).append(t).append(n.cut(e));let a=Py(s.content,e-o-1,t);return a&&n.replaceChild(i,s.copy(a))}function Y6(n,e,t){if(t.openStart>n.depth)throw new sc("Inserted content deeper than insertion position");if(n.depth-t.openStart!=e.depth-t.openEnd)throw new sc("Inconsistent open depths");return Fy(n,e,t,0)}function Fy(n,e,t,r){let i=n.index(r),o=n.node(r);if(i==e.index(r)&&r<n.depth-t.openStart){let s=Fy(n,e,t,r+1);return o.copy(o.content.replaceChild(i,s))}else if(t.content.size)if(!t.openStart&&!t.openEnd&&n.depth==r&&e.depth==r){let s=n.parent,a=s.content;return To(s,a.cut(0,n.parentOffset).append(t.content).append(a.cut(e.parentOffset)))}else{let{start:s,end:a}=J6(t,n);return To(o,Ly(n,s,a,e,r))}else return To(o,ac(n,e,r))}function Ry(n,e){if(!e.type.compatibleContent(n.type))throw new sc("Cannot join "+e.type.name+" onto "+n.type.name)}function xh(n,e,t){let r=n.node(t);return Ry(r,e.node(t)),r}function Ao(n,e){let t=e.length-1;t>=0&&n.isText&&n.sameMarkup(e[t])?e[t]=n.withText(e[t].text+n.text):e.push(n)}function Ha(n,e,t,r){let i=(e||n).node(t),o=0,s=e?e.index(t):i.childCount;n&&(o=n.index(t),n.depth>t?o++:n.textOffset&&(Ao(n.nodeAfter,r),o++));for(let a=o;a<s;a++)Ao(i.child(a),r);e&&e.depth==t&&e.textOffset&&Ao(e.nodeBefore,r)}function To(n,e){return n.type.checkContent(e),n.copy(e)}function Ly(n,e,t,r,i){let o=n.depth>i&&xh(n,e,i+1),s=r.depth>i&&xh(t,r,i+1),a=[];return Ha(null,n,i,a),o&&s&&e.index(i)==t.index(i)?(Ry(o,s),Ao(To(o,Ly(n,e,t,r,i+1)),a)):(o&&Ao(To(o,ac(n,e,i+1)),a),Ha(e,t,i,a),s&&Ao(To(s,ac(t,r,i+1)),a)),Ha(r,null,i,a),new q(a)}function ac(n,e,t){let r=[];if(Ha(null,n,t,r),n.depth>t){let i=xh(n,e,t+1);Ao(To(i,ac(n,e,t+1)),r)}return Ha(e,null,t,r),new q(r)}function J6(n,e){let t=e.depth-n.openStart,i=e.node(t).copy(n.content);for(let o=t-1;o>=0;o--)i=e.node(o).copy(q.from(i));return{start:i.resolveNoCache(n.openStart+t),end:i.resolveNoCache(i.content.size-n.openEnd-t)}}class ja{constructor(e,t,r){this.pos=e,this.path=t,this.parentOffset=r,this.depth=t.length/3-1}resolveDepth(e){return e==null?this.depth:e<0?this.depth+e:e}get parent(){return this.node(this.depth)}get doc(){return this.node(0)}node(e){return this.path[this.resolveDepth(e)*3]}index(e){return this.path[this.resolveDepth(e)*3+1]}indexAfter(e){return e=this.resolveDepth(e),this.index(e)+(e==this.depth&&!this.textOffset?0:1)}start(e){return e=this.resolveDepth(e),e==0?0:this.path[e*3-1]+1}end(e){return e=this.resolveDepth(e),this.start(e)+this.node(e).content.size}before(e){if(e=this.resolveDepth(e),!e)throw new RangeError("There is no position before the top-level node");return e==this.depth+1?this.pos:this.path[e*3-1]}after(e){if(e=this.resolveDepth(e),!e)throw new RangeError("There is no position after the top-level node");return e==this.depth+1?this.pos:this.path[e*3-1]+this.path[e*3].nodeSize}get textOffset(){return this.pos-this.path[this.path.length-1]}get nodeAfter(){let e=this.parent,t=this.index(this.depth);if(t==e.childCount)return null;let r=this.pos-this.path[this.path.length-1],i=e.child(t);return r?e.child(t).cut(r):i}get nodeBefore(){let e=this.index(this.depth),t=this.pos-this.path[this.path.length-1];return t?this.parent.child(e).cut(0,t):e==0?null:this.parent.child(e-1)}posAtIndex(e,t){t=this.resolveDepth(t);let r=this.path[t*3],i=t==0?0:this.path[t*3-1]+1;for(let o=0;o<e;o++)i+=r.child(o).nodeSize;return i}marks(){let e=this.parent,t=this.index();if(e.content.size==0)return qe.none;if(this.textOffset)return e.child(t).marks;let r=e.maybeChild(t-1),i=e.maybeChild(t);if(!r){let a=r;r=i,i=a}let o=r.marks;for(var s=0;s<o.length;s++)o[s].type.spec.inclusive===!1&&(!i||!o[s].isInSet(i.marks))&&(o=o[s--].removeFromSet(o));return o}marksAcross(e){let t=this.parent.maybeChild(this.index());if(!t||!t.isInline)return null;let r=t.marks,i=e.parent.maybeChild(e.index());for(var o=0;o<r.length;o++)r[o].type.spec.inclusive===!1&&(!i||!r[o].isInSet(i.marks))&&(r=r[o--].removeFromSet(r));return r}sharedDepth(e){for(let t=this.depth;t>0;t--)if(this.start(t)<=e&&this.end(t)>=e)return t;return 0}blockRange(e=this,t){if(e.pos<this.pos)return e.blockRange(this);for(let r=this.depth-(this.parent.inlineContent||this.pos==e.pos?1:0);r>=0;r--)if(e.pos<=this.end(r)&&(!t||t(this.node(r))))return new uc(this,e,r);return null}sameParent(e){return this.pos-this.parentOffset==e.pos-e.parentOffset}max(e){return e.pos>this.pos?e:this}min(e){return e.pos<this.pos?e:this}toString(){let e="";for(let t=1;t<=this.depth;t++)e+=(e?"/":"")+this.node(t).type.name+"_"+this.index(t-1);return e+":"+this.parentOffset}static resolve(e,t){if(!(t>=0&&t<=e.content.size))throw new RangeError("Position "+t+" out of range");let r=[],i=0,o=t;for(let s=e;;){let{index:a,offset:l}=s.content.findIndex(o),d=o-l;if(r.push(s,a,i+l),!d||(s=s.child(a),s.isText))break;o=d-1,i+=l+1}return new ja(t,r,o)}static resolveCached(e,t){let r=Vg.get(e);if(r)for(let o=0;o<r.elts.length;o++){let s=r.elts[o];if(s.pos==t)return s}else Vg.set(e,r=new Z6);let i=r.elts[r.i]=ja.resolve(e,t);return r.i=(r.i+1)%Q6,i}}class Z6{constructor(){this.elts=[],this.i=0}}const Q6=12,Vg=new WeakMap;class uc{constructor(e,t,r){this.$from=e,this.$to=t,this.depth=r}get start(){return this.$from.before(this.depth+1)}get end(){return this.$to.after(this.depth+1)}get parent(){return this.$from.node(this.depth)}get startIndex(){return this.$from.index(this.depth)}get endIndex(){return this.$to.indexAfter(this.depth)}}const eT=Object.create(null);let Ui=class wh{constructor(e,t,r,i=qe.none){this.type=e,this.attrs=t,this.marks=i,this.content=r||q.empty}get children(){return this.content.content}get nodeSize(){return this.isLeaf?1:2+this.content.size}get childCount(){return this.content.childCount}child(e){return this.content.child(e)}maybeChild(e){return this.content.maybeChild(e)}forEach(e){this.content.forEach(e)}nodesBetween(e,t,r,i=0){this.content.nodesBetween(e,t,r,i,this)}descendants(e){this.nodesBetween(0,this.content.size,e)}get textContent(){return this.isLeaf&&this.type.spec.leafText?this.type.spec.leafText(this):this.textBetween(0,this.content.size,"")}textBetween(e,t,r,i){return this.content.textBetween(e,t,r,i)}get firstChild(){return this.content.firstChild}get lastChild(){return this.content.lastChild}eq(e){return this==e||this.sameMarkup(e)&&this.content.eq(e.content)}sameMarkup(e){return this.hasMarkup(e.type,e.attrs,e.marks)}hasMarkup(e,t,r){return this.type==e&&oc(this.attrs,t||e.defaultAttrs||eT)&&qe.sameSet(this.marks,r||qe.none)}copy(e=null){return e==this.content?this:new wh(this.type,this.attrs,e,this.marks)}mark(e){return e==this.marks?this:new wh(this.type,this.attrs,this.content,e)}cut(e,t=this.content.size){return e==0&&t==this.content.size?this:this.copy(this.content.cut(e,t))}slice(e,t=this.content.size,r=!1){if(e==t)return X.empty;let i=this.resolve(e),o=this.resolve(t),s=r?0:i.sharedDepth(t),a=i.start(s),d=i.node(s).content.cut(i.pos-a,o.pos-a);return new X(d,i.depth-s,o.depth-s)}replace(e,t,r){return Y6(this.resolve(e),this.resolve(t),r)}nodeAt(e){for(let t=this;;){let{index:r,offset:i}=t.content.findIndex(e);if(t=t.maybeChild(r),!t)return null;if(i==e||t.isText)return t;e-=i+1}}childAfter(e){let{index:t,offset:r}=this.content.findIndex(e);return{node:this.content.maybeChild(t),index:t,offset:r}}childBefore(e){if(e==0)return{node:null,index:0,offset:0};let{index:t,offset:r}=this.content.findIndex(e);if(r<e)return{node:this.content.child(t),index:t,offset:r};let i=this.content.child(t-1);return{node:i,index:t-1,offset:r-i.nodeSize}}resolve(e){return ja.resolveCached(this,e)}resolveNoCache(e){return ja.resolve(this,e)}rangeHasMark(e,t,r){let i=!1;return t>e&&this.nodesBetween(e,t,o=>(r.isInSet(o.marks)&&(i=!0),!i)),i}get isBlock(){return this.type.isBlock}get isTextblock(){return this.type.isTextblock}get inlineContent(){return this.type.inlineContent}get isInline(){return this.type.isInline}get isText(){return this.type.isText}get isLeaf(){return this.type.isLeaf}get isAtom(){return this.type.isAtom}toString(){if(this.type.spec.toDebugString)return this.type.spec.toDebugString(this);let e=this.type.name;return this.content.size&&(e+="("+this.content.toStringInner()+")"),By(this.marks,e)}contentMatchAt(e){let t=this.type.contentMatch.matchFragment(this.content,0,e);if(!t)throw new Error("Called contentMatchAt on a node with invalid content");return t}canReplace(e,t,r=q.empty,i=0,o=r.childCount){let s=this.contentMatchAt(e).matchFragment(r,i,o),a=s&&s.matchFragment(this.content,t);if(!a||!a.validEnd)return!1;for(let l=i;l<o;l++)if(!this.type.allowsMarks(r.child(l).marks))return!1;return!0}canReplaceWith(e,t,r,i){if(i&&!this.type.allowsMarks(i))return!1;let o=this.contentMatchAt(e).matchType(r),s=o&&o.matchFragment(this.content,t);return s?s.validEnd:!1}canAppend(e){return e.content.size?this.canReplace(this.childCount,this.childCount,e.content):this.type.compatibleContent(e.type)}check(){this.type.checkContent(this.content),this.type.checkAttrs(this.attrs);let e=qe.none;for(let t=0;t<this.marks.length;t++){let r=this.marks[t];r.type.checkAttrs(r.attrs),e=r.addToSet(e)}if(!qe.sameSet(e,this.marks))throw new RangeError(`Invalid collection of marks for node ${this.type.name}: ${this.marks.map(t=>t.type.name)}`);this.content.forEach(t=>t.check())}toJSON(){let e={type:this.type.name};for(let t in this.attrs){e.attrs=this.attrs;break}return this.content.size&&(e.content=this.content.toJSON()),this.marks.length&&(e.marks=this.marks.map(t=>t.toJSON())),e}static fromJSON(e,t){if(!t)throw new RangeError("Invalid input for Node.fromJSON");let r;if(t.marks){if(!Array.isArray(t.marks))throw new RangeError("Invalid mark data for Node.fromJSON");r=t.marks.map(e.markFromJSON)}if(t.type=="text"){if(typeof t.text!="string")throw new RangeError("Invalid text node in JSON");return e.text(t.text,r)}let i=q.fromJSON(e,t.content),o=e.nodeType(t.type).create(t.attrs,i,r);return o.type.checkAttrs(o.attrs),o}};Ui.prototype.text=void 0;class lc extends Ui{constructor(e,t,r,i){if(super(e,t,null,i),!r)throw new RangeError("Empty text nodes are not allowed");this.text=r}toString(){return this.type.spec.toDebugString?this.type.spec.toDebugString(this):By(this.marks,JSON.stringify(this.text))}get textContent(){return this.text}textBetween(e,t){return this.text.slice(e,t)}get nodeSize(){return this.text.length}mark(e){return e==this.marks?this:new lc(this.type,this.attrs,this.text,e)}withText(e){return e==this.text?this:new lc(this.type,this.attrs,e,this.marks)}cut(e=0,t=this.text.length){return e==0&&t==this.text.length?this:this.withText(this.text.slice(e,t))}eq(e){return this.sameMarkup(e)&&this.text==e.text}toJSON(){let e=super.toJSON();return e.text=this.text,e}}function By(n,e){for(let t=n.length-1;t>=0;t--)e=n[t].type.name+"("+e+")";return e}class No{constructor(e){this.validEnd=e,this.next=[],this.wrapCache=[]}static parse(e,t){let r=new tT(e,t);if(r.next==null)return No.empty;let i=$y(r);r.next&&r.err("Unexpected trailing text");let o=uT(aT(i));return lT(o,r),o}matchType(e){for(let t=0;t<this.next.length;t++)if(this.next[t].type==e)return this.next[t].next;return null}matchFragment(e,t=0,r=e.childCount){let i=this;for(let o=t;i&&o<r;o++)i=i.matchType(e.child(o).type);return i}get inlineContent(){return this.next.length!=0&&this.next[0].type.isInline}get defaultType(){for(let e=0;e<this.next.length;e++){let{type:t}=this.next[e];if(!(t.isText||t.hasRequiredAttrs()))return t}return null}compatible(e){for(let t=0;t<this.next.length;t++)for(let r=0;r<e.next.length;r++)if(this.next[t].type==e.next[r].type)return!0;return!1}fillBefore(e,t=!1,r=0){let i=[this];function o(s,a){let l=s.matchFragment(e,r);if(l&&(!t||l.validEnd))return q.from(a.map(d=>d.createAndFill()));for(let d=0;d<s.next.length;d++){let{type:f,next:h}=s.next[d];if(!(f.isText||f.hasRequiredAttrs())&&i.indexOf(h)==-1){i.push(h);let m=o(h,a.concat(f));if(m)return m}}return null}return o(this,[])}findWrapping(e){for(let r=0;r<this.wrapCache.length;r+=2)if(this.wrapCache[r]==e)return this.wrapCache[r+1];let t=this.computeWrapping(e);return this.wrapCache.push(e,t),t}computeWrapping(e){let t=Object.create(null),r=[{match:this,type:null,via:null}];for(;r.length;){let i=r.shift(),o=i.match;if(o.matchType(e)){let s=[];for(let a=i;a.type;a=a.via)s.push(a.type);return s.reverse()}for(let s=0;s<o.next.length;s++){let{type:a,next:l}=o.next[s];!a.isLeaf&&!a.hasRequiredAttrs()&&!(a.name in t)&&(!i.type||l.validEnd)&&(r.push({match:a.contentMatch,type:a,via:i}),t[a.name]=!0)}}return null}get edgeCount(){return this.next.length}edge(e){if(e>=this.next.length)throw new RangeError(`There's no ${e}th edge in this content match`);return this.next[e]}toString(){let e=[];function t(r){e.push(r);for(let i=0;i<r.next.length;i++)e.indexOf(r.next[i].next)==-1&&t(r.next[i].next)}return t(this),e.map((r,i)=>{let o=i+(r.validEnd?"*":" ")+" ";for(let s=0;s<r.next.length;s++)o+=(s?", ":"")+r.next[s].type.name+"->"+e.indexOf(r.next[s].next);return o}).join(`
`)}}No.empty=new No(!0);class tT{constructor(e,t){this.string=e,this.nodeTypes=t,this.inline=null,this.pos=0,this.tokens=e.split(/\s*(?=\b|\W|$)/),this.tokens[this.tokens.length-1]==""&&this.tokens.pop(),this.tokens[0]==""&&this.tokens.shift()}get next(){return this.tokens[this.pos]}eat(e){return this.next==e&&(this.pos++||!0)}err(e){throw new SyntaxError(e+" (in content expression '"+this.string+"')")}}function $y(n){let e=[];do e.push(nT(n));while(n.eat("|"));return e.length==1?e[0]:{type:"choice",exprs:e}}function nT(n){let e=[];do e.push(rT(n));while(n.next&&n.next!=")"&&n.next!="|");return e.length==1?e[0]:{type:"seq",exprs:e}}function rT(n){let e=sT(n);for(;;)if(n.eat("+"))e={type:"plus",expr:e};else if(n.eat("*"))e={type:"star",expr:e};else if(n.eat("?"))e={type:"opt",expr:e};else if(n.eat("{"))e=iT(n,e);else break;return e}function Wg(n){/\D/.test(n.next)&&n.err("Expected number, got '"+n.next+"'");let e=Number(n.next);return n.pos++,e}function iT(n,e){let t=Wg(n),r=t;return n.eat(",")&&(n.next!="}"?r=Wg(n):r=-1),n.eat("}")||n.err("Unclosed braced range"),{type:"range",min:t,max:r,expr:e}}function oT(n,e){let t=n.nodeTypes,r=t[e];if(r)return[r];let i=[];for(let o in t){let s=t[o];s.isInGroup(e)&&i.push(s)}return i.length==0&&n.err("No node type or group '"+e+"' found"),i}function sT(n){if(n.eat("(")){let e=$y(n);return n.eat(")")||n.err("Missing closing paren"),e}else if(/\W/.test(n.next))n.err("Unexpected token '"+n.next+"'");else{let e=oT(n,n.next).map(t=>(n.inline==null?n.inline=t.isInline:n.inline!=t.isInline&&n.err("Mixing inline and block content"),{type:"name",value:t}));return n.pos++,e.length==1?e[0]:{type:"choice",exprs:e}}}function aT(n){let e=[[]];return i(o(n,0),t()),e;function t(){return e.push([])-1}function r(s,a,l){let d={term:l,to:a};return e[s].push(d),d}function i(s,a){s.forEach(l=>l.to=a)}function o(s,a){if(s.type=="choice")return s.exprs.reduce((l,d)=>l.concat(o(d,a)),[]);if(s.type=="seq")for(let l=0;;l++){let d=o(s.exprs[l],a);if(l==s.exprs.length-1)return d;i(d,a=t())}else if(s.type=="star"){let l=t();return r(a,l),i(o(s.expr,l),l),[r(l)]}else if(s.type=="plus"){let l=t();return i(o(s.expr,a),l),i(o(s.expr,l),l),[r(l)]}else{if(s.type=="opt")return[r(a)].concat(o(s.expr,a));if(s.type=="range"){let l=a;for(let d=0;d<s.min;d++){let f=t();i(o(s.expr,l),f),l=f}if(s.max==-1)i(o(s.expr,l),l);else for(let d=s.min;d<s.max;d++){let f=t();r(l,f),i(o(s.expr,l),f),l=f}return[r(l)]}else{if(s.type=="name")return[r(a,void 0,s.value)];throw new Error("Unknown expr type")}}}}function zy(n,e){return e-n}function Ug(n,e){let t=[];return r(e),t.sort(zy);function r(i){let o=n[i];if(o.length==1&&!o[0].term)return r(o[0].to);t.push(i);for(let s=0;s<o.length;s++){let{term:a,to:l}=o[s];!a&&t.indexOf(l)==-1&&r(l)}}}function uT(n){let e=Object.create(null);return t(Ug(n,0));function t(r){let i=[];r.forEach(s=>{n[s].forEach(({term:a,to:l})=>{if(!a)return;let d;for(let f=0;f<i.length;f++)i[f][0]==a&&(d=i[f][1]);Ug(n,l).forEach(f=>{d||i.push([a,d=[]]),d.indexOf(f)==-1&&d.push(f)})})});let o=e[r.join(",")]=new No(r.indexOf(n.length-1)>-1);for(let s=0;s<i.length;s++){let a=i[s][1].sort(zy);o.next.push({type:i[s][0],next:e[a.join(",")]||t(a)})}return o}}function lT(n,e){for(let t=0,r=[n];t<r.length;t++){let i=r[t],o=!i.validEnd,s=[];for(let a=0;a<i.next.length;a++){let{type:l,next:d}=i.next[a];s.push(l.name),o&&!(l.isText||l.hasRequiredAttrs())&&(o=!1),r.indexOf(d)==-1&&r.push(d)}o&&e.err("Only non-generatable nodes ("+s.join(", ")+") in a required position (see https://prosemirror.net/docs/guide/#generatable)")}}function Hy(n){let e=Object.create(null);for(let t in n){let r=n[t];if(!r.hasDefault)return null;e[t]=r.default}return e}function qy(n,e){let t=Object.create(null);for(let r in n){let i=e&&e[r];if(i===void 0){let o=n[r];if(o.hasDefault)i=o.default;else throw new RangeError("No value supplied for attribute "+r)}t[r]=i}return t}function Vy(n,e,t,r){for(let i in e)if(!(i in n))throw new RangeError(`Unsupported attribute ${i} for ${t} of type ${i}`);for(let i in n){let o=n[i];o.validate&&o.validate(e[i])}}function Wy(n,e){let t=Object.create(null);if(e)for(let r in e)t[r]=new dT(n,r,e[r]);return t}let Kg=class Uy{constructor(e,t,r){this.name=e,this.schema=t,this.spec=r,this.markSet=null,this.groups=r.group?r.group.split(" "):[],this.attrs=Wy(e,r.attrs),this.defaultAttrs=Hy(this.attrs),this.contentMatch=null,this.inlineContent=null,this.isBlock=!(r.inline||e=="text"),this.isText=e=="text"}get isInline(){return!this.isBlock}get isTextblock(){return this.isBlock&&this.inlineContent}get isLeaf(){return this.contentMatch==No.empty}get isAtom(){return this.isLeaf||!!this.spec.atom}isInGroup(e){return this.groups.indexOf(e)>-1}get whitespace(){return this.spec.whitespace||(this.spec.code?"pre":"normal")}hasRequiredAttrs(){for(let e in this.attrs)if(this.attrs[e].isRequired)return!0;return!1}compatibleContent(e){return this==e||this.contentMatch.compatible(e.contentMatch)}computeAttrs(e){return!e&&this.defaultAttrs?this.defaultAttrs:qy(this.attrs,e)}create(e=null,t,r){if(this.isText)throw new Error("NodeType.create can't construct text nodes");return new Ui(this,this.computeAttrs(e),q.from(t),qe.setFrom(r))}createChecked(e=null,t,r){return t=q.from(t),this.checkContent(t),new Ui(this,this.computeAttrs(e),t,qe.setFrom(r))}createAndFill(e=null,t,r){if(e=this.computeAttrs(e),t=q.from(t),t.size){let s=this.contentMatch.fillBefore(t);if(!s)return null;t=s.append(t)}let i=this.contentMatch.matchFragment(t),o=i&&i.fillBefore(q.empty,!0);return o?new Ui(this,e,t.append(o),qe.setFrom(r)):null}validContent(e){let t=this.contentMatch.matchFragment(e);if(!t||!t.validEnd)return!1;for(let r=0;r<e.childCount;r++)if(!this.allowsMarks(e.child(r).marks))return!1;return!0}checkContent(e){if(!this.validContent(e))throw new RangeError(`Invalid content for node ${this.name}: ${e.toString().slice(0,50)}`)}checkAttrs(e){Vy(this.attrs,e,"node",this.name)}allowsMarkType(e){return this.markSet==null||this.markSet.indexOf(e)>-1}allowsMarks(e){if(this.markSet==null)return!0;for(let t=0;t<e.length;t++)if(!this.allowsMarkType(e[t].type))return!1;return!0}allowedMarks(e){if(this.markSet==null)return e;let t;for(let r=0;r<e.length;r++)this.allowsMarkType(e[r].type)?t&&t.push(e[r]):t||(t=e.slice(0,r));return t?t.length?t:qe.none:e}static compile(e,t){let r=Object.create(null);e.forEach((o,s)=>r[o]=new Uy(o,t,s));let i=t.spec.topNode||"doc";if(!r[i])throw new RangeError("Schema is missing its top node type ('"+i+"')");if(!r.text)throw new RangeError("Every schema needs a 'text' type");for(let o in r.text.attrs)throw new RangeError("The text node type should not have attributes");return r}};function cT(n,e,t){let r=t.split("|");return i=>{let o=i===null?"null":typeof i;if(r.indexOf(o)<0)throw new RangeError(`Expected value of type ${r} for attribute ${e} on type ${n}, got ${o}`)}}class dT{constructor(e,t,r){this.hasDefault=Object.prototype.hasOwnProperty.call(r,"default"),this.default=r.default,this.validate=typeof r.validate=="string"?cT(e,t,r.validate):r.validate}get isRequired(){return!this.hasDefault}}class Ac{constructor(e,t,r,i){this.name=e,this.rank=t,this.schema=r,this.spec=i,this.attrs=Wy(e,i.attrs),this.excluded=null;let o=Hy(this.attrs);this.instance=o?new qe(this,o):null}create(e=null){return!e&&this.instance?this.instance:new qe(this,qy(this.attrs,e))}static compile(e,t){let r=Object.create(null),i=0;return e.forEach((o,s)=>r[o]=new Ac(o,i++,t,s)),r}removeFromSet(e){for(var t=0;t<e.length;t++)e[t].type==this&&(e=e.slice(0,t).concat(e.slice(t+1)),t--);return e}isInSet(e){for(let t=0;t<e.length;t++)if(e[t].type==this)return e[t]}checkAttrs(e){Vy(this.attrs,e,"mark",this.name)}excludes(e){return this.excluded.indexOf(e)>-1}}class np{constructor(e){this.linebreakReplacement=null,this.cached=Object.create(null);let t=this.spec={};for(let i in e)t[i]=e[i];t.nodes=Ft.from(e.nodes),t.marks=Ft.from(e.marks||{}),this.nodes=Kg.compile(this.spec.nodes,this),this.marks=Ac.compile(this.spec.marks,this);let r=Object.create(null);for(let i in this.nodes){if(i in this.marks)throw new RangeError(i+" can not be both a node and a mark");let o=this.nodes[i],s=o.spec.content||"",a=o.spec.marks;if(o.contentMatch=r[s]||(r[s]=No.parse(s,this.nodes)),o.inlineContent=o.contentMatch.inlineContent,o.spec.linebreakReplacement){if(this.linebreakReplacement)throw new RangeError("Multiple linebreak nodes defined");if(!o.isInline||!o.isLeaf)throw new RangeError("Linebreak replacement nodes must be inline leaf nodes");this.linebreakReplacement=o}o.markSet=a=="_"?null:a?jg(this,a.split(" ")):a==""||!o.inlineContent?[]:null}for(let i in this.marks){let o=this.marks[i],s=o.spec.excludes;o.excluded=s==null?[o]:s==""?[]:jg(this,s.split(" "))}this.nodeFromJSON=this.nodeFromJSON.bind(this),this.markFromJSON=this.markFromJSON.bind(this),this.topNodeType=this.nodes[this.spec.topNode||"doc"],this.cached.wrappings=Object.create(null)}node(e,t=null,r,i){if(typeof e=="string")e=this.nodeType(e);else if(e instanceof Kg){if(e.schema!=this)throw new RangeError("Node type from different schema used ("+e.name+")")}else throw new RangeError("Invalid node type: "+e);return e.createChecked(t,r,i)}text(e,t){let r=this.nodes.text;return new lc(r,r.defaultAttrs,e,qe.setFrom(t))}mark(e,t){return typeof e=="string"&&(e=this.marks[e]),e.create(t)}nodeFromJSON(e){return Ui.fromJSON(this,e)}markFromJSON(e){return qe.fromJSON(this,e)}nodeType(e){let t=this.nodes[e];if(!t)throw new RangeError("Unknown node type: "+e);return t}}function jg(n,e){let t=[];for(let r=0;r<e.length;r++){let i=e[r],o=n.marks[i],s=o;if(o)t.push(o);else for(let a in n.marks){let l=n.marks[a];(i=="_"||l.spec.group&&l.spec.group.split(" ").indexOf(i)>-1)&&t.push(s=l)}if(!s)throw new SyntaxError("Unknown mark type: '"+e[r]+"'")}return t}function fT(n){return n.tag!=null}function hT(n){return n.style!=null}let _s=class kh{constructor(e,t){this.schema=e,this.rules=t,this.tags=[],this.styles=[];let r=this.matchedStyles=[];t.forEach(i=>{if(fT(i))this.tags.push(i);else if(hT(i)){let o=/[^=]*/.exec(i.style)[0];r.indexOf(o)<0&&r.push(o),this.styles.push(i)}}),this.normalizeLists=!this.tags.some(i=>{if(!/^(ul|ol)\b/.test(i.tag)||!i.node)return!1;let o=e.nodes[i.node];return o.contentMatch.matchType(o)})}parse(e,t={}){let r=new Xg(this,t,!1);return r.addAll(e,qe.none,t.from,t.to),r.finish()}parseSlice(e,t={}){let r=new Xg(this,t,!0);return r.addAll(e,qe.none,t.from,t.to),X.maxOpen(r.finish())}matchTag(e,t,r){for(let i=r?this.tags.indexOf(r)+1:0;i<this.tags.length;i++){let o=this.tags[i];if(gT(e,o.tag)&&(o.namespace===void 0||e.namespaceURI==o.namespace)&&(!o.context||t.matchesContext(o.context))){if(o.getAttrs){let s=o.getAttrs(e);if(s===!1)continue;o.attrs=s||void 0}return o}}}matchStyle(e,t,r,i){for(let o=i?this.styles.indexOf(i)+1:0;o<this.styles.length;o++){let s=this.styles[o],a=s.style;if(!(a.indexOf(e)!=0||s.context&&!r.matchesContext(s.context)||a.length>e.length&&(a.charCodeAt(e.length)!=61||a.slice(e.length+1)!=t))){if(s.getAttrs){let l=s.getAttrs(t);if(l===!1)continue;s.attrs=l||void 0}return s}}}static schemaRules(e){let t=[];function r(i){let o=i.priority==null?50:i.priority,s=0;for(;s<t.length;s++){let a=t[s];if((a.priority==null?50:a.priority)<o)break}t.splice(s,0,i)}for(let i in e.marks){let o=e.marks[i].spec.parseDOM;o&&o.forEach(s=>{r(s=Yg(s)),s.mark||s.ignore||s.clearMark||(s.mark=i)})}for(let i in e.nodes){let o=e.nodes[i].spec.parseDOM;o&&o.forEach(s=>{r(s=Yg(s)),s.node||s.ignore||s.mark||(s.node=i)})}return t}static fromSchema(e){return e.cached.domParser||(e.cached.domParser=new kh(e,kh.schemaRules(e)))}};const Ky={address:!0,article:!0,aside:!0,blockquote:!0,canvas:!0,dd:!0,div:!0,dl:!0,fieldset:!0,figcaption:!0,figure:!0,footer:!0,form:!0,h1:!0,h2:!0,h3:!0,h4:!0,h5:!0,h6:!0,header:!0,hgroup:!0,hr:!0,li:!0,noscript:!0,ol:!0,output:!0,p:!0,pre:!0,section:!0,table:!0,tfoot:!0,ul:!0},pT={head:!0,noscript:!0,object:!0,script:!0,style:!0,title:!0},jy={ol:!0,ul:!0},Ga=1,Sh=2,Vl=4;function Gg(n,e,t){return e!=null?(e?Ga:0)|(e==="full"?Sh:0):n&&n.whitespace=="pre"?Ga|Sh:t&-5}class Sl{constructor(e,t,r,i,o,s){this.type=e,this.attrs=t,this.marks=r,this.solid=i,this.options=s,this.content=[],this.activeMarks=qe.none,this.match=o||(s&Vl?null:e.contentMatch)}findWrapping(e){if(!this.match){if(!this.type)return[];let t=this.type.contentMatch.fillBefore(q.from(e));if(t)this.match=this.type.contentMatch.matchFragment(t);else{let r=this.type.contentMatch,i;return(i=r.findWrapping(e.type))?(this.match=r,i):null}}return this.match.findWrapping(e.type)}finish(e){if(!(this.options&Ga)){let r=this.content[this.content.length-1],i;if(r&&r.isText&&(i=/[ \t\r\n\u000c]+$/.exec(r.text))){let o=r;r.text.length==i[0].length?this.content.pop():this.content[this.content.length-1]=o.withText(o.text.slice(0,o.text.length-i[0].length))}}let t=q.from(this.content);return!e&&this.match&&(t=t.append(this.match.fillBefore(q.empty,!0))),this.type?this.type.create(this.attrs,t,this.marks):t}inlineContext(e){return this.type?this.type.inlineContent:this.content.length?this.content[0].isInline:e.parentNode&&!Ky.hasOwnProperty(e.parentNode.nodeName.toLowerCase())}}class Xg{constructor(e,t,r){this.parser=e,this.options=t,this.isOpen=r,this.open=0,this.localPreserveWS=!1;let i=t.topNode,o,s=Gg(null,t.preserveWhitespace,0)|(r?Vl:0);i?o=new Sl(i.type,i.attrs,qe.none,!0,t.topMatch||i.type.contentMatch,s):r?o=new Sl(null,null,qe.none,!0,null,s):o=new Sl(e.schema.topNodeType,null,qe.none,!0,null,s),this.nodes=[o],this.find=t.findPositions,this.needsBlock=!1}get top(){return this.nodes[this.open]}addDOM(e,t){e.nodeType==3?this.addTextNode(e,t):e.nodeType==1&&this.addElement(e,t)}addTextNode(e,t){let r=e.nodeValue,i=this.top,o=i.options&Sh?"full":this.localPreserveWS||(i.options&Ga)>0;if(o==="full"||i.inlineContext(e)||/[^ \t\r\n\u000c]/.test(r)){if(o)o!=="full"?r=r.replace(/\r?\n|\r/g," "):r=r.replace(/\r\n?/g,`
`);else if(r=r.replace(/[ \t\r\n\u000c]+/g," "),/^[ \t\r\n\u000c]/.test(r)&&this.open==this.nodes.length-1){let s=i.content[i.content.length-1],a=e.previousSibling;(!s||a&&a.nodeName=="BR"||s.isText&&/[ \t\r\n\u000c]$/.test(s.text))&&(r=r.slice(1))}r&&this.insertNode(this.parser.schema.text(r),t,!/\S/.test(r)),this.findInText(e)}else this.findInside(e)}addElement(e,t,r){let i=this.localPreserveWS,o=this.top;(e.tagName=="PRE"||/pre/.test(e.style&&e.style.whiteSpace))&&(this.localPreserveWS=!0);let s=e.nodeName.toLowerCase(),a;jy.hasOwnProperty(s)&&this.parser.normalizeLists&&mT(e);let l=this.options.ruleFromNode&&this.options.ruleFromNode(e)||(a=this.parser.matchTag(e,this,r));e:if(l?l.ignore:pT.hasOwnProperty(s))this.findInside(e),this.ignoreFallback(e,t);else if(!l||l.skip||l.closeParent){l&&l.closeParent?this.open=Math.max(0,this.open-1):l&&l.skip.nodeType&&(e=l.skip);let d,f=this.needsBlock;if(Ky.hasOwnProperty(s))o.content.length&&o.content[0].isInline&&this.open&&(this.open--,o=this.top),d=!0,o.type||(this.needsBlock=!0);else if(!e.firstChild){this.leafFallback(e,t);break e}let h=l&&l.skip?t:this.readStyles(e,t);h&&this.addAll(e,h),d&&this.sync(o),this.needsBlock=f}else{let d=this.readStyles(e,t);d&&this.addElementByRule(e,l,d,l.consuming===!1?a:void 0)}this.localPreserveWS=i}leafFallback(e,t){e.nodeName=="BR"&&this.top.type&&this.top.type.inlineContent&&this.addTextNode(e.ownerDocument.createTextNode(`
`),t)}ignoreFallback(e,t){e.nodeName=="BR"&&(!this.top.type||!this.top.type.inlineContent)&&this.findPlace(this.parser.schema.text("-"),t,!0)}readStyles(e,t){let r=e.style;if(r&&r.length)for(let i=0;i<this.parser.matchedStyles.length;i++){let o=this.parser.matchedStyles[i],s=r.getPropertyValue(o);if(s)for(let a=void 0;;){let l=this.parser.matchStyle(o,s,this,a);if(!l)break;if(l.ignore)return null;if(l.clearMark?t=t.filter(d=>!l.clearMark(d)):t=t.concat(this.parser.schema.marks[l.mark].create(l.attrs)),l.consuming===!1)a=l;else break}}return t}addElementByRule(e,t,r,i){let o,s;if(t.node)if(s=this.parser.schema.nodes[t.node],s.isLeaf)this.insertNode(s.create(t.attrs),r,e.nodeName=="BR")||this.leafFallback(e,r);else{let l=this.enter(s,t.attrs||null,r,t.preserveWhitespace);l&&(o=!0,r=l)}else{let l=this.parser.schema.marks[t.mark];r=r.concat(l.create(t.attrs))}let a=this.top;if(s&&s.isLeaf)this.findInside(e);else if(i)this.addElement(e,r,i);else if(t.getContent)this.findInside(e),t.getContent(e,this.parser.schema).forEach(l=>this.insertNode(l,r,!1));else{let l=e;typeof t.contentElement=="string"?l=e.querySelector(t.contentElement):typeof t.contentElement=="function"?l=t.contentElement(e):t.contentElement&&(l=t.contentElement),this.findAround(e,l,!0),this.addAll(l,r),this.findAround(e,l,!1)}o&&this.sync(a)&&this.open--}addAll(e,t,r,i){let o=r||0;for(let s=r?e.childNodes[r]:e.firstChild,a=i==null?null:e.childNodes[i];s!=a;s=s.nextSibling,++o)this.findAtPoint(e,o),this.addDOM(s,t);this.findAtPoint(e,o)}findPlace(e,t,r){let i,o;for(let s=this.open,a=0;s>=0;s--){let l=this.nodes[s],d=l.findWrapping(e);if(d&&(!i||i.length>d.length+a)&&(i=d,o=l,!d.length))break;if(l.solid){if(r)break;a+=2}}if(!i)return null;this.sync(o);for(let s=0;s<i.length;s++)t=this.enterInner(i[s],null,t,!1);return t}insertNode(e,t,r){if(e.isInline&&this.needsBlock&&!this.top.type){let o=this.textblockFromContext();o&&(t=this.enterInner(o,null,t))}let i=this.findPlace(e,t,r);if(i){this.closeExtra();let o=this.top;o.match&&(o.match=o.match.matchType(e.type));let s=qe.none;for(let a of i.concat(e.marks))(o.type?o.type.allowsMarkType(a.type):Jg(a.type,e.type))&&(s=a.addToSet(s));return o.content.push(e.mark(s)),!0}return!1}enter(e,t,r,i){let o=this.findPlace(e.create(t),r,!1);return o&&(o=this.enterInner(e,t,r,!0,i)),o}enterInner(e,t,r,i=!1,o){this.closeExtra();let s=this.top;s.match=s.match&&s.match.matchType(e);let a=Gg(e,o,s.options);s.options&Vl&&s.content.length==0&&(a|=Vl);let l=qe.none;return r=r.filter(d=>(s.type?s.type.allowsMarkType(d.type):Jg(d.type,e))?(l=d.addToSet(l),!1):!0),this.nodes.push(new Sl(e,t,l,i,null,a)),this.open++,r}closeExtra(e=!1){let t=this.nodes.length-1;if(t>this.open){for(;t>this.open;t--)this.nodes[t-1].content.push(this.nodes[t].finish(e));this.nodes.length=this.open+1}}finish(){return this.open=0,this.closeExtra(this.isOpen),this.nodes[0].finish(!!(this.isOpen||this.options.topOpen))}sync(e){for(let t=this.open;t>=0;t--){if(this.nodes[t]==e)return this.open=t,!0;this.localPreserveWS&&(this.nodes[t].options|=Ga)}return!1}get currentPos(){this.closeExtra();let e=0;for(let t=this.open;t>=0;t--){let r=this.nodes[t].content;for(let i=r.length-1;i>=0;i--)e+=r[i].nodeSize;t&&e++}return e}findAtPoint(e,t){if(this.find)for(let r=0;r<this.find.length;r++)this.find[r].node==e&&this.find[r].offset==t&&(this.find[r].pos=this.currentPos)}findInside(e){if(this.find)for(let t=0;t<this.find.length;t++)this.find[t].pos==null&&e.nodeType==1&&e.contains(this.find[t].node)&&(this.find[t].pos=this.currentPos)}findAround(e,t,r){if(e!=t&&this.find)for(let i=0;i<this.find.length;i++)this.find[i].pos==null&&e.nodeType==1&&e.contains(this.find[i].node)&&t.compareDocumentPosition(this.find[i].node)&(r?2:4)&&(this.find[i].pos=this.currentPos)}findInText(e){if(this.find)for(let t=0;t<this.find.length;t++)this.find[t].node==e&&(this.find[t].pos=this.currentPos-(e.nodeValue.length-this.find[t].offset))}matchesContext(e){if(e.indexOf("|")>-1)return e.split(/\s*\|\s*/).some(this.matchesContext,this);let t=e.split("/"),r=this.options.context,i=!this.isOpen&&(!r||r.parent.type==this.nodes[0].type),o=-(r?r.depth+1:0)+(i?0:1),s=(a,l)=>{for(;a>=0;a--){let d=t[a];if(d==""){if(a==t.length-1||a==0)continue;for(;l>=o;l--)if(s(a-1,l))return!0;return!1}else{let f=l>0||l==0&&i?this.nodes[l].type:r&&l>=o?r.node(l-o).type:null;if(!f||f.name!=d&&!f.isInGroup(d))return!1;l--}}return!0};return s(t.length-1,this.open)}textblockFromContext(){let e=this.options.context;if(e)for(let t=e.depth;t>=0;t--){let r=e.node(t).contentMatchAt(e.indexAfter(t)).defaultType;if(r&&r.isTextblock&&r.defaultAttrs)return r}for(let t in this.parser.schema.nodes){let r=this.parser.schema.nodes[t];if(r.isTextblock&&r.defaultAttrs)return r}}}function mT(n){for(let e=n.firstChild,t=null;e;e=e.nextSibling){let r=e.nodeType==1?e.nodeName.toLowerCase():null;r&&jy.hasOwnProperty(r)&&t?(t.appendChild(e),e=t):r=="li"?t=e:r&&(t=null)}}function gT(n,e){return(n.matches||n.msMatchesSelector||n.webkitMatchesSelector||n.mozMatchesSelector).call(n,e)}function Yg(n){let e={};for(let t in n)e[t]=n[t];return e}function Jg(n,e){let t=e.schema.nodes;for(let r in t){let i=t[r];if(!i.allowsMarkType(n))continue;let o=[],s=a=>{o.push(a);for(let l=0;l<a.edgeCount;l++){let{type:d,next:f}=a.edge(l);if(d==e||o.indexOf(f)<0&&s(f))return!0}};if(s(i.contentMatch))return!0}}class zo{constructor(e,t){this.nodes=e,this.marks=t}serializeFragment(e,t={},r){r||(r=Af(t).createDocumentFragment());let i=r,o=[];return e.forEach(s=>{if(o.length||s.marks.length){let a=0,l=0;for(;a<o.length&&l<s.marks.length;){let d=s.marks[l];if(!this.marks[d.type.name]){l++;continue}if(!d.eq(o[a][0])||d.type.spec.spanning===!1)break;a++,l++}for(;a<o.length;)i=o.pop()[1];for(;l<s.marks.length;){let d=s.marks[l++],f=this.serializeMark(d,s.isInline,t);f&&(o.push([d,i]),i.appendChild(f.dom),i=f.contentDOM||f.dom)}}i.appendChild(this.serializeNodeInner(s,t))}),r}serializeNodeInner(e,t){let{dom:r,contentDOM:i}=Wl(Af(t),this.nodes[e.type.name](e),null,e.attrs);if(i){if(e.isLeaf)throw new RangeError("Content hole not allowed in a leaf node spec");this.serializeFragment(e.content,t,i)}return r}serializeNode(e,t={}){let r=this.serializeNodeInner(e,t);for(let i=e.marks.length-1;i>=0;i--){let o=this.serializeMark(e.marks[i],e.isInline,t);o&&((o.contentDOM||o.dom).appendChild(r),r=o.dom)}return r}serializeMark(e,t,r={}){let i=this.marks[e.type.name];return i&&Wl(Af(r),i(e,t),null,e.attrs)}static renderSpec(e,t,r=null,i){return Wl(e,t,r,i)}static fromSchema(e){return e.cached.domSerializer||(e.cached.domSerializer=new zo(this.nodesFromSchema(e),this.marksFromSchema(e)))}static nodesFromSchema(e){let t=Zg(e.nodes);return t.text||(t.text=r=>r.text),t}static marksFromSchema(e){return Zg(e.marks)}}function Zg(n){let e={};for(let t in n){let r=n[t].spec.toDOM;r&&(e[t]=r)}return e}function Af(n){return n.document||window.document}const Qg=new WeakMap;function bT(n){let e=Qg.get(n);return e===void 0&&Qg.set(n,e=yT(n)),e}function yT(n){let e=null;function t(r){if(r&&typeof r=="object")if(Array.isArray(r))if(typeof r[0]=="string")e||(e=[]),e.push(r);else for(let i=0;i<r.length;i++)t(r[i]);else for(let i in r)t(r[i])}return t(n),e}function Wl(n,e,t,r){if(typeof e=="string")return{dom:n.createTextNode(e)};if(e.nodeType!=null)return{dom:e};if(e.dom&&e.dom.nodeType!=null)return e;let i=e[0],o;if(typeof i!="string")throw new RangeError("Invalid array passed to renderSpec");if(r&&(o=bT(r))&&o.indexOf(e)>-1)throw new RangeError("Using an array from an attribute object as a DOM spec. This may be an attempted cross site scripting attack.");let s=i.indexOf(" ");s>0&&(t=i.slice(0,s),i=i.slice(s+1));let a,l=t?n.createElementNS(t,i):n.createElement(i),d=e[1],f=1;if(d&&typeof d=="object"&&d.nodeType==null&&!Array.isArray(d)){f=2;for(let h in d)if(d[h]!=null){let m=h.indexOf(" ");m>0?l.setAttributeNS(h.slice(0,m),h.slice(m+1),d[h]):l.setAttribute(h,d[h])}}for(let h=f;h<e.length;h++){let m=e[h];if(m===0){if(h<e.length-1||h>f)throw new RangeError("Content hole must be the only child of its parent node");return{dom:l,contentDOM:l}}else{let{dom:g,contentDOM:b}=Wl(n,m,t,r);if(l.appendChild(g),b){if(a)throw new RangeError("Multiple content holes");a=b}}}return{dom:l,contentDOM:a}}const Gy=65535,Xy=Math.pow(2,16);function vT(n,e){return n+e*Xy}function e1(n){return n&Gy}function xT(n){return(n-(n&Gy))/Xy}const Yy=1,Jy=2,Ul=4,Zy=8;class Ch{constructor(e,t,r){this.pos=e,this.delInfo=t,this.recover=r}get deleted(){return(this.delInfo&Zy)>0}get deletedBefore(){return(this.delInfo&(Yy|Ul))>0}get deletedAfter(){return(this.delInfo&(Jy|Ul))>0}get deletedAcross(){return(this.delInfo&Ul)>0}}class Ln{constructor(e,t=!1){if(this.ranges=e,this.inverted=t,!e.length&&Ln.empty)return Ln.empty}recover(e){let t=0,r=e1(e);if(!this.inverted)for(let i=0;i<r;i++)t+=this.ranges[i*3+2]-this.ranges[i*3+1];return this.ranges[r*3]+t+xT(e)}mapResult(e,t=1){return this._map(e,t,!1)}map(e,t=1){return this._map(e,t,!0)}_map(e,t,r){let i=0,o=this.inverted?2:1,s=this.inverted?1:2;for(let a=0;a<this.ranges.length;a+=3){let l=this.ranges[a]-(this.inverted?i:0);if(l>e)break;let d=this.ranges[a+o],f=this.ranges[a+s],h=l+d;if(e<=h){let m=d?e==l?-1:e==h?1:t:t,g=l+i+(m<0?0:f);if(r)return g;let b=e==(t<0?l:h)?null:vT(a/3,e-l),v=e==l?Jy:e==h?Yy:Ul;return(t<0?e!=l:e!=h)&&(v|=Zy),new Ch(g,v,b)}i+=f-d}return r?e+i:new Ch(e+i,0,null)}touches(e,t){let r=0,i=e1(t),o=this.inverted?2:1,s=this.inverted?1:2;for(let a=0;a<this.ranges.length;a+=3){let l=this.ranges[a]-(this.inverted?r:0);if(l>e)break;let d=this.ranges[a+o],f=l+d;if(e<=f&&a==i*3)return!0;r+=this.ranges[a+s]-d}return!1}forEach(e){let t=this.inverted?2:1,r=this.inverted?1:2;for(let i=0,o=0;i<this.ranges.length;i+=3){let s=this.ranges[i],a=s-(this.inverted?o:0),l=s+(this.inverted?0:o),d=this.ranges[i+t],f=this.ranges[i+r];e(a,a+d,l,l+f),o+=f-d}}invert(){return new Ln(this.ranges,!this.inverted)}toString(){return(this.inverted?"-":"")+JSON.stringify(this.ranges)}static offset(e){return e==0?Ln.empty:new Ln(e<0?[0,-e,0]:[0,0,e])}}Ln.empty=new Ln([]);class Xa{constructor(e,t,r=0,i=e?e.length:0){this.mirror=t,this.from=r,this.to=i,this._maps=e||[],this.ownData=!(e||t)}get maps(){return this._maps}slice(e=0,t=this.maps.length){return new Xa(this._maps,this.mirror,e,t)}appendMap(e,t){this.ownData||(this._maps=this._maps.slice(),this.mirror=this.mirror&&this.mirror.slice(),this.ownData=!0),this.to=this._maps.push(e),t!=null&&this.setMirror(this._maps.length-1,t)}appendMapping(e){for(let t=0,r=this._maps.length;t<e._maps.length;t++){let i=e.getMirror(t);this.appendMap(e._maps[t],i!=null&&i<t?r+i:void 0)}}getMirror(e){if(this.mirror){for(let t=0;t<this.mirror.length;t++)if(this.mirror[t]==e)return this.mirror[t+(t%2?-1:1)]}}setMirror(e,t){this.mirror||(this.mirror=[]),this.mirror.push(e,t)}appendMappingInverted(e){for(let t=e.maps.length-1,r=this._maps.length+e._maps.length;t>=0;t--){let i=e.getMirror(t);this.appendMap(e._maps[t].invert(),i!=null&&i>t?r-i-1:void 0)}}invert(){let e=new Xa;return e.appendMappingInverted(this),e}map(e,t=1){if(this.mirror)return this._map(e,t,!0);for(let r=this.from;r<this.to;r++)e=this._maps[r].map(e,t);return e}mapResult(e,t=1){return this._map(e,t,!1)}_map(e,t,r){let i=0;for(let o=this.from;o<this.to;o++){let s=this._maps[o],a=s.mapResult(e,t);if(a.recover!=null){let l=this.getMirror(o);if(l!=null&&l>o&&l<this.to){o=l,e=this._maps[l].recover(a.recover);continue}}i|=a.delInfo,e=a.pos}return r?e:new Ch(e,i,null)}}const Tf=Object.create(null);class Jt{getMap(){return Ln.empty}merge(e){return null}static fromJSON(e,t){if(!t||!t.stepType)throw new RangeError("Invalid input for Step.fromJSON");let r=Tf[t.stepType];if(!r)throw new RangeError(`No step type ${t.stepType} defined`);return r.fromJSON(e,t)}static jsonID(e,t){if(e in Tf)throw new RangeError("Duplicate use of step JSON ID "+e);return Tf[e]=t,t.prototype.jsonID=e,t}}class gt{constructor(e,t){this.doc=e,this.failed=t}static ok(e){return new gt(e,null)}static fail(e){return new gt(null,e)}static fromReplace(e,t,r,i){try{return gt.ok(e.replace(t,r,i))}catch(o){if(o instanceof sc)return gt.fail(o.message);throw o}}}function rp(n,e,t){let r=[];for(let i=0;i<n.childCount;i++){let o=n.child(i);o.content.size&&(o=o.copy(rp(o.content,e,o))),o.isInline&&(o=e(o,t,i)),r.push(o)}return q.fromArray(r)}class Hi extends Jt{constructor(e,t,r){super(),this.from=e,this.to=t,this.mark=r}apply(e){let t=e.slice(this.from,this.to),r=e.resolve(this.from),i=r.node(r.sharedDepth(this.to)),o=new X(rp(t.content,(s,a)=>!s.isAtom||!a.type.allowsMarkType(this.mark.type)?s:s.mark(this.mark.addToSet(s.marks)),i),t.openStart,t.openEnd);return gt.fromReplace(e,this.from,this.to,o)}invert(){return new Ir(this.from,this.to,this.mark)}map(e){let t=e.mapResult(this.from,1),r=e.mapResult(this.to,-1);return t.deleted&&r.deleted||t.pos>=r.pos?null:new Hi(t.pos,r.pos,this.mark)}merge(e){return e instanceof Hi&&e.mark.eq(this.mark)&&this.from<=e.to&&this.to>=e.from?new Hi(Math.min(this.from,e.from),Math.max(this.to,e.to),this.mark):null}toJSON(){return{stepType:"addMark",mark:this.mark.toJSON(),from:this.from,to:this.to}}static fromJSON(e,t){if(typeof t.from!="number"||typeof t.to!="number")throw new RangeError("Invalid input for AddMarkStep.fromJSON");return new Hi(t.from,t.to,e.markFromJSON(t.mark))}}Jt.jsonID("addMark",Hi);class Ir extends Jt{constructor(e,t,r){super(),this.from=e,this.to=t,this.mark=r}apply(e){let t=e.slice(this.from,this.to),r=new X(rp(t.content,i=>i.mark(this.mark.removeFromSet(i.marks)),e),t.openStart,t.openEnd);return gt.fromReplace(e,this.from,this.to,r)}invert(){return new Hi(this.from,this.to,this.mark)}map(e){let t=e.mapResult(this.from,1),r=e.mapResult(this.to,-1);return t.deleted&&r.deleted||t.pos>=r.pos?null:new Ir(t.pos,r.pos,this.mark)}merge(e){return e instanceof Ir&&e.mark.eq(this.mark)&&this.from<=e.to&&this.to>=e.from?new Ir(Math.min(this.from,e.from),Math.max(this.to,e.to),this.mark):null}toJSON(){return{stepType:"removeMark",mark:this.mark.toJSON(),from:this.from,to:this.to}}static fromJSON(e,t){if(typeof t.from!="number"||typeof t.to!="number")throw new RangeError("Invalid input for RemoveMarkStep.fromJSON");return new Ir(t.from,t.to,e.markFromJSON(t.mark))}}Jt.jsonID("removeMark",Ir);class qi extends Jt{constructor(e,t){super(),this.pos=e,this.mark=t}apply(e){let t=e.nodeAt(this.pos);if(!t)return gt.fail("No node at mark step's position");let r=t.type.create(t.attrs,null,this.mark.addToSet(t.marks));return gt.fromReplace(e,this.pos,this.pos+1,new X(q.from(r),0,t.isLeaf?0:1))}invert(e){let t=e.nodeAt(this.pos);if(t){let r=this.mark.addToSet(t.marks);if(r.length==t.marks.length){for(let i=0;i<t.marks.length;i++)if(!t.marks[i].isInSet(r))return new qi(this.pos,t.marks[i]);return new qi(this.pos,this.mark)}}return new Po(this.pos,this.mark)}map(e){let t=e.mapResult(this.pos,1);return t.deletedAfter?null:new qi(t.pos,this.mark)}toJSON(){return{stepType:"addNodeMark",pos:this.pos,mark:this.mark.toJSON()}}static fromJSON(e,t){if(typeof t.pos!="number")throw new RangeError("Invalid input for AddNodeMarkStep.fromJSON");return new qi(t.pos,e.markFromJSON(t.mark))}}Jt.jsonID("addNodeMark",qi);class Po extends Jt{constructor(e,t){super(),this.pos=e,this.mark=t}apply(e){let t=e.nodeAt(this.pos);if(!t)return gt.fail("No node at mark step's position");let r=t.type.create(t.attrs,null,this.mark.removeFromSet(t.marks));return gt.fromReplace(e,this.pos,this.pos+1,new X(q.from(r),0,t.isLeaf?0:1))}invert(e){let t=e.nodeAt(this.pos);return!t||!this.mark.isInSet(t.marks)?this:new qi(this.pos,this.mark)}map(e){let t=e.mapResult(this.pos,1);return t.deletedAfter?null:new Po(t.pos,this.mark)}toJSON(){return{stepType:"removeNodeMark",pos:this.pos,mark:this.mark.toJSON()}}static fromJSON(e,t){if(typeof t.pos!="number")throw new RangeError("Invalid input for RemoveNodeMarkStep.fromJSON");return new Po(t.pos,e.markFromJSON(t.mark))}}Jt.jsonID("removeNodeMark",Po);class Ct extends Jt{constructor(e,t,r,i=!1){super(),this.from=e,this.to=t,this.slice=r,this.structure=i}apply(e){return this.structure&&Eh(e,this.from,this.to)?gt.fail("Structure replace would overwrite content"):gt.fromReplace(e,this.from,this.to,this.slice)}getMap(){return new Ln([this.from,this.to-this.from,this.slice.size])}invert(e){return new Ct(this.from,this.from+this.slice.size,e.slice(this.from,this.to))}map(e){let t=e.mapResult(this.from,1),r=e.mapResult(this.to,-1);return t.deletedAcross&&r.deletedAcross?null:new Ct(t.pos,Math.max(t.pos,r.pos),this.slice,this.structure)}merge(e){if(!(e instanceof Ct)||e.structure||this.structure)return null;if(this.from+this.slice.size==e.from&&!this.slice.openEnd&&!e.slice.openStart){let t=this.slice.size+e.slice.size==0?X.empty:new X(this.slice.content.append(e.slice.content),this.slice.openStart,e.slice.openEnd);return new Ct(this.from,this.to+(e.to-e.from),t,this.structure)}else if(e.to==this.from&&!this.slice.openStart&&!e.slice.openEnd){let t=this.slice.size+e.slice.size==0?X.empty:new X(e.slice.content.append(this.slice.content),e.slice.openStart,this.slice.openEnd);return new Ct(e.from,this.to,t,this.structure)}else return null}toJSON(){let e={stepType:"replace",from:this.from,to:this.to};return this.slice.size&&(e.slice=this.slice.toJSON()),this.structure&&(e.structure=!0),e}static fromJSON(e,t){if(typeof t.from!="number"||typeof t.to!="number")throw new RangeError("Invalid input for ReplaceStep.fromJSON");return new Ct(t.from,t.to,X.fromJSON(e,t.slice),!!t.structure)}}Jt.jsonID("replace",Ct);class _t extends Jt{constructor(e,t,r,i,o,s,a=!1){super(),this.from=e,this.to=t,this.gapFrom=r,this.gapTo=i,this.slice=o,this.insert=s,this.structure=a}apply(e){if(this.structure&&(Eh(e,this.from,this.gapFrom)||Eh(e,this.gapTo,this.to)))return gt.fail("Structure gap-replace would overwrite content");let t=e.slice(this.gapFrom,this.gapTo);if(t.openStart||t.openEnd)return gt.fail("Gap is not a flat range");let r=this.slice.insertAt(this.insert,t.content);return r?gt.fromReplace(e,this.from,this.to,r):gt.fail("Content does not fit in gap")}getMap(){return new Ln([this.from,this.gapFrom-this.from,this.insert,this.gapTo,this.to-this.gapTo,this.slice.size-this.insert])}invert(e){let t=this.gapTo-this.gapFrom;return new _t(this.from,this.from+this.slice.size+t,this.from+this.insert,this.from+this.insert+t,e.slice(this.from,this.to).removeBetween(this.gapFrom-this.from,this.gapTo-this.from),this.gapFrom-this.from,this.structure)}map(e){let t=e.mapResult(this.from,1),r=e.mapResult(this.to,-1),i=this.from==this.gapFrom?t.pos:e.map(this.gapFrom,-1),o=this.to==this.gapTo?r.pos:e.map(this.gapTo,1);return t.deletedAcross&&r.deletedAcross||i<t.pos||o>r.pos?null:new _t(t.pos,r.pos,i,o,this.slice,this.insert,this.structure)}toJSON(){let e={stepType:"replaceAround",from:this.from,to:this.to,gapFrom:this.gapFrom,gapTo:this.gapTo,insert:this.insert};return this.slice.size&&(e.slice=this.slice.toJSON()),this.structure&&(e.structure=!0),e}static fromJSON(e,t){if(typeof t.from!="number"||typeof t.to!="number"||typeof t.gapFrom!="number"||typeof t.gapTo!="number"||typeof t.insert!="number")throw new RangeError("Invalid input for ReplaceAroundStep.fromJSON");return new _t(t.from,t.to,t.gapFrom,t.gapTo,X.fromJSON(e,t.slice),t.insert,!!t.structure)}}Jt.jsonID("replaceAround",_t);function Eh(n,e,t){let r=n.resolve(e),i=t-e,o=r.depth;for(;i>0&&o>0&&r.indexAfter(o)==r.node(o).childCount;)o--,i--;if(i>0){let s=r.node(o).maybeChild(r.indexAfter(o));for(;i>0;){if(!s||s.isLeaf)return!0;s=s.firstChild,i--}}return!1}function wT(n,e,t,r){let i=[],o=[],s,a;n.doc.nodesBetween(e,t,(l,d,f)=>{if(!l.isInline)return;let h=l.marks;if(!r.isInSet(h)&&f.type.allowsMarkType(r.type)){let m=Math.max(d,e),g=Math.min(d+l.nodeSize,t),b=r.addToSet(h);for(let v=0;v<h.length;v++)h[v].isInSet(b)||(s&&s.to==m&&s.mark.eq(h[v])?s.to=g:i.push(s=new Ir(m,g,h[v])));a&&a.to==m?a.to=g:o.push(a=new Hi(m,g,r))}}),i.forEach(l=>n.step(l)),o.forEach(l=>n.step(l))}function kT(n,e,t,r){let i=[],o=0;n.doc.nodesBetween(e,t,(s,a)=>{if(!s.isInline)return;o++;let l=null;if(r instanceof Ac){let d=s.marks,f;for(;f=r.isInSet(d);)(l||(l=[])).push(f),d=f.removeFromSet(d)}else r?r.isInSet(s.marks)&&(l=[r]):l=s.marks;if(l&&l.length){let d=Math.min(a+s.nodeSize,t);for(let f=0;f<l.length;f++){let h=l[f],m;for(let g=0;g<i.length;g++){let b=i[g];b.step==o-1&&h.eq(i[g].style)&&(m=b)}m?(m.to=d,m.step=o):i.push({style:h,from:Math.max(a,e),to:d,step:o})}}}),i.forEach(s=>n.step(new Ir(s.from,s.to,s.style)))}function ip(n,e,t,r=t.contentMatch,i=!0){let o=n.doc.nodeAt(e),s=[],a=e+1;for(let l=0;l<o.childCount;l++){let d=o.child(l),f=a+d.nodeSize,h=r.matchType(d.type);if(!h)s.push(new Ct(a,f,X.empty));else{r=h;for(let m=0;m<d.marks.length;m++)t.allowsMarkType(d.marks[m].type)||n.step(new Ir(a,f,d.marks[m]));if(i&&d.isText&&t.whitespace!="pre"){let m,g=/\r?\n|\r/g,b;for(;m=g.exec(d.text);)b||(b=new X(q.from(t.schema.text(" ",t.allowedMarks(d.marks))),0,0)),s.push(new Ct(a+m.index,a+m.index+m[0].length,b))}}a=f}if(!r.validEnd){let l=r.fillBefore(q.empty,!0);n.replace(a,a,new X(l,0,0))}for(let l=s.length-1;l>=0;l--)n.step(s[l])}function ST(n,e,t){return(e==0||n.canReplace(e,n.childCount))&&(t==n.childCount||n.canReplace(0,t))}function qs(n){let t=n.parent.content.cutByIndex(n.startIndex,n.endIndex);for(let r=n.depth;;--r){let i=n.$from.node(r),o=n.$from.index(r),s=n.$to.indexAfter(r);if(r<n.depth&&i.canReplace(o,s,t))return r;if(r==0||i.type.spec.isolating||!ST(i,o,s))break}return null}function CT(n,e,t){let{$from:r,$to:i,depth:o}=e,s=r.before(o+1),a=i.after(o+1),l=s,d=a,f=q.empty,h=0;for(let b=o,v=!1;b>t;b--)v||r.index(b)>0?(v=!0,f=q.from(r.node(b).copy(f)),h++):l--;let m=q.empty,g=0;for(let b=o,v=!1;b>t;b--)v||i.after(b+1)<i.end(b)?(v=!0,m=q.from(i.node(b).copy(m)),g++):d++;n.step(new _t(l,d,s,a,new X(f.append(m),h,g),f.size-h,!0))}function op(n,e,t=null,r=n){let i=ET(n,e),o=i&&_T(r,e);return o?i.map(t1).concat({type:e,attrs:t}).concat(o.map(t1)):null}function t1(n){return{type:n,attrs:null}}function ET(n,e){let{parent:t,startIndex:r,endIndex:i}=n,o=t.contentMatchAt(r).findWrapping(e);if(!o)return null;let s=o.length?o[0]:e;return t.canReplaceWith(r,i,s)?o:null}function _T(n,e){let{parent:t,startIndex:r,endIndex:i}=n,o=t.child(r),s=e.contentMatch.findWrapping(o.type);if(!s)return null;let l=(s.length?s[s.length-1]:e).contentMatch;for(let d=r;l&&d<i;d++)l=l.matchType(t.child(d).type);return!l||!l.validEnd?null:s}function AT(n,e,t){let r=q.empty;for(let s=t.length-1;s>=0;s--){if(r.size){let a=t[s].type.contentMatch.matchFragment(r);if(!a||!a.validEnd)throw new RangeError("Wrapper type given to Transform.wrap does not form valid content of its parent wrapper")}r=q.from(t[s].type.create(t[s].attrs,r))}let i=e.start,o=e.end;n.step(new _t(i,o,i,o,new X(r,0,0),t.length,!0))}function TT(n,e,t,r,i){if(!r.isTextblock)throw new RangeError("Type given to setBlockType should be a textblock");let o=n.steps.length;n.doc.nodesBetween(e,t,(s,a)=>{let l=typeof i=="function"?i(s):i;if(s.isTextblock&&!s.hasMarkup(r,l)&&DT(n.doc,n.mapping.slice(o).map(a),r)){let d=null;if(r.schema.linebreakReplacement){let g=r.whitespace=="pre",b=!!r.contentMatch.matchType(r.schema.linebreakReplacement);g&&!b?d=!1:!g&&b&&(d=!0)}d===!1&&ev(n,s,a,o),ip(n,n.mapping.slice(o).map(a,1),r,void 0,d===null);let f=n.mapping.slice(o),h=f.map(a,1),m=f.map(a+s.nodeSize,1);return n.step(new _t(h,m,h+1,m-1,new X(q.from(r.create(l,null,s.marks)),0,0),1,!0)),d===!0&&Qy(n,s,a,o),!1}})}function Qy(n,e,t,r){e.forEach((i,o)=>{if(i.isText){let s,a=/\r?\n|\r/g;for(;s=a.exec(i.text);){let l=n.mapping.slice(r).map(t+1+o+s.index);n.replaceWith(l,l+1,e.type.schema.linebreakReplacement.create())}}})}function ev(n,e,t,r){e.forEach((i,o)=>{if(i.type==i.type.schema.linebreakReplacement){let s=n.mapping.slice(r).map(t+1+o);n.replaceWith(s,s+1,e.type.schema.text(`
`))}})}function DT(n,e,t){let r=n.resolve(e),i=r.index();return r.parent.canReplaceWith(i,i+1,t)}function MT(n,e,t,r,i){let o=n.doc.nodeAt(e);if(!o)throw new RangeError("No node at given position");t||(t=o.type);let s=t.create(r,null,i||o.marks);if(o.isLeaf)return n.replaceWith(e,e+o.nodeSize,s);if(!t.validContent(o.content))throw new RangeError("Invalid content for node type "+t.name);n.step(new _t(e,e+o.nodeSize,e+1,e+o.nodeSize-1,new X(q.from(s),0,0),1,!0))}function di(n,e,t=1,r){let i=n.resolve(e),o=i.depth-t,s=r&&r[r.length-1]||i.parent;if(o<0||i.parent.type.spec.isolating||!i.parent.canReplace(i.index(),i.parent.childCount)||!s.type.validContent(i.parent.content.cutByIndex(i.index(),i.parent.childCount)))return!1;for(let d=i.depth-1,f=t-2;d>o;d--,f--){let h=i.node(d),m=i.index(d);if(h.type.spec.isolating)return!1;let g=h.content.cutByIndex(m,h.childCount),b=r&&r[f+1];b&&(g=g.replaceChild(0,b.type.create(b.attrs)));let v=r&&r[f]||h;if(!h.canReplace(m+1,h.childCount)||!v.type.validContent(g))return!1}let a=i.indexAfter(o),l=r&&r[0];return i.node(o).canReplaceWith(a,a,l?l.type:i.node(o+1).type)}function OT(n,e,t=1,r){let i=n.doc.resolve(e),o=q.empty,s=q.empty;for(let a=i.depth,l=i.depth-t,d=t-1;a>l;a--,d--){o=q.from(i.node(a).copy(o));let f=r&&r[d];s=q.from(f?f.type.create(f.attrs,s):i.node(a).copy(s))}n.step(new Ct(e,e,new X(o.append(s),t,t),!0))}function Ji(n,e){let t=n.resolve(e),r=t.index();return tv(t.nodeBefore,t.nodeAfter)&&t.parent.canReplace(r,r+1)}function IT(n,e){e.content.size||n.type.compatibleContent(e.type);let t=n.contentMatchAt(n.childCount),{linebreakReplacement:r}=n.type.schema;for(let i=0;i<e.childCount;i++){let o=e.child(i),s=o.type==r?n.type.schema.nodes.text:o.type;if(t=t.matchType(s),!t||!n.type.allowsMarks(o.marks))return!1}return t.validEnd}function tv(n,e){return!!(n&&e&&!n.isLeaf&&IT(n,e))}function Tc(n,e,t=-1){let r=n.resolve(e);for(let i=r.depth;;i--){let o,s,a=r.index(i);if(i==r.depth?(o=r.nodeBefore,s=r.nodeAfter):t>0?(o=r.node(i+1),a++,s=r.node(i).maybeChild(a)):(o=r.node(i).maybeChild(a-1),s=r.node(i+1)),o&&!o.isTextblock&&tv(o,s)&&r.node(i).canReplace(a,a+1))return e;if(i==0)break;e=t<0?r.before(i):r.after(i)}}function NT(n,e,t){let r=null,{linebreakReplacement:i}=n.doc.type.schema,o=n.doc.resolve(e-t),s=o.node().type;if(i&&s.inlineContent){let f=s.whitespace=="pre",h=!!s.contentMatch.matchType(i);f&&!h?r=!1:!f&&h&&(r=!0)}let a=n.steps.length;if(r===!1){let f=n.doc.resolve(e+t);ev(n,f.node(),f.before(),a)}s.inlineContent&&ip(n,e+t-1,s,o.node().contentMatchAt(o.index()),r==null);let l=n.mapping.slice(a),d=l.map(e-t);if(n.step(new Ct(d,l.map(e+t,-1),X.empty,!0)),r===!0){let f=n.doc.resolve(d);Qy(n,f.node(),f.before(),n.steps.length)}return n}function PT(n,e,t){let r=n.resolve(e);if(r.parent.canReplaceWith(r.index(),r.index(),t))return e;if(r.parentOffset==0)for(let i=r.depth-1;i>=0;i--){let o=r.index(i);if(r.node(i).canReplaceWith(o,o,t))return r.before(i+1);if(o>0)return null}if(r.parentOffset==r.parent.content.size)for(let i=r.depth-1;i>=0;i--){let o=r.indexAfter(i);if(r.node(i).canReplaceWith(o,o,t))return r.after(i+1);if(o<r.node(i).childCount)return null}return null}function nv(n,e,t){let r=n.resolve(e);if(!t.content.size)return e;let i=t.content;for(let o=0;o<t.openStart;o++)i=i.firstChild.content;for(let o=1;o<=(t.openStart==0&&t.size?2:1);o++)for(let s=r.depth;s>=0;s--){let a=s==r.depth?0:r.pos<=(r.start(s+1)+r.end(s+1))/2?-1:1,l=r.index(s)+(a>0?1:0),d=r.node(s),f=!1;if(o==1)f=d.canReplace(l,l,i);else{let h=d.contentMatchAt(l).findWrapping(i.firstChild.type);f=h&&d.canReplaceWith(l,l,h[0])}if(f)return a==0?r.pos:a<0?r.before(s+1):r.after(s+1)}return null}function Dc(n,e,t=e,r=X.empty){if(e==t&&!r.size)return null;let i=n.resolve(e),o=n.resolve(t);return rv(i,o,r)?new Ct(e,t,r):new FT(i,o,r).fit()}function rv(n,e,t){return!t.openStart&&!t.openEnd&&n.start()==e.start()&&n.parent.canReplace(n.index(),e.index(),t.content)}class FT{constructor(e,t,r){this.$from=e,this.$to=t,this.unplaced=r,this.frontier=[],this.placed=q.empty;for(let i=0;i<=e.depth;i++){let o=e.node(i);this.frontier.push({type:o.type,match:o.contentMatchAt(e.indexAfter(i))})}for(let i=e.depth;i>0;i--)this.placed=q.from(e.node(i).copy(this.placed))}get depth(){return this.frontier.length-1}fit(){for(;this.unplaced.size;){let d=this.findFittable();d?this.placeNodes(d):this.openMore()||this.dropNode()}let e=this.mustMoveInline(),t=this.placed.size-this.depth-this.$from.depth,r=this.$from,i=this.close(e<0?this.$to:r.doc.resolve(e));if(!i)return null;let o=this.placed,s=r.depth,a=i.depth;for(;s&&a&&o.childCount==1;)o=o.firstChild.content,s--,a--;let l=new X(o,s,a);return e>-1?new _t(r.pos,e,this.$to.pos,this.$to.end(),l,t):l.size||r.pos!=this.$to.pos?new Ct(r.pos,i.pos,l):null}findFittable(){let e=this.unplaced.openStart;for(let t=this.unplaced.content,r=0,i=this.unplaced.openEnd;r<e;r++){let o=t.firstChild;if(t.childCount>1&&(i=0),o.type.spec.isolating&&i<=r){e=r;break}t=o.content}for(let t=1;t<=2;t++)for(let r=t==1?e:this.unplaced.openStart;r>=0;r--){let i,o=null;r?(o=Df(this.unplaced.content,r-1).firstChild,i=o.content):i=this.unplaced.content;let s=i.firstChild;for(let a=this.depth;a>=0;a--){let{type:l,match:d}=this.frontier[a],f,h=null;if(t==1&&(s?d.matchType(s.type)||(h=d.fillBefore(q.from(s),!1)):o&&l.compatibleContent(o.type)))return{sliceDepth:r,frontierDepth:a,parent:o,inject:h};if(t==2&&s&&(f=d.findWrapping(s.type)))return{sliceDepth:r,frontierDepth:a,parent:o,wrap:f};if(o&&d.matchType(o.type))break}}}openMore(){let{content:e,openStart:t,openEnd:r}=this.unplaced,i=Df(e,t);return!i.childCount||i.firstChild.isLeaf?!1:(this.unplaced=new X(e,t+1,Math.max(r,i.size+t>=e.size-r?t+1:0)),!0)}dropNode(){let{content:e,openStart:t,openEnd:r}=this.unplaced,i=Df(e,t);if(i.childCount<=1&&t>0){let o=e.size-t<=t+i.size;this.unplaced=new X(Ta(e,t-1,1),t-1,o?t-1:r)}else this.unplaced=new X(Ta(e,t,1),t,r)}placeNodes({sliceDepth:e,frontierDepth:t,parent:r,inject:i,wrap:o}){for(;this.depth>t;)this.closeFrontierNode();if(o)for(let v=0;v<o.length;v++)this.openFrontierNode(o[v]);let s=this.unplaced,a=r?r.content:s.content,l=s.openStart-e,d=0,f=[],{match:h,type:m}=this.frontier[t];if(i){for(let v=0;v<i.childCount;v++)f.push(i.child(v));h=h.matchFragment(i)}let g=a.size+e-(s.content.size-s.openEnd);for(;d<a.childCount;){let v=a.child(d),x=h.matchType(v.type);if(!x)break;d++,(d>1||l==0||v.content.size)&&(h=x,f.push(iv(v.mark(m.allowedMarks(v.marks)),d==1?l:0,d==a.childCount?g:-1)))}let b=d==a.childCount;b||(g=-1),this.placed=Da(this.placed,t,q.from(f)),this.frontier[t].match=h,b&&g<0&&r&&r.type==this.frontier[this.depth].type&&this.frontier.length>1&&this.closeFrontierNode();for(let v=0,x=a;v<g;v++){let E=x.lastChild;this.frontier.push({type:E.type,match:E.contentMatchAt(E.childCount)}),x=E.content}this.unplaced=b?e==0?X.empty:new X(Ta(s.content,e-1,1),e-1,g<0?s.openEnd:e-1):new X(Ta(s.content,e,d),s.openStart,s.openEnd)}mustMoveInline(){if(!this.$to.parent.isTextblock)return-1;let e=this.frontier[this.depth],t;if(!e.type.isTextblock||!Mf(this.$to,this.$to.depth,e.type,e.match,!1)||this.$to.depth==this.depth&&(t=this.findCloseLevel(this.$to))&&t.depth==this.depth)return-1;let{depth:r}=this.$to,i=this.$to.after(r);for(;r>1&&i==this.$to.end(--r);)++i;return i}findCloseLevel(e){e:for(let t=Math.min(this.depth,e.depth);t>=0;t--){let{match:r,type:i}=this.frontier[t],o=t<e.depth&&e.end(t+1)==e.pos+(e.depth-(t+1)),s=Mf(e,t,i,r,o);if(s){for(let a=t-1;a>=0;a--){let{match:l,type:d}=this.frontier[a],f=Mf(e,a,d,l,!0);if(!f||f.childCount)continue e}return{depth:t,fit:s,move:o?e.doc.resolve(e.after(t+1)):e}}}}close(e){let t=this.findCloseLevel(e);if(!t)return null;for(;this.depth>t.depth;)this.closeFrontierNode();t.fit.childCount&&(this.placed=Da(this.placed,t.depth,t.fit)),e=t.move;for(let r=t.depth+1;r<=e.depth;r++){let i=e.node(r),o=i.type.contentMatch.fillBefore(i.content,!0,e.index(r));this.openFrontierNode(i.type,i.attrs,o)}return e}openFrontierNode(e,t=null,r){let i=this.frontier[this.depth];i.match=i.match.matchType(e),this.placed=Da(this.placed,this.depth,q.from(e.create(t,r))),this.frontier.push({type:e,match:e.contentMatch})}closeFrontierNode(){let t=this.frontier.pop().match.fillBefore(q.empty,!0);t.childCount&&(this.placed=Da(this.placed,this.frontier.length,t))}}function Ta(n,e,t){return e==0?n.cutByIndex(t,n.childCount):n.replaceChild(0,n.firstChild.copy(Ta(n.firstChild.content,e-1,t)))}function Da(n,e,t){return e==0?n.append(t):n.replaceChild(n.childCount-1,n.lastChild.copy(Da(n.lastChild.content,e-1,t)))}function Df(n,e){for(let t=0;t<e;t++)n=n.firstChild.content;return n}function iv(n,e,t){if(e<=0)return n;let r=n.content;return e>1&&(r=r.replaceChild(0,iv(r.firstChild,e-1,r.childCount==1?t-1:0))),e>0&&(r=n.type.contentMatch.fillBefore(r).append(r),t<=0&&(r=r.append(n.type.contentMatch.matchFragment(r).fillBefore(q.empty,!0)))),n.copy(r)}function Mf(n,e,t,r,i){let o=n.node(e),s=i?n.indexAfter(e):n.index(e);if(s==o.childCount&&!t.compatibleContent(o.type))return null;let a=r.fillBefore(o.content,!0,s);return a&&!RT(t,o.content,s)?a:null}function RT(n,e,t){for(let r=t;r<e.childCount;r++)if(!n.allowsMarks(e.child(r).marks))return!0;return!1}function LT(n){return n.spec.defining||n.spec.definingForContent}function BT(n,e,t,r){if(!r.size)return n.deleteRange(e,t);let i=n.doc.resolve(e),o=n.doc.resolve(t);if(rv(i,o,r))return n.step(new Ct(e,t,r));let s=sv(i,n.doc.resolve(t));s[s.length-1]==0&&s.pop();let a=-(i.depth+1);s.unshift(a);for(let m=i.depth,g=i.pos-1;m>0;m--,g--){let b=i.node(m).type.spec;if(b.defining||b.definingAsContext||b.isolating)break;s.indexOf(m)>-1?a=m:i.before(m)==g&&s.splice(1,0,-m)}let l=s.indexOf(a),d=[],f=r.openStart;for(let m=r.content,g=0;;g++){let b=m.firstChild;if(d.push(b),g==r.openStart)break;m=b.content}for(let m=f-1;m>=0;m--){let g=d[m],b=LT(g.type);if(b&&!g.sameMarkup(i.node(Math.abs(a)-1)))f=m;else if(b||!g.type.isTextblock)break}for(let m=r.openStart;m>=0;m--){let g=(m+f+1)%(r.openStart+1),b=d[g];if(b)for(let v=0;v<s.length;v++){let x=s[(v+l)%s.length],E=!0;x<0&&(E=!1,x=-x);let A=i.node(x-1),M=i.index(x-1);if(A.canReplaceWith(M,M,b.type,b.marks))return n.replace(i.before(x),E?o.after(x):t,new X(ov(r.content,0,r.openStart,g),g,r.openEnd))}}let h=n.steps.length;for(let m=s.length-1;m>=0&&(n.replace(e,t,r),!(n.steps.length>h));m--){let g=s[m];g<0||(e=i.before(g),t=o.after(g))}}function ov(n,e,t,r,i){if(e<t){let o=n.firstChild;n=n.replaceChild(0,o.copy(ov(o.content,e+1,t,r,o)))}if(e>r){let o=i.contentMatchAt(0),s=o.fillBefore(n).append(n);n=s.append(o.matchFragment(s).fillBefore(q.empty,!0))}return n}function $T(n,e,t,r){if(!r.isInline&&e==t&&n.doc.resolve(e).parent.content.size){let i=PT(n.doc,e,r.type);i!=null&&(e=t=i)}n.replaceRange(e,t,new X(q.from(r),0,0))}function zT(n,e,t){let r=n.doc.resolve(e),i=n.doc.resolve(t),o=sv(r,i);for(let s=0;s<o.length;s++){let a=o[s],l=s==o.length-1;if(l&&a==0||r.node(a).type.contentMatch.validEnd)return n.delete(r.start(a),i.end(a));if(a>0&&(l||r.node(a-1).canReplace(r.index(a-1),i.indexAfter(a-1))))return n.delete(r.before(a),i.after(a))}for(let s=1;s<=r.depth&&s<=i.depth;s++)if(e-r.start(s)==r.depth-s&&t>r.end(s)&&i.end(s)-t!=i.depth-s&&r.start(s-1)==i.start(s-1)&&r.node(s-1).canReplace(r.index(s-1),i.index(s-1)))return n.delete(r.before(s),t);n.delete(e,t)}function sv(n,e){let t=[],r=Math.min(n.depth,e.depth);for(let i=r;i>=0;i--){let o=n.start(i);if(o<n.pos-(n.depth-i)||e.end(i)>e.pos+(e.depth-i)||n.node(i).type.spec.isolating||e.node(i).type.spec.isolating)break;(o==e.start(i)||i==n.depth&&i==e.depth&&n.parent.inlineContent&&e.parent.inlineContent&&i&&e.start(i-1)==o-1)&&t.push(i)}return t}class As extends Jt{constructor(e,t,r){super(),this.pos=e,this.attr=t,this.value=r}apply(e){let t=e.nodeAt(this.pos);if(!t)return gt.fail("No node at attribute step's position");let r=Object.create(null);for(let o in t.attrs)r[o]=t.attrs[o];r[this.attr]=this.value;let i=t.type.create(r,null,t.marks);return gt.fromReplace(e,this.pos,this.pos+1,new X(q.from(i),0,t.isLeaf?0:1))}getMap(){return Ln.empty}invert(e){return new As(this.pos,this.attr,e.nodeAt(this.pos).attrs[this.attr])}map(e){let t=e.mapResult(this.pos,1);return t.deletedAfter?null:new As(t.pos,this.attr,this.value)}toJSON(){return{stepType:"attr",pos:this.pos,attr:this.attr,value:this.value}}static fromJSON(e,t){if(typeof t.pos!="number"||typeof t.attr!="string")throw new RangeError("Invalid input for AttrStep.fromJSON");return new As(t.pos,t.attr,t.value)}}Jt.jsonID("attr",As);class Ya extends Jt{constructor(e,t){super(),this.attr=e,this.value=t}apply(e){let t=Object.create(null);for(let i in e.attrs)t[i]=e.attrs[i];t[this.attr]=this.value;let r=e.type.create(t,e.content,e.marks);return gt.ok(r)}getMap(){return Ln.empty}invert(e){return new Ya(this.attr,e.attrs[this.attr])}map(e){return this}toJSON(){return{stepType:"docAttr",attr:this.attr,value:this.value}}static fromJSON(e,t){if(typeof t.attr!="string")throw new RangeError("Invalid input for DocAttrStep.fromJSON");return new Ya(t.attr,t.value)}}Jt.jsonID("docAttr",Ya);let Is=class extends Error{};Is=function n(e){let t=Error.call(this,e);return t.__proto__=n.prototype,t};Is.prototype=Object.create(Error.prototype);Is.prototype.constructor=Is;Is.prototype.name="TransformError";class HT{constructor(e){this.doc=e,this.steps=[],this.docs=[],this.mapping=new Xa}get before(){return this.docs.length?this.docs[0]:this.doc}step(e){let t=this.maybeStep(e);if(t.failed)throw new Is(t.failed);return this}maybeStep(e){let t=e.apply(this.doc);return t.failed||this.addStep(e,t.doc),t}get docChanged(){return this.steps.length>0}addStep(e,t){this.docs.push(this.doc),this.steps.push(e),this.mapping.appendMap(e.getMap()),this.doc=t}replace(e,t=e,r=X.empty){let i=Dc(this.doc,e,t,r);return i&&this.step(i),this}replaceWith(e,t,r){return this.replace(e,t,new X(q.from(r),0,0))}delete(e,t){return this.replace(e,t,X.empty)}insert(e,t){return this.replaceWith(e,e,t)}replaceRange(e,t,r){return BT(this,e,t,r),this}replaceRangeWith(e,t,r){return $T(this,e,t,r),this}deleteRange(e,t){return zT(this,e,t),this}lift(e,t){return CT(this,e,t),this}join(e,t=1){return NT(this,e,t),this}wrap(e,t){return AT(this,e,t),this}setBlockType(e,t=e,r,i=null){return TT(this,e,t,r,i),this}setNodeMarkup(e,t,r=null,i){return MT(this,e,t,r,i),this}setNodeAttribute(e,t,r){return this.step(new As(e,t,r)),this}setDocAttribute(e,t){return this.step(new Ya(e,t)),this}addNodeMark(e,t){return this.step(new qi(e,t)),this}removeNodeMark(e,t){let r=this.doc.nodeAt(e);if(!r)throw new RangeError("No node at position "+e);if(t instanceof qe)t.isInSet(r.marks)&&this.step(new Po(e,t));else{let i=r.marks,o,s=[];for(;o=t.isInSet(i);)s.push(new Po(e,o)),i=o.removeFromSet(i);for(let a=s.length-1;a>=0;a--)this.step(s[a])}return this}split(e,t=1,r){return OT(this,e,t,r),this}addMark(e,t,r){return wT(this,e,t,r),this}removeMark(e,t,r){return kT(this,e,t,r),this}clearIncompatible(e,t,r){return ip(this,e,t,r),this}}const Of=Object.create(null);class Ce{constructor(e,t,r){this.$anchor=e,this.$head=t,this.ranges=r||[new qT(e.min(t),e.max(t))]}get anchor(){return this.$anchor.pos}get head(){return this.$head.pos}get from(){return this.$from.pos}get to(){return this.$to.pos}get $from(){return this.ranges[0].$from}get $to(){return this.ranges[0].$to}get empty(){let e=this.ranges;for(let t=0;t<e.length;t++)if(e[t].$from.pos!=e[t].$to.pos)return!1;return!0}content(){return this.$from.doc.slice(this.from,this.to,!0)}replace(e,t=X.empty){let r=t.content.lastChild,i=null;for(let a=0;a<t.openEnd;a++)i=r,r=r.lastChild;let o=e.steps.length,s=this.ranges;for(let a=0;a<s.length;a++){let{$from:l,$to:d}=s[a],f=e.mapping.slice(o);e.replaceRange(f.map(l.pos),f.map(d.pos),a?X.empty:t),a==0&&i1(e,o,(r?r.isInline:i&&i.isTextblock)?-1:1)}}replaceWith(e,t){let r=e.steps.length,i=this.ranges;for(let o=0;o<i.length;o++){let{$from:s,$to:a}=i[o],l=e.mapping.slice(r),d=l.map(s.pos),f=l.map(a.pos);o?e.deleteRange(d,f):(e.replaceRangeWith(d,f,t),i1(e,r,t.isInline?-1:1))}}static findFrom(e,t,r=!1){let i=e.parent.inlineContent?new pe(e):gs(e.node(0),e.parent,e.pos,e.index(),t,r);if(i)return i;for(let o=e.depth-1;o>=0;o--){let s=t<0?gs(e.node(0),e.node(o),e.before(o+1),e.index(o),t,r):gs(e.node(0),e.node(o),e.after(o+1),e.index(o)+1,t,r);if(s)return s}return null}static near(e,t=1){return this.findFrom(e,t)||this.findFrom(e,-t)||new Bn(e.node(0))}static atStart(e){return gs(e,e,0,0,1)||new Bn(e)}static atEnd(e){return gs(e,e,e.content.size,e.childCount,-1)||new Bn(e)}static fromJSON(e,t){if(!t||!t.type)throw new RangeError("Invalid input for Selection.fromJSON");let r=Of[t.type];if(!r)throw new RangeError(`No selection type ${t.type} defined`);return r.fromJSON(e,t)}static jsonID(e,t){if(e in Of)throw new RangeError("Duplicate use of selection JSON ID "+e);return Of[e]=t,t.prototype.jsonID=e,t}getBookmark(){return pe.between(this.$anchor,this.$head).getBookmark()}}Ce.prototype.visible=!0;class qT{constructor(e,t){this.$from=e,this.$to=t}}let n1=!1;function r1(n){!n1&&!n.parent.inlineContent&&(n1=!0,console.warn("TextSelection endpoint not pointing into a node with inline content ("+n.parent.type.name+")"))}class pe extends Ce{constructor(e,t=e){r1(e),r1(t),super(e,t)}get $cursor(){return this.$anchor.pos==this.$head.pos?this.$head:null}map(e,t){let r=e.resolve(t.map(this.head));if(!r.parent.inlineContent)return Ce.near(r);let i=e.resolve(t.map(this.anchor));return new pe(i.parent.inlineContent?i:r,r)}replace(e,t=X.empty){if(super.replace(e,t),t==X.empty){let r=this.$from.marksAcross(this.$to);r&&e.ensureMarks(r)}}eq(e){return e instanceof pe&&e.anchor==this.anchor&&e.head==this.head}getBookmark(){return new Mc(this.anchor,this.head)}toJSON(){return{type:"text",anchor:this.anchor,head:this.head}}static fromJSON(e,t){if(typeof t.anchor!="number"||typeof t.head!="number")throw new RangeError("Invalid input for TextSelection.fromJSON");return new pe(e.resolve(t.anchor),e.resolve(t.head))}static create(e,t,r=t){let i=e.resolve(t);return new this(i,r==t?i:e.resolve(r))}static between(e,t,r){let i=e.pos-t.pos;if((!r||i)&&(r=i>=0?1:-1),!t.parent.inlineContent){let o=Ce.findFrom(t,r,!0)||Ce.findFrom(t,-r,!0);if(o)t=o.$head;else return Ce.near(t,r)}return e.parent.inlineContent||(i==0?e=t:(e=(Ce.findFrom(e,-r,!0)||Ce.findFrom(e,r,!0)).$anchor,e.pos<t.pos!=i<0&&(e=t))),new pe(e,t)}}Ce.jsonID("text",pe);class Mc{constructor(e,t){this.anchor=e,this.head=t}map(e){return new Mc(e.map(this.anchor),e.map(this.head))}resolve(e){return pe.between(e.resolve(this.anchor),e.resolve(this.head))}}class re extends Ce{constructor(e){let t=e.nodeAfter,r=e.node(0).resolve(e.pos+t.nodeSize);super(e,r),this.node=t}map(e,t){let{deleted:r,pos:i}=t.mapResult(this.anchor),o=e.resolve(i);return r?Ce.near(o):new re(o)}content(){return new X(q.from(this.node),0,0)}eq(e){return e instanceof re&&e.anchor==this.anchor}toJSON(){return{type:"node",anchor:this.anchor}}getBookmark(){return new sp(this.anchor)}static fromJSON(e,t){if(typeof t.anchor!="number")throw new RangeError("Invalid input for NodeSelection.fromJSON");return new re(e.resolve(t.anchor))}static create(e,t){return new re(e.resolve(t))}static isSelectable(e){return!e.isText&&e.type.spec.selectable!==!1}}re.prototype.visible=!1;Ce.jsonID("node",re);class sp{constructor(e){this.anchor=e}map(e){let{deleted:t,pos:r}=e.mapResult(this.anchor);return t?new Mc(r,r):new sp(r)}resolve(e){let t=e.resolve(this.anchor),r=t.nodeAfter;return r&&re.isSelectable(r)?new re(t):Ce.near(t)}}class Bn extends Ce{constructor(e){super(e.resolve(0),e.resolve(e.content.size))}replace(e,t=X.empty){if(t==X.empty){e.delete(0,e.doc.content.size);let r=Ce.atStart(e.doc);r.eq(e.selection)||e.setSelection(r)}else super.replace(e,t)}toJSON(){return{type:"all"}}static fromJSON(e){return new Bn(e)}map(e){return new Bn(e)}eq(e){return e instanceof Bn}getBookmark(){return VT}}Ce.jsonID("all",Bn);const VT={map(){return this},resolve(n){return new Bn(n)}};function gs(n,e,t,r,i,o=!1){if(e.inlineContent)return pe.create(n,t);for(let s=r-(i>0?0:1);i>0?s<e.childCount:s>=0;s+=i){let a=e.child(s);if(a.isAtom){if(!o&&re.isSelectable(a))return re.create(n,t-(i<0?a.nodeSize:0))}else{let l=gs(n,a,t+i,i<0?a.childCount:0,i,o);if(l)return l}t+=a.nodeSize*i}return null}function i1(n,e,t){let r=n.steps.length-1;if(r<e)return;let i=n.steps[r];if(!(i instanceof Ct||i instanceof _t))return;let o=n.mapping.maps[r],s;o.forEach((a,l,d,f)=>{s==null&&(s=f)}),n.setSelection(Ce.near(n.doc.resolve(s),t))}const o1=1,s1=2,a1=4;class WT extends HT{constructor(e){super(e.doc),this.curSelectionFor=0,this.updated=0,this.meta=Object.create(null),this.time=Date.now(),this.curSelection=e.selection,this.storedMarks=e.storedMarks}get selection(){return this.curSelectionFor<this.steps.length&&(this.curSelection=this.curSelection.map(this.doc,this.mapping.slice(this.curSelectionFor)),this.curSelectionFor=this.steps.length),this.curSelection}setSelection(e){if(e.$from.doc!=this.doc)throw new RangeError("Selection passed to setSelection must point at the current document");return this.curSelection=e,this.curSelectionFor=this.steps.length,this.updated=(this.updated|o1)&-3,this.storedMarks=null,this}get selectionSet(){return(this.updated&o1)>0}setStoredMarks(e){return this.storedMarks=e,this.updated|=s1,this}ensureMarks(e){return qe.sameSet(this.storedMarks||this.selection.$from.marks(),e)||this.setStoredMarks(e),this}addStoredMark(e){return this.ensureMarks(e.addToSet(this.storedMarks||this.selection.$head.marks()))}removeStoredMark(e){return this.ensureMarks(e.removeFromSet(this.storedMarks||this.selection.$head.marks()))}get storedMarksSet(){return(this.updated&s1)>0}addStep(e,t){super.addStep(e,t),this.updated=this.updated&-3,this.storedMarks=null}setTime(e){return this.time=e,this}replaceSelection(e){return this.selection.replace(this,e),this}replaceSelectionWith(e,t=!0){let r=this.selection;return t&&(e=e.mark(this.storedMarks||(r.empty?r.$from.marks():r.$from.marksAcross(r.$to)||qe.none))),r.replaceWith(this,e),this}deleteSelection(){return this.selection.replace(this),this}insertText(e,t,r){let i=this.doc.type.schema;if(t==null)return e?this.replaceSelectionWith(i.text(e),!0):this.deleteSelection();{if(r==null&&(r=t),r=r??t,!e)return this.deleteRange(t,r);let o=this.storedMarks;if(!o){let s=this.doc.resolve(t);o=r==t?s.marks():s.marksAcross(this.doc.resolve(r))}return this.replaceRangeWith(t,r,i.text(e,o)),this.selection.empty||this.setSelection(Ce.near(this.selection.$to)),this}}setMeta(e,t){return this.meta[typeof e=="string"?e:e.key]=t,this}getMeta(e){return this.meta[typeof e=="string"?e:e.key]}get isGeneric(){for(let e in this.meta)return!1;return!0}scrollIntoView(){return this.updated|=a1,this}get scrolledIntoView(){return(this.updated&a1)>0}}function u1(n,e){return!e||!n?n:n.bind(e)}class Ma{constructor(e,t,r){this.name=e,this.init=u1(t.init,r),this.apply=u1(t.apply,r)}}const UT=[new Ma("doc",{init(n){return n.doc||n.schema.topNodeType.createAndFill()},apply(n){return n.doc}}),new Ma("selection",{init(n,e){return n.selection||Ce.atStart(e.doc)},apply(n){return n.selection}}),new Ma("storedMarks",{init(n){return n.storedMarks||null},apply(n,e,t,r){return r.selection.$cursor?n.storedMarks:null}}),new Ma("scrollToSelection",{init(){return 0},apply(n,e){return n.scrolledIntoView?e+1:e}})];class If{constructor(e,t){this.schema=e,this.plugins=[],this.pluginsByKey=Object.create(null),this.fields=UT.slice(),t&&t.forEach(r=>{if(this.pluginsByKey[r.key])throw new RangeError("Adding different instances of a keyed plugin ("+r.key+")");this.plugins.push(r),this.pluginsByKey[r.key]=r,r.spec.state&&this.fields.push(new Ma(r.key,r.spec.state,r))})}}class ws{constructor(e){this.config=e}get schema(){return this.config.schema}get plugins(){return this.config.plugins}apply(e){return this.applyTransaction(e).state}filterTransaction(e,t=-1){for(let r=0;r<this.config.plugins.length;r++)if(r!=t){let i=this.config.plugins[r];if(i.spec.filterTransaction&&!i.spec.filterTransaction.call(i,e,this))return!1}return!0}applyTransaction(e){if(!this.filterTransaction(e))return{state:this,transactions:[]};let t=[e],r=this.applyInner(e),i=null;for(;;){let o=!1;for(let s=0;s<this.config.plugins.length;s++){let a=this.config.plugins[s];if(a.spec.appendTransaction){let l=i?i[s].n:0,d=i?i[s].state:this,f=l<t.length&&a.spec.appendTransaction.call(a,l?t.slice(l):t,d,r);if(f&&r.filterTransaction(f,s)){if(f.setMeta("appendedTransaction",e),!i){i=[];for(let h=0;h<this.config.plugins.length;h++)i.push(h<s?{state:r,n:t.length}:{state:this,n:0})}t.push(f),r=r.applyInner(f),o=!0}i&&(i[s]={state:r,n:t.length})}}if(!o)return{state:r,transactions:t}}}applyInner(e){if(!e.before.eq(this.doc))throw new RangeError("Applying a mismatched transaction");let t=new ws(this.config),r=this.config.fields;for(let i=0;i<r.length;i++){let o=r[i];t[o.name]=o.apply(e,this[o.name],this,t)}return t}get tr(){return new WT(this)}static create(e){let t=new If(e.doc?e.doc.type.schema:e.schema,e.plugins),r=new ws(t);for(let i=0;i<t.fields.length;i++)r[t.fields[i].name]=t.fields[i].init(e,r);return r}reconfigure(e){let t=new If(this.schema,e.plugins),r=t.fields,i=new ws(t);for(let o=0;o<r.length;o++){let s=r[o].name;i[s]=this.hasOwnProperty(s)?this[s]:r[o].init(e,i)}return i}toJSON(e){let t={doc:this.doc.toJSON(),selection:this.selection.toJSON()};if(this.storedMarks&&(t.storedMarks=this.storedMarks.map(r=>r.toJSON())),e&&typeof e=="object")for(let r in e){if(r=="doc"||r=="selection")throw new RangeError("The JSON fields `doc` and `selection` are reserved");let i=e[r],o=i.spec.state;o&&o.toJSON&&(t[r]=o.toJSON.call(i,this[i.key]))}return t}static fromJSON(e,t,r){if(!t)throw new RangeError("Invalid input for EditorState.fromJSON");if(!e.schema)throw new RangeError("Required config field 'schema' missing");let i=new If(e.schema,e.plugins),o=new ws(i);return i.fields.forEach(s=>{if(s.name=="doc")o.doc=Ui.fromJSON(e.schema,t.doc);else if(s.name=="selection")o.selection=Ce.fromJSON(o.doc,t.selection);else if(s.name=="storedMarks")t.storedMarks&&(o.storedMarks=t.storedMarks.map(e.schema.markFromJSON));else{if(r)for(let a in r){let l=r[a],d=l.spec.state;if(l.key==s.name&&d&&d.fromJSON&&Object.prototype.hasOwnProperty.call(t,a)){o[s.name]=d.fromJSON.call(l,e,t[a],o);return}}o[s.name]=s.init(e,o)}}),o}}function av(n,e,t){for(let r in n){let i=n[r];i instanceof Function?i=i.bind(e):r=="handleDOMEvents"&&(i=av(i,e,{})),t[r]=i}return t}class zt{constructor(e){this.spec=e,this.props={},e.props&&av(e.props,this,this.props),this.key=e.key?e.key.key:uv("plugin")}getState(e){return e[this.key]}}const Nf=Object.create(null);function uv(n){return n in Nf?n+"$"+ ++Nf[n]:(Nf[n]=0,n+"$")}class Hn{constructor(e="key"){this.key=uv(e)}get(e){return e.config.pluginsByKey[this.key]}getState(e){return e[this.key]}}const Rt=function(n){for(var e=0;;e++)if(n=n.previousSibling,!n)return e},Ns=function(n){let e=n.assignedSlot||n.parentNode;return e&&e.nodeType==11?e.host:e};let _h=null;const si=function(n,e,t){let r=_h||(_h=document.createRange());return r.setEnd(n,t??n.nodeValue.length),r.setStart(n,e||0),r},KT=function(){_h=null},Fo=function(n,e,t,r){return t&&(l1(n,e,t,r,-1)||l1(n,e,t,r,1))},jT=/^(img|br|input|textarea|hr)$/i;function l1(n,e,t,r,i){for(var o;;){if(n==t&&e==r)return!0;if(e==(i<0?0:er(n))){let s=n.parentNode;if(!s||s.nodeType!=1||hu(n)||jT.test(n.nodeName)||n.contentEditable=="false")return!1;e=Rt(n)+(i<0?0:1),n=s}else if(n.nodeType==1){let s=n.childNodes[e+(i<0?-1:0)];if(s.nodeType==1&&s.contentEditable=="false")if(!((o=s.pmViewDesc)===null||o===void 0)&&o.ignoreForSelection)e+=i;else return!1;else n=s,e=i<0?er(n):0}else return!1}}function er(n){return n.nodeType==3?n.nodeValue.length:n.childNodes.length}function GT(n,e){for(;;){if(n.nodeType==3&&e)return n;if(n.nodeType==1&&e>0){if(n.contentEditable=="false")return null;n=n.childNodes[e-1],e=er(n)}else if(n.parentNode&&!hu(n))e=Rt(n),n=n.parentNode;else return null}}function XT(n,e){for(;;){if(n.nodeType==3&&e<n.nodeValue.length)return n;if(n.nodeType==1&&e<n.childNodes.length){if(n.contentEditable=="false")return null;n=n.childNodes[e],e=0}else if(n.parentNode&&!hu(n))e=Rt(n)+1,n=n.parentNode;else return null}}function YT(n,e,t){for(let r=e==0,i=e==er(n);r||i;){if(n==t)return!0;let o=Rt(n);if(n=n.parentNode,!n)return!1;r=r&&o==0,i=i&&o==er(n)}}function hu(n){let e;for(let t=n;t&&!(e=t.pmViewDesc);t=t.parentNode);return e&&e.node&&e.node.isBlock&&(e.dom==n||e.contentDOM==n)}const Oc=function(n){return n.focusNode&&Fo(n.focusNode,n.focusOffset,n.anchorNode,n.anchorOffset)};function wo(n,e){let t=document.createEvent("Event");return t.initEvent("keydown",!0,!0),t.keyCode=n,t.key=t.code=e,t}function JT(n){let e=n.activeElement;for(;e&&e.shadowRoot;)e=e.shadowRoot.activeElement;return e}function ZT(n,e,t){if(n.caretPositionFromPoint)try{let r=n.caretPositionFromPoint(e,t);if(r)return{node:r.offsetNode,offset:Math.min(er(r.offsetNode),r.offset)}}catch{}if(n.caretRangeFromPoint){let r=n.caretRangeFromPoint(e,t);if(r)return{node:r.startContainer,offset:Math.min(er(r.startContainer),r.startOffset)}}}const zr=typeof navigator<"u"?navigator:null,c1=typeof document<"u"?document:null,Zi=zr&&zr.userAgent||"",Ah=/Edge\/(\d+)/.exec(Zi),lv=/MSIE \d/.exec(Zi),Th=/Trident\/(?:[7-9]|\d{2,})\..*rv:(\d+)/.exec(Zi),xn=!!(lv||Th||Ah),Ki=lv?document.documentMode:Th?+Th[1]:Ah?+Ah[1]:0,wr=!xn&&/gecko\/(\d+)/i.test(Zi);wr&&+(/Firefox\/(\d+)/.exec(Zi)||[0,0])[1];const Dh=!xn&&/Chrome\/(\d+)/.exec(Zi),Xt=!!Dh,cv=Dh?+Dh[1]:0,an=!xn&&!!zr&&/Apple Computer/.test(zr.vendor),Ps=an&&(/Mobile\/\w+/.test(Zi)||!!zr&&zr.maxTouchPoints>2),Qn=Ps||(zr?/Mac/.test(zr.platform):!1),QT=zr?/Win/.test(zr.platform):!1,ai=/Android \d/.test(Zi),pu=!!c1&&"webkitFontSmoothing"in c1.documentElement.style,eD=pu?+(/\bAppleWebKit\/(\d+)/.exec(navigator.userAgent)||[0,0])[1]:0;function tD(n){let e=n.defaultView&&n.defaultView.visualViewport;return e?{left:0,right:e.width,top:0,bottom:e.height}:{left:0,right:n.documentElement.clientWidth,top:0,bottom:n.documentElement.clientHeight}}function oi(n,e){return typeof n=="number"?n:n[e]}function nD(n){let e=n.getBoundingClientRect(),t=e.width/n.offsetWidth||1,r=e.height/n.offsetHeight||1;return{left:e.left,right:e.left+n.clientWidth*t,top:e.top,bottom:e.top+n.clientHeight*r}}function d1(n,e,t){let r=n.someProp("scrollThreshold")||0,i=n.someProp("scrollMargin")||5,o=n.dom.ownerDocument;for(let s=t||n.dom;s;){if(s.nodeType!=1){s=Ns(s);continue}let a=s,l=a==o.body,d=l?tD(o):nD(a),f=0,h=0;if(e.top<d.top+oi(r,"top")?h=-(d.top-e.top+oi(i,"top")):e.bottom>d.bottom-oi(r,"bottom")&&(h=e.bottom-e.top>d.bottom-d.top?e.top+oi(i,"top")-d.top:e.bottom-d.bottom+oi(i,"bottom")),e.left<d.left+oi(r,"left")?f=-(d.left-e.left+oi(i,"left")):e.right>d.right-oi(r,"right")&&(f=e.right-d.right+oi(i,"right")),f||h)if(l)o.defaultView.scrollBy(f,h);else{let g=a.scrollLeft,b=a.scrollTop;h&&(a.scrollTop+=h),f&&(a.scrollLeft+=f);let v=a.scrollLeft-g,x=a.scrollTop-b;e={left:e.left-v,top:e.top-x,right:e.right-v,bottom:e.bottom-x}}let m=l?"fixed":getComputedStyle(s).position;if(/^(fixed|sticky)$/.test(m))break;s=m=="absolute"?s.offsetParent:Ns(s)}}function rD(n){let e=n.dom.getBoundingClientRect(),t=Math.max(0,e.top),r,i;for(let o=(e.left+e.right)/2,s=t+1;s<Math.min(innerHeight,e.bottom);s+=5){let a=n.root.elementFromPoint(o,s);if(!a||a==n.dom||!n.dom.contains(a))continue;let l=a.getBoundingClientRect();if(l.top>=t-20){r=a,i=l.top;break}}return{refDOM:r,refTop:i,stack:dv(n.dom)}}function dv(n){let e=[],t=n.ownerDocument;for(let r=n;r&&(e.push({dom:r,top:r.scrollTop,left:r.scrollLeft}),n!=t);r=Ns(r));return e}function iD({refDOM:n,refTop:e,stack:t}){let r=n?n.getBoundingClientRect().top:0;fv(t,r==0?0:r-e)}function fv(n,e){for(let t=0;t<n.length;t++){let{dom:r,top:i,left:o}=n[t];r.scrollTop!=i+e&&(r.scrollTop=i+e),r.scrollLeft!=o&&(r.scrollLeft=o)}}let ds=null;function oD(n){if(n.setActive)return n.setActive();if(ds)return n.focus(ds);let e=dv(n);n.focus(ds==null?{get preventScroll(){return ds={preventScroll:!0},!0}}:void 0),ds||(ds=!1,fv(e,0))}function hv(n,e){let t,r=2e8,i,o=0,s=e.top,a=e.top,l,d;for(let f=n.firstChild,h=0;f;f=f.nextSibling,h++){let m;if(f.nodeType==1)m=f.getClientRects();else if(f.nodeType==3)m=si(f).getClientRects();else continue;for(let g=0;g<m.length;g++){let b=m[g];if(b.top<=s&&b.bottom>=a){s=Math.max(b.bottom,s),a=Math.min(b.top,a);let v=b.left>e.left?b.left-e.left:b.right<e.left?e.left-b.right:0;if(v<r){t=f,r=v,i=v&&t.nodeType==3?{left:b.right<e.left?b.right:b.left,top:e.top}:e,f.nodeType==1&&v&&(o=h+(e.left>=(b.left+b.right)/2?1:0));continue}}else b.top>e.top&&!l&&b.left<=e.left&&b.right>=e.left&&(l=f,d={left:Math.max(b.left,Math.min(b.right,e.left)),top:b.top});!t&&(e.left>=b.right&&e.top>=b.top||e.left>=b.left&&e.top>=b.bottom)&&(o=h+1)}}return!t&&l&&(t=l,i=d,r=0),t&&t.nodeType==3?sD(t,i):!t||r&&t.nodeType==1?{node:n,offset:o}:hv(t,i)}function sD(n,e){let t=n.nodeValue.length,r=document.createRange();for(let i=0;i<t;i++){r.setEnd(n,i+1),r.setStart(n,i);let o=Di(r,1);if(o.top!=o.bottom&&ap(e,o))return{node:n,offset:i+(e.left>=(o.left+o.right)/2?1:0)}}return{node:n,offset:0}}function ap(n,e){return n.left>=e.left-1&&n.left<=e.right+1&&n.top>=e.top-1&&n.top<=e.bottom+1}function aD(n,e){let t=n.parentNode;return t&&/^li$/i.test(t.nodeName)&&e.left<n.getBoundingClientRect().left?t:n}function uD(n,e,t){let{node:r,offset:i}=hv(e,t),o=-1;if(r.nodeType==1&&!r.firstChild){let s=r.getBoundingClientRect();o=s.left!=s.right&&t.left>(s.left+s.right)/2?1:-1}return n.docView.posFromDOM(r,i,o)}function lD(n,e,t,r){let i=-1;for(let o=e,s=!1;o!=n.dom;){let a=n.docView.nearestDesc(o,!0),l;if(!a)return null;if(a.dom.nodeType==1&&(a.node.isBlock&&a.parent||!a.contentDOM)&&((l=a.dom.getBoundingClientRect()).width||l.height)&&(a.node.isBlock&&a.parent&&(!s&&l.left>r.left||l.top>r.top?i=a.posBefore:(!s&&l.right<r.left||l.bottom<r.top)&&(i=a.posAfter),s=!0),!a.contentDOM&&i<0&&!a.node.isText))return(a.node.isBlock?r.top<(l.top+l.bottom)/2:r.left<(l.left+l.right)/2)?a.posBefore:a.posAfter;o=a.dom.parentNode}return i>-1?i:n.docView.posFromDOM(e,t,-1)}function pv(n,e,t){let r=n.childNodes.length;if(r&&t.top<t.bottom)for(let i=Math.max(0,Math.min(r-1,Math.floor(r*(e.top-t.top)/(t.bottom-t.top))-2)),o=i;;){let s=n.childNodes[o];if(s.nodeType==1){let a=s.getClientRects();for(let l=0;l<a.length;l++){let d=a[l];if(ap(e,d))return pv(s,e,d)}}if((o=(o+1)%r)==i)break}return n}function cD(n,e){let t=n.dom.ownerDocument,r,i=0,o=ZT(t,e.left,e.top);o&&({node:r,offset:i}=o);let s=(n.root.elementFromPoint?n.root:t).elementFromPoint(e.left,e.top),a;if(!s||!n.dom.contains(s.nodeType!=1?s.parentNode:s)){let d=n.dom.getBoundingClientRect();if(!ap(e,d)||(s=pv(n.dom,e,d),!s))return null}if(an)for(let d=s;r&&d;d=Ns(d))d.draggable&&(r=void 0);if(s=aD(s,e),r){if(wr&&r.nodeType==1&&(i=Math.min(i,r.childNodes.length),i<r.childNodes.length)){let f=r.childNodes[i],h;f.nodeName=="IMG"&&(h=f.getBoundingClientRect()).right<=e.left&&h.bottom>e.top&&i++}let d;pu&&i&&r.nodeType==1&&(d=r.childNodes[i-1]).nodeType==1&&d.contentEditable=="false"&&d.getBoundingClientRect().top>=e.top&&i--,r==n.dom&&i==r.childNodes.length-1&&r.lastChild.nodeType==1&&e.top>r.lastChild.getBoundingClientRect().bottom?a=n.state.doc.content.size:(i==0||r.nodeType!=1||r.childNodes[i-1].nodeName!="BR")&&(a=lD(n,r,i,e))}a==null&&(a=uD(n,s,e));let l=n.docView.nearestDesc(s,!0);return{pos:a,inside:l?l.posAtStart-l.border:-1}}function f1(n){return n.top<n.bottom||n.left<n.right}function Di(n,e){let t=n.getClientRects();if(t.length){let r=t[e<0?0:t.length-1];if(f1(r))return r}return Array.prototype.find.call(t,f1)||n.getBoundingClientRect()}const dD=/[\u0590-\u05f4\u0600-\u06ff\u0700-\u08ac]/;function mv(n,e,t){let{node:r,offset:i,atom:o}=n.docView.domFromPos(e,t<0?-1:1),s=pu||wr;if(r.nodeType==3)if(s&&(dD.test(r.nodeValue)||(t<0?!i:i==r.nodeValue.length))){let l=Di(si(r,i,i),t);if(wr&&i&&/\s/.test(r.nodeValue[i-1])&&i<r.nodeValue.length){let d=Di(si(r,i-1,i-1),-1);if(d.top==l.top){let f=Di(si(r,i,i+1),-1);if(f.top!=l.top)return ba(f,f.left<d.left)}}return l}else{let l=i,d=i,f=t<0?1:-1;return t<0&&!i?(d++,f=-1):t>=0&&i==r.nodeValue.length?(l--,f=1):t<0?l--:d++,ba(Di(si(r,l,d),f),f<0)}if(!n.state.doc.resolve(e-(o||0)).parent.inlineContent){if(o==null&&i&&(t<0||i==er(r))){let l=r.childNodes[i-1];if(l.nodeType==1)return Pf(l.getBoundingClientRect(),!1)}if(o==null&&i<er(r)){let l=r.childNodes[i];if(l.nodeType==1)return Pf(l.getBoundingClientRect(),!0)}return Pf(r.getBoundingClientRect(),t>=0)}if(o==null&&i&&(t<0||i==er(r))){let l=r.childNodes[i-1],d=l.nodeType==3?si(l,er(l)-(s?0:1)):l.nodeType==1&&(l.nodeName!="BR"||!l.nextSibling)?l:null;if(d)return ba(Di(d,1),!1)}if(o==null&&i<er(r)){let l=r.childNodes[i];for(;l.pmViewDesc&&l.pmViewDesc.ignoreForCoords;)l=l.nextSibling;let d=l?l.nodeType==3?si(l,0,s?0:1):l.nodeType==1?l:null:null;if(d)return ba(Di(d,-1),!0)}return ba(Di(r.nodeType==3?si(r):r,-t),t>=0)}function ba(n,e){if(n.width==0)return n;let t=e?n.left:n.right;return{top:n.top,bottom:n.bottom,left:t,right:t}}function Pf(n,e){if(n.height==0)return n;let t=e?n.top:n.bottom;return{top:t,bottom:t,left:n.left,right:n.right}}function gv(n,e,t){let r=n.state,i=n.root.activeElement;r!=e&&n.updateState(e),i!=n.dom&&n.focus();try{return t()}finally{r!=e&&n.updateState(r),i!=n.dom&&i&&i.focus()}}function fD(n,e,t){let r=e.selection,i=t=="up"?r.$from:r.$to;return gv(n,e,()=>{let{node:o}=n.docView.domFromPos(i.pos,t=="up"?-1:1);for(;;){let a=n.docView.nearestDesc(o,!0);if(!a)break;if(a.node.isBlock){o=a.contentDOM||a.dom;break}o=a.dom.parentNode}let s=mv(n,i.pos,1);for(let a=o.firstChild;a;a=a.nextSibling){let l;if(a.nodeType==1)l=a.getClientRects();else if(a.nodeType==3)l=si(a,0,a.nodeValue.length).getClientRects();else continue;for(let d=0;d<l.length;d++){let f=l[d];if(f.bottom>f.top+1&&(t=="up"?s.top-f.top>(f.bottom-s.top)*2:f.bottom-s.bottom>(s.bottom-f.top)*2))return!1}}return!0})}const hD=/[\u0590-\u08ac]/;function pD(n,e,t){let{$head:r}=e.selection;if(!r.parent.isTextblock)return!1;let i=r.parentOffset,o=!i,s=i==r.parent.content.size,a=n.domSelection();return a?!hD.test(r.parent.textContent)||!a.modify?t=="left"||t=="backward"?o:s:gv(n,e,()=>{let{focusNode:l,focusOffset:d,anchorNode:f,anchorOffset:h}=n.domSelectionRange(),m=a.caretBidiLevel;a.modify("move",t,"character");let g=r.depth?n.docView.domAfterPos(r.before()):n.dom,{focusNode:b,focusOffset:v}=n.domSelectionRange(),x=b&&!g.contains(b.nodeType==1?b:b.parentNode)||l==b&&d==v;try{a.collapse(f,h),l&&(l!=f||d!=h)&&a.extend&&a.extend(l,d)}catch{}return m!=null&&(a.caretBidiLevel=m),x}):r.pos==r.start()||r.pos==r.end()}let h1=null,p1=null,m1=!1;function mD(n,e,t){return h1==e&&p1==t?m1:(h1=e,p1=t,m1=t=="up"||t=="down"?fD(n,e,t):pD(n,e,t))}const nr=0,g1=1,Co=2,Hr=3;class mu{constructor(e,t,r,i){this.parent=e,this.children=t,this.dom=r,this.contentDOM=i,this.dirty=nr,r.pmViewDesc=this}matchesWidget(e){return!1}matchesMark(e){return!1}matchesNode(e,t,r){return!1}matchesHack(e){return!1}parseRule(){return null}stopEvent(e){return!1}get size(){let e=0;for(let t=0;t<this.children.length;t++)e+=this.children[t].size;return e}get border(){return 0}destroy(){this.parent=void 0,this.dom.pmViewDesc==this&&(this.dom.pmViewDesc=void 0);for(let e=0;e<this.children.length;e++)this.children[e].destroy()}posBeforeChild(e){for(let t=0,r=this.posAtStart;;t++){let i=this.children[t];if(i==e)return r;r+=i.size}}get posBefore(){return this.parent.posBeforeChild(this)}get posAtStart(){return this.parent?this.parent.posBeforeChild(this)+this.border:0}get posAfter(){return this.posBefore+this.size}get posAtEnd(){return this.posAtStart+this.size-2*this.border}localPosFromDOM(e,t,r){if(this.contentDOM&&this.contentDOM.contains(e.nodeType==1?e:e.parentNode))if(r<0){let o,s;if(e==this.contentDOM)o=e.childNodes[t-1];else{for(;e.parentNode!=this.contentDOM;)e=e.parentNode;o=e.previousSibling}for(;o&&!((s=o.pmViewDesc)&&s.parent==this);)o=o.previousSibling;return o?this.posBeforeChild(s)+s.size:this.posAtStart}else{let o,s;if(e==this.contentDOM)o=e.childNodes[t];else{for(;e.parentNode!=this.contentDOM;)e=e.parentNode;o=e.nextSibling}for(;o&&!((s=o.pmViewDesc)&&s.parent==this);)o=o.nextSibling;return o?this.posBeforeChild(s):this.posAtEnd}let i;if(e==this.dom&&this.contentDOM)i=t>Rt(this.contentDOM);else if(this.contentDOM&&this.contentDOM!=this.dom&&this.dom.contains(this.contentDOM))i=e.compareDocumentPosition(this.contentDOM)&2;else if(this.dom.firstChild){if(t==0)for(let o=e;;o=o.parentNode){if(o==this.dom){i=!1;break}if(o.previousSibling)break}if(i==null&&t==e.childNodes.length)for(let o=e;;o=o.parentNode){if(o==this.dom){i=!0;break}if(o.nextSibling)break}}return i??r>0?this.posAtEnd:this.posAtStart}nearestDesc(e,t=!1){for(let r=!0,i=e;i;i=i.parentNode){let o=this.getDesc(i),s;if(o&&(!t||o.node))if(r&&(s=o.nodeDOM)&&!(s.nodeType==1?s.contains(e.nodeType==1?e:e.parentNode):s==e))r=!1;else return o}}getDesc(e){let t=e.pmViewDesc;for(let r=t;r;r=r.parent)if(r==this)return t}posFromDOM(e,t,r){for(let i=e;i;i=i.parentNode){let o=this.getDesc(i);if(o)return o.localPosFromDOM(e,t,r)}return-1}descAt(e){for(let t=0,r=0;t<this.children.length;t++){let i=this.children[t],o=r+i.size;if(r==e&&o!=r){for(;!i.border&&i.children.length;)for(let s=0;s<i.children.length;s++){let a=i.children[s];if(a.size){i=a;break}}return i}if(e<o)return i.descAt(e-r-i.border);r=o}}domFromPos(e,t){if(!this.contentDOM)return{node:this.dom,offset:0,atom:e+1};let r=0,i=0;for(let o=0;r<this.children.length;r++){let s=this.children[r],a=o+s.size;if(a>e||s instanceof yv){i=e-o;break}o=a}if(i)return this.children[r].domFromPos(i-this.children[r].border,t);for(let o;r&&!(o=this.children[r-1]).size&&o instanceof bv&&o.side>=0;r--);if(t<=0){let o,s=!0;for(;o=r?this.children[r-1]:null,!(!o||o.dom.parentNode==this.contentDOM);r--,s=!1);return o&&t&&s&&!o.border&&!o.domAtom?o.domFromPos(o.size,t):{node:this.contentDOM,offset:o?Rt(o.dom)+1:0}}else{let o,s=!0;for(;o=r<this.children.length?this.children[r]:null,!(!o||o.dom.parentNode==this.contentDOM);r++,s=!1);return o&&s&&!o.border&&!o.domAtom?o.domFromPos(0,t):{node:this.contentDOM,offset:o?Rt(o.dom):this.contentDOM.childNodes.length}}}parseRange(e,t,r=0){if(this.children.length==0)return{node:this.contentDOM,from:e,to:t,fromOffset:0,toOffset:this.contentDOM.childNodes.length};let i=-1,o=-1;for(let s=r,a=0;;a++){let l=this.children[a],d=s+l.size;if(i==-1&&e<=d){let f=s+l.border;if(e>=f&&t<=d-l.border&&l.node&&l.contentDOM&&this.contentDOM.contains(l.contentDOM))return l.parseRange(e,t,f);e=s;for(let h=a;h>0;h--){let m=this.children[h-1];if(m.size&&m.dom.parentNode==this.contentDOM&&!m.emptyChildAt(1)){i=Rt(m.dom)+1;break}e-=m.size}i==-1&&(i=0)}if(i>-1&&(d>t||a==this.children.length-1)){t=d;for(let f=a+1;f<this.children.length;f++){let h=this.children[f];if(h.size&&h.dom.parentNode==this.contentDOM&&!h.emptyChildAt(-1)){o=Rt(h.dom);break}t+=h.size}o==-1&&(o=this.contentDOM.childNodes.length);break}s=d}return{node:this.contentDOM,from:e,to:t,fromOffset:i,toOffset:o}}emptyChildAt(e){if(this.border||!this.contentDOM||!this.children.length)return!1;let t=this.children[e<0?0:this.children.length-1];return t.size==0||t.emptyChildAt(e)}domAfterPos(e){let{node:t,offset:r}=this.domFromPos(e,0);if(t.nodeType!=1||r==t.childNodes.length)throw new RangeError("No node after pos "+e);return t.childNodes[r]}setSelection(e,t,r,i=!1){let o=Math.min(e,t),s=Math.max(e,t);for(let g=0,b=0;g<this.children.length;g++){let v=this.children[g],x=b+v.size;if(o>b&&s<x)return v.setSelection(e-b-v.border,t-b-v.border,r,i);b=x}let a=this.domFromPos(e,e?-1:1),l=t==e?a:this.domFromPos(t,t?-1:1),d=r.root.getSelection(),f=r.domSelectionRange(),h=!1;if((wr||an)&&e==t){let{node:g,offset:b}=a;if(g.nodeType==3){if(h=!!(b&&g.nodeValue[b-1]==`
`),h&&b==g.nodeValue.length)for(let v=g,x;v;v=v.parentNode){if(x=v.nextSibling){x.nodeName=="BR"&&(a=l={node:x.parentNode,offset:Rt(x)+1});break}let E=v.pmViewDesc;if(E&&E.node&&E.node.isBlock)break}}else{let v=g.childNodes[b-1];h=v&&(v.nodeName=="BR"||v.contentEditable=="false")}}if(wr&&f.focusNode&&f.focusNode!=l.node&&f.focusNode.nodeType==1){let g=f.focusNode.childNodes[f.focusOffset];g&&g.contentEditable=="false"&&(i=!0)}if(!(i||h&&an)&&Fo(a.node,a.offset,f.anchorNode,f.anchorOffset)&&Fo(l.node,l.offset,f.focusNode,f.focusOffset))return;let m=!1;if((d.extend||e==t)&&!h){d.collapse(a.node,a.offset);try{e!=t&&d.extend(l.node,l.offset),m=!0}catch{}}if(!m){if(e>t){let b=a;a=l,l=b}let g=document.createRange();g.setEnd(l.node,l.offset),g.setStart(a.node,a.offset),d.removeAllRanges(),d.addRange(g)}}ignoreMutation(e){return!this.contentDOM&&e.type!="selection"}get contentLost(){return this.contentDOM&&this.contentDOM!=this.dom&&!this.dom.contains(this.contentDOM)}markDirty(e,t){for(let r=0,i=0;i<this.children.length;i++){let o=this.children[i],s=r+o.size;if(r==s?e<=s&&t>=r:e<s&&t>r){let a=r+o.border,l=s-o.border;if(e>=a&&t<=l){this.dirty=e==r||t==s?Co:g1,e==a&&t==l&&(o.contentLost||o.dom.parentNode!=this.contentDOM)?o.dirty=Hr:o.markDirty(e-a,t-a);return}else o.dirty=o.dom==o.contentDOM&&o.dom.parentNode==this.contentDOM&&!o.children.length?Co:Hr}r=s}this.dirty=Co}markParentsDirty(){let e=1;for(let t=this.parent;t;t=t.parent,e++){let r=e==1?Co:g1;t.dirty<r&&(t.dirty=r)}}get domAtom(){return!1}get ignoreForCoords(){return!1}get ignoreForSelection(){return!1}isText(e){return!1}}class bv extends mu{constructor(e,t,r,i){let o,s=t.type.toDOM;if(typeof s=="function"&&(s=s(r,()=>{if(!o)return i;if(o.parent)return o.parent.posBeforeChild(o)})),!t.type.spec.raw){if(s.nodeType!=1){let a=document.createElement("span");a.appendChild(s),s=a}s.contentEditable="false",s.classList.add("ProseMirror-widget")}super(e,[],s,null),this.widget=t,this.widget=t,o=this}matchesWidget(e){return this.dirty==nr&&e.type.eq(this.widget.type)}parseRule(){return{ignore:!0}}stopEvent(e){let t=this.widget.spec.stopEvent;return t?t(e):!1}ignoreMutation(e){return e.type!="selection"||this.widget.spec.ignoreSelection}destroy(){this.widget.type.destroy(this.dom),super.destroy()}get domAtom(){return!0}get ignoreForSelection(){return!!this.widget.type.spec.relaxedSide}get side(){return this.widget.type.side}}class gD extends mu{constructor(e,t,r,i){super(e,[],t,null),this.textDOM=r,this.text=i}get size(){return this.text.length}localPosFromDOM(e,t){return e!=this.textDOM?this.posAtStart+(t?this.size:0):this.posAtStart+t}domFromPos(e){return{node:this.textDOM,offset:e}}ignoreMutation(e){return e.type==="characterData"&&e.target.nodeValue==e.oldValue}}class Ro extends mu{constructor(e,t,r,i,o){super(e,[],r,i),this.mark=t,this.spec=o}static create(e,t,r,i){let o=i.nodeViews[t.type.name],s=o&&o(t,i,r);return(!s||!s.dom)&&(s=zo.renderSpec(document,t.type.spec.toDOM(t,r),null,t.attrs)),new Ro(e,t,s.dom,s.contentDOM||s.dom,s)}parseRule(){return this.dirty&Hr||this.mark.type.spec.reparseInView?null:{mark:this.mark.type.name,attrs:this.mark.attrs,contentElement:this.contentDOM}}matchesMark(e){return this.dirty!=Hr&&this.mark.eq(e)}markDirty(e,t){if(super.markDirty(e,t),this.dirty!=nr){let r=this.parent;for(;!r.node;)r=r.parent;r.dirty<this.dirty&&(r.dirty=this.dirty),this.dirty=nr}}slice(e,t,r){let i=Ro.create(this.parent,this.mark,!0,r),o=this.children,s=this.size;t<s&&(o=Oh(o,t,s,r)),e>0&&(o=Oh(o,0,e,r));for(let a=0;a<o.length;a++)o[a].parent=i;return i.children=o,i}ignoreMutation(e){return this.spec.ignoreMutation?this.spec.ignoreMutation(e):super.ignoreMutation(e)}destroy(){this.spec.destroy&&this.spec.destroy(),super.destroy()}}class ji extends mu{constructor(e,t,r,i,o,s,a,l,d){super(e,[],o,s),this.node=t,this.outerDeco=r,this.innerDeco=i,this.nodeDOM=a}static create(e,t,r,i,o,s){let a=o.nodeViews[t.type.name],l,d=a&&a(t,o,()=>{if(!l)return s;if(l.parent)return l.parent.posBeforeChild(l)},r,i),f=d&&d.dom,h=d&&d.contentDOM;if(t.isText){if(!f)f=document.createTextNode(t.text);else if(f.nodeType!=3)throw new RangeError("Text must be rendered as a DOM text node")}else f||({dom:f,contentDOM:h}=zo.renderSpec(document,t.type.spec.toDOM(t),null,t.attrs));!h&&!t.isText&&f.nodeName!="BR"&&(f.hasAttribute("contenteditable")||(f.contentEditable="false"),t.type.spec.draggable&&(f.draggable=!0));let m=f;return f=wv(f,r,t),d?l=new bD(e,t,r,i,f,h||null,m,d,o,s+1):t.isText?new Ic(e,t,r,i,f,m,o):new ji(e,t,r,i,f,h||null,m,o,s+1)}parseRule(){if(this.node.type.spec.reparseInView)return null;let e={node:this.node.type.name,attrs:this.node.attrs};if(this.node.type.whitespace=="pre"&&(e.preserveWhitespace="full"),!this.contentDOM)e.getContent=()=>this.node.content;else if(!this.contentLost)e.contentElement=this.contentDOM;else{for(let t=this.children.length-1;t>=0;t--){let r=this.children[t];if(this.dom.contains(r.dom.parentNode)){e.contentElement=r.dom.parentNode;break}}e.contentElement||(e.getContent=()=>q.empty)}return e}matchesNode(e,t,r){return this.dirty==nr&&e.eq(this.node)&&cc(t,this.outerDeco)&&r.eq(this.innerDeco)}get size(){return this.node.nodeSize}get border(){return this.node.isLeaf?0:1}updateChildren(e,t){let r=this.node.inlineContent,i=t,o=e.composing?this.localCompositionInfo(e,t):null,s=o&&o.pos>-1?o:null,a=o&&o.pos<0,l=new vD(this,s&&s.node,e);kD(this.node,this.innerDeco,(d,f,h)=>{d.spec.marks?l.syncToMarks(d.spec.marks,r,e):d.type.side>=0&&!h&&l.syncToMarks(f==this.node.childCount?qe.none:this.node.child(f).marks,r,e),l.placeWidget(d,e,i)},(d,f,h,m)=>{l.syncToMarks(d.marks,r,e);let g;l.findNodeMatch(d,f,h,m)||a&&e.state.selection.from>i&&e.state.selection.to<i+d.nodeSize&&(g=l.findIndexWithChild(o.node))>-1&&l.updateNodeAt(d,f,h,g,e)||l.updateNextNode(d,f,h,e,m,i)||l.addNode(d,f,h,e,i),i+=d.nodeSize}),l.syncToMarks([],r,e),this.node.isTextblock&&l.addTextblockHacks(),l.destroyRest(),(l.changed||this.dirty==Co)&&(s&&this.protectLocalComposition(e,s),vv(this.contentDOM,this.children,e),Ps&&SD(this.dom))}localCompositionInfo(e,t){let{from:r,to:i}=e.state.selection;if(!(e.state.selection instanceof pe)||r<t||i>t+this.node.content.size)return null;let o=e.input.compositionNode;if(!o||!this.dom.contains(o.parentNode))return null;if(this.node.inlineContent){let s=o.nodeValue,a=CD(this.node.content,s,r-t,i-t);return a<0?null:{node:o,pos:a,text:s}}else return{node:o,pos:-1,text:""}}protectLocalComposition(e,{node:t,pos:r,text:i}){if(this.getDesc(t))return;let o=t;for(;o.parentNode!=this.contentDOM;o=o.parentNode){for(;o.previousSibling;)o.parentNode.removeChild(o.previousSibling);for(;o.nextSibling;)o.parentNode.removeChild(o.nextSibling);o.pmViewDesc&&(o.pmViewDesc=void 0)}let s=new gD(this,o,t,i);e.input.compositionNodes.push(s),this.children=Oh(this.children,r,r+i.length,e,s)}update(e,t,r,i){return this.dirty==Hr||!e.sameMarkup(this.node)?!1:(this.updateInner(e,t,r,i),!0)}updateInner(e,t,r,i){this.updateOuterDeco(t),this.node=e,this.innerDeco=r,this.contentDOM&&this.updateChildren(i,this.posAtStart),this.dirty=nr}updateOuterDeco(e){if(cc(e,this.outerDeco))return;let t=this.nodeDOM.nodeType!=1,r=this.dom;this.dom=xv(this.dom,this.nodeDOM,Mh(this.outerDeco,this.node,t),Mh(e,this.node,t)),this.dom!=r&&(r.pmViewDesc=void 0,this.dom.pmViewDesc=this),this.outerDeco=e}selectNode(){this.nodeDOM.nodeType==1&&this.nodeDOM.classList.add("ProseMirror-selectednode"),(this.contentDOM||!this.node.type.spec.draggable)&&(this.dom.draggable=!0)}deselectNode(){this.nodeDOM.nodeType==1&&(this.nodeDOM.classList.remove("ProseMirror-selectednode"),(this.contentDOM||!this.node.type.spec.draggable)&&this.dom.removeAttribute("draggable"))}get domAtom(){return this.node.isAtom}}function b1(n,e,t,r,i){wv(r,e,n);let o=new ji(void 0,n,e,t,r,r,r,i,0);return o.contentDOM&&o.updateChildren(i,0),o}class Ic extends ji{constructor(e,t,r,i,o,s,a){super(e,t,r,i,o,null,s,a,0)}parseRule(){let e=this.nodeDOM.parentNode;for(;e&&e!=this.dom&&!e.pmIsDeco;)e=e.parentNode;return{skip:e||!0}}update(e,t,r,i){return this.dirty==Hr||this.dirty!=nr&&!this.inParent()||!e.sameMarkup(this.node)?!1:(this.updateOuterDeco(t),(this.dirty!=nr||e.text!=this.node.text)&&e.text!=this.nodeDOM.nodeValue&&(this.nodeDOM.nodeValue=e.text,i.trackWrites==this.nodeDOM&&(i.trackWrites=null)),this.node=e,this.dirty=nr,!0)}inParent(){let e=this.parent.contentDOM;for(let t=this.nodeDOM;t;t=t.parentNode)if(t==e)return!0;return!1}domFromPos(e){return{node:this.nodeDOM,offset:e}}localPosFromDOM(e,t,r){return e==this.nodeDOM?this.posAtStart+Math.min(t,this.node.text.length):super.localPosFromDOM(e,t,r)}ignoreMutation(e){return e.type!="characterData"&&e.type!="selection"}slice(e,t,r){let i=this.node.cut(e,t),o=document.createTextNode(i.text);return new Ic(this.parent,i,this.outerDeco,this.innerDeco,o,o,r)}markDirty(e,t){super.markDirty(e,t),this.dom!=this.nodeDOM&&(e==0||t==this.nodeDOM.nodeValue.length)&&(this.dirty=Hr)}get domAtom(){return!1}isText(e){return this.node.text==e}}class yv extends mu{parseRule(){return{ignore:!0}}matchesHack(e){return this.dirty==nr&&this.dom.nodeName==e}get domAtom(){return!0}get ignoreForCoords(){return this.dom.nodeName=="IMG"}}class bD extends ji{constructor(e,t,r,i,o,s,a,l,d,f){super(e,t,r,i,o,s,a,d,f),this.spec=l}update(e,t,r,i){if(this.dirty==Hr)return!1;if(this.spec.update&&(this.node.type==e.type||this.spec.multiType)){let o=this.spec.update(e,t,r);return o&&this.updateInner(e,t,r,i),o}else return!this.contentDOM&&!e.isLeaf?!1:super.update(e,t,r,i)}selectNode(){this.spec.selectNode?this.spec.selectNode():super.selectNode()}deselectNode(){this.spec.deselectNode?this.spec.deselectNode():super.deselectNode()}setSelection(e,t,r,i){this.spec.setSelection?this.spec.setSelection(e,t,r.root):super.setSelection(e,t,r,i)}destroy(){this.spec.destroy&&this.spec.destroy(),super.destroy()}stopEvent(e){return this.spec.stopEvent?this.spec.stopEvent(e):!1}ignoreMutation(e){return this.spec.ignoreMutation?this.spec.ignoreMutation(e):super.ignoreMutation(e)}}function vv(n,e,t){let r=n.firstChild,i=!1;for(let o=0;o<e.length;o++){let s=e[o],a=s.dom;if(a.parentNode==n){for(;a!=r;)r=y1(r),i=!0;r=r.nextSibling}else i=!0,n.insertBefore(a,r);if(s instanceof Ro){let l=r?r.previousSibling:n.lastChild;vv(s.contentDOM,s.children,t),r=l?l.nextSibling:n.firstChild}}for(;r;)r=y1(r),i=!0;i&&t.trackWrites==n&&(t.trackWrites=null)}const qa=function(n){n&&(this.nodeName=n)};qa.prototype=Object.create(null);const Eo=[new qa];function Mh(n,e,t){if(n.length==0)return Eo;let r=t?Eo[0]:new qa,i=[r];for(let o=0;o<n.length;o++){let s=n[o].type.attrs;if(s){s.nodeName&&i.push(r=new qa(s.nodeName));for(let a in s){let l=s[a];l!=null&&(t&&i.length==1&&i.push(r=new qa(e.isInline?"span":"div")),a=="class"?r.class=(r.class?r.class+" ":"")+l:a=="style"?r.style=(r.style?r.style+";":"")+l:a!="nodeName"&&(r[a]=l))}}}return i}function xv(n,e,t,r){if(t==Eo&&r==Eo)return e;let i=e;for(let o=0;o<r.length;o++){let s=r[o],a=t[o];if(o){let l;a&&a.nodeName==s.nodeName&&i!=n&&(l=i.parentNode)&&l.nodeName.toLowerCase()==s.nodeName||(l=document.createElement(s.nodeName),l.pmIsDeco=!0,l.appendChild(i),a=Eo[0]),i=l}yD(i,a||Eo[0],s)}return i}function yD(n,e,t){for(let r in e)r!="class"&&r!="style"&&r!="nodeName"&&!(r in t)&&n.removeAttribute(r);for(let r in t)r!="class"&&r!="style"&&r!="nodeName"&&t[r]!=e[r]&&n.setAttribute(r,t[r]);if(e.class!=t.class){let r=e.class?e.class.split(" ").filter(Boolean):[],i=t.class?t.class.split(" ").filter(Boolean):[];for(let o=0;o<r.length;o++)i.indexOf(r[o])==-1&&n.classList.remove(r[o]);for(let o=0;o<i.length;o++)r.indexOf(i[o])==-1&&n.classList.add(i[o]);n.classList.length==0&&n.removeAttribute("class")}if(e.style!=t.style){if(e.style){let r=/\s*([\w\-\xa1-\uffff]+)\s*:(?:"(?:\\.|[^"])*"|'(?:\\.|[^'])*'|\(.*?\)|[^;])*/g,i;for(;i=r.exec(e.style);)n.style.removeProperty(i[1])}t.style&&(n.style.cssText+=t.style)}}function wv(n,e,t){return xv(n,n,Eo,Mh(e,t,n.nodeType!=1))}function cc(n,e){if(n.length!=e.length)return!1;for(let t=0;t<n.length;t++)if(!n[t].type.eq(e[t].type))return!1;return!0}function y1(n){let e=n.nextSibling;return n.parentNode.removeChild(n),e}class vD{constructor(e,t,r){this.lock=t,this.view=r,this.index=0,this.stack=[],this.changed=!1,this.top=e,this.preMatch=xD(e.node.content,e)}destroyBetween(e,t){if(e!=t){for(let r=e;r<t;r++)this.top.children[r].destroy();this.top.children.splice(e,t-e),this.changed=!0}}destroyRest(){this.destroyBetween(this.index,this.top.children.length)}syncToMarks(e,t,r){let i=0,o=this.stack.length>>1,s=Math.min(o,e.length);for(;i<s&&(i==o-1?this.top:this.stack[i+1<<1]).matchesMark(e[i])&&e[i].type.spec.spanning!==!1;)i++;for(;i<o;)this.destroyRest(),this.top.dirty=nr,this.index=this.stack.pop(),this.top=this.stack.pop(),o--;for(;o<e.length;){this.stack.push(this.top,this.index+1);let a=-1;for(let l=this.index;l<Math.min(this.index+3,this.top.children.length);l++){let d=this.top.children[l];if(d.matchesMark(e[o])&&!this.isLocked(d.dom)){a=l;break}}if(a>-1)a>this.index&&(this.changed=!0,this.destroyBetween(this.index,a)),this.top=this.top.children[this.index];else{let l=Ro.create(this.top,e[o],t,r);this.top.children.splice(this.index,0,l),this.top=l,this.changed=!0}this.index=0,o++}}findNodeMatch(e,t,r,i){let o=-1,s;if(i>=this.preMatch.index&&(s=this.preMatch.matches[i-this.preMatch.index]).parent==this.top&&s.matchesNode(e,t,r))o=this.top.children.indexOf(s,this.index);else for(let a=this.index,l=Math.min(this.top.children.length,a+5);a<l;a++){let d=this.top.children[a];if(d.matchesNode(e,t,r)&&!this.preMatch.matched.has(d)){o=a;break}}return o<0?!1:(this.destroyBetween(this.index,o),this.index++,!0)}updateNodeAt(e,t,r,i,o){let s=this.top.children[i];return s.dirty==Hr&&s.dom==s.contentDOM&&(s.dirty=Co),s.update(e,t,r,o)?(this.destroyBetween(this.index,i),this.index++,!0):!1}findIndexWithChild(e){for(;;){let t=e.parentNode;if(!t)return-1;if(t==this.top.contentDOM){let r=e.pmViewDesc;if(r){for(let i=this.index;i<this.top.children.length;i++)if(this.top.children[i]==r)return i}return-1}e=t}}updateNextNode(e,t,r,i,o,s){for(let a=this.index;a<this.top.children.length;a++){let l=this.top.children[a];if(l instanceof ji){let d=this.preMatch.matched.get(l);if(d!=null&&d!=o)return!1;let f=l.dom,h,m=this.isLocked(f)&&!(e.isText&&l.node&&l.node.isText&&l.nodeDOM.nodeValue==e.text&&l.dirty!=Hr&&cc(t,l.outerDeco));if(!m&&l.update(e,t,r,i))return this.destroyBetween(this.index,a),l.dom!=f&&(this.changed=!0),this.index++,!0;if(!m&&(h=this.recreateWrapper(l,e,t,r,i,s)))return this.destroyBetween(this.index,a),this.top.children[this.index]=h,h.contentDOM&&(h.dirty=Co,h.updateChildren(i,s+1),h.dirty=nr),this.changed=!0,this.index++,!0;break}}return!1}recreateWrapper(e,t,r,i,o,s){if(e.dirty||t.isAtom||!e.children.length||!e.node.content.eq(t.content)||!cc(r,e.outerDeco)||!i.eq(e.innerDeco))return null;let a=ji.create(this.top,t,r,i,o,s);if(a.contentDOM){a.children=e.children,e.children=[];for(let l of a.children)l.parent=a}return e.destroy(),a}addNode(e,t,r,i,o){let s=ji.create(this.top,e,t,r,i,o);s.contentDOM&&s.updateChildren(i,o+1),this.top.children.splice(this.index++,0,s),this.changed=!0}placeWidget(e,t,r){let i=this.index<this.top.children.length?this.top.children[this.index]:null;if(i&&i.matchesWidget(e)&&(e==i.widget||!i.widget.type.toDOM.parentNode))this.index++;else{let o=new bv(this.top,e,t,r);this.top.children.splice(this.index++,0,o),this.changed=!0}}addTextblockHacks(){let e=this.top.children[this.index-1],t=this.top;for(;e instanceof Ro;)t=e,e=t.children[t.children.length-1];(!e||!(e instanceof Ic)||/\n$/.test(e.node.text)||this.view.requiresGeckoHackNode&&/\s$/.test(e.node.text))&&((an||Xt)&&e&&e.dom.contentEditable=="false"&&this.addHackNode("IMG",t),this.addHackNode("BR",this.top))}addHackNode(e,t){if(t==this.top&&this.index<t.children.length&&t.children[this.index].matchesHack(e))this.index++;else{let r=document.createElement(e);e=="IMG"&&(r.className="ProseMirror-separator",r.alt=""),e=="BR"&&(r.className="ProseMirror-trailingBreak");let i=new yv(this.top,[],r,null);t!=this.top?t.children.push(i):t.children.splice(this.index++,0,i),this.changed=!0}}isLocked(e){return this.lock&&(e==this.lock||e.nodeType==1&&e.contains(this.lock.parentNode))}}function xD(n,e){let t=e,r=t.children.length,i=n.childCount,o=new Map,s=[];e:for(;i>0;){let a;for(;;)if(r){let d=t.children[r-1];if(d instanceof Ro)t=d,r=d.children.length;else{a=d,r--;break}}else{if(t==e)break e;r=t.parent.children.indexOf(t),t=t.parent}let l=a.node;if(l){if(l!=n.child(i-1))break;--i,o.set(a,i),s.push(a)}}return{index:i,matched:o,matches:s.reverse()}}function wD(n,e){return n.type.side-e.type.side}function kD(n,e,t,r){let i=e.locals(n),o=0;if(i.length==0){for(let d=0;d<n.childCount;d++){let f=n.child(d);r(f,i,e.forChild(o,f),d),o+=f.nodeSize}return}let s=0,a=[],l=null;for(let d=0;;){let f,h;for(;s<i.length&&i[s].to==o;){let x=i[s++];x.widget&&(f?(h||(h=[f])).push(x):f=x)}if(f)if(h){h.sort(wD);for(let x=0;x<h.length;x++)t(h[x],d,!!l)}else t(f,d,!!l);let m,g;if(l)g=-1,m=l,l=null;else if(d<n.childCount)g=d,m=n.child(d++);else break;for(let x=0;x<a.length;x++)a[x].to<=o&&a.splice(x--,1);for(;s<i.length&&i[s].from<=o&&i[s].to>o;)a.push(i[s++]);let b=o+m.nodeSize;if(m.isText){let x=b;s<i.length&&i[s].from<x&&(x=i[s].from);for(let E=0;E<a.length;E++)a[E].to<x&&(x=a[E].to);x<b&&(l=m.cut(x-o),m=m.cut(0,x-o),b=x,g=-1)}else for(;s<i.length&&i[s].to<b;)s++;let v=m.isInline&&!m.isLeaf?a.filter(x=>!x.inline):a.slice();r(m,v,e.forChild(o,m),g),o=b}}function SD(n){if(n.nodeName=="UL"||n.nodeName=="OL"){let e=n.style.cssText;n.style.cssText=e+"; list-style: square !important",window.getComputedStyle(n).listStyle,n.style.cssText=e}}function CD(n,e,t,r){for(let i=0,o=0;i<n.childCount&&o<=r;){let s=n.child(i++),a=o;if(o+=s.nodeSize,!s.isText)continue;let l=s.text;for(;i<n.childCount;){let d=n.child(i++);if(o+=d.nodeSize,!d.isText)break;l+=d.text}if(o>=t){if(o>=r&&l.slice(r-e.length-a,r-a)==e)return r-e.length;let d=a<r?l.lastIndexOf(e,r-a-1):-1;if(d>=0&&d+e.length+a>=t)return a+d;if(t==r&&l.length>=r+e.length-a&&l.slice(r-a,r-a+e.length)==e)return r}}return-1}function Oh(n,e,t,r,i){let o=[];for(let s=0,a=0;s<n.length;s++){let l=n[s],d=a,f=a+=l.size;d>=t||f<=e?o.push(l):(d<e&&o.push(l.slice(0,e-d,r)),i&&(o.push(i),i=void 0),f>t&&o.push(l.slice(t-d,l.size,r)))}return o}function up(n,e=null){let t=n.domSelectionRange(),r=n.state.doc;if(!t.focusNode)return null;let i=n.docView.nearestDesc(t.focusNode),o=i&&i.size==0,s=n.docView.posFromDOM(t.focusNode,t.focusOffset,1);if(s<0)return null;let a=r.resolve(s),l,d;if(Oc(t)){for(l=s;i&&!i.node;)i=i.parent;let h=i.node;if(i&&h.isAtom&&re.isSelectable(h)&&i.parent&&!(h.isInline&&YT(t.focusNode,t.focusOffset,i.dom))){let m=i.posBefore;d=new re(s==m?a:r.resolve(m))}}else{if(t instanceof n.dom.ownerDocument.defaultView.Selection&&t.rangeCount>1){let h=s,m=s;for(let g=0;g<t.rangeCount;g++){let b=t.getRangeAt(g);h=Math.min(h,n.docView.posFromDOM(b.startContainer,b.startOffset,1)),m=Math.max(m,n.docView.posFromDOM(b.endContainer,b.endOffset,-1))}if(h<0)return null;[l,s]=m==n.state.selection.anchor?[m,h]:[h,m],a=r.resolve(s)}else l=n.docView.posFromDOM(t.anchorNode,t.anchorOffset,1);if(l<0)return null}let f=r.resolve(l);if(!d){let h=e=="pointer"||n.state.selection.head<a.pos&&!o?1:-1;d=lp(n,f,a,h)}return d}function kv(n){return n.editable?n.hasFocus():Cv(n)&&document.activeElement&&document.activeElement.contains(n.dom)}function fi(n,e=!1){let t=n.state.selection;if(Sv(n,t),!!kv(n)){if(!e&&n.input.mouseDown&&n.input.mouseDown.allowDefault&&Xt){let r=n.domSelectionRange(),i=n.domObserver.currentSelection;if(r.anchorNode&&i.anchorNode&&Fo(r.anchorNode,r.anchorOffset,i.anchorNode,i.anchorOffset)){n.input.mouseDown.delayedSelectionSync=!0,n.domObserver.setCurSelection();return}}if(n.domObserver.disconnectSelection(),n.cursorWrapper)_D(n);else{let{anchor:r,head:i}=t,o,s;v1&&!(t instanceof pe)&&(t.$from.parent.inlineContent||(o=x1(n,t.from)),!t.empty&&!t.$from.parent.inlineContent&&(s=x1(n,t.to))),n.docView.setSelection(r,i,n,e),v1&&(o&&w1(o),s&&w1(s)),t.visible?n.dom.classList.remove("ProseMirror-hideselection"):(n.dom.classList.add("ProseMirror-hideselection"),"onselectionchange"in document&&ED(n))}n.domObserver.setCurSelection(),n.domObserver.connectSelection()}}const v1=an||Xt&&cv<63;function x1(n,e){let{node:t,offset:r}=n.docView.domFromPos(e,0),i=r<t.childNodes.length?t.childNodes[r]:null,o=r?t.childNodes[r-1]:null;if(an&&i&&i.contentEditable=="false")return Ff(i);if((!i||i.contentEditable=="false")&&(!o||o.contentEditable=="false")){if(i)return Ff(i);if(o)return Ff(o)}}function Ff(n){return n.contentEditable="true",an&&n.draggable&&(n.draggable=!1,n.wasDraggable=!0),n}function w1(n){n.contentEditable="false",n.wasDraggable&&(n.draggable=!0,n.wasDraggable=null)}function ED(n){let e=n.dom.ownerDocument;e.removeEventListener("selectionchange",n.input.hideSelectionGuard);let t=n.domSelectionRange(),r=t.anchorNode,i=t.anchorOffset;e.addEventListener("selectionchange",n.input.hideSelectionGuard=()=>{(t.anchorNode!=r||t.anchorOffset!=i)&&(e.removeEventListener("selectionchange",n.input.hideSelectionGuard),setTimeout(()=>{(!kv(n)||n.state.selection.visible)&&n.dom.classList.remove("ProseMirror-hideselection")},20))})}function _D(n){let e=n.domSelection(),t=document.createRange();if(!e)return;let r=n.cursorWrapper.dom,i=r.nodeName=="IMG";i?t.setStart(r.parentNode,Rt(r)+1):t.setStart(r,0),t.collapse(!0),e.removeAllRanges(),e.addRange(t),!i&&!n.state.selection.visible&&xn&&Ki<=11&&(r.disabled=!0,r.disabled=!1)}function Sv(n,e){if(e instanceof re){let t=n.docView.descAt(e.from);t!=n.lastSelectedViewDesc&&(k1(n),t&&t.selectNode(),n.lastSelectedViewDesc=t)}else k1(n)}function k1(n){n.lastSelectedViewDesc&&(n.lastSelectedViewDesc.parent&&n.lastSelectedViewDesc.deselectNode(),n.lastSelectedViewDesc=void 0)}function lp(n,e,t,r){return n.someProp("createSelectionBetween",i=>i(n,e,t))||pe.between(e,t,r)}function S1(n){return n.editable&&!n.hasFocus()?!1:Cv(n)}function Cv(n){let e=n.domSelectionRange();if(!e.anchorNode)return!1;try{return n.dom.contains(e.anchorNode.nodeType==3?e.anchorNode.parentNode:e.anchorNode)&&(n.editable||n.dom.contains(e.focusNode.nodeType==3?e.focusNode.parentNode:e.focusNode))}catch{return!1}}function AD(n){let e=n.docView.domFromPos(n.state.selection.anchor,0),t=n.domSelectionRange();return Fo(e.node,e.offset,t.anchorNode,t.anchorOffset)}function Ih(n,e){let{$anchor:t,$head:r}=n.selection,i=e>0?t.max(r):t.min(r),o=i.parent.inlineContent?i.depth?n.doc.resolve(e>0?i.after():i.before()):null:i;return o&&Ce.findFrom(o,e)}function Ii(n,e){return n.dispatch(n.state.tr.setSelection(e).scrollIntoView()),!0}function C1(n,e,t){let r=n.state.selection;if(r instanceof pe)if(t.indexOf("s")>-1){let{$head:i}=r,o=i.textOffset?null:e<0?i.nodeBefore:i.nodeAfter;if(!o||o.isText||!o.isLeaf)return!1;let s=n.state.doc.resolve(i.pos+o.nodeSize*(e<0?-1:1));return Ii(n,new pe(r.$anchor,s))}else if(r.empty){if(n.endOfTextblock(e>0?"forward":"backward")){let i=Ih(n.state,e);return i&&i instanceof re?Ii(n,i):!1}else if(!(Qn&&t.indexOf("m")>-1)){let i=r.$head,o=i.textOffset?null:e<0?i.nodeBefore:i.nodeAfter,s;if(!o||o.isText)return!1;let a=e<0?i.pos-o.nodeSize:i.pos;return o.isAtom||(s=n.docView.descAt(a))&&!s.contentDOM?re.isSelectable(o)?Ii(n,new re(e<0?n.state.doc.resolve(i.pos-o.nodeSize):i)):pu?Ii(n,new pe(n.state.doc.resolve(e<0?a:a+o.nodeSize))):!1:!1}}else return!1;else{if(r instanceof re&&r.node.isInline)return Ii(n,new pe(e>0?r.$to:r.$from));{let i=Ih(n.state,e);return i?Ii(n,i):!1}}}function dc(n){return n.nodeType==3?n.nodeValue.length:n.childNodes.length}function Va(n,e){let t=n.pmViewDesc;return t&&t.size==0&&(e<0||n.nextSibling||n.nodeName!="BR")}function fs(n,e){return e<0?TD(n):DD(n)}function TD(n){let e=n.domSelectionRange(),t=e.focusNode,r=e.focusOffset;if(!t)return;let i,o,s=!1;for(wr&&t.nodeType==1&&r<dc(t)&&Va(t.childNodes[r],-1)&&(s=!0);;)if(r>0){if(t.nodeType!=1)break;{let a=t.childNodes[r-1];if(Va(a,-1))i=t,o=--r;else if(a.nodeType==3)t=a,r=t.nodeValue.length;else break}}else{if(Ev(t))break;{let a=t.previousSibling;for(;a&&Va(a,-1);)i=t.parentNode,o=Rt(a),a=a.previousSibling;if(a)t=a,r=dc(t);else{if(t=t.parentNode,t==n.dom)break;r=0}}}s?Nh(n,t,r):i&&Nh(n,i,o)}function DD(n){let e=n.domSelectionRange(),t=e.focusNode,r=e.focusOffset;if(!t)return;let i=dc(t),o,s;for(;;)if(r<i){if(t.nodeType!=1)break;let a=t.childNodes[r];if(Va(a,1))o=t,s=++r;else break}else{if(Ev(t))break;{let a=t.nextSibling;for(;a&&Va(a,1);)o=a.parentNode,s=Rt(a)+1,a=a.nextSibling;if(a)t=a,r=0,i=dc(t);else{if(t=t.parentNode,t==n.dom)break;r=i=0}}}o&&Nh(n,o,s)}function Ev(n){let e=n.pmViewDesc;return e&&e.node&&e.node.isBlock}function MD(n,e){for(;n&&e==n.childNodes.length&&!hu(n);)e=Rt(n)+1,n=n.parentNode;for(;n&&e<n.childNodes.length;){let t=n.childNodes[e];if(t.nodeType==3)return t;if(t.nodeType==1&&t.contentEditable=="false")break;n=t,e=0}}function OD(n,e){for(;n&&!e&&!hu(n);)e=Rt(n),n=n.parentNode;for(;n&&e;){let t=n.childNodes[e-1];if(t.nodeType==3)return t;if(t.nodeType==1&&t.contentEditable=="false")break;n=t,e=n.childNodes.length}}function Nh(n,e,t){if(e.nodeType!=3){let o,s;(s=MD(e,t))?(e=s,t=0):(o=OD(e,t))&&(e=o,t=o.nodeValue.length)}let r=n.domSelection();if(!r)return;if(Oc(r)){let o=document.createRange();o.setEnd(e,t),o.setStart(e,t),r.removeAllRanges(),r.addRange(o)}else r.extend&&r.extend(e,t);n.domObserver.setCurSelection();let{state:i}=n;setTimeout(()=>{n.state==i&&fi(n)},50)}function E1(n,e){let t=n.state.doc.resolve(e);if(!(Xt||QT)&&t.parent.inlineContent){let i=n.coordsAtPos(e);if(e>t.start()){let o=n.coordsAtPos(e-1),s=(o.top+o.bottom)/2;if(s>i.top&&s<i.bottom&&Math.abs(o.left-i.left)>1)return o.left<i.left?"ltr":"rtl"}if(e<t.end()){let o=n.coordsAtPos(e+1),s=(o.top+o.bottom)/2;if(s>i.top&&s<i.bottom&&Math.abs(o.left-i.left)>1)return o.left>i.left?"ltr":"rtl"}}return getComputedStyle(n.dom).direction=="rtl"?"rtl":"ltr"}function _1(n,e,t){let r=n.state.selection;if(r instanceof pe&&!r.empty||t.indexOf("s")>-1||Qn&&t.indexOf("m")>-1)return!1;let{$from:i,$to:o}=r;if(!i.parent.inlineContent||n.endOfTextblock(e<0?"up":"down")){let s=Ih(n.state,e);if(s&&s instanceof re)return Ii(n,s)}if(!i.parent.inlineContent){let s=e<0?i:o,a=r instanceof Bn?Ce.near(s,e):Ce.findFrom(s,e);return a?Ii(n,a):!1}return!1}function A1(n,e){if(!(n.state.selection instanceof pe))return!0;let{$head:t,$anchor:r,empty:i}=n.state.selection;if(!t.sameParent(r))return!0;if(!i)return!1;if(n.endOfTextblock(e>0?"forward":"backward"))return!0;let o=!t.textOffset&&(e<0?t.nodeBefore:t.nodeAfter);if(o&&!o.isText){let s=n.state.tr;return e<0?s.delete(t.pos-o.nodeSize,t.pos):s.delete(t.pos,t.pos+o.nodeSize),n.dispatch(s),!0}return!1}function T1(n,e,t){n.domObserver.stop(),e.contentEditable=t,n.domObserver.start()}function ID(n){if(!an||n.state.selection.$head.parentOffset>0)return!1;let{focusNode:e,focusOffset:t}=n.domSelectionRange();if(e&&e.nodeType==1&&t==0&&e.firstChild&&e.firstChild.contentEditable=="false"){let r=e.firstChild;T1(n,r,"true"),setTimeout(()=>T1(n,r,"false"),20)}return!1}function ND(n){let e="";return n.ctrlKey&&(e+="c"),n.metaKey&&(e+="m"),n.altKey&&(e+="a"),n.shiftKey&&(e+="s"),e}function PD(n,e){let t=e.keyCode,r=ND(e);if(t==8||Qn&&t==72&&r=="c")return A1(n,-1)||fs(n,-1);if(t==46&&!e.shiftKey||Qn&&t==68&&r=="c")return A1(n,1)||fs(n,1);if(t==13||t==27)return!0;if(t==37||Qn&&t==66&&r=="c"){let i=t==37?E1(n,n.state.selection.from)=="ltr"?-1:1:-1;return C1(n,i,r)||fs(n,i)}else if(t==39||Qn&&t==70&&r=="c"){let i=t==39?E1(n,n.state.selection.from)=="ltr"?1:-1:1;return C1(n,i,r)||fs(n,i)}else{if(t==38||Qn&&t==80&&r=="c")return _1(n,-1,r)||fs(n,-1);if(t==40||Qn&&t==78&&r=="c")return ID(n)||_1(n,1,r)||fs(n,1);if(r==(Qn?"m":"c")&&(t==66||t==73||t==89||t==90))return!0}return!1}function cp(n,e){n.someProp("transformCopied",g=>{e=g(e,n)});let t=[],{content:r,openStart:i,openEnd:o}=e;for(;i>1&&o>1&&r.childCount==1&&r.firstChild.childCount==1;){i--,o--;let g=r.firstChild;t.push(g.type.name,g.attrs!=g.type.defaultAttrs?g.attrs:null),r=g.content}let s=n.someProp("clipboardSerializer")||zo.fromSchema(n.state.schema),a=Ov(),l=a.createElement("div");l.appendChild(s.serializeFragment(r,{document:a}));let d=l.firstChild,f,h=0;for(;d&&d.nodeType==1&&(f=Mv[d.nodeName.toLowerCase()]);){for(let g=f.length-1;g>=0;g--){let b=a.createElement(f[g]);for(;l.firstChild;)b.appendChild(l.firstChild);l.appendChild(b),h++}d=l.firstChild}d&&d.nodeType==1&&d.setAttribute("data-pm-slice",`${i} ${o}${h?` -${h}`:""} ${JSON.stringify(t)}`);let m=n.someProp("clipboardTextSerializer",g=>g(e,n))||e.content.textBetween(0,e.content.size,`

`);return{dom:l,text:m,slice:e}}function _v(n,e,t,r,i){let o=i.parent.type.spec.code,s,a;if(!t&&!e)return null;let l=e&&(r||o||!t);if(l){if(n.someProp("transformPastedText",m=>{e=m(e,o||r,n)}),o)return e?new X(q.from(n.state.schema.text(e.replace(/\r\n?/g,`
`))),0,0):X.empty;let h=n.someProp("clipboardTextParser",m=>m(e,i,r,n));if(h)a=h;else{let m=i.marks(),{schema:g}=n.state,b=zo.fromSchema(g);s=document.createElement("div"),e.split(/(?:\r\n?|\n)+/).forEach(v=>{let x=s.appendChild(document.createElement("p"));v&&x.appendChild(b.serializeNode(g.text(v,m)))})}}else n.someProp("transformPastedHTML",h=>{t=h(t,n)}),s=BD(t),pu&&$D(s);let d=s&&s.querySelector("[data-pm-slice]"),f=d&&/^(\d+) (\d+)(?: -(\d+))? (.*)/.exec(d.getAttribute("data-pm-slice")||"");if(f&&f[3])for(let h=+f[3];h>0;h--){let m=s.firstChild;for(;m&&m.nodeType!=1;)m=m.nextSibling;if(!m)break;s=m}if(a||(a=(n.someProp("clipboardParser")||n.someProp("domParser")||_s.fromSchema(n.state.schema)).parseSlice(s,{preserveWhitespace:!!(l||f),context:i,ruleFromNode(m){return m.nodeName=="BR"&&!m.nextSibling&&m.parentNode&&!FD.test(m.parentNode.nodeName)?{ignore:!0}:null}})),f)a=zD(D1(a,+f[1],+f[2]),f[4]);else if(a=X.maxOpen(RD(a.content,i),!0),a.openStart||a.openEnd){let h=0,m=0;for(let g=a.content.firstChild;h<a.openStart&&!g.type.spec.isolating;h++,g=g.firstChild);for(let g=a.content.lastChild;m<a.openEnd&&!g.type.spec.isolating;m++,g=g.lastChild);a=D1(a,h,m)}return n.someProp("transformPasted",h=>{a=h(a,n)}),a}const FD=/^(a|abbr|acronym|b|cite|code|del|em|i|ins|kbd|label|output|q|ruby|s|samp|span|strong|sub|sup|time|u|tt|var)$/i;function RD(n,e){if(n.childCount<2)return n;for(let t=e.depth;t>=0;t--){let i=e.node(t).contentMatchAt(e.index(t)),o,s=[];if(n.forEach(a=>{if(!s)return;let l=i.findWrapping(a.type),d;if(!l)return s=null;if(d=s.length&&o.length&&Tv(l,o,a,s[s.length-1],0))s[s.length-1]=d;else{s.length&&(s[s.length-1]=Dv(s[s.length-1],o.length));let f=Av(a,l);s.push(f),i=i.matchType(f.type),o=l}}),s)return q.from(s)}return n}function Av(n,e,t=0){for(let r=e.length-1;r>=t;r--)n=e[r].create(null,q.from(n));return n}function Tv(n,e,t,r,i){if(i<n.length&&i<e.length&&n[i]==e[i]){let o=Tv(n,e,t,r.lastChild,i+1);if(o)return r.copy(r.content.replaceChild(r.childCount-1,o));if(r.contentMatchAt(r.childCount).matchType(i==n.length-1?t.type:n[i+1]))return r.copy(r.content.append(q.from(Av(t,n,i+1))))}}function Dv(n,e){if(e==0)return n;let t=n.content.replaceChild(n.childCount-1,Dv(n.lastChild,e-1)),r=n.contentMatchAt(n.childCount).fillBefore(q.empty,!0);return n.copy(t.append(r))}function Ph(n,e,t,r,i,o){let s=e<0?n.firstChild:n.lastChild,a=s.content;return n.childCount>1&&(o=0),i<r-1&&(a=Ph(a,e,t,r,i+1,o)),i>=t&&(a=e<0?s.contentMatchAt(0).fillBefore(a,o<=i).append(a):a.append(s.contentMatchAt(s.childCount).fillBefore(q.empty,!0))),n.replaceChild(e<0?0:n.childCount-1,s.copy(a))}function D1(n,e,t){return e<n.openStart&&(n=new X(Ph(n.content,-1,e,n.openStart,0,n.openEnd),e,n.openEnd)),t<n.openEnd&&(n=new X(Ph(n.content,1,t,n.openEnd,0,0),n.openStart,t)),n}const Mv={thead:["table"],tbody:["table"],tfoot:["table"],caption:["table"],colgroup:["table"],col:["table","colgroup"],tr:["table","tbody"],td:["table","tbody","tr"],th:["table","tbody","tr"]};let M1=null;function Ov(){return M1||(M1=document.implementation.createHTMLDocument("title"))}let Rf=null;function LD(n){let e=window.trustedTypes;return e?(Rf||(Rf=e.defaultPolicy||e.createPolicy("ProseMirrorClipboard",{createHTML:t=>t})),Rf.createHTML(n)):n}function BD(n){let e=/^(\s*<meta [^>]*>)*/.exec(n);e&&(n=n.slice(e[0].length));let t=Ov().createElement("div"),r=/<([a-z][^>\s]+)/i.exec(n),i;if((i=r&&Mv[r[1].toLowerCase()])&&(n=i.map(o=>"<"+o+">").join("")+n+i.map(o=>"</"+o+">").reverse().join("")),t.innerHTML=LD(n),i)for(let o=0;o<i.length;o++)t=t.querySelector(i[o])||t;return t}function $D(n){let e=n.querySelectorAll(Xt?"span:not([class]):not([style])":"span.Apple-converted-space");for(let t=0;t<e.length;t++){let r=e[t];r.childNodes.length==1&&r.textContent==""&&r.parentNode&&r.parentNode.replaceChild(n.ownerDocument.createTextNode(" "),r)}}function zD(n,e){if(!n.size)return n;let t=n.content.firstChild.type.schema,r;try{r=JSON.parse(e)}catch{return n}let{content:i,openStart:o,openEnd:s}=n;for(let a=r.length-2;a>=0;a-=2){let l=t.nodes[r[a]];if(!l||l.hasRequiredAttrs())break;i=q.from(l.create(r[a+1],i)),o++,s++}return new X(i,o,s)}const un={},ln={},HD={touchstart:!0,touchmove:!0};class qD{constructor(){this.shiftKey=!1,this.mouseDown=null,this.lastKeyCode=null,this.lastKeyCodeTime=0,this.lastClick={time:0,x:0,y:0,type:"",button:0},this.lastSelectionOrigin=null,this.lastSelectionTime=0,this.lastIOSEnter=0,this.lastIOSEnterFallbackTimeout=-1,this.lastFocus=0,this.lastTouch=0,this.lastChromeDelete=0,this.composing=!1,this.compositionNode=null,this.composingTimeout=-1,this.compositionNodes=[],this.compositionEndedAt=-2e8,this.compositionID=1,this.compositionPendingChanges=0,this.domChangeCount=0,this.eventHandlers=Object.create(null),this.hideSelectionGuard=null}}function VD(n){for(let e in un){let t=un[e];n.dom.addEventListener(e,n.input.eventHandlers[e]=r=>{UD(n,r)&&!dp(n,r)&&(n.editable||!(r.type in ln))&&t(n,r)},HD[e]?{passive:!0}:void 0)}an&&n.dom.addEventListener("input",()=>null),Fh(n)}function Vi(n,e){n.input.lastSelectionOrigin=e,n.input.lastSelectionTime=Date.now()}function WD(n){n.domObserver.stop();for(let e in n.input.eventHandlers)n.dom.removeEventListener(e,n.input.eventHandlers[e]);clearTimeout(n.input.composingTimeout),clearTimeout(n.input.lastIOSEnterFallbackTimeout)}function Fh(n){n.someProp("handleDOMEvents",e=>{for(let t in e)n.input.eventHandlers[t]||n.dom.addEventListener(t,n.input.eventHandlers[t]=r=>dp(n,r))})}function dp(n,e){return n.someProp("handleDOMEvents",t=>{let r=t[e.type];return r?r(n,e)||e.defaultPrevented:!1})}function UD(n,e){if(!e.bubbles)return!0;if(e.defaultPrevented)return!1;for(let t=e.target;t!=n.dom;t=t.parentNode)if(!t||t.nodeType==11||t.pmViewDesc&&t.pmViewDesc.stopEvent(e))return!1;return!0}function KD(n,e){!dp(n,e)&&un[e.type]&&(n.editable||!(e.type in ln))&&un[e.type](n,e)}ln.keydown=(n,e)=>{let t=e;if(n.input.shiftKey=t.keyCode==16||t.shiftKey,!Nv(n,t)&&(n.input.lastKeyCode=t.keyCode,n.input.lastKeyCodeTime=Date.now(),!(ai&&Xt&&t.keyCode==13)))if(t.keyCode!=229&&n.domObserver.forceFlush(),Ps&&t.keyCode==13&&!t.ctrlKey&&!t.altKey&&!t.metaKey){let r=Date.now();n.input.lastIOSEnter=r,n.input.lastIOSEnterFallbackTimeout=setTimeout(()=>{n.input.lastIOSEnter==r&&(n.someProp("handleKeyDown",i=>i(n,wo(13,"Enter"))),n.input.lastIOSEnter=0)},200)}else n.someProp("handleKeyDown",r=>r(n,t))||PD(n,t)?t.preventDefault():Vi(n,"key")};ln.keyup=(n,e)=>{e.keyCode==16&&(n.input.shiftKey=!1)};ln.keypress=(n,e)=>{let t=e;if(Nv(n,t)||!t.charCode||t.ctrlKey&&!t.altKey||Qn&&t.metaKey)return;if(n.someProp("handleKeyPress",i=>i(n,t))){t.preventDefault();return}let r=n.state.selection;if(!(r instanceof pe)||!r.$from.sameParent(r.$to)){let i=String.fromCharCode(t.charCode),o=()=>n.state.tr.insertText(i).scrollIntoView();!/[\r\n]/.test(i)&&!n.someProp("handleTextInput",s=>s(n,r.$from.pos,r.$to.pos,i,o))&&n.dispatch(o()),t.preventDefault()}};function Nc(n){return{left:n.clientX,top:n.clientY}}function jD(n,e){let t=e.x-n.clientX,r=e.y-n.clientY;return t*t+r*r<100}function fp(n,e,t,r,i){if(r==-1)return!1;let o=n.state.doc.resolve(r);for(let s=o.depth+1;s>0;s--)if(n.someProp(e,a=>s>o.depth?a(n,t,o.nodeAfter,o.before(s),i,!0):a(n,t,o.node(s),o.before(s),i,!1)))return!0;return!1}function Ts(n,e,t){if(n.focused||n.focus(),n.state.selection.eq(e))return;let r=n.state.tr.setSelection(e);r.setMeta("pointer",!0),n.dispatch(r)}function GD(n,e){if(e==-1)return!1;let t=n.state.doc.resolve(e),r=t.nodeAfter;return r&&r.isAtom&&re.isSelectable(r)?(Ts(n,new re(t)),!0):!1}function XD(n,e){if(e==-1)return!1;let t=n.state.selection,r,i;t instanceof re&&(r=t.node);let o=n.state.doc.resolve(e);for(let s=o.depth+1;s>0;s--){let a=s>o.depth?o.nodeAfter:o.node(s);if(re.isSelectable(a)){r&&t.$from.depth>0&&s>=t.$from.depth&&o.before(t.$from.depth+1)==t.$from.pos?i=o.before(t.$from.depth):i=o.before(s);break}}return i!=null?(Ts(n,re.create(n.state.doc,i)),!0):!1}function YD(n,e,t,r,i){return fp(n,"handleClickOn",e,t,r)||n.someProp("handleClick",o=>o(n,e,r))||(i?XD(n,t):GD(n,t))}function JD(n,e,t,r){return fp(n,"handleDoubleClickOn",e,t,r)||n.someProp("handleDoubleClick",i=>i(n,e,r))}function ZD(n,e,t,r){return fp(n,"handleTripleClickOn",e,t,r)||n.someProp("handleTripleClick",i=>i(n,e,r))||QD(n,t,r)}function QD(n,e,t){if(t.button!=0)return!1;let r=n.state.doc;if(e==-1)return r.inlineContent?(Ts(n,pe.create(r,0,r.content.size)),!0):!1;let i=r.resolve(e);for(let o=i.depth+1;o>0;o--){let s=o>i.depth?i.nodeAfter:i.node(o),a=i.before(o);if(s.inlineContent)Ts(n,pe.create(r,a+1,a+1+s.content.size));else if(re.isSelectable(s))Ts(n,re.create(r,a));else continue;return!0}}function hp(n){return fc(n)}const Iv=Qn?"metaKey":"ctrlKey";un.mousedown=(n,e)=>{let t=e;n.input.shiftKey=t.shiftKey;let r=hp(n),i=Date.now(),o="singleClick";i-n.input.lastClick.time<500&&jD(t,n.input.lastClick)&&!t[Iv]&&n.input.lastClick.button==t.button&&(n.input.lastClick.type=="singleClick"?o="doubleClick":n.input.lastClick.type=="doubleClick"&&(o="tripleClick")),n.input.lastClick={time:i,x:t.clientX,y:t.clientY,type:o,button:t.button};let s=n.posAtCoords(Nc(t));s&&(o=="singleClick"?(n.input.mouseDown&&n.input.mouseDown.done(),n.input.mouseDown=new eM(n,s,t,!!r)):(o=="doubleClick"?JD:ZD)(n,s.pos,s.inside,t)?t.preventDefault():Vi(n,"pointer"))};class eM{constructor(e,t,r,i){this.view=e,this.pos=t,this.event=r,this.flushed=i,this.delayedSelectionSync=!1,this.mightDrag=null,this.startDoc=e.state.doc,this.selectNode=!!r[Iv],this.allowDefault=r.shiftKey;let o,s;if(t.inside>-1)o=e.state.doc.nodeAt(t.inside),s=t.inside;else{let f=e.state.doc.resolve(t.pos);o=f.parent,s=f.depth?f.before():0}const a=i?null:r.target,l=a?e.docView.nearestDesc(a,!0):null;this.target=l&&l.dom.nodeType==1?l.dom:null;let{selection:d}=e.state;(r.button==0&&o.type.spec.draggable&&o.type.spec.selectable!==!1||d instanceof re&&d.from<=s&&d.to>s)&&(this.mightDrag={node:o,pos:s,addAttr:!!(this.target&&!this.target.draggable),setUneditable:!!(this.target&&wr&&!this.target.hasAttribute("contentEditable"))}),this.target&&this.mightDrag&&(this.mightDrag.addAttr||this.mightDrag.setUneditable)&&(this.view.domObserver.stop(),this.mightDrag.addAttr&&(this.target.draggable=!0),this.mightDrag.setUneditable&&setTimeout(()=>{this.view.input.mouseDown==this&&this.target.setAttribute("contentEditable","false")},20),this.view.domObserver.start()),e.root.addEventListener("mouseup",this.up=this.up.bind(this)),e.root.addEventListener("mousemove",this.move=this.move.bind(this)),Vi(e,"pointer")}done(){this.view.root.removeEventListener("mouseup",this.up),this.view.root.removeEventListener("mousemove",this.move),this.mightDrag&&this.target&&(this.view.domObserver.stop(),this.mightDrag.addAttr&&this.target.removeAttribute("draggable"),this.mightDrag.setUneditable&&this.target.removeAttribute("contentEditable"),this.view.domObserver.start()),this.delayedSelectionSync&&setTimeout(()=>fi(this.view)),this.view.input.mouseDown=null}up(e){if(this.done(),!this.view.dom.contains(e.target))return;let t=this.pos;this.view.state.doc!=this.startDoc&&(t=this.view.posAtCoords(Nc(e))),this.updateAllowDefault(e),this.allowDefault||!t?Vi(this.view,"pointer"):YD(this.view,t.pos,t.inside,e,this.selectNode)?e.preventDefault():e.button==0&&(this.flushed||an&&this.mightDrag&&!this.mightDrag.node.isAtom||Xt&&!this.view.state.selection.visible&&Math.min(Math.abs(t.pos-this.view.state.selection.from),Math.abs(t.pos-this.view.state.selection.to))<=2)?(Ts(this.view,Ce.near(this.view.state.doc.resolve(t.pos))),e.preventDefault()):Vi(this.view,"pointer")}move(e){this.updateAllowDefault(e),Vi(this.view,"pointer"),e.buttons==0&&this.done()}updateAllowDefault(e){!this.allowDefault&&(Math.abs(this.event.x-e.clientX)>4||Math.abs(this.event.y-e.clientY)>4)&&(this.allowDefault=!0)}}un.touchstart=n=>{n.input.lastTouch=Date.now(),hp(n),Vi(n,"pointer")};un.touchmove=n=>{n.input.lastTouch=Date.now(),Vi(n,"pointer")};un.contextmenu=n=>hp(n);function Nv(n,e){return n.composing?!0:an&&Math.abs(e.timeStamp-n.input.compositionEndedAt)<500?(n.input.compositionEndedAt=-2e8,!0):!1}const tM=ai?5e3:-1;ln.compositionstart=ln.compositionupdate=n=>{if(!n.composing){n.domObserver.flush();let{state:e}=n,t=e.selection.$to;if(e.selection instanceof pe&&(e.storedMarks||!t.textOffset&&t.parentOffset&&t.nodeBefore.marks.some(r=>r.type.spec.inclusive===!1)))n.markCursor=n.state.storedMarks||t.marks(),fc(n,!0),n.markCursor=null;else if(fc(n,!e.selection.empty),wr&&e.selection.empty&&t.parentOffset&&!t.textOffset&&t.nodeBefore.marks.length){let r=n.domSelectionRange();for(let i=r.focusNode,o=r.focusOffset;i&&i.nodeType==1&&o!=0;){let s=o<0?i.lastChild:i.childNodes[o-1];if(!s)break;if(s.nodeType==3){let a=n.domSelection();a&&a.collapse(s,s.nodeValue.length);break}else i=s,o=-1}}n.input.composing=!0}Pv(n,tM)};ln.compositionend=(n,e)=>{n.composing&&(n.input.composing=!1,n.input.compositionEndedAt=e.timeStamp,n.input.compositionPendingChanges=n.domObserver.pendingRecords().length?n.input.compositionID:0,n.input.compositionNode=null,n.input.compositionPendingChanges&&Promise.resolve().then(()=>n.domObserver.flush()),n.input.compositionID++,Pv(n,20))};function Pv(n,e){clearTimeout(n.input.composingTimeout),e>-1&&(n.input.composingTimeout=setTimeout(()=>fc(n),e))}function Fv(n){for(n.composing&&(n.input.composing=!1,n.input.compositionEndedAt=rM());n.input.compositionNodes.length>0;)n.input.compositionNodes.pop().markParentsDirty()}function nM(n){let e=n.domSelectionRange();if(!e.focusNode)return null;let t=GT(e.focusNode,e.focusOffset),r=XT(e.focusNode,e.focusOffset);if(t&&r&&t!=r){let i=r.pmViewDesc,o=n.domObserver.lastChangedTextNode;if(t==o||r==o)return o;if(!i||!i.isText(r.nodeValue))return r;if(n.input.compositionNode==r){let s=t.pmViewDesc;if(!(!s||!s.isText(t.nodeValue)))return r}}return t||r}function rM(){let n=document.createEvent("Event");return n.initEvent("event",!0,!0),n.timeStamp}function fc(n,e=!1){if(!(ai&&n.domObserver.flushingSoon>=0)){if(n.domObserver.forceFlush(),Fv(n),e||n.docView&&n.docView.dirty){let t=up(n),r=n.state.selection;return t&&!t.eq(r)?n.dispatch(n.state.tr.setSelection(t)):(n.markCursor||e)&&!r.$from.node(r.$from.sharedDepth(r.to)).inlineContent?n.dispatch(n.state.tr.deleteSelection()):n.updateState(n.state),!0}return!1}}function iM(n,e){if(!n.dom.parentNode)return;let t=n.dom.parentNode.appendChild(document.createElement("div"));t.appendChild(e),t.style.cssText="position: fixed; left: -10000px; top: 10px";let r=getSelection(),i=document.createRange();i.selectNodeContents(e),n.dom.blur(),r.removeAllRanges(),r.addRange(i),setTimeout(()=>{t.parentNode&&t.parentNode.removeChild(t),n.focus()},50)}const Ja=xn&&Ki<15||Ps&&eD<604;un.copy=ln.cut=(n,e)=>{let t=e,r=n.state.selection,i=t.type=="cut";if(r.empty)return;let o=Ja?null:t.clipboardData,s=r.content(),{dom:a,text:l}=cp(n,s);o?(t.preventDefault(),o.clearData(),o.setData("text/html",a.innerHTML),o.setData("text/plain",l)):iM(n,a),i&&n.dispatch(n.state.tr.deleteSelection().scrollIntoView().setMeta("uiEvent","cut"))};function oM(n){return n.openStart==0&&n.openEnd==0&&n.content.childCount==1?n.content.firstChild:null}function sM(n,e){if(!n.dom.parentNode)return;let t=n.input.shiftKey||n.state.selection.$from.parent.type.spec.code,r=n.dom.parentNode.appendChild(document.createElement(t?"textarea":"div"));t||(r.contentEditable="true"),r.style.cssText="position: fixed; left: -10000px; top: 10px",r.focus();let i=n.input.shiftKey&&n.input.lastKeyCode!=45;setTimeout(()=>{n.focus(),r.parentNode&&r.parentNode.removeChild(r),t?Za(n,r.value,null,i,e):Za(n,r.textContent,r.innerHTML,i,e)},50)}function Za(n,e,t,r,i){let o=_v(n,e,t,r,n.state.selection.$from);if(n.someProp("handlePaste",l=>l(n,i,o||X.empty)))return!0;if(!o)return!1;let s=oM(o),a=s?n.state.tr.replaceSelectionWith(s,r):n.state.tr.replaceSelection(o);return n.dispatch(a.scrollIntoView().setMeta("paste",!0).setMeta("uiEvent","paste")),!0}function Rv(n){let e=n.getData("text/plain")||n.getData("Text");if(e)return e;let t=n.getData("text/uri-list");return t?t.replace(/\r?\n/g," "):""}ln.paste=(n,e)=>{let t=e;if(n.composing&&!ai)return;let r=Ja?null:t.clipboardData,i=n.input.shiftKey&&n.input.lastKeyCode!=45;r&&Za(n,Rv(r),r.getData("text/html"),i,t)?t.preventDefault():sM(n,t)};class Lv{constructor(e,t,r){this.slice=e,this.move=t,this.node=r}}const aM=Qn?"altKey":"ctrlKey";function Bv(n,e){let t=n.someProp("dragCopies",r=>!r(e));return t??!e[aM]}un.dragstart=(n,e)=>{let t=e,r=n.input.mouseDown;if(r&&r.done(),!t.dataTransfer)return;let i=n.state.selection,o=i.empty?null:n.posAtCoords(Nc(t)),s;if(!(o&&o.pos>=i.from&&o.pos<=(i instanceof re?i.to-1:i.to))){if(r&&r.mightDrag)s=re.create(n.state.doc,r.mightDrag.pos);else if(t.target&&t.target.nodeType==1){let h=n.docView.nearestDesc(t.target,!0);h&&h.node.type.spec.draggable&&h!=n.docView&&(s=re.create(n.state.doc,h.posBefore))}}let a=(s||n.state.selection).content(),{dom:l,text:d,slice:f}=cp(n,a);(!t.dataTransfer.files.length||!Xt||cv>120)&&t.dataTransfer.clearData(),t.dataTransfer.setData(Ja?"Text":"text/html",l.innerHTML),t.dataTransfer.effectAllowed="copyMove",Ja||t.dataTransfer.setData("text/plain",d),n.dragging=new Lv(f,Bv(n,t),s)};un.dragend=n=>{let e=n.dragging;window.setTimeout(()=>{n.dragging==e&&(n.dragging=null)},50)};ln.dragover=ln.dragenter=(n,e)=>e.preventDefault();ln.drop=(n,e)=>{let t=e,r=n.dragging;if(n.dragging=null,!t.dataTransfer)return;let i=n.posAtCoords(Nc(t));if(!i)return;let o=n.state.doc.resolve(i.pos),s=r&&r.slice;s?n.someProp("transformPasted",b=>{s=b(s,n)}):s=_v(n,Rv(t.dataTransfer),Ja?null:t.dataTransfer.getData("text/html"),!1,o);let a=!!(r&&Bv(n,t));if(n.someProp("handleDrop",b=>b(n,t,s||X.empty,a))){t.preventDefault();return}if(!s)return;t.preventDefault();let l=s?nv(n.state.doc,o.pos,s):o.pos;l==null&&(l=o.pos);let d=n.state.tr;if(a){let{node:b}=r;b?b.replace(d):d.deleteSelection()}let f=d.mapping.map(l),h=s.openStart==0&&s.openEnd==0&&s.content.childCount==1,m=d.doc;if(h?d.replaceRangeWith(f,f,s.content.firstChild):d.replaceRange(f,f,s),d.doc.eq(m))return;let g=d.doc.resolve(f);if(h&&re.isSelectable(s.content.firstChild)&&g.nodeAfter&&g.nodeAfter.sameMarkup(s.content.firstChild))d.setSelection(new re(g));else{let b=d.mapping.map(l);d.mapping.maps[d.mapping.maps.length-1].forEach((v,x,E,A)=>b=A),d.setSelection(lp(n,g,d.doc.resolve(b)))}n.focus(),n.dispatch(d.setMeta("uiEvent","drop"))};un.focus=n=>{n.input.lastFocus=Date.now(),n.focused||(n.domObserver.stop(),n.dom.classList.add("ProseMirror-focused"),n.domObserver.start(),n.focused=!0,setTimeout(()=>{n.docView&&n.hasFocus()&&!n.domObserver.currentSelection.eq(n.domSelectionRange())&&fi(n)},20))};un.blur=(n,e)=>{let t=e;n.focused&&(n.domObserver.stop(),n.dom.classList.remove("ProseMirror-focused"),n.domObserver.start(),t.relatedTarget&&n.dom.contains(t.relatedTarget)&&n.domObserver.currentSelection.clear(),n.focused=!1)};un.beforeinput=(n,e)=>{if(Xt&&ai&&e.inputType=="deleteContentBackward"){n.domObserver.flushSoon();let{domChangeCount:r}=n.input;setTimeout(()=>{if(n.input.domChangeCount!=r||(n.dom.blur(),n.focus(),n.someProp("handleKeyDown",o=>o(n,wo(8,"Backspace")))))return;let{$cursor:i}=n.state.selection;i&&i.pos>0&&n.dispatch(n.state.tr.delete(i.pos-1,i.pos).scrollIntoView())},50)}};for(let n in ln)un[n]=ln[n];function Qa(n,e){if(n==e)return!0;for(let t in n)if(n[t]!==e[t])return!1;for(let t in e)if(!(t in n))return!1;return!0}class hc{constructor(e,t){this.toDOM=e,this.spec=t||Do,this.side=this.spec.side||0}map(e,t,r,i){let{pos:o,deleted:s}=e.mapResult(t.from+i,this.side<0?-1:1);return s?null:new tr(o-r,o-r,this)}valid(){return!0}eq(e){return this==e||e instanceof hc&&(this.spec.key&&this.spec.key==e.spec.key||this.toDOM==e.toDOM&&Qa(this.spec,e.spec))}destroy(e){this.spec.destroy&&this.spec.destroy(e)}}class Gi{constructor(e,t){this.attrs=e,this.spec=t||Do}map(e,t,r,i){let o=e.map(t.from+i,this.spec.inclusiveStart?-1:1)-r,s=e.map(t.to+i,this.spec.inclusiveEnd?1:-1)-r;return o>=s?null:new tr(o,s,this)}valid(e,t){return t.from<t.to}eq(e){return this==e||e instanceof Gi&&Qa(this.attrs,e.attrs)&&Qa(this.spec,e.spec)}static is(e){return e.type instanceof Gi}destroy(){}}class pp{constructor(e,t){this.attrs=e,this.spec=t||Do}map(e,t,r,i){let o=e.mapResult(t.from+i,1);if(o.deleted)return null;let s=e.mapResult(t.to+i,-1);return s.deleted||s.pos<=o.pos?null:new tr(o.pos-r,s.pos-r,this)}valid(e,t){let{index:r,offset:i}=e.content.findIndex(t.from),o;return i==t.from&&!(o=e.child(r)).isText&&i+o.nodeSize==t.to}eq(e){return this==e||e instanceof pp&&Qa(this.attrs,e.attrs)&&Qa(this.spec,e.spec)}destroy(){}}class tr{constructor(e,t,r){this.from=e,this.to=t,this.type=r}copy(e,t){return new tr(e,t,this.type)}eq(e,t=0){return this.type.eq(e.type)&&this.from+t==e.from&&this.to+t==e.to}map(e,t,r){return this.type.map(e,this,t,r)}static widget(e,t,r){return new tr(e,e,new hc(t,r))}static inline(e,t,r,i){return new tr(e,t,new Gi(r,i))}static node(e,t,r,i){return new tr(e,t,new pp(r,i))}get spec(){return this.type.spec}get inline(){return this.type instanceof Gi}get widget(){return this.type instanceof hc}}const bs=[],Do={};class xt{constructor(e,t){this.local=e.length?e:bs,this.children=t.length?t:bs}static create(e,t){return t.length?pc(t,e,0,Do):Gt}find(e,t,r){let i=[];return this.findInner(e??0,t??1e9,i,0,r),i}findInner(e,t,r,i,o){for(let s=0;s<this.local.length;s++){let a=this.local[s];a.from<=t&&a.to>=e&&(!o||o(a.spec))&&r.push(a.copy(a.from+i,a.to+i))}for(let s=0;s<this.children.length;s+=3)if(this.children[s]<t&&this.children[s+1]>e){let a=this.children[s]+1;this.children[s+2].findInner(e-a,t-a,r,i+a,o)}}map(e,t,r){return this==Gt||e.maps.length==0?this:this.mapInner(e,t,0,0,r||Do)}mapInner(e,t,r,i,o){let s;for(let a=0;a<this.local.length;a++){let l=this.local[a].map(e,r,i);l&&l.type.valid(t,l)?(s||(s=[])).push(l):o.onRemove&&o.onRemove(this.local[a].spec)}return this.children.length?uM(this.children,s||[],e,t,r,i,o):s?new xt(s.sort(Mo),bs):Gt}add(e,t){return t.length?this==Gt?xt.create(e,t):this.addInner(e,t,0):this}addInner(e,t,r){let i,o=0;e.forEach((a,l)=>{let d=l+r,f;if(f=zv(t,a,d)){for(i||(i=this.children.slice());o<i.length&&i[o]<l;)o+=3;i[o]==l?i[o+2]=i[o+2].addInner(a,f,d+1):i.splice(o,0,l,l+a.nodeSize,pc(f,a,d+1,Do)),o+=3}});let s=$v(o?Hv(t):t,-r);for(let a=0;a<s.length;a++)s[a].type.valid(e,s[a])||s.splice(a--,1);return new xt(s.length?this.local.concat(s).sort(Mo):this.local,i||this.children)}remove(e){return e.length==0||this==Gt?this:this.removeInner(e,0)}removeInner(e,t){let r=this.children,i=this.local;for(let o=0;o<r.length;o+=3){let s,a=r[o]+t,l=r[o+1]+t;for(let f=0,h;f<e.length;f++)(h=e[f])&&h.from>a&&h.to<l&&(e[f]=null,(s||(s=[])).push(h));if(!s)continue;r==this.children&&(r=this.children.slice());let d=r[o+2].removeInner(s,a+1);d!=Gt?r[o+2]=d:(r.splice(o,3),o-=3)}if(i.length){for(let o=0,s;o<e.length;o++)if(s=e[o])for(let a=0;a<i.length;a++)i[a].eq(s,t)&&(i==this.local&&(i=this.local.slice()),i.splice(a--,1))}return r==this.children&&i==this.local?this:i.length||r.length?new xt(i,r):Gt}forChild(e,t){if(this==Gt)return this;if(t.isLeaf)return xt.empty;let r,i;for(let a=0;a<this.children.length;a+=3)if(this.children[a]>=e){this.children[a]==e&&(r=this.children[a+2]);break}let o=e+1,s=o+t.content.size;for(let a=0;a<this.local.length;a++){let l=this.local[a];if(l.from<s&&l.to>o&&l.type instanceof Gi){let d=Math.max(o,l.from)-o,f=Math.min(s,l.to)-o;d<f&&(i||(i=[])).push(l.copy(d,f))}}if(i){let a=new xt(i.sort(Mo),bs);return r?new Li([a,r]):a}return r||Gt}eq(e){if(this==e)return!0;if(!(e instanceof xt)||this.local.length!=e.local.length||this.children.length!=e.children.length)return!1;for(let t=0;t<this.local.length;t++)if(!this.local[t].eq(e.local[t]))return!1;for(let t=0;t<this.children.length;t+=3)if(this.children[t]!=e.children[t]||this.children[t+1]!=e.children[t+1]||!this.children[t+2].eq(e.children[t+2]))return!1;return!0}locals(e){return mp(this.localsInner(e))}localsInner(e){if(this==Gt)return bs;if(e.inlineContent||!this.local.some(Gi.is))return this.local;let t=[];for(let r=0;r<this.local.length;r++)this.local[r].type instanceof Gi||t.push(this.local[r]);return t}forEachSet(e){e(this)}}xt.empty=new xt([],[]);xt.removeOverlap=mp;const Gt=xt.empty;class Li{constructor(e){this.members=e}map(e,t){const r=this.members.map(i=>i.map(e,t,Do));return Li.from(r)}forChild(e,t){if(t.isLeaf)return xt.empty;let r=[];for(let i=0;i<this.members.length;i++){let o=this.members[i].forChild(e,t);o!=Gt&&(o instanceof Li?r=r.concat(o.members):r.push(o))}return Li.from(r)}eq(e){if(!(e instanceof Li)||e.members.length!=this.members.length)return!1;for(let t=0;t<this.members.length;t++)if(!this.members[t].eq(e.members[t]))return!1;return!0}locals(e){let t,r=!0;for(let i=0;i<this.members.length;i++){let o=this.members[i].localsInner(e);if(o.length)if(!t)t=o;else{r&&(t=t.slice(),r=!1);for(let s=0;s<o.length;s++)t.push(o[s])}}return t?mp(r?t:t.sort(Mo)):bs}static from(e){switch(e.length){case 0:return Gt;case 1:return e[0];default:return new Li(e.every(t=>t instanceof xt)?e:e.reduce((t,r)=>t.concat(r instanceof xt?r:r.members),[]))}}forEachSet(e){for(let t=0;t<this.members.length;t++)this.members[t].forEachSet(e)}}function uM(n,e,t,r,i,o,s){let a=n.slice();for(let d=0,f=o;d<t.maps.length;d++){let h=0;t.maps[d].forEach((m,g,b,v)=>{let x=v-b-(g-m);for(let E=0;E<a.length;E+=3){let A=a[E+1];if(A<0||m>A+f-h)continue;let M=a[E]+f-h;g>=M?a[E+1]=m<=M?-2:-1:m>=f&&x&&(a[E]+=x,a[E+1]+=x)}h+=x}),f=t.maps[d].map(f,-1)}let l=!1;for(let d=0;d<a.length;d+=3)if(a[d+1]<0){if(a[d+1]==-2){l=!0,a[d+1]=-1;continue}let f=t.map(n[d]+o),h=f-i;if(h<0||h>=r.content.size){l=!0;continue}let m=t.map(n[d+1]+o,-1),g=m-i,{index:b,offset:v}=r.content.findIndex(h),x=r.maybeChild(b);if(x&&v==h&&v+x.nodeSize==g){let E=a[d+2].mapInner(t,x,f+1,n[d]+o+1,s);E!=Gt?(a[d]=h,a[d+1]=g,a[d+2]=E):(a[d+1]=-2,l=!0)}else l=!0}if(l){let d=lM(a,n,e,t,i,o,s),f=pc(d,r,0,s);e=f.local;for(let h=0;h<a.length;h+=3)a[h+1]<0&&(a.splice(h,3),h-=3);for(let h=0,m=0;h<f.children.length;h+=3){let g=f.children[h];for(;m<a.length&&a[m]<g;)m+=3;a.splice(m,0,f.children[h],f.children[h+1],f.children[h+2])}}return new xt(e.sort(Mo),a)}function $v(n,e){if(!e||!n.length)return n;let t=[];for(let r=0;r<n.length;r++){let i=n[r];t.push(new tr(i.from+e,i.to+e,i.type))}return t}function lM(n,e,t,r,i,o,s){function a(l,d){for(let f=0;f<l.local.length;f++){let h=l.local[f].map(r,i,d);h?t.push(h):s.onRemove&&s.onRemove(l.local[f].spec)}for(let f=0;f<l.children.length;f+=3)a(l.children[f+2],l.children[f]+d+1)}for(let l=0;l<n.length;l+=3)n[l+1]==-1&&a(n[l+2],e[l]+o+1);return t}function zv(n,e,t){if(e.isLeaf)return null;let r=t+e.nodeSize,i=null;for(let o=0,s;o<n.length;o++)(s=n[o])&&s.from>t&&s.to<r&&((i||(i=[])).push(s),n[o]=null);return i}function Hv(n){let e=[];for(let t=0;t<n.length;t++)n[t]!=null&&e.push(n[t]);return e}function pc(n,e,t,r){let i=[],o=!1;e.forEach((a,l)=>{let d=zv(n,a,l+t);if(d){o=!0;let f=pc(d,a,t+l+1,r);f!=Gt&&i.push(l,l+a.nodeSize,f)}});let s=$v(o?Hv(n):n,-t).sort(Mo);for(let a=0;a<s.length;a++)s[a].type.valid(e,s[a])||(r.onRemove&&r.onRemove(s[a].spec),s.splice(a--,1));return s.length||i.length?new xt(s,i):Gt}function Mo(n,e){return n.from-e.from||n.to-e.to}function mp(n){let e=n;for(let t=0;t<e.length-1;t++){let r=e[t];if(r.from!=r.to)for(let i=t+1;i<e.length;i++){let o=e[i];if(o.from==r.from){o.to!=r.to&&(e==n&&(e=n.slice()),e[i]=o.copy(o.from,r.to),O1(e,i+1,o.copy(r.to,o.to)));continue}else{o.from<r.to&&(e==n&&(e=n.slice()),e[t]=r.copy(r.from,o.from),O1(e,i,r.copy(o.from,r.to)));break}}}return e}function O1(n,e,t){for(;e<n.length&&Mo(t,n[e])>0;)e++;n.splice(e,0,t)}function Lf(n){let e=[];return n.someProp("decorations",t=>{let r=t(n.state);r&&r!=Gt&&e.push(r)}),n.cursorWrapper&&e.push(xt.create(n.state.doc,[n.cursorWrapper.deco])),Li.from(e)}const cM={childList:!0,characterData:!0,characterDataOldValue:!0,attributes:!0,attributeOldValue:!0,subtree:!0},dM=xn&&Ki<=11;class fM{constructor(){this.anchorNode=null,this.anchorOffset=0,this.focusNode=null,this.focusOffset=0}set(e){this.anchorNode=e.anchorNode,this.anchorOffset=e.anchorOffset,this.focusNode=e.focusNode,this.focusOffset=e.focusOffset}clear(){this.anchorNode=this.focusNode=null}eq(e){return e.anchorNode==this.anchorNode&&e.anchorOffset==this.anchorOffset&&e.focusNode==this.focusNode&&e.focusOffset==this.focusOffset}}class hM{constructor(e,t){this.view=e,this.handleDOMChange=t,this.queue=[],this.flushingSoon=-1,this.observer=null,this.currentSelection=new fM,this.onCharData=null,this.suppressingSelectionUpdates=!1,this.lastChangedTextNode=null,this.observer=window.MutationObserver&&new window.MutationObserver(r=>{for(let i=0;i<r.length;i++)this.queue.push(r[i]);xn&&Ki<=11&&r.some(i=>i.type=="childList"&&i.removedNodes.length||i.type=="characterData"&&i.oldValue.length>i.target.nodeValue.length)?this.flushSoon():this.flush()}),dM&&(this.onCharData=r=>{this.queue.push({target:r.target,type:"characterData",oldValue:r.prevValue}),this.flushSoon()}),this.onSelectionChange=this.onSelectionChange.bind(this)}flushSoon(){this.flushingSoon<0&&(this.flushingSoon=window.setTimeout(()=>{this.flushingSoon=-1,this.flush()},20))}forceFlush(){this.flushingSoon>-1&&(window.clearTimeout(this.flushingSoon),this.flushingSoon=-1,this.flush())}start(){this.observer&&(this.observer.takeRecords(),this.observer.observe(this.view.dom,cM)),this.onCharData&&this.view.dom.addEventListener("DOMCharacterDataModified",this.onCharData),this.connectSelection()}stop(){if(this.observer){let e=this.observer.takeRecords();if(e.length){for(let t=0;t<e.length;t++)this.queue.push(e[t]);window.setTimeout(()=>this.flush(),20)}this.observer.disconnect()}this.onCharData&&this.view.dom.removeEventListener("DOMCharacterDataModified",this.onCharData),this.disconnectSelection()}connectSelection(){this.view.dom.ownerDocument.addEventListener("selectionchange",this.onSelectionChange)}disconnectSelection(){this.view.dom.ownerDocument.removeEventListener("selectionchange",this.onSelectionChange)}suppressSelectionUpdates(){this.suppressingSelectionUpdates=!0,setTimeout(()=>this.suppressingSelectionUpdates=!1,50)}onSelectionChange(){if(S1(this.view)){if(this.suppressingSelectionUpdates)return fi(this.view);if(xn&&Ki<=11&&!this.view.state.selection.empty){let e=this.view.domSelectionRange();if(e.focusNode&&Fo(e.focusNode,e.focusOffset,e.anchorNode,e.anchorOffset))return this.flushSoon()}this.flush()}}setCurSelection(){this.currentSelection.set(this.view.domSelectionRange())}ignoreSelectionChange(e){if(!e.focusNode)return!0;let t=new Set,r;for(let o=e.focusNode;o;o=Ns(o))t.add(o);for(let o=e.anchorNode;o;o=Ns(o))if(t.has(o)){r=o;break}let i=r&&this.view.docView.nearestDesc(r);if(i&&i.ignoreMutation({type:"selection",target:r.nodeType==3?r.parentNode:r}))return this.setCurSelection(),!0}pendingRecords(){if(this.observer)for(let e of this.observer.takeRecords())this.queue.push(e);return this.queue}flush(){let{view:e}=this;if(!e.docView||this.flushingSoon>-1)return;let t=this.pendingRecords();t.length&&(this.queue=[]);let r=e.domSelectionRange(),i=!this.suppressingSelectionUpdates&&!this.currentSelection.eq(r)&&S1(e)&&!this.ignoreSelectionChange(r),o=-1,s=-1,a=!1,l=[];if(e.editable)for(let f=0;f<t.length;f++){let h=this.registerMutation(t[f],l);h&&(o=o<0?h.from:Math.min(h.from,o),s=s<0?h.to:Math.max(h.to,s),h.typeOver&&(a=!0))}if(wr&&l.length){let f=l.filter(h=>h.nodeName=="BR");if(f.length==2){let[h,m]=f;h.parentNode&&h.parentNode.parentNode==m.parentNode?m.remove():h.remove()}else{let{focusNode:h}=this.currentSelection;for(let m of f){let g=m.parentNode;g&&g.nodeName=="LI"&&(!h||gM(e,h)!=g)&&m.remove()}}}let d=null;o<0&&i&&e.input.lastFocus>Date.now()-200&&Math.max(e.input.lastTouch,e.input.lastClick.time)<Date.now()-300&&Oc(r)&&(d=up(e))&&d.eq(Ce.near(e.state.doc.resolve(0),1))?(e.input.lastFocus=0,fi(e),this.currentSelection.set(r),e.scrollToSelection()):(o>-1||i)&&(o>-1&&(e.docView.markDirty(o,s),pM(e)),this.handleDOMChange(o,s,a,l),e.docView&&e.docView.dirty?e.updateState(e.state):this.currentSelection.eq(r)||fi(e),this.currentSelection.set(r))}registerMutation(e,t){if(t.indexOf(e.target)>-1)return null;let r=this.view.docView.nearestDesc(e.target);if(e.type=="attributes"&&(r==this.view.docView||e.attributeName=="contenteditable"||e.attributeName=="style"&&!e.oldValue&&!e.target.getAttribute("style"))||!r||r.ignoreMutation(e))return null;if(e.type=="childList"){for(let f=0;f<e.addedNodes.length;f++){let h=e.addedNodes[f];t.push(h),h.nodeType==3&&(this.lastChangedTextNode=h)}if(r.contentDOM&&r.contentDOM!=r.dom&&!r.contentDOM.contains(e.target))return{from:r.posBefore,to:r.posAfter};let i=e.previousSibling,o=e.nextSibling;if(xn&&Ki<=11&&e.addedNodes.length)for(let f=0;f<e.addedNodes.length;f++){let{previousSibling:h,nextSibling:m}=e.addedNodes[f];(!h||Array.prototype.indexOf.call(e.addedNodes,h)<0)&&(i=h),(!m||Array.prototype.indexOf.call(e.addedNodes,m)<0)&&(o=m)}let s=i&&i.parentNode==e.target?Rt(i)+1:0,a=r.localPosFromDOM(e.target,s,-1),l=o&&o.parentNode==e.target?Rt(o):e.target.childNodes.length,d=r.localPosFromDOM(e.target,l,1);return{from:a,to:d}}else return e.type=="attributes"?{from:r.posAtStart-r.border,to:r.posAtEnd+r.border}:(this.lastChangedTextNode=e.target,{from:r.posAtStart,to:r.posAtEnd,typeOver:e.target.nodeValue==e.oldValue})}}let I1=new WeakMap,N1=!1;function pM(n){if(!I1.has(n)&&(I1.set(n,null),["normal","nowrap","pre-line"].indexOf(getComputedStyle(n.dom).whiteSpace)!==-1)){if(n.requiresGeckoHackNode=wr,N1)return;console.warn("ProseMirror expects the CSS white-space property to be set, preferably to 'pre-wrap'. It is recommended to load style/prosemirror.css from the prosemirror-view package."),N1=!0}}function P1(n,e){let t=e.startContainer,r=e.startOffset,i=e.endContainer,o=e.endOffset,s=n.domAtPos(n.state.selection.anchor);return Fo(s.node,s.offset,i,o)&&([t,r,i,o]=[i,o,t,r]),{anchorNode:t,anchorOffset:r,focusNode:i,focusOffset:o}}function mM(n,e){if(e.getComposedRanges){let i=e.getComposedRanges(n.root)[0];if(i)return P1(n,i)}let t;function r(i){i.preventDefault(),i.stopImmediatePropagation(),t=i.getTargetRanges()[0]}return n.dom.addEventListener("beforeinput",r,!0),document.execCommand("indent"),n.dom.removeEventListener("beforeinput",r,!0),t?P1(n,t):null}function gM(n,e){for(let t=e.parentNode;t&&t!=n.dom;t=t.parentNode){let r=n.docView.nearestDesc(t,!0);if(r&&r.node.isBlock)return t}return null}function bM(n,e,t){let{node:r,fromOffset:i,toOffset:o,from:s,to:a}=n.docView.parseRange(e,t),l=n.domSelectionRange(),d,f=l.anchorNode;if(f&&n.dom.contains(f.nodeType==1?f:f.parentNode)&&(d=[{node:f,offset:l.anchorOffset}],Oc(l)||d.push({node:l.focusNode,offset:l.focusOffset})),Xt&&n.input.lastKeyCode===8)for(let x=o;x>i;x--){let E=r.childNodes[x-1],A=E.pmViewDesc;if(E.nodeName=="BR"&&!A){o=x;break}if(!A||A.size)break}let h=n.state.doc,m=n.someProp("domParser")||_s.fromSchema(n.state.schema),g=h.resolve(s),b=null,v=m.parse(r,{topNode:g.parent,topMatch:g.parent.contentMatchAt(g.index()),topOpen:!0,from:i,to:o,preserveWhitespace:g.parent.type.whitespace=="pre"?"full":!0,findPositions:d,ruleFromNode:yM,context:g});if(d&&d[0].pos!=null){let x=d[0].pos,E=d[1]&&d[1].pos;E==null&&(E=x),b={anchor:x+s,head:E+s}}return{doc:v,sel:b,from:s,to:a}}function yM(n){let e=n.pmViewDesc;if(e)return e.parseRule();if(n.nodeName=="BR"&&n.parentNode){if(an&&/^(ul|ol)$/i.test(n.parentNode.nodeName)){let t=document.createElement("div");return t.appendChild(document.createElement("li")),{skip:t}}else if(n.parentNode.lastChild==n||an&&/^(tr|table)$/i.test(n.parentNode.nodeName))return{ignore:!0}}else if(n.nodeName=="IMG"&&n.getAttribute("mark-placeholder"))return{ignore:!0};return null}const vM=/^(a|abbr|acronym|b|bd[io]|big|br|button|cite|code|data(list)?|del|dfn|em|i|ins|kbd|label|map|mark|meter|output|q|ruby|s|samp|small|span|strong|su[bp]|time|u|tt|var)$/i;function xM(n,e,t,r,i){let o=n.input.compositionPendingChanges||(n.composing?n.input.compositionID:0);if(n.input.compositionPendingChanges=0,e<0){let V=n.input.lastSelectionTime>Date.now()-50?n.input.lastSelectionOrigin:null,U=up(n,V);if(U&&!n.state.selection.eq(U)){if(Xt&&ai&&n.input.lastKeyCode===13&&Date.now()-100<n.input.lastKeyCodeTime&&n.someProp("handleKeyDown",oe=>oe(n,wo(13,"Enter"))))return;let Q=n.state.tr.setSelection(U);V=="pointer"?Q.setMeta("pointer",!0):V=="key"&&Q.scrollIntoView(),o&&Q.setMeta("composition",o),n.dispatch(Q)}return}let s=n.state.doc.resolve(e),a=s.sharedDepth(t);e=s.before(a+1),t=n.state.doc.resolve(t).after(a+1);let l=n.state.selection,d=bM(n,e,t),f=n.state.doc,h=f.slice(d.from,d.to),m,g;n.input.lastKeyCode===8&&Date.now()-100<n.input.lastKeyCodeTime?(m=n.state.selection.to,g="end"):(m=n.state.selection.from,g="start"),n.input.lastKeyCode=null;let b=SM(h.content,d.doc.content,d.from,m,g);if(b&&n.input.domChangeCount++,(Ps&&n.input.lastIOSEnter>Date.now()-225||ai)&&i.some(V=>V.nodeType==1&&!vM.test(V.nodeName))&&(!b||b.endA>=b.endB)&&n.someProp("handleKeyDown",V=>V(n,wo(13,"Enter")))){n.input.lastIOSEnter=0;return}if(!b)if(r&&l instanceof pe&&!l.empty&&l.$head.sameParent(l.$anchor)&&!n.composing&&!(d.sel&&d.sel.anchor!=d.sel.head))b={start:l.from,endA:l.to,endB:l.to};else{if(d.sel){let V=F1(n,n.state.doc,d.sel);if(V&&!V.eq(n.state.selection)){let U=n.state.tr.setSelection(V);o&&U.setMeta("composition",o),n.dispatch(U)}}return}n.state.selection.from<n.state.selection.to&&b.start==b.endB&&n.state.selection instanceof pe&&(b.start>n.state.selection.from&&b.start<=n.state.selection.from+2&&n.state.selection.from>=d.from?b.start=n.state.selection.from:b.endA<n.state.selection.to&&b.endA>=n.state.selection.to-2&&n.state.selection.to<=d.to&&(b.endB+=n.state.selection.to-b.endA,b.endA=n.state.selection.to)),xn&&Ki<=11&&b.endB==b.start+1&&b.endA==b.start&&b.start>d.from&&d.doc.textBetween(b.start-d.from-1,b.start-d.from+1)==" "&&(b.start--,b.endA--,b.endB--);let v=d.doc.resolveNoCache(b.start-d.from),x=d.doc.resolveNoCache(b.endB-d.from),E=f.resolve(b.start),A=v.sameParent(x)&&v.parent.inlineContent&&E.end()>=b.endA,M;if((Ps&&n.input.lastIOSEnter>Date.now()-225&&(!A||i.some(V=>V.nodeName=="DIV"||V.nodeName=="P"))||!A&&v.pos<d.doc.content.size&&(!v.sameParent(x)||!v.parent.inlineContent)&&!/\S/.test(d.doc.textBetween(v.pos,x.pos,"",""))&&(M=Ce.findFrom(d.doc.resolve(v.pos+1),1,!0))&&M.head>v.pos)&&n.someProp("handleKeyDown",V=>V(n,wo(13,"Enter")))){n.input.lastIOSEnter=0;return}if(n.state.selection.anchor>b.start&&kM(f,b.start,b.endA,v,x)&&n.someProp("handleKeyDown",V=>V(n,wo(8,"Backspace")))){ai&&Xt&&n.domObserver.suppressSelectionUpdates();return}Xt&&b.endB==b.start&&(n.input.lastChromeDelete=Date.now()),ai&&!A&&v.start()!=x.start()&&x.parentOffset==0&&v.depth==x.depth&&d.sel&&d.sel.anchor==d.sel.head&&d.sel.head==b.endA&&(b.endB-=2,x=d.doc.resolveNoCache(b.endB-d.from),setTimeout(()=>{n.someProp("handleKeyDown",function(V){return V(n,wo(13,"Enter"))})},20));let C=b.start,P=b.endA,N=V=>{let U=V||n.state.tr.replace(C,P,d.doc.slice(b.start-d.from,b.endB-d.from));if(d.sel){let Q=F1(n,U.doc,d.sel);Q&&!(Xt&&n.composing&&Q.empty&&(b.start!=b.endB||n.input.lastChromeDelete<Date.now()-100)&&(Q.head==C||Q.head==U.mapping.map(P)-1)||xn&&Q.empty&&Q.head==C)&&U.setSelection(Q)}return o&&U.setMeta("composition",o),U.scrollIntoView()},W;if(A){if(v.pos==x.pos){xn&&Ki<=11&&v.parentOffset==0&&(n.domObserver.suppressSelectionUpdates(),setTimeout(()=>fi(n),20));let V=N(n.state.tr.delete(C,P)),U=f.resolve(b.start).marksAcross(f.resolve(b.endA));U&&V.ensureMarks(U),n.dispatch(V)}else if(b.endA==b.endB&&(W=wM(v.parent.content.cut(v.parentOffset,x.parentOffset),E.parent.content.cut(E.parentOffset,b.endA-E.start())))){let V=N(n.state.tr);W.type=="add"?V.addMark(C,P,W.mark):V.removeMark(C,P,W.mark),n.dispatch(V)}else if(v.parent.child(v.index()).isText&&v.index()==x.index()-(x.textOffset?0:1)){let V=v.parent.textBetween(v.parentOffset,x.parentOffset),U=()=>N(n.state.tr.insertText(V,C,P));n.someProp("handleTextInput",Q=>Q(n,C,P,V,U))||n.dispatch(U())}}else n.dispatch(N())}function F1(n,e,t){return Math.max(t.anchor,t.head)>e.content.size?null:lp(n,e.resolve(t.anchor),e.resolve(t.head))}function wM(n,e){let t=n.firstChild.marks,r=e.firstChild.marks,i=t,o=r,s,a,l;for(let f=0;f<r.length;f++)i=r[f].removeFromSet(i);for(let f=0;f<t.length;f++)o=t[f].removeFromSet(o);if(i.length==1&&o.length==0)a=i[0],s="add",l=f=>f.mark(a.addToSet(f.marks));else if(i.length==0&&o.length==1)a=o[0],s="remove",l=f=>f.mark(a.removeFromSet(f.marks));else return null;let d=[];for(let f=0;f<e.childCount;f++)d.push(l(e.child(f)));if(q.from(d).eq(n))return{mark:a,type:s}}function kM(n,e,t,r,i){if(t-e<=i.pos-r.pos||Bf(r,!0,!1)<i.pos)return!1;let o=n.resolve(e);if(!r.parent.isTextblock){let a=o.nodeAfter;return a!=null&&t==e+a.nodeSize}if(o.parentOffset<o.parent.content.size||!o.parent.isTextblock)return!1;let s=n.resolve(Bf(o,!0,!0));return!s.parent.isTextblock||s.pos>t||Bf(s,!0,!1)<t?!1:r.parent.content.cut(r.parentOffset).eq(s.parent.content)}function Bf(n,e,t){let r=n.depth,i=e?n.end():n.pos;for(;r>0&&(e||n.indexAfter(r)==n.node(r).childCount);)r--,i++,e=!1;if(t){let o=n.node(r).maybeChild(n.indexAfter(r));for(;o&&!o.isLeaf;)o=o.firstChild,i++}return i}function SM(n,e,t,r,i){let o=n.findDiffStart(e,t);if(o==null)return null;let{a:s,b:a}=n.findDiffEnd(e,t+n.size,t+e.size);if(i=="end"){let l=Math.max(0,o-Math.min(s,a));r-=s+l-o}if(s<o&&n.size<e.size){let l=r<=o&&r>=s?o-r:0;o-=l,o&&o<e.size&&R1(e.textBetween(o-1,o+1))&&(o+=l?1:-1),a=o+(a-s),s=o}else if(a<o){let l=r<=o&&r>=a?o-r:0;o-=l,o&&o<n.size&&R1(n.textBetween(o-1,o+1))&&(o+=l?1:-1),s=o+(s-a),a=o}return{start:o,endA:s,endB:a}}function R1(n){if(n.length!=2)return!1;let e=n.charCodeAt(0),t=n.charCodeAt(1);return e>=56320&&e<=57343&&t>=55296&&t<=56319}class qv{constructor(e,t){this._root=null,this.focused=!1,this.trackWrites=null,this.mounted=!1,this.markCursor=null,this.cursorWrapper=null,this.lastSelectedViewDesc=void 0,this.input=new qD,this.prevDirectPlugins=[],this.pluginViews=[],this.requiresGeckoHackNode=!1,this.dragging=null,this._props=t,this.state=t.state,this.directPlugins=t.plugins||[],this.directPlugins.forEach(H1),this.dispatch=this.dispatch.bind(this),this.dom=e&&e.mount||document.createElement("div"),e&&(e.appendChild?e.appendChild(this.dom):typeof e=="function"?e(this.dom):e.mount&&(this.mounted=!0)),this.editable=$1(this),B1(this),this.nodeViews=z1(this),this.docView=b1(this.state.doc,L1(this),Lf(this),this.dom,this),this.domObserver=new hM(this,(r,i,o,s)=>xM(this,r,i,o,s)),this.domObserver.start(),VD(this),this.updatePluginViews()}get composing(){return this.input.composing}get props(){if(this._props.state!=this.state){let e=this._props;this._props={};for(let t in e)this._props[t]=e[t];this._props.state=this.state}return this._props}update(e){e.handleDOMEvents!=this._props.handleDOMEvents&&Fh(this);let t=this._props;this._props=e,e.plugins&&(e.plugins.forEach(H1),this.directPlugins=e.plugins),this.updateStateInner(e.state,t)}setProps(e){let t={};for(let r in this._props)t[r]=this._props[r];t.state=this.state;for(let r in e)t[r]=e[r];this.update(t)}updateState(e){this.updateStateInner(e,this._props)}updateStateInner(e,t){var r;let i=this.state,o=!1,s=!1;e.storedMarks&&this.composing&&(Fv(this),s=!0),this.state=e;let a=i.plugins!=e.plugins||this._props.plugins!=t.plugins;if(a||this._props.plugins!=t.plugins||this._props.nodeViews!=t.nodeViews){let g=z1(this);EM(g,this.nodeViews)&&(this.nodeViews=g,o=!0)}(a||t.handleDOMEvents!=this._props.handleDOMEvents)&&Fh(this),this.editable=$1(this),B1(this);let l=Lf(this),d=L1(this),f=i.plugins!=e.plugins&&!i.doc.eq(e.doc)?"reset":e.scrollToSelection>i.scrollToSelection?"to selection":"preserve",h=o||!this.docView.matchesNode(e.doc,d,l);(h||!e.selection.eq(i.selection))&&(s=!0);let m=f=="preserve"&&s&&this.dom.style.overflowAnchor==null&&rD(this);if(s){this.domObserver.stop();let g=h&&(xn||Xt)&&!this.composing&&!i.selection.empty&&!e.selection.empty&&CM(i.selection,e.selection);if(h){let b=Xt?this.trackWrites=this.domSelectionRange().focusNode:null;this.composing&&(this.input.compositionNode=nM(this)),(o||!this.docView.update(e.doc,d,l,this))&&(this.docView.updateOuterDeco(d),this.docView.destroy(),this.docView=b1(e.doc,d,l,this.dom,this)),b&&!this.trackWrites&&(g=!0)}g||!(this.input.mouseDown&&this.domObserver.currentSelection.eq(this.domSelectionRange())&&AD(this))?fi(this,g):(Sv(this,e.selection),this.domObserver.setCurSelection()),this.domObserver.start()}this.updatePluginViews(i),!((r=this.dragging)===null||r===void 0)&&r.node&&!i.doc.eq(e.doc)&&this.updateDraggedNode(this.dragging,i),f=="reset"?this.dom.scrollTop=0:f=="to selection"?this.scrollToSelection():m&&iD(m)}scrollToSelection(){let e=this.domSelectionRange().focusNode;if(!(!e||!this.dom.contains(e.nodeType==1?e:e.parentNode))){if(!this.someProp("handleScrollToSelection",t=>t(this)))if(this.state.selection instanceof re){let t=this.docView.domAfterPos(this.state.selection.from);t.nodeType==1&&d1(this,t.getBoundingClientRect(),e)}else d1(this,this.coordsAtPos(this.state.selection.head,1),e)}}destroyPluginViews(){let e;for(;e=this.pluginViews.pop();)e.destroy&&e.destroy()}updatePluginViews(e){if(!e||e.plugins!=this.state.plugins||this.directPlugins!=this.prevDirectPlugins){this.prevDirectPlugins=this.directPlugins,this.destroyPluginViews();for(let t=0;t<this.directPlugins.length;t++){let r=this.directPlugins[t];r.spec.view&&this.pluginViews.push(r.spec.view(this))}for(let t=0;t<this.state.plugins.length;t++){let r=this.state.plugins[t];r.spec.view&&this.pluginViews.push(r.spec.view(this))}}else for(let t=0;t<this.pluginViews.length;t++){let r=this.pluginViews[t];r.update&&r.update(this,e)}}updateDraggedNode(e,t){let r=e.node,i=-1;if(this.state.doc.nodeAt(r.from)==r.node)i=r.from;else{let o=r.from+(this.state.doc.content.size-t.doc.content.size);(o>0&&this.state.doc.nodeAt(o))==r.node&&(i=o)}this.dragging=new Lv(e.slice,e.move,i<0?void 0:re.create(this.state.doc,i))}someProp(e,t){let r=this._props&&this._props[e],i;if(r!=null&&(i=t?t(r):r))return i;for(let s=0;s<this.directPlugins.length;s++){let a=this.directPlugins[s].props[e];if(a!=null&&(i=t?t(a):a))return i}let o=this.state.plugins;if(o)for(let s=0;s<o.length;s++){let a=o[s].props[e];if(a!=null&&(i=t?t(a):a))return i}}hasFocus(){if(xn){let e=this.root.activeElement;if(e==this.dom)return!0;if(!e||!this.dom.contains(e))return!1;for(;e&&this.dom!=e&&this.dom.contains(e);){if(e.contentEditable=="false")return!1;e=e.parentElement}return!0}return this.root.activeElement==this.dom}focus(){this.domObserver.stop(),this.editable&&oD(this.dom),fi(this),this.domObserver.start()}get root(){let e=this._root;if(e==null){for(let t=this.dom.parentNode;t;t=t.parentNode)if(t.nodeType==9||t.nodeType==11&&t.host)return t.getSelection||(Object.getPrototypeOf(t).getSelection=()=>t.ownerDocument.getSelection()),this._root=t}return e||document}updateRoot(){this._root=null}posAtCoords(e){return cD(this,e)}coordsAtPos(e,t=1){return mv(this,e,t)}domAtPos(e,t=0){return this.docView.domFromPos(e,t)}nodeDOM(e){let t=this.docView.descAt(e);return t?t.nodeDOM:null}posAtDOM(e,t,r=-1){let i=this.docView.posFromDOM(e,t,r);if(i==null)throw new RangeError("DOM position not inside the editor");return i}endOfTextblock(e,t){return mD(this,t||this.state,e)}pasteHTML(e,t){return Za(this,"",e,!1,t||new ClipboardEvent("paste"))}pasteText(e,t){return Za(this,e,null,!0,t||new ClipboardEvent("paste"))}serializeForClipboard(e){return cp(this,e)}destroy(){this.docView&&(WD(this),this.destroyPluginViews(),this.mounted?(this.docView.update(this.state.doc,[],Lf(this),this),this.dom.textContent=""):this.dom.parentNode&&this.dom.parentNode.removeChild(this.dom),this.docView.destroy(),this.docView=null,KT())}get isDestroyed(){return this.docView==null}dispatchEvent(e){return KD(this,e)}domSelectionRange(){let e=this.domSelection();return e?an&&this.root.nodeType===11&&JT(this.dom.ownerDocument)==this.dom&&mM(this,e)||e:{focusNode:null,focusOffset:0,anchorNode:null,anchorOffset:0}}domSelection(){return this.root.getSelection()}}qv.prototype.dispatch=function(n){let e=this._props.dispatchTransaction;e?e.call(this,n):this.updateState(this.state.apply(n))};function L1(n){let e=Object.create(null);return e.class="ProseMirror",e.contenteditable=String(n.editable),n.someProp("attributes",t=>{if(typeof t=="function"&&(t=t(n.state)),t)for(let r in t)r=="class"?e.class+=" "+t[r]:r=="style"?e.style=(e.style?e.style+";":"")+t[r]:!e[r]&&r!="contenteditable"&&r!="nodeName"&&(e[r]=String(t[r]))}),e.translate||(e.translate="no"),[tr.node(0,n.state.doc.content.size,e)]}function B1(n){if(n.markCursor){let e=document.createElement("img");e.className="ProseMirror-separator",e.setAttribute("mark-placeholder","true"),e.setAttribute("alt",""),n.cursorWrapper={dom:e,deco:tr.widget(n.state.selection.from,e,{raw:!0,marks:n.markCursor})}}else n.cursorWrapper=null}function $1(n){return!n.someProp("editable",e=>e(n.state)===!1)}function CM(n,e){let t=Math.min(n.$anchor.sharedDepth(n.head),e.$anchor.sharedDepth(e.head));return n.$anchor.start(t)!=e.$anchor.start(t)}function z1(n){let e=Object.create(null);function t(r){for(let i in r)Object.prototype.hasOwnProperty.call(e,i)||(e[i]=r[i])}return n.someProp("nodeViews",t),n.someProp("markViews",t),e}function EM(n,e){let t=0,r=0;for(let i in n){if(n[i]!=e[i])return!0;t++}for(let i in e)r++;return t!=r}function H1(n){if(n.spec.state||n.spec.filterTransaction||n.spec.appendTransaction)throw new RangeError("Plugins passed directly to the view must not have a state component")}var Xi={8:"Backspace",9:"Tab",10:"Enter",12:"NumLock",13:"Enter",16:"Shift",17:"Control",18:"Alt",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",44:"PrintScreen",45:"Insert",46:"Delete",59:";",61:"=",91:"Meta",92:"Meta",106:"*",107:"+",108:",",109:"-",110:".",111:"/",144:"NumLock",145:"ScrollLock",160:"Shift",161:"Shift",162:"Control",163:"Control",164:"Alt",165:"Alt",173:"-",186:";",187:"=",188:",",189:"-",190:".",191:"/",192:"`",219:"[",220:"\\",221:"]",222:"'"},mc={48:")",49:"!",50:"@",51:"#",52:"$",53:"%",54:"^",55:"&",56:"*",57:"(",59:":",61:"+",173:"_",186:":",187:"+",188:"<",189:"_",190:">",191:"?",192:"~",219:"{",220:"|",221:"}",222:'"'},_M=typeof navigator<"u"&&/Mac/.test(navigator.platform),AM=typeof navigator<"u"&&/MSIE \d|Trident\/(?:[7-9]|\d{2,})\..*rv:(\d+)/.exec(navigator.userAgent);for(var Lt=0;Lt<10;Lt++)Xi[48+Lt]=Xi[96+Lt]=String(Lt);for(var Lt=1;Lt<=24;Lt++)Xi[Lt+111]="F"+Lt;for(var Lt=65;Lt<=90;Lt++)Xi[Lt]=String.fromCharCode(Lt+32),mc[Lt]=String.fromCharCode(Lt);for(var $f in Xi)mc.hasOwnProperty($f)||(mc[$f]=Xi[$f]);function TM(n){var e=_M&&n.metaKey&&n.shiftKey&&!n.ctrlKey&&!n.altKey||AM&&n.shiftKey&&n.key&&n.key.length==1||n.key=="Unidentified",t=!e&&n.key||(n.shiftKey?mc:Xi)[n.keyCode]||n.key||"Unidentified";return t=="Esc"&&(t="Escape"),t=="Del"&&(t="Delete"),t=="Left"&&(t="ArrowLeft"),t=="Up"&&(t="ArrowUp"),t=="Right"&&(t="ArrowRight"),t=="Down"&&(t="ArrowDown"),t}const DM=typeof navigator<"u"&&/Mac|iP(hone|[oa]d)/.test(navigator.platform),MM=typeof navigator<"u"&&/Win/.test(navigator.platform);function OM(n){let e=n.split(/-(?!$)/),t=e[e.length-1];t=="Space"&&(t=" ");let r,i,o,s;for(let a=0;a<e.length-1;a++){let l=e[a];if(/^(cmd|meta|m)$/i.test(l))s=!0;else if(/^a(lt)?$/i.test(l))r=!0;else if(/^(c|ctrl|control)$/i.test(l))i=!0;else if(/^s(hift)?$/i.test(l))o=!0;else if(/^mod$/i.test(l))DM?s=!0:i=!0;else throw new Error("Unrecognized modifier name: "+l)}return r&&(t="Alt-"+t),i&&(t="Ctrl-"+t),s&&(t="Meta-"+t),o&&(t="Shift-"+t),t}function IM(n){let e=Object.create(null);for(let t in n)e[OM(t)]=n[t];return e}function zf(n,e,t=!0){return e.altKey&&(n="Alt-"+n),e.ctrlKey&&(n="Ctrl-"+n),e.metaKey&&(n="Meta-"+n),t&&e.shiftKey&&(n="Shift-"+n),n}function NM(n){return new zt({props:{handleKeyDown:Vv(n)}})}function Vv(n){let e=IM(n);return function(t,r){let i=TM(r),o,s=e[zf(i,r)];if(s&&s(t.state,t.dispatch,t))return!0;if(i.length==1&&i!=" "){if(r.shiftKey){let a=e[zf(i,r,!1)];if(a&&a(t.state,t.dispatch,t))return!0}if((r.altKey||r.metaKey||r.ctrlKey)&&!(MM&&r.ctrlKey&&r.altKey)&&(o=Xi[r.keyCode])&&o!=i){let a=e[zf(o,r)];if(a&&a(t.state,t.dispatch,t))return!0}}return!1}}const gp=(n,e)=>n.selection.empty?!1:(e&&e(n.tr.deleteSelection().scrollIntoView()),!0);function Wv(n,e){let{$cursor:t}=n.selection;return!t||(e?!e.endOfTextblock("backward",n):t.parentOffset>0)?null:t}const Uv=(n,e,t)=>{let r=Wv(n,t);if(!r)return!1;let i=bp(r);if(!i){let s=r.blockRange(),a=s&&qs(s);return a==null?!1:(e&&e(n.tr.lift(s,a).scrollIntoView()),!0)}let o=i.nodeBefore;if(ex(n,i,e,-1))return!0;if(r.parent.content.size==0&&(Fs(o,"end")||re.isSelectable(o)))for(let s=r.depth;;s--){let a=Dc(n.doc,r.before(s),r.after(s),X.empty);if(a&&a.slice.size<a.to-a.from){if(e){let l=n.tr.step(a);l.setSelection(Fs(o,"end")?Ce.findFrom(l.doc.resolve(l.mapping.map(i.pos,-1)),-1):re.create(l.doc,i.pos-o.nodeSize)),e(l.scrollIntoView())}return!0}if(s==1||r.node(s-1).childCount>1)break}return o.isAtom&&i.depth==r.depth-1?(e&&e(n.tr.delete(i.pos-o.nodeSize,i.pos).scrollIntoView()),!0):!1},PM=(n,e,t)=>{let r=Wv(n,t);if(!r)return!1;let i=bp(r);return i?Kv(n,i,e):!1},FM=(n,e,t)=>{let r=Gv(n,t);if(!r)return!1;let i=yp(r);return i?Kv(n,i,e):!1};function Kv(n,e,t){let r=e.nodeBefore,i=r,o=e.pos-1;for(;!i.isTextblock;o--){if(i.type.spec.isolating)return!1;let f=i.lastChild;if(!f)return!1;i=f}let s=e.nodeAfter,a=s,l=e.pos+1;for(;!a.isTextblock;l++){if(a.type.spec.isolating)return!1;let f=a.firstChild;if(!f)return!1;a=f}let d=Dc(n.doc,o,l,X.empty);if(!d||d.from!=o||d instanceof Ct&&d.slice.size>=l-o)return!1;if(t){let f=n.tr.step(d);f.setSelection(pe.create(f.doc,o)),t(f.scrollIntoView())}return!0}function Fs(n,e,t=!1){for(let r=n;r;r=e=="start"?r.firstChild:r.lastChild){if(r.isTextblock)return!0;if(t&&r.childCount!=1)return!1}return!1}const jv=(n,e,t)=>{let{$head:r,empty:i}=n.selection,o=r;if(!i)return!1;if(r.parent.isTextblock){if(t?!t.endOfTextblock("backward",n):r.parentOffset>0)return!1;o=bp(r)}let s=o&&o.nodeBefore;return!s||!re.isSelectable(s)?!1:(e&&e(n.tr.setSelection(re.create(n.doc,o.pos-s.nodeSize)).scrollIntoView()),!0)};function bp(n){if(!n.parent.type.spec.isolating)for(let e=n.depth-1;e>=0;e--){if(n.index(e)>0)return n.doc.resolve(n.before(e+1));if(n.node(e).type.spec.isolating)break}return null}function Gv(n,e){let{$cursor:t}=n.selection;return!t||(e?!e.endOfTextblock("forward",n):t.parentOffset<t.parent.content.size)?null:t}const Xv=(n,e,t)=>{let r=Gv(n,t);if(!r)return!1;let i=yp(r);if(!i)return!1;let o=i.nodeAfter;if(ex(n,i,e,1))return!0;if(r.parent.content.size==0&&(Fs(o,"start")||re.isSelectable(o))){let s=Dc(n.doc,r.before(),r.after(),X.empty);if(s&&s.slice.size<s.to-s.from){if(e){let a=n.tr.step(s);a.setSelection(Fs(o,"start")?Ce.findFrom(a.doc.resolve(a.mapping.map(i.pos)),1):re.create(a.doc,a.mapping.map(i.pos))),e(a.scrollIntoView())}return!0}}return o.isAtom&&i.depth==r.depth-1?(e&&e(n.tr.delete(i.pos,i.pos+o.nodeSize).scrollIntoView()),!0):!1},Yv=(n,e,t)=>{let{$head:r,empty:i}=n.selection,o=r;if(!i)return!1;if(r.parent.isTextblock){if(t?!t.endOfTextblock("forward",n):r.parentOffset<r.parent.content.size)return!1;o=yp(r)}let s=o&&o.nodeAfter;return!s||!re.isSelectable(s)?!1:(e&&e(n.tr.setSelection(re.create(n.doc,o.pos)).scrollIntoView()),!0)};function yp(n){if(!n.parent.type.spec.isolating)for(let e=n.depth-1;e>=0;e--){let t=n.node(e);if(n.index(e)+1<t.childCount)return n.doc.resolve(n.after(e+1));if(t.type.spec.isolating)break}return null}const RM=(n,e)=>{let t=n.selection,r=t instanceof re,i;if(r){if(t.node.isTextblock||!Ji(n.doc,t.from))return!1;i=t.from}else if(i=Tc(n.doc,t.from,-1),i==null)return!1;if(e){let o=n.tr.join(i);r&&o.setSelection(re.create(o.doc,i-n.doc.resolve(i).nodeBefore.nodeSize)),e(o.scrollIntoView())}return!0},LM=(n,e)=>{let t=n.selection,r;if(t instanceof re){if(t.node.isTextblock||!Ji(n.doc,t.to))return!1;r=t.to}else if(r=Tc(n.doc,t.to,1),r==null)return!1;return e&&e(n.tr.join(r).scrollIntoView()),!0},BM=(n,e)=>{let{$from:t,$to:r}=n.selection,i=t.blockRange(r),o=i&&qs(i);return o==null?!1:(e&&e(n.tr.lift(i,o).scrollIntoView()),!0)},Jv=(n,e)=>{let{$head:t,$anchor:r}=n.selection;return!t.parent.type.spec.code||!t.sameParent(r)?!1:(e&&e(n.tr.insertText(`
`).scrollIntoView()),!0)};function vp(n){for(let e=0;e<n.edgeCount;e++){let{type:t}=n.edge(e);if(t.isTextblock&&!t.hasRequiredAttrs())return t}return null}const $M=(n,e)=>{let{$head:t,$anchor:r}=n.selection;if(!t.parent.type.spec.code||!t.sameParent(r))return!1;let i=t.node(-1),o=t.indexAfter(-1),s=vp(i.contentMatchAt(o));if(!s||!i.canReplaceWith(o,o,s))return!1;if(e){let a=t.after(),l=n.tr.replaceWith(a,a,s.createAndFill());l.setSelection(Ce.near(l.doc.resolve(a),1)),e(l.scrollIntoView())}return!0},Zv=(n,e)=>{let t=n.selection,{$from:r,$to:i}=t;if(t instanceof Bn||r.parent.inlineContent||i.parent.inlineContent)return!1;let o=vp(i.parent.contentMatchAt(i.indexAfter()));if(!o||!o.isTextblock)return!1;if(e){let s=(!r.parentOffset&&i.index()<i.parent.childCount?r:i).pos,a=n.tr.insert(s,o.createAndFill());a.setSelection(pe.create(a.doc,s+1)),e(a.scrollIntoView())}return!0},Qv=(n,e)=>{let{$cursor:t}=n.selection;if(!t||t.parent.content.size)return!1;if(t.depth>1&&t.after()!=t.end(-1)){let o=t.before();if(di(n.doc,o))return e&&e(n.tr.split(o).scrollIntoView()),!0}let r=t.blockRange(),i=r&&qs(r);return i==null?!1:(e&&e(n.tr.lift(r,i).scrollIntoView()),!0)};function zM(n){return(e,t)=>{let{$from:r,$to:i}=e.selection;if(e.selection instanceof re&&e.selection.node.isBlock)return!r.parentOffset||!di(e.doc,r.pos)?!1:(t&&t(e.tr.split(r.pos).scrollIntoView()),!0);if(!r.depth)return!1;let o=[],s,a,l=!1,d=!1;for(let g=r.depth;;g--)if(r.node(g).isBlock){l=r.end(g)==r.pos+(r.depth-g),d=r.start(g)==r.pos-(r.depth-g),a=vp(r.node(g-1).contentMatchAt(r.indexAfter(g-1))),o.unshift(l&&a?{type:a}:null),s=g;break}else{if(g==1)return!1;o.unshift(null)}let f=e.tr;(e.selection instanceof pe||e.selection instanceof Bn)&&f.deleteSelection();let h=f.mapping.map(r.pos),m=di(f.doc,h,o.length,o);if(m||(o[0]=a?{type:a}:null,m=di(f.doc,h,o.length,o)),!m)return!1;if(f.split(h,o.length,o),!l&&d&&r.node(s).type!=a){let g=f.mapping.map(r.before(s)),b=f.doc.resolve(g);a&&r.node(s-1).canReplaceWith(b.index(),b.index()+1,a)&&f.setNodeMarkup(f.mapping.map(r.before(s)),a)}return t&&t(f.scrollIntoView()),!0}}const HM=zM(),qM=(n,e)=>{let{$from:t,to:r}=n.selection,i,o=t.sharedDepth(r);return o==0?!1:(i=t.before(o),e&&e(n.tr.setSelection(re.create(n.doc,i))),!0)};function VM(n,e,t){let r=e.nodeBefore,i=e.nodeAfter,o=e.index();return!r||!i||!r.type.compatibleContent(i.type)?!1:!r.content.size&&e.parent.canReplace(o-1,o)?(t&&t(n.tr.delete(e.pos-r.nodeSize,e.pos).scrollIntoView()),!0):!e.parent.canReplace(o,o+1)||!(i.isTextblock||Ji(n.doc,e.pos))?!1:(t&&t(n.tr.join(e.pos).scrollIntoView()),!0)}function ex(n,e,t,r){let i=e.nodeBefore,o=e.nodeAfter,s,a,l=i.type.spec.isolating||o.type.spec.isolating;if(!l&&VM(n,e,t))return!0;let d=!l&&e.parent.canReplace(e.index(),e.index()+1);if(d&&(s=(a=i.contentMatchAt(i.childCount)).findWrapping(o.type))&&a.matchType(s[0]||o.type).validEnd){if(t){let g=e.pos+o.nodeSize,b=q.empty;for(let E=s.length-1;E>=0;E--)b=q.from(s[E].create(null,b));b=q.from(i.copy(b));let v=n.tr.step(new _t(e.pos-1,g,e.pos,g,new X(b,1,0),s.length,!0)),x=v.doc.resolve(g+2*s.length);x.nodeAfter&&x.nodeAfter.type==i.type&&Ji(v.doc,x.pos)&&v.join(x.pos),t(v.scrollIntoView())}return!0}let f=o.type.spec.isolating||r>0&&l?null:Ce.findFrom(e,1),h=f&&f.$from.blockRange(f.$to),m=h&&qs(h);if(m!=null&&m>=e.depth)return t&&t(n.tr.lift(h,m).scrollIntoView()),!0;if(d&&Fs(o,"start",!0)&&Fs(i,"end")){let g=i,b=[];for(;b.push(g),!g.isTextblock;)g=g.lastChild;let v=o,x=1;for(;!v.isTextblock;v=v.firstChild)x++;if(g.canReplace(g.childCount,g.childCount,v.content)){if(t){let E=q.empty;for(let M=b.length-1;M>=0;M--)E=q.from(b[M].copy(E));let A=n.tr.step(new _t(e.pos-b.length,e.pos+o.nodeSize,e.pos+x,e.pos+o.nodeSize-x,new X(E,b.length,0),0,!0));t(A.scrollIntoView())}return!0}}return!1}function tx(n){return function(e,t){let r=e.selection,i=n<0?r.$from:r.$to,o=i.depth;for(;i.node(o).isInline;){if(!o)return!1;o--}return i.node(o).isTextblock?(t&&t(e.tr.setSelection(pe.create(e.doc,n<0?i.start(o):i.end(o)))),!0):!1}}const WM=tx(-1),UM=tx(1);function KM(n,e=null){return function(t,r){let{$from:i,$to:o}=t.selection,s=i.blockRange(o),a=s&&op(s,n,e);return a?(r&&r(t.tr.wrap(s,a).scrollIntoView()),!0):!1}}function q1(n,e=null){return function(t,r){let i=!1;for(let o=0;o<t.selection.ranges.length&&!i;o++){let{$from:{pos:s},$to:{pos:a}}=t.selection.ranges[o];t.doc.nodesBetween(s,a,(l,d)=>{if(i)return!1;if(!(!l.isTextblock||l.hasMarkup(n,e)))if(l.type==n)i=!0;else{let f=t.doc.resolve(d),h=f.index();i=f.parent.canReplaceWith(h,h+1,n)}})}if(!i)return!1;if(r){let o=t.tr;for(let s=0;s<t.selection.ranges.length;s++){let{$from:{pos:a},$to:{pos:l}}=t.selection.ranges[s];o.setBlockType(a,l,n,e)}r(o.scrollIntoView())}return!0}}function xp(...n){return function(e,t,r){for(let i=0;i<n.length;i++)if(n[i](e,t,r))return!0;return!1}}xp(gp,Uv,jv);xp(gp,Xv,Yv);xp(Jv,Zv,Qv,HM);typeof navigator<"u"?/Mac|iP(hone|[oa]d)/.test(navigator.platform):typeof os<"u"&&os.platform&&os.platform()=="darwin";function jM(n,e=null){return function(t,r){let{$from:i,$to:o}=t.selection,s=i.blockRange(o);if(!s)return!1;let a=r?t.tr:null;return GM(a,s,n,e)?(r&&r(a.scrollIntoView()),!0):!1}}function GM(n,e,t,r=null){let i=!1,o=e,s=e.$from.doc;if(e.depth>=2&&e.$from.node(e.depth-1).type.compatibleContent(t)&&e.startIndex==0){if(e.$from.index(e.depth-1)==0)return!1;let l=s.resolve(e.start-2);o=new uc(l,l,e.depth),e.endIndex<e.parent.childCount&&(e=new uc(e.$from,s.resolve(e.$to.end(e.depth)),e.depth)),i=!0}let a=op(o,t,r,e);return a?(n&&XM(n,e,a,i,t),!0):!1}function XM(n,e,t,r,i){let o=q.empty;for(let f=t.length-1;f>=0;f--)o=q.from(t[f].type.create(t[f].attrs,o));n.step(new _t(e.start-(r?2:0),e.end,e.start,e.end,new X(o,0,0),t.length,!0));let s=0;for(let f=0;f<t.length;f++)t[f].type==i&&(s=f+1);let a=t.length-s,l=e.start+t.length-(r?2:0),d=e.parent;for(let f=e.startIndex,h=e.endIndex,m=!0;f<h;f++,m=!1)!m&&di(n.doc,l,a)&&(n.split(l,a),l+=2*a),l+=d.child(f).nodeSize;return n}function YM(n){return function(e,t){let{$from:r,$to:i}=e.selection,o=r.blockRange(i,s=>s.childCount>0&&s.firstChild.type==n);return o?t?r.node(o.depth-1).type==n?JM(e,t,n,o):ZM(e,t,o):!0:!1}}function JM(n,e,t,r){let i=n.tr,o=r.end,s=r.$to.end(r.depth);o<s&&(i.step(new _t(o-1,s,o,s,new X(q.from(t.create(null,r.parent.copy())),1,0),1,!0)),r=new uc(i.doc.resolve(r.$from.pos),i.doc.resolve(s),r.depth));const a=qs(r);if(a==null)return!1;i.lift(r,a);let l=i.doc.resolve(i.mapping.map(o,-1)-1);return Ji(i.doc,l.pos)&&l.nodeBefore.type==l.nodeAfter.type&&i.join(l.pos),e(i.scrollIntoView()),!0}function ZM(n,e,t){let r=n.tr,i=t.parent;for(let g=t.end,b=t.endIndex-1,v=t.startIndex;b>v;b--)g-=i.child(b).nodeSize,r.delete(g-1,g+1);let o=r.doc.resolve(t.start),s=o.nodeAfter;if(r.mapping.map(t.end)!=t.start+o.nodeAfter.nodeSize)return!1;let a=t.startIndex==0,l=t.endIndex==i.childCount,d=o.node(-1),f=o.index(-1);if(!d.canReplace(f+(a?0:1),f+1,s.content.append(l?q.empty:q.from(i))))return!1;let h=o.pos,m=h+s.nodeSize;return r.step(new _t(h-(a?1:0),m+(l?1:0),h+1,m-1,new X((a?q.empty:q.from(i.copy(q.empty))).append(l?q.empty:q.from(i.copy(q.empty))),a?0:1,l?0:1),a?0:1)),e(r.scrollIntoView()),!0}function QM(n){return function(e,t){let{$from:r,$to:i}=e.selection,o=r.blockRange(i,d=>d.childCount>0&&d.firstChild.type==n);if(!o)return!1;let s=o.startIndex;if(s==0)return!1;let a=o.parent,l=a.child(s-1);if(l.type!=n)return!1;if(t){let d=l.lastChild&&l.lastChild.type==a.type,f=q.from(d?n.create():null),h=new X(q.from(n.create(null,q.from(a.type.create(null,f)))),d?3:1,0),m=o.start,g=o.end;t(e.tr.step(new _t(m-(d?3:1),g,m,g,h,1,!0)).scrollIntoView())}return!0}}function Pc(n){const{state:e,transaction:t}=n;let{selection:r}=t,{doc:i}=t,{storedMarks:o}=t;return{...e,apply:e.apply.bind(e),applyTransaction:e.applyTransaction.bind(e),plugins:e.plugins,schema:e.schema,reconfigure:e.reconfigure.bind(e),toJSON:e.toJSON.bind(e),get storedMarks(){return o},get selection(){return r},get doc(){return i},get tr(){return r=t.selection,i=t.doc,o=t.storedMarks,t}}}class Fc{constructor(e){this.editor=e.editor,this.rawCommands=this.editor.extensionManager.commands,this.customState=e.state}get hasCustomState(){return!!this.customState}get state(){return this.customState||this.editor.state}get commands(){const{rawCommands:e,editor:t,state:r}=this,{view:i}=t,{tr:o}=r,s=this.buildProps(o);return Object.fromEntries(Object.entries(e).map(([a,l])=>[a,(...f)=>{const h=l(...f)(s);return!o.getMeta("preventDispatch")&&!this.hasCustomState&&i.dispatch(o),h}]))}get chain(){return()=>this.createChain()}get can(){return()=>this.createCan()}createChain(e,t=!0){const{rawCommands:r,editor:i,state:o}=this,{view:s}=i,a=[],l=!!e,d=e||o.tr,f=()=>(!l&&t&&!d.getMeta("preventDispatch")&&!this.hasCustomState&&s.dispatch(d),a.every(m=>m===!0)),h={...Object.fromEntries(Object.entries(r).map(([m,g])=>[m,(...v)=>{const x=this.buildProps(d,t),E=g(...v)(x);return a.push(E),h}])),run:f};return h}createCan(e){const{rawCommands:t,state:r}=this,i=!1,o=e||r.tr,s=this.buildProps(o,i);return{...Object.fromEntries(Object.entries(t).map(([l,d])=>[l,(...f)=>d(...f)({...s,dispatch:void 0})])),chain:()=>this.createChain(o,i)}}buildProps(e,t=!0){const{rawCommands:r,editor:i,state:o}=this,{view:s}=i,a={tr:e,editor:i,view:s,state:Pc({state:o,transaction:e}),dispatch:t?()=>{}:void 0,chain:()=>this.createChain(e,t),can:()=>this.createCan(e),get commands(){return Object.fromEntries(Object.entries(r).map(([l,d])=>[l,(...f)=>d(...f)(a)]))}};return a}}class e4{constructor(){this.callbacks={}}on(e,t){return this.callbacks[e]||(this.callbacks[e]=[]),this.callbacks[e].push(t),this}emit(e,...t){const r=this.callbacks[e];return r&&r.forEach(i=>i.apply(this,t)),this}off(e,t){const r=this.callbacks[e];return r&&(t?this.callbacks[e]=r.filter(i=>i!==t):delete this.callbacks[e]),this}once(e,t){const r=(...i)=>{this.off(e,r),t.apply(this,i)};return this.on(e,r)}removeAllListeners(){this.callbacks={}}}function Z(n,e,t){return n.config[e]===void 0&&n.parent?Z(n.parent,e,t):typeof n.config[e]=="function"?n.config[e].bind({...t,parent:n.parent?Z(n.parent,e,t):null}):n.config[e]}function Rc(n){const e=n.filter(i=>i.type==="extension"),t=n.filter(i=>i.type==="node"),r=n.filter(i=>i.type==="mark");return{baseExtensions:e,nodeExtensions:t,markExtensions:r}}function nx(n){const e=[],{nodeExtensions:t,markExtensions:r}=Rc(n),i=[...t,...r],o={default:null,rendered:!0,renderHTML:null,parseHTML:null,keepOnSplit:!0,isRequired:!1};return n.forEach(s=>{const a={name:s.name,options:s.options,storage:s.storage,extensions:i},l=Z(s,"addGlobalAttributes",a);if(!l)return;l().forEach(f=>{f.types.forEach(h=>{Object.entries(f.attributes).forEach(([m,g])=>{e.push({type:h,name:m,attribute:{...o,...g}})})})})}),i.forEach(s=>{const a={name:s.name,options:s.options,storage:s.storage},l=Z(s,"addAttributes",a);if(!l)return;const d=l();Object.entries(d).forEach(([f,h])=>{const m={...o,...h};typeof(m==null?void 0:m.default)=="function"&&(m.default=m.default()),m!=null&&m.isRequired&&(m==null?void 0:m.default)===void 0&&delete m.default,e.push({type:s.name,name:f,attribute:m})})}),e}function Tt(n,e){if(typeof n=="string"){if(!e.nodes[n])throw Error(`There is no node type named '${n}'. Maybe you forgot to add the extension?`);return e.nodes[n]}return n}function $t(...n){return n.filter(e=>!!e).reduce((e,t)=>{const r={...e};return Object.entries(t).forEach(([i,o])=>{if(!r[i]){r[i]=o;return}if(i==="class"){const a=o?String(o).split(" "):[],l=r[i]?r[i].split(" "):[],d=a.filter(f=>!l.includes(f));r[i]=[...l,...d].join(" ")}else if(i==="style"){const a=o?o.split(";").map(f=>f.trim()).filter(Boolean):[],l=r[i]?r[i].split(";").map(f=>f.trim()).filter(Boolean):[],d=new Map;l.forEach(f=>{const[h,m]=f.split(":").map(g=>g.trim());d.set(h,m)}),a.forEach(f=>{const[h,m]=f.split(":").map(g=>g.trim());d.set(h,m)}),r[i]=Array.from(d.entries()).map(([f,h])=>`${f}: ${h}`).join("; ")}else r[i]=o}),r},{})}function Rh(n,e){return e.filter(t=>t.type===n.type.name).filter(t=>t.attribute.rendered).map(t=>t.attribute.renderHTML?t.attribute.renderHTML(n.attrs)||{}:{[t.name]:n.attrs[t.name]}).reduce((t,r)=>$t(t,r),{})}function rx(n){return typeof n=="function"}function De(n,e=void 0,...t){return rx(n)?e?n.bind(e)(...t):n(...t):n}function t4(n={}){return Object.keys(n).length===0&&n.constructor===Object}function n4(n){return typeof n!="string"?n:n.match(/^[+-]?(?:\d*\.)?\d+$/)?Number(n):n==="true"?!0:n==="false"?!1:n}function V1(n,e){return"style"in n?n:{...n,getAttrs:t=>{const r=n.getAttrs?n.getAttrs(t):n.attrs;if(r===!1)return!1;const i=e.reduce((o,s)=>{const a=s.attribute.parseHTML?s.attribute.parseHTML(t):n4(t.getAttribute(s.name));return a==null?o:{...o,[s.name]:a}},{});return{...r,...i}}}}function W1(n){return Object.fromEntries(Object.entries(n).filter(([e,t])=>e==="attrs"&&t4(t)?!1:t!=null))}function r4(n,e){var t;const r=nx(n),{nodeExtensions:i,markExtensions:o}=Rc(n),s=(t=i.find(d=>Z(d,"topNode")))===null||t===void 0?void 0:t.name,a=Object.fromEntries(i.map(d=>{const f=r.filter(E=>E.type===d.name),h={name:d.name,options:d.options,storage:d.storage,editor:e},m=n.reduce((E,A)=>{const M=Z(A,"extendNodeSchema",h);return{...E,...M?M(d):{}}},{}),g=W1({...m,content:De(Z(d,"content",h)),marks:De(Z(d,"marks",h)),group:De(Z(d,"group",h)),inline:De(Z(d,"inline",h)),atom:De(Z(d,"atom",h)),selectable:De(Z(d,"selectable",h)),draggable:De(Z(d,"draggable",h)),code:De(Z(d,"code",h)),whitespace:De(Z(d,"whitespace",h)),linebreakReplacement:De(Z(d,"linebreakReplacement",h)),defining:De(Z(d,"defining",h)),isolating:De(Z(d,"isolating",h)),attrs:Object.fromEntries(f.map(E=>{var A;return[E.name,{default:(A=E==null?void 0:E.attribute)===null||A===void 0?void 0:A.default}]}))}),b=De(Z(d,"parseHTML",h));b&&(g.parseDOM=b.map(E=>V1(E,f)));const v=Z(d,"renderHTML",h);v&&(g.toDOM=E=>v({node:E,HTMLAttributes:Rh(E,f)}));const x=Z(d,"renderText",h);return x&&(g.toText=x),[d.name,g]})),l=Object.fromEntries(o.map(d=>{const f=r.filter(x=>x.type===d.name),h={name:d.name,options:d.options,storage:d.storage,editor:e},m=n.reduce((x,E)=>{const A=Z(E,"extendMarkSchema",h);return{...x,...A?A(d):{}}},{}),g=W1({...m,inclusive:De(Z(d,"inclusive",h)),excludes:De(Z(d,"excludes",h)),group:De(Z(d,"group",h)),spanning:De(Z(d,"spanning",h)),code:De(Z(d,"code",h)),attrs:Object.fromEntries(f.map(x=>{var E;return[x.name,{default:(E=x==null?void 0:x.attribute)===null||E===void 0?void 0:E.default}]}))}),b=De(Z(d,"parseHTML",h));b&&(g.parseDOM=b.map(x=>V1(x,f)));const v=Z(d,"renderHTML",h);return v&&(g.toDOM=x=>v({mark:x,HTMLAttributes:Rh(x,f)})),[d.name,g]}));return new np({topNode:s,nodes:a,marks:l})}function Hf(n,e){return e.nodes[n]||e.marks[n]||null}function U1(n,e){return Array.isArray(e)?e.some(t=>(typeof t=="string"?t:t.name)===n.name):e}function gu(n,e){const t=zo.fromSchema(e).serializeFragment(n),i=document.implementation.createHTMLDocument().createElement("div");return i.appendChild(t),i.innerHTML}const i4=(n,e=500)=>{let t="";const r=n.parentOffset;return n.parent.nodesBetween(Math.max(0,r-e),r,(i,o,s,a)=>{var l,d;const f=((d=(l=i.type.spec).toText)===null||d===void 0?void 0:d.call(l,{node:i,pos:o,parent:s,index:a}))||i.textContent||"%leaf%";t+=i.isAtom&&!i.isText?f:f.slice(0,Math.max(0,r-o))}),t};function wp(n){return Object.prototype.toString.call(n)==="[object RegExp]"}class Lc{constructor(e){this.find=e.find,this.handler=e.handler}}const o4=(n,e)=>{if(wp(e))return e.exec(n);const t=e(n);if(!t)return null;const r=[t.text];return r.index=t.index,r.input=n,r.data=t.data,t.replaceWith&&(t.text.includes(t.replaceWith)||console.warn('[tiptap warn]: "inputRuleMatch.replaceWith" must be part of "inputRuleMatch.text".'),r.push(t.replaceWith)),r};function Cl(n){var e;const{editor:t,from:r,to:i,text:o,rules:s,plugin:a}=n,{view:l}=t;if(l.composing)return!1;const d=l.state.doc.resolve(r);if(d.parent.type.spec.code||!((e=d.nodeBefore||d.nodeAfter)===null||e===void 0)&&e.marks.find(m=>m.type.spec.code))return!1;let f=!1;const h=i4(d)+o;return s.forEach(m=>{if(f)return;const g=o4(h,m.find);if(!g)return;const b=l.state.tr,v=Pc({state:l.state,transaction:b}),x={from:r-(g[0].length-o.length),to:i},{commands:E,chain:A,can:M}=new Fc({editor:t,state:v});m.handler({state:v,range:x,match:g,commands:E,chain:A,can:M})===null||!b.steps.length||(b.setMeta(a,{transform:b,from:r,to:i,text:o}),l.dispatch(b),f=!0)}),f}function s4(n){const{editor:e,rules:t}=n,r=new zt({state:{init(){return null},apply(i,o,s){const a=i.getMeta(r);if(a)return a;const l=i.getMeta("applyInputRules");return!!l&&setTimeout(()=>{let{text:f}=l;typeof f=="string"?f=f:f=gu(q.from(f),s.schema);const{from:h}=l,m=h+f.length;Cl({editor:e,from:h,to:m,text:f,rules:t,plugin:r})}),i.selectionSet||i.docChanged?null:o}},props:{handleTextInput(i,o,s,a){return Cl({editor:e,from:o,to:s,text:a,rules:t,plugin:r})},handleDOMEvents:{compositionend:i=>(setTimeout(()=>{const{$cursor:o}=i.state.selection;o&&Cl({editor:e,from:o.pos,to:o.pos,text:"",rules:t,plugin:r})}),!1)},handleKeyDown(i,o){if(o.key!=="Enter")return!1;const{$cursor:s}=i.state.selection;return s?Cl({editor:e,from:s.pos,to:s.pos,text:`
`,rules:t,plugin:r}):!1}},isInputRules:!0});return r}function a4(n){return Object.prototype.toString.call(n).slice(8,-1)}function El(n){return a4(n)!=="Object"?!1:n.constructor===Object&&Object.getPrototypeOf(n)===Object.prototype}function Bc(n,e){const t={...n};return El(n)&&El(e)&&Object.keys(e).forEach(r=>{El(e[r])&&El(n[r])?t[r]=Bc(n[r],e[r]):t[r]=e[r]}),t}class Yt{constructor(e={}){this.type="mark",this.name="mark",this.parent=null,this.child=null,this.config={name:this.name,defaultOptions:{}},this.config={...this.config,...e},this.name=this.config.name,e.defaultOptions&&Object.keys(e.defaultOptions).length>0&&console.warn(`[tiptap warn]: BREAKING CHANGE: "defaultOptions" is deprecated. Please use "addOptions" instead. Found in extension: "${this.name}".`),this.options=this.config.defaultOptions,this.config.addOptions&&(this.options=De(Z(this,"addOptions",{name:this.name}))),this.storage=De(Z(this,"addStorage",{name:this.name,options:this.options}))||{}}static create(e={}){return new Yt(e)}configure(e={}){const t=this.extend({...this.config,addOptions:()=>Bc(this.options,e)});return t.name=this.name,t.parent=this.parent,t}extend(e={}){const t=new Yt(e);return t.parent=this,this.child=t,t.name=e.name?e.name:t.parent.name,e.defaultOptions&&Object.keys(e.defaultOptions).length>0&&console.warn(`[tiptap warn]: BREAKING CHANGE: "defaultOptions" is deprecated. Please use "addOptions" instead. Found in extension: "${t.name}".`),t.options=De(Z(t,"addOptions",{name:t.name})),t.storage=De(Z(t,"addStorage",{name:t.name,options:t.options})),t}static handleExit({editor:e,mark:t}){const{tr:r}=e.state,i=e.state.selection.$from;if(i.pos===i.end()){const s=i.marks();if(!!!s.find(d=>(d==null?void 0:d.type.name)===t.name))return!1;const l=s.find(d=>(d==null?void 0:d.type.name)===t.name);return l&&r.removeStoredMark(l),r.insertText(" ",i.pos),e.view.dispatch(r),!0}return!1}}function u4(n){return typeof n=="number"}class l4{constructor(e){this.find=e.find,this.handler=e.handler}}const c4=(n,e,t)=>{if(wp(e))return[...n.matchAll(e)];const r=e(n,t);return r?r.map(i=>{const o=[i.text];return o.index=i.index,o.input=n,o.data=i.data,i.replaceWith&&(i.text.includes(i.replaceWith)||console.warn('[tiptap warn]: "pasteRuleMatch.replaceWith" must be part of "pasteRuleMatch.text".'),o.push(i.replaceWith)),o}):[]};function d4(n){const{editor:e,state:t,from:r,to:i,rule:o,pasteEvent:s,dropEvent:a}=n,{commands:l,chain:d,can:f}=new Fc({editor:e,state:t}),h=[];return t.doc.nodesBetween(r,i,(g,b)=>{if(!g.isTextblock||g.type.spec.code)return;const v=Math.max(r,b),x=Math.min(i,b+g.content.size),E=g.textBetween(v-b,x-b,void 0,"");c4(E,o.find,s).forEach(M=>{if(M.index===void 0)return;const C=v+M.index+1,P=C+M[0].length,N={from:t.tr.mapping.map(C),to:t.tr.mapping.map(P)},W=o.handler({state:t,range:N,match:M,commands:l,chain:d,can:f,pasteEvent:s,dropEvent:a});h.push(W)})}),h.every(g=>g!==null)}let _l=null;const f4=n=>{var e;const t=new ClipboardEvent("paste",{clipboardData:new DataTransfer});return(e=t.clipboardData)===null||e===void 0||e.setData("text/html",n),t};function h4(n){const{editor:e,rules:t}=n;let r=null,i=!1,o=!1,s=typeof ClipboardEvent<"u"?new ClipboardEvent("paste"):null,a;try{a=typeof DragEvent<"u"?new DragEvent("drop"):null}catch{a=null}const l=({state:f,from:h,to:m,rule:g,pasteEvt:b})=>{const v=f.tr,x=Pc({state:f,transaction:v});if(!(!d4({editor:e,state:x,from:Math.max(h-1,0),to:m.b-1,rule:g,pasteEvent:b,dropEvent:a})||!v.steps.length)){try{a=typeof DragEvent<"u"?new DragEvent("drop"):null}catch{a=null}return s=typeof ClipboardEvent<"u"?new ClipboardEvent("paste"):null,v}};return t.map(f=>new zt({view(h){const m=b=>{var v;r=!((v=h.dom.parentElement)===null||v===void 0)&&v.contains(b.target)?h.dom.parentElement:null,r&&(_l=e)},g=()=>{_l&&(_l=null)};return window.addEventListener("dragstart",m),window.addEventListener("dragend",g),{destroy(){window.removeEventListener("dragstart",m),window.removeEventListener("dragend",g)}}},props:{handleDOMEvents:{drop:(h,m)=>{if(o=r===h.dom.parentElement,a=m,!o){const g=_l;g!=null&&g.isEditable&&setTimeout(()=>{const b=g.state.selection;b&&g.commands.deleteRange({from:b.from,to:b.to})},10)}return!1},paste:(h,m)=>{var g;const b=(g=m.clipboardData)===null||g===void 0?void 0:g.getData("text/html");return s=m,i=!!(b!=null&&b.includes("data-pm-slice")),!1}}},appendTransaction:(h,m,g)=>{const b=h[0],v=b.getMeta("uiEvent")==="paste"&&!i,x=b.getMeta("uiEvent")==="drop"&&!o,E=b.getMeta("applyPasteRules"),A=!!E;if(!v&&!x&&!A)return;if(A){let{text:P}=E;typeof P=="string"?P=P:P=gu(q.from(P),g.schema);const{from:N}=E,W=N+P.length,V=f4(P);return l({rule:f,state:g,from:N,to:{b:W},pasteEvt:V})}const M=m.doc.content.findDiffStart(g.doc.content),C=m.doc.content.findDiffEnd(g.doc.content);if(!(!u4(M)||!C||M===C.b))return l({rule:f,state:g,from:M,to:C,pasteEvt:s})}}))}function p4(n){const e=n.filter((t,r)=>n.indexOf(t)!==r);return Array.from(new Set(e))}class ks{constructor(e,t){this.splittableMarks=[],this.editor=t,this.extensions=ks.resolve(e),this.schema=r4(this.extensions,t),this.setupExtensions()}static resolve(e){const t=ks.sort(ks.flatten(e)),r=p4(t.map(i=>i.name));return r.length&&console.warn(`[tiptap warn]: Duplicate extension names found: [${r.map(i=>`'${i}'`).join(", ")}]. This can lead to issues.`),t}static flatten(e){return e.map(t=>{const r={name:t.name,options:t.options,storage:t.storage},i=Z(t,"addExtensions",r);return i?[t,...this.flatten(i())]:t}).flat(10)}static sort(e){return e.sort((r,i)=>{const o=Z(r,"priority")||100,s=Z(i,"priority")||100;return o>s?-1:o<s?1:0})}get commands(){return this.extensions.reduce((e,t)=>{const r={name:t.name,options:t.options,storage:t.storage,editor:this.editor,type:Hf(t.name,this.schema)},i=Z(t,"addCommands",r);return i?{...e,...i()}:e},{})}get plugins(){const{editor:e}=this,t=ks.sort([...this.extensions].reverse()),r=[],i=[],o=t.map(s=>{const a={name:s.name,options:s.options,storage:s.storage,editor:e,type:Hf(s.name,this.schema)},l=[],d=Z(s,"addKeyboardShortcuts",a);let f={};if(s.type==="mark"&&Z(s,"exitable",a)&&(f.ArrowRight=()=>Yt.handleExit({editor:e,mark:s})),d){const v=Object.fromEntries(Object.entries(d()).map(([x,E])=>[x,()=>E({editor:e})]));f={...f,...v}}const h=NM(f);l.push(h);const m=Z(s,"addInputRules",a);U1(s,e.options.enableInputRules)&&m&&r.push(...m());const g=Z(s,"addPasteRules",a);U1(s,e.options.enablePasteRules)&&g&&i.push(...g());const b=Z(s,"addProseMirrorPlugins",a);if(b){const v=b();l.push(...v)}return l}).flat();return[s4({editor:e,rules:r}),...h4({editor:e,rules:i}),...o]}get attributes(){return nx(this.extensions)}get nodeViews(){const{editor:e}=this,{nodeExtensions:t}=Rc(this.extensions);return Object.fromEntries(t.filter(r=>!!Z(r,"addNodeView")).map(r=>{const i=this.attributes.filter(l=>l.type===r.name),o={name:r.name,options:r.options,storage:r.storage,editor:e,type:Tt(r.name,this.schema)},s=Z(r,"addNodeView",o);if(!s)return[];const a=(l,d,f,h,m)=>{const g=Rh(l,i);return s()({node:l,view:d,getPos:f,decorations:h,innerDecorations:m,editor:e,extension:r,HTMLAttributes:g})};return[r.name,a]}))}setupExtensions(){this.extensions.forEach(e=>{var t;this.editor.extensionStorage[e.name]=e.storage;const r={name:e.name,options:e.options,storage:e.storage,editor:this.editor,type:Hf(e.name,this.schema)};e.type==="mark"&&(!((t=De(Z(e,"keepOnSplit",r)))!==null&&t!==void 0)||t)&&this.splittableMarks.push(e.name);const i=Z(e,"onBeforeCreate",r),o=Z(e,"onCreate",r),s=Z(e,"onUpdate",r),a=Z(e,"onSelectionUpdate",r),l=Z(e,"onTransaction",r),d=Z(e,"onFocus",r),f=Z(e,"onBlur",r),h=Z(e,"onDestroy",r);i&&this.editor.on("beforeCreate",i),o&&this.editor.on("create",o),s&&this.editor.on("update",s),a&&this.editor.on("selectionUpdate",a),l&&this.editor.on("transaction",l),d&&this.editor.on("focus",d),f&&this.editor.on("blur",f),h&&this.editor.on("destroy",h)})}}class bt{constructor(e={}){this.type="extension",this.name="extension",this.parent=null,this.child=null,this.config={name:this.name,defaultOptions:{}},this.config={...this.config,...e},this.name=this.config.name,e.defaultOptions&&Object.keys(e.defaultOptions).length>0&&console.warn(`[tiptap warn]: BREAKING CHANGE: "defaultOptions" is deprecated. Please use "addOptions" instead. Found in extension: "${this.name}".`),this.options=this.config.defaultOptions,this.config.addOptions&&(this.options=De(Z(this,"addOptions",{name:this.name}))),this.storage=De(Z(this,"addStorage",{name:this.name,options:this.options}))||{}}static create(e={}){return new bt(e)}configure(e={}){const t=this.extend({...this.config,addOptions:()=>Bc(this.options,e)});return t.name=this.name,t.parent=this.parent,t}extend(e={}){const t=new bt({...this.config,...e});return t.parent=this,this.child=t,t.name=e.name?e.name:t.parent.name,e.defaultOptions&&Object.keys(e.defaultOptions).length>0&&console.warn(`[tiptap warn]: BREAKING CHANGE: "defaultOptions" is deprecated. Please use "addOptions" instead. Found in extension: "${t.name}".`),t.options=De(Z(t,"addOptions",{name:t.name})),t.storage=De(Z(t,"addStorage",{name:t.name,options:t.options})),t}}function ix(n,e,t){const{from:r,to:i}=e,{blockSeparator:o=`

`,textSerializers:s={}}=t||{};let a="";return n.nodesBetween(r,i,(l,d,f,h)=>{var m;l.isBlock&&d>r&&(a+=o);const g=s==null?void 0:s[l.type.name];if(g)return f&&(a+=g({node:l,pos:d,parent:f,index:h,range:e})),!1;l.isText&&(a+=(m=l==null?void 0:l.text)===null||m===void 0?void 0:m.slice(Math.max(r,d)-d,i-d))}),a}function kp(n){return Object.fromEntries(Object.entries(n.nodes).filter(([,e])=>e.spec.toText).map(([e,t])=>[e,t.spec.toText]))}const ox=bt.create({name:"clipboardTextSerializer",addOptions(){return{blockSeparator:void 0}},addProseMirrorPlugins(){return[new zt({key:new Hn("clipboardTextSerializer"),props:{clipboardTextSerializer:()=>{const{editor:n}=this,{state:e,schema:t}=n,{doc:r,selection:i}=e,{ranges:o}=i,s=Math.min(...o.map(f=>f.$from.pos)),a=Math.max(...o.map(f=>f.$to.pos)),l=kp(t);return ix(r,{from:s,to:a},{...this.options.blockSeparator!==void 0?{blockSeparator:this.options.blockSeparator}:{},textSerializers:l})}}})]}}),m4=()=>({editor:n,view:e})=>(requestAnimationFrame(()=>{var t;n.isDestroyed||(e.dom.blur(),(t=window==null?void 0:window.getSelection())===null||t===void 0||t.removeAllRanges())}),!0),g4=(n=!1)=>({commands:e})=>e.setContent("",n),b4=()=>({state:n,tr:e,dispatch:t})=>{const{selection:r}=e,{ranges:i}=r;return t&&i.forEach(({$from:o,$to:s})=>{n.doc.nodesBetween(o.pos,s.pos,(a,l)=>{if(a.type.isText)return;const{doc:d,mapping:f}=e,h=d.resolve(f.map(l)),m=d.resolve(f.map(l+a.nodeSize)),g=h.blockRange(m);if(!g)return;const b=qs(g);if(a.type.isTextblock){const{defaultType:v}=h.parent.contentMatchAt(h.index());e.setNodeMarkup(g.start,v)}(b||b===0)&&e.lift(g,b)})}),!0},y4=n=>e=>n(e),v4=()=>({state:n,dispatch:e})=>Zv(n,e),x4=(n,e)=>({editor:t,tr:r})=>{const{state:i}=t,o=i.doc.slice(n.from,n.to);r.deleteRange(n.from,n.to);const s=r.mapping.map(e);return r.insert(s,o.content),r.setSelection(new pe(r.doc.resolve(s-1))),!0},w4=()=>({tr:n,dispatch:e})=>{const{selection:t}=n,r=t.$anchor.node();if(r.content.size>0)return!1;const i=n.selection.$anchor;for(let o=i.depth;o>0;o-=1)if(i.node(o).type===r.type){if(e){const a=i.before(o),l=i.after(o);n.delete(a,l).scrollIntoView()}return!0}return!1},k4=n=>({tr:e,state:t,dispatch:r})=>{const i=Tt(n,t.schema),o=e.selection.$anchor;for(let s=o.depth;s>0;s-=1)if(o.node(s).type===i){if(r){const l=o.before(s),d=o.after(s);e.delete(l,d).scrollIntoView()}return!0}return!1},S4=n=>({tr:e,dispatch:t})=>{const{from:r,to:i}=n;return t&&e.delete(r,i),!0},C4=()=>({state:n,dispatch:e})=>gp(n,e),E4=()=>({commands:n})=>n.keyboardShortcut("Enter"),_4=()=>({state:n,dispatch:e})=>$M(n,e);function gc(n,e,t={strict:!0}){const r=Object.keys(e);return r.length?r.every(i=>t.strict?e[i]===n[i]:wp(e[i])?e[i].test(n[i]):e[i]===n[i]):!0}function sx(n,e,t={}){return n.find(r=>r.type===e&&gc(Object.fromEntries(Object.keys(t).map(i=>[i,r.attrs[i]])),t))}function K1(n,e,t={}){return!!sx(n,e,t)}function Sp(n,e,t){var r;if(!n||!e)return;let i=n.parent.childAfter(n.parentOffset);if((!i.node||!i.node.marks.some(f=>f.type===e))&&(i=n.parent.childBefore(n.parentOffset)),!i.node||!i.node.marks.some(f=>f.type===e)||(t=t||((r=i.node.marks[0])===null||r===void 0?void 0:r.attrs),!sx([...i.node.marks],e,t)))return;let s=i.index,a=n.start()+i.offset,l=s+1,d=a+i.node.nodeSize;for(;s>0&&K1([...n.parent.child(s-1).marks],e,t);)s-=1,a-=n.parent.child(s).nodeSize;for(;l<n.parent.childCount&&K1([...n.parent.child(l).marks],e,t);)d+=n.parent.child(l).nodeSize,l+=1;return{from:a,to:d}}function Qi(n,e){if(typeof n=="string"){if(!e.marks[n])throw Error(`There is no mark type named '${n}'. Maybe you forgot to add the extension?`);return e.marks[n]}return n}const A4=(n,e={})=>({tr:t,state:r,dispatch:i})=>{const o=Qi(n,r.schema),{doc:s,selection:a}=t,{$from:l,from:d,to:f}=a;if(i){const h=Sp(l,o,e);if(h&&h.from<=d&&h.to>=f){const m=pe.create(s,h.from,h.to);t.setSelection(m)}}return!0},T4=n=>e=>{const t=typeof n=="function"?n(e):n;for(let r=0;r<t.length;r+=1)if(t[r](e))return!0;return!1};function Cp(n){return n instanceof pe}function ui(n=0,e=0,t=0){return Math.min(Math.max(n,e),t)}function ax(n,e=null){if(!e)return null;const t=Ce.atStart(n),r=Ce.atEnd(n);if(e==="start"||e===!0)return t;if(e==="end")return r;const i=t.from,o=r.to;return e==="all"?pe.create(n,ui(0,i,o),ui(n.content.size,i,o)):pe.create(n,ui(e,i,o),ui(e,i,o))}function D4(){return navigator.platform==="Android"||/android/i.test(navigator.userAgent)}function Ep(){return["iPad Simulator","iPhone Simulator","iPod Simulator","iPad","iPhone","iPod"].includes(navigator.platform)||navigator.userAgent.includes("Mac")&&"ontouchend"in document}const M4=(n=null,e={})=>({editor:t,view:r,tr:i,dispatch:o})=>{e={scrollIntoView:!0,...e};const s=()=>{(Ep()||D4())&&r.dom.focus(),requestAnimationFrame(()=>{t.isDestroyed||(r.focus(),e!=null&&e.scrollIntoView&&t.commands.scrollIntoView())})};if(r.hasFocus()&&n===null||n===!1)return!0;if(o&&n===null&&!Cp(t.state.selection))return s(),!0;const a=ax(i.doc,n)||t.state.selection,l=t.state.selection.eq(a);return o&&(l||i.setSelection(a),l&&i.storedMarks&&i.setStoredMarks(i.storedMarks),s()),!0},O4=(n,e)=>t=>n.every((r,i)=>e(r,{...t,index:i})),I4=(n,e)=>({tr:t,commands:r})=>r.insertContentAt({from:t.selection.from,to:t.selection.to},n,e),ux=n=>{const e=n.childNodes;for(let t=e.length-1;t>=0;t-=1){const r=e[t];r.nodeType===3&&r.nodeValue&&/^(\n\s\s|\n)$/.test(r.nodeValue)?n.removeChild(r):r.nodeType===1&&ux(r)}return n};function Al(n){const e=`<body>${n}</body>`,t=new window.DOMParser().parseFromString(e,"text/html").body;return ux(t)}function eu(n,e,t){if(n instanceof Ui||n instanceof q)return n;t={slice:!0,parseOptions:{},...t};const r=typeof n=="object"&&n!==null,i=typeof n=="string";if(r)try{if(Array.isArray(n)&&n.length>0)return q.fromArray(n.map(a=>e.nodeFromJSON(a)));const s=e.nodeFromJSON(n);return t.errorOnInvalidContent&&s.check(),s}catch(o){if(t.errorOnInvalidContent)throw new Error("[tiptap error]: Invalid JSON content",{cause:o});return console.warn("[tiptap warn]: Invalid content.","Passed value:",n,"Error:",o),eu("",e,t)}if(i){if(t.errorOnInvalidContent){let s=!1,a="";const l=new np({topNode:e.spec.topNode,marks:e.spec.marks,nodes:e.spec.nodes.append({__tiptap__private__unknown__catch__all__node:{content:"inline*",group:"block",parseDOM:[{tag:"*",getAttrs:d=>(s=!0,a=typeof d=="string"?d:d.outerHTML,null)}]}})});if(t.slice?_s.fromSchema(l).parseSlice(Al(n),t.parseOptions):_s.fromSchema(l).parse(Al(n),t.parseOptions),t.errorOnInvalidContent&&s)throw new Error("[tiptap error]: Invalid HTML content",{cause:new Error(`Invalid element found: ${a}`)})}const o=_s.fromSchema(e);return t.slice?o.parseSlice(Al(n),t.parseOptions).content:o.parse(Al(n),t.parseOptions)}return eu("",e,t)}function N4(n,e,t){const r=n.steps.length-1;if(r<e)return;const i=n.steps[r];if(!(i instanceof Ct||i instanceof _t))return;const o=n.mapping.maps[r];let s=0;o.forEach((a,l,d,f)=>{s===0&&(s=f)}),n.setSelection(Ce.near(n.doc.resolve(s),t))}const P4=n=>!("type"in n),F4=(n,e,t)=>({tr:r,dispatch:i,editor:o})=>{var s;if(i){t={parseOptions:o.options.parseOptions,updateSelection:!0,applyInputRules:!1,applyPasteRules:!1,...t};let a;const l=x=>{o.emit("contentError",{editor:o,error:x,disableCollaboration:()=>{o.storage.collaboration&&(o.storage.collaboration.isDisabled=!0)}})},d={preserveWhitespace:"full",...t.parseOptions};if(!t.errorOnInvalidContent&&!o.options.enableContentCheck&&o.options.emitContentError)try{eu(e,o.schema,{parseOptions:d,errorOnInvalidContent:!0})}catch(x){l(x)}try{a=eu(e,o.schema,{parseOptions:d,errorOnInvalidContent:(s=t.errorOnInvalidContent)!==null&&s!==void 0?s:o.options.enableContentCheck})}catch(x){return l(x),!1}let{from:f,to:h}=typeof n=="number"?{from:n,to:n}:{from:n.from,to:n.to},m=!0,g=!0;if((P4(a)?a:[a]).forEach(x=>{x.check(),m=m?x.isText&&x.marks.length===0:!1,g=g?x.isBlock:!1}),f===h&&g){const{parent:x}=r.doc.resolve(f);x.isTextblock&&!x.type.spec.code&&!x.childCount&&(f-=1,h+=1)}let v;if(m){if(Array.isArray(e))v=e.map(x=>x.text||"").join("");else if(e instanceof q){let x="";e.forEach(E=>{E.text&&(x+=E.text)}),v=x}else typeof e=="object"&&e&&e.text?v=e.text:v=e;r.insertText(v,f,h)}else v=a,r.replaceWith(f,h,v);t.updateSelection&&N4(r,r.steps.length-1,-1),t.applyInputRules&&r.setMeta("applyInputRules",{from:f,text:v}),t.applyPasteRules&&r.setMeta("applyPasteRules",{from:f,text:v})}return!0},R4=()=>({state:n,dispatch:e})=>RM(n,e),L4=()=>({state:n,dispatch:e})=>LM(n,e),B4=()=>({state:n,dispatch:e})=>Uv(n,e),$4=()=>({state:n,dispatch:e})=>Xv(n,e),z4=()=>({state:n,dispatch:e,tr:t})=>{try{const r=Tc(n.doc,n.selection.$from.pos,-1);return r==null?!1:(t.join(r,2),e&&e(t),!0)}catch{return!1}},H4=()=>({state:n,dispatch:e,tr:t})=>{try{const r=Tc(n.doc,n.selection.$from.pos,1);return r==null?!1:(t.join(r,2),e&&e(t),!0)}catch{return!1}},q4=()=>({state:n,dispatch:e})=>PM(n,e),V4=()=>({state:n,dispatch:e})=>FM(n,e);function lx(){return typeof navigator<"u"?/Mac/.test(navigator.platform):!1}function W4(n){const e=n.split(/-(?!$)/);let t=e[e.length-1];t==="Space"&&(t=" ");let r,i,o,s;for(let a=0;a<e.length-1;a+=1){const l=e[a];if(/^(cmd|meta|m)$/i.test(l))s=!0;else if(/^a(lt)?$/i.test(l))r=!0;else if(/^(c|ctrl|control)$/i.test(l))i=!0;else if(/^s(hift)?$/i.test(l))o=!0;else if(/^mod$/i.test(l))Ep()||lx()?s=!0:i=!0;else throw new Error(`Unrecognized modifier name: ${l}`)}return r&&(t=`Alt-${t}`),i&&(t=`Ctrl-${t}`),s&&(t=`Meta-${t}`),o&&(t=`Shift-${t}`),t}const U4=n=>({editor:e,view:t,tr:r,dispatch:i})=>{const o=W4(n).split(/-(?!$)/),s=o.find(d=>!["Alt","Ctrl","Meta","Shift"].includes(d)),a=new KeyboardEvent("keydown",{key:s==="Space"?" ":s,altKey:o.includes("Alt"),ctrlKey:o.includes("Ctrl"),metaKey:o.includes("Meta"),shiftKey:o.includes("Shift"),bubbles:!0,cancelable:!0}),l=e.captureTransaction(()=>{t.someProp("handleKeyDown",d=>d(t,a))});return l==null||l.steps.forEach(d=>{const f=d.map(r.mapping);f&&i&&r.maybeStep(f)}),!0};function tu(n,e,t={}){const{from:r,to:i,empty:o}=n.selection,s=e?Tt(e,n.schema):null,a=[];n.doc.nodesBetween(r,i,(h,m)=>{if(h.isText)return;const g=Math.max(r,m),b=Math.min(i,m+h.nodeSize);a.push({node:h,from:g,to:b})});const l=i-r,d=a.filter(h=>s?s.name===h.node.type.name:!0).filter(h=>gc(h.node.attrs,t,{strict:!1}));return o?!!d.length:d.reduce((h,m)=>h+m.to-m.from,0)>=l}const K4=(n,e={})=>({state:t,dispatch:r})=>{const i=Tt(n,t.schema);return tu(t,i,e)?BM(t,r):!1},j4=()=>({state:n,dispatch:e})=>Qv(n,e),G4=n=>({state:e,dispatch:t})=>{const r=Tt(n,e.schema);return YM(r)(e,t)},X4=()=>({state:n,dispatch:e})=>Jv(n,e);function $c(n,e){return e.nodes[n]?"node":e.marks[n]?"mark":null}function j1(n,e){const t=typeof e=="string"?[e]:e;return Object.keys(n).reduce((r,i)=>(t.includes(i)||(r[i]=n[i]),r),{})}const Y4=(n,e)=>({tr:t,state:r,dispatch:i})=>{let o=null,s=null;const a=$c(typeof n=="string"?n:n.name,r.schema);return a?(a==="node"&&(o=Tt(n,r.schema)),a==="mark"&&(s=Qi(n,r.schema)),i&&t.selection.ranges.forEach(l=>{r.doc.nodesBetween(l.$from.pos,l.$to.pos,(d,f)=>{o&&o===d.type&&t.setNodeMarkup(f,void 0,j1(d.attrs,e)),s&&d.marks.length&&d.marks.forEach(h=>{s===h.type&&t.addMark(f,f+d.nodeSize,s.create(j1(h.attrs,e)))})})}),!0):!1},J4=()=>({tr:n,dispatch:e})=>(e&&n.scrollIntoView(),!0),Z4=()=>({tr:n,dispatch:e})=>{if(e){const t=new Bn(n.doc);n.setSelection(t)}return!0},Q4=()=>({state:n,dispatch:e})=>jv(n,e),e8=()=>({state:n,dispatch:e})=>Yv(n,e),t8=()=>({state:n,dispatch:e})=>qM(n,e),n8=()=>({state:n,dispatch:e})=>UM(n,e),r8=()=>({state:n,dispatch:e})=>WM(n,e);function Lh(n,e,t={},r={}){return eu(n,e,{slice:!1,parseOptions:t,errorOnInvalidContent:r.errorOnInvalidContent})}const i8=(n,e=!1,t={},r={})=>({editor:i,tr:o,dispatch:s,commands:a})=>{var l,d;const{doc:f}=o;if(t.preserveWhitespace!=="full"){const h=Lh(n,i.schema,t,{errorOnInvalidContent:(l=r.errorOnInvalidContent)!==null&&l!==void 0?l:i.options.enableContentCheck});return s&&o.replaceWith(0,f.content.size,h).setMeta("preventUpdate",!e),!0}return s&&o.setMeta("preventUpdate",!e),a.insertContentAt({from:0,to:f.content.size},n,{parseOptions:t,errorOnInvalidContent:(d=r.errorOnInvalidContent)!==null&&d!==void 0?d:i.options.enableContentCheck})};function cx(n,e){const t=Qi(e,n.schema),{from:r,to:i,empty:o}=n.selection,s=[];o?(n.storedMarks&&s.push(...n.storedMarks),s.push(...n.selection.$head.marks())):n.doc.nodesBetween(r,i,l=>{s.push(...l.marks)});const a=s.find(l=>l.type.name===t.name);return a?{...a.attrs}:{}}function o8(n){for(let e=0;e<n.edgeCount;e+=1){const{type:t}=n.edge(e);if(t.isTextblock&&!t.hasRequiredAttrs())return t}return null}function s8(n,e){for(let t=n.depth;t>0;t-=1){const r=n.node(t);if(e(r))return{pos:t>0?n.before(t):0,start:n.start(t),depth:t,node:r}}}function _p(n){return e=>s8(e.$from,n)}function dx(n,e){const t={from:0,to:n.content.size};return ix(n,t,e)}function a8(n,e){const t=Tt(e,n.schema),{from:r,to:i}=n.selection,o=[];n.doc.nodesBetween(r,i,a=>{o.push(a)});const s=o.reverse().find(a=>a.type.name===t.name);return s?{...s.attrs}:{}}function u8(n,e){const t=$c(typeof e=="string"?e:e.name,n.schema);return t==="node"?a8(n,e):t==="mark"?cx(n,e):{}}function fx(n,e,t){const r=[];return n===e?t.resolve(n).marks().forEach(i=>{const o=t.resolve(n),s=Sp(o,i.type);s&&r.push({mark:i,...s})}):t.nodesBetween(n,e,(i,o)=>{!i||(i==null?void 0:i.nodeSize)===void 0||r.push(...i.marks.map(s=>({from:o,to:o+i.nodeSize,mark:s})))}),r}function Kl(n,e,t){return Object.fromEntries(Object.entries(t).filter(([r])=>{const i=n.find(o=>o.type===e&&o.name===r);return i?i.attribute.keepOnSplit:!1}))}function Bh(n,e,t={}){const{empty:r,ranges:i}=n.selection,o=e?Qi(e,n.schema):null;if(r)return!!(n.storedMarks||n.selection.$from.marks()).filter(h=>o?o.name===h.type.name:!0).find(h=>gc(h.attrs,t,{strict:!1}));let s=0;const a=[];if(i.forEach(({$from:h,$to:m})=>{const g=h.pos,b=m.pos;n.doc.nodesBetween(g,b,(v,x)=>{if(!v.isText&&!v.marks.length)return;const E=Math.max(g,x),A=Math.min(b,x+v.nodeSize),M=A-E;s+=M,a.push(...v.marks.map(C=>({mark:C,from:E,to:A})))})}),s===0)return!1;const l=a.filter(h=>o?o.name===h.mark.type.name:!0).filter(h=>gc(h.mark.attrs,t,{strict:!1})).reduce((h,m)=>h+m.to-m.from,0),d=a.filter(h=>o?h.mark.type!==o&&h.mark.type.excludes(o):!0).reduce((h,m)=>h+m.to-m.from,0);return(l>0?l+d:l)>=s}function l8(n,e,t={}){if(!e)return tu(n,null,t)||Bh(n,null,t);const r=$c(e,n.schema);return r==="node"?tu(n,e,t):r==="mark"?Bh(n,e,t):!1}function G1(n,e){const{nodeExtensions:t}=Rc(e),r=t.find(s=>s.name===n);if(!r)return!1;const i={name:r.name,options:r.options,storage:r.storage},o=De(Z(r,"group",i));return typeof o!="string"?!1:o.split(" ").includes("list")}function Ap(n,{checkChildren:e=!0,ignoreWhitespace:t=!1}={}){var r;if(t){if(n.type.name==="hardBreak")return!0;if(n.isText)return/^\s*$/m.test((r=n.text)!==null&&r!==void 0?r:"")}if(n.isText)return!n.text;if(n.isAtom||n.isLeaf)return!1;if(n.content.childCount===0)return!0;if(e){let i=!0;return n.content.forEach(o=>{i!==!1&&(Ap(o,{ignoreWhitespace:t,checkChildren:e})||(i=!1))}),i}return!1}function hx(n){return n instanceof re}function px(n,e,t){const i=n.state.doc.content.size,o=ui(e,0,i),s=ui(t,0,i),a=n.coordsAtPos(o),l=n.coordsAtPos(s,-1),d=Math.min(a.top,l.top),f=Math.max(a.bottom,l.bottom),h=Math.min(a.left,l.left),m=Math.max(a.right,l.right),g=m-h,b=f-d,E={top:d,bottom:f,left:h,right:m,width:g,height:b,x:h,y:d};return{...E,toJSON:()=>E}}function c8(n,e,t){var r;const{selection:i}=e;let o=null;if(Cp(i)&&(o=i.$cursor),o){const a=(r=n.storedMarks)!==null&&r!==void 0?r:o.marks();return!!t.isInSet(a)||!a.some(l=>l.type.excludes(t))}const{ranges:s}=i;return s.some(({$from:a,$to:l})=>{let d=a.depth===0?n.doc.inlineContent&&n.doc.type.allowsMarkType(t):!1;return n.doc.nodesBetween(a.pos,l.pos,(f,h,m)=>{if(d)return!1;if(f.isInline){const g=!m||m.type.allowsMarkType(t),b=!!t.isInSet(f.marks)||!f.marks.some(v=>v.type.excludes(t));d=g&&b}return!d}),d})}const d8=(n,e={})=>({tr:t,state:r,dispatch:i})=>{const{selection:o}=t,{empty:s,ranges:a}=o,l=Qi(n,r.schema);if(i)if(s){const d=cx(r,l);t.addStoredMark(l.create({...d,...e}))}else a.forEach(d=>{const f=d.$from.pos,h=d.$to.pos;r.doc.nodesBetween(f,h,(m,g)=>{const b=Math.max(g,f),v=Math.min(g+m.nodeSize,h);m.marks.find(E=>E.type===l)?m.marks.forEach(E=>{l===E.type&&t.addMark(b,v,l.create({...E.attrs,...e}))}):t.addMark(b,v,l.create(e))})});return c8(r,t,l)},f8=(n,e)=>({tr:t})=>(t.setMeta(n,e),!0),h8=(n,e={})=>({state:t,dispatch:r,chain:i})=>{const o=Tt(n,t.schema);let s;return t.selection.$anchor.sameParent(t.selection.$head)&&(s=t.selection.$anchor.parent.attrs),o.isTextblock?i().command(({commands:a})=>q1(o,{...s,...e})(t)?!0:a.clearNodes()).command(({state:a})=>q1(o,{...s,...e})(a,r)).run():(console.warn('[tiptap warn]: Currently "setNode()" only supports text block nodes.'),!1)},p8=n=>({tr:e,dispatch:t})=>{if(t){const{doc:r}=e,i=ui(n,0,r.content.size),o=re.create(r,i);e.setSelection(o)}return!0},m8=n=>({tr:e,dispatch:t})=>{if(t){const{doc:r}=e,{from:i,to:o}=typeof n=="number"?{from:n,to:n}:n,s=pe.atStart(r).from,a=pe.atEnd(r).to,l=ui(i,s,a),d=ui(o,s,a),f=pe.create(r,l,d);e.setSelection(f)}return!0},g8=n=>({state:e,dispatch:t})=>{const r=Tt(n,e.schema);return QM(r)(e,t)};function X1(n,e){const t=n.storedMarks||n.selection.$to.parentOffset&&n.selection.$from.marks();if(t){const r=t.filter(i=>e==null?void 0:e.includes(i.type.name));n.tr.ensureMarks(r)}}const b8=({keepMarks:n=!0}={})=>({tr:e,state:t,dispatch:r,editor:i})=>{const{selection:o,doc:s}=e,{$from:a,$to:l}=o,d=i.extensionManager.attributes,f=Kl(d,a.node().type.name,a.node().attrs);if(o instanceof re&&o.node.isBlock)return!a.parentOffset||!di(s,a.pos)?!1:(r&&(n&&X1(t,i.extensionManager.splittableMarks),e.split(a.pos).scrollIntoView()),!0);if(!a.parent.isBlock)return!1;const h=l.parentOffset===l.parent.content.size,m=a.depth===0?void 0:o8(a.node(-1).contentMatchAt(a.indexAfter(-1)));let g=h&&m?[{type:m,attrs:f}]:void 0,b=di(e.doc,e.mapping.map(a.pos),1,g);if(!g&&!b&&di(e.doc,e.mapping.map(a.pos),1,m?[{type:m}]:void 0)&&(b=!0,g=m?[{type:m,attrs:f}]:void 0),r){if(b&&(o instanceof pe&&e.deleteSelection(),e.split(e.mapping.map(a.pos),1,g),m&&!h&&!a.parentOffset&&a.parent.type!==m)){const v=e.mapping.map(a.before()),x=e.doc.resolve(v);a.node(-1).canReplaceWith(x.index(),x.index()+1,m)&&e.setNodeMarkup(e.mapping.map(a.before()),m)}n&&X1(t,i.extensionManager.splittableMarks),e.scrollIntoView()}return b},y8=(n,e={})=>({tr:t,state:r,dispatch:i,editor:o})=>{var s;const a=Tt(n,r.schema),{$from:l,$to:d}=r.selection,f=r.selection.node;if(f&&f.isBlock||l.depth<2||!l.sameParent(d))return!1;const h=l.node(-1);if(h.type!==a)return!1;const m=o.extensionManager.attributes;if(l.parent.content.size===0&&l.node(-1).childCount===l.indexAfter(-1)){if(l.depth===2||l.node(-3).type!==a||l.index(-2)!==l.node(-2).childCount-1)return!1;if(i){let E=q.empty;const A=l.index(-1)?1:l.index(-2)?2:3;for(let V=l.depth-A;V>=l.depth-3;V-=1)E=q.from(l.node(V).copy(E));const M=l.indexAfter(-1)<l.node(-2).childCount?1:l.indexAfter(-2)<l.node(-3).childCount?2:3,C={...Kl(m,l.node().type.name,l.node().attrs),...e},P=((s=a.contentMatch.defaultType)===null||s===void 0?void 0:s.createAndFill(C))||void 0;E=E.append(q.from(a.createAndFill(null,P)||void 0));const N=l.before(l.depth-(A-1));t.replace(N,l.after(-M),new X(E,4-A,0));let W=-1;t.doc.nodesBetween(N,t.doc.content.size,(V,U)=>{if(W>-1)return!1;V.isTextblock&&V.content.size===0&&(W=U+1)}),W>-1&&t.setSelection(pe.near(t.doc.resolve(W))),t.scrollIntoView()}return!0}const g=d.pos===l.end()?h.contentMatchAt(0).defaultType:null,b={...Kl(m,h.type.name,h.attrs),...e},v={...Kl(m,l.node().type.name,l.node().attrs),...e};t.delete(l.pos,d.pos);const x=g?[{type:a,attrs:b},{type:g,attrs:v}]:[{type:a,attrs:b}];if(!di(t.doc,l.pos,2))return!1;if(i){const{selection:E,storedMarks:A}=r,{splittableMarks:M}=o.extensionManager,C=A||E.$to.parentOffset&&E.$from.marks();if(t.split(l.pos,2,x).scrollIntoView(),!C||!i)return!0;const P=C.filter(N=>M.includes(N.type.name));t.ensureMarks(P)}return!0},qf=(n,e)=>{const t=_p(s=>s.type===e)(n.selection);if(!t)return!0;const r=n.doc.resolve(Math.max(0,t.pos-1)).before(t.depth);if(r===void 0)return!0;const i=n.doc.nodeAt(r);return t.node.type===(i==null?void 0:i.type)&&Ji(n.doc,t.pos)&&n.join(t.pos),!0},Vf=(n,e)=>{const t=_p(s=>s.type===e)(n.selection);if(!t)return!0;const r=n.doc.resolve(t.start).after(t.depth);if(r===void 0)return!0;const i=n.doc.nodeAt(r);return t.node.type===(i==null?void 0:i.type)&&Ji(n.doc,r)&&n.join(r),!0},v8=(n,e,t,r={})=>({editor:i,tr:o,state:s,dispatch:a,chain:l,commands:d,can:f})=>{const{extensions:h,splittableMarks:m}=i.extensionManager,g=Tt(n,s.schema),b=Tt(e,s.schema),{selection:v,storedMarks:x}=s,{$from:E,$to:A}=v,M=E.blockRange(A),C=x||v.$to.parentOffset&&v.$from.marks();if(!M)return!1;const P=_p(N=>G1(N.type.name,h))(v);if(M.depth>=1&&P&&M.depth-P.depth<=1){if(P.node.type===g)return d.liftListItem(b);if(G1(P.node.type.name,h)&&g.validContent(P.node.content)&&a)return l().command(()=>(o.setNodeMarkup(P.pos,g),!0)).command(()=>qf(o,g)).command(()=>Vf(o,g)).run()}return!t||!C||!a?l().command(()=>f().wrapInList(g,r)?!0:d.clearNodes()).wrapInList(g,r).command(()=>qf(o,g)).command(()=>Vf(o,g)).run():l().command(()=>{const N=f().wrapInList(g,r),W=C.filter(V=>m.includes(V.type.name));return o.ensureMarks(W),N?!0:d.clearNodes()}).wrapInList(g,r).command(()=>qf(o,g)).command(()=>Vf(o,g)).run()},x8=(n,e={},t={})=>({state:r,commands:i})=>{const{extendEmptyMarkRange:o=!1}=t,s=Qi(n,r.schema);return Bh(r,s,e)?i.unsetMark(s,{extendEmptyMarkRange:o}):i.setMark(s,e)},w8=(n,e,t={})=>({state:r,commands:i})=>{const o=Tt(n,r.schema),s=Tt(e,r.schema),a=tu(r,o,t);let l;return r.selection.$anchor.sameParent(r.selection.$head)&&(l=r.selection.$anchor.parent.attrs),a?i.setNode(s,l):i.setNode(o,{...l,...t})},k8=(n,e={})=>({state:t,commands:r})=>{const i=Tt(n,t.schema);return tu(t,i,e)?r.lift(i):r.wrapIn(i,e)},S8=()=>({state:n,dispatch:e})=>{const t=n.plugins;for(let r=0;r<t.length;r+=1){const i=t[r];let o;if(i.spec.isInputRules&&(o=i.getState(n))){if(e){const s=n.tr,a=o.transform;for(let l=a.steps.length-1;l>=0;l-=1)s.step(a.steps[l].invert(a.docs[l]));if(o.text){const l=s.doc.resolve(o.from).marks();s.replaceWith(o.from,o.to,n.schema.text(o.text,l))}else s.delete(o.from,o.to)}return!0}}return!1},C8=()=>({tr:n,dispatch:e})=>{const{selection:t}=n,{empty:r,ranges:i}=t;return r||e&&i.forEach(o=>{n.removeMark(o.$from.pos,o.$to.pos)}),!0},E8=(n,e={})=>({tr:t,state:r,dispatch:i})=>{var o;const{extendEmptyMarkRange:s=!1}=e,{selection:a}=t,l=Qi(n,r.schema),{$from:d,empty:f,ranges:h}=a;if(!i)return!0;if(f&&s){let{from:m,to:g}=a;const b=(o=d.marks().find(x=>x.type===l))===null||o===void 0?void 0:o.attrs,v=Sp(d,l,b);v&&(m=v.from,g=v.to),t.removeMark(m,g,l)}else h.forEach(m=>{t.removeMark(m.$from.pos,m.$to.pos,l)});return t.removeStoredMark(l),!0},_8=(n,e={})=>({tr:t,state:r,dispatch:i})=>{let o=null,s=null;const a=$c(typeof n=="string"?n:n.name,r.schema);return a?(a==="node"&&(o=Tt(n,r.schema)),a==="mark"&&(s=Qi(n,r.schema)),i&&t.selection.ranges.forEach(l=>{const d=l.$from.pos,f=l.$to.pos;let h,m,g,b;t.selection.empty?r.doc.nodesBetween(d,f,(v,x)=>{o&&o===v.type&&(g=Math.max(x,d),b=Math.min(x+v.nodeSize,f),h=x,m=v)}):r.doc.nodesBetween(d,f,(v,x)=>{x<d&&o&&o===v.type&&(g=Math.max(x,d),b=Math.min(x+v.nodeSize,f),h=x,m=v),x>=d&&x<=f&&(o&&o===v.type&&t.setNodeMarkup(x,void 0,{...v.attrs,...e}),s&&v.marks.length&&v.marks.forEach(E=>{if(s===E.type){const A=Math.max(x,d),M=Math.min(x+v.nodeSize,f);t.addMark(A,M,s.create({...E.attrs,...e}))}}))}),m&&(h!==void 0&&t.setNodeMarkup(h,void 0,{...m.attrs,...e}),s&&m.marks.length&&m.marks.forEach(v=>{s===v.type&&t.addMark(g,b,s.create({...v.attrs,...e}))}))}),!0):!1},A8=(n,e={})=>({state:t,dispatch:r})=>{const i=Tt(n,t.schema);return KM(i,e)(t,r)},T8=(n,e={})=>({state:t,dispatch:r})=>{const i=Tt(n,t.schema);return jM(i,e)(t,r)};var D8=Object.freeze({__proto__:null,blur:m4,clearContent:g4,clearNodes:b4,command:y4,createParagraphNear:v4,cut:x4,deleteCurrentNode:w4,deleteNode:k4,deleteRange:S4,deleteSelection:C4,enter:E4,exitCode:_4,extendMarkRange:A4,first:T4,focus:M4,forEach:O4,insertContent:I4,insertContentAt:F4,joinBackward:B4,joinDown:L4,joinForward:$4,joinItemBackward:z4,joinItemForward:H4,joinTextblockBackward:q4,joinTextblockForward:V4,joinUp:R4,keyboardShortcut:U4,lift:K4,liftEmptyBlock:j4,liftListItem:G4,newlineInCode:X4,resetAttributes:Y4,scrollIntoView:J4,selectAll:Z4,selectNodeBackward:Q4,selectNodeForward:e8,selectParentNode:t8,selectTextblockEnd:n8,selectTextblockStart:r8,setContent:i8,setMark:d8,setMeta:f8,setNode:h8,setNodeSelection:p8,setTextSelection:m8,sinkListItem:g8,splitBlock:b8,splitListItem:y8,toggleList:v8,toggleMark:x8,toggleNode:w8,toggleWrap:k8,undoInputRule:S8,unsetAllMarks:C8,unsetMark:E8,updateAttributes:_8,wrapIn:A8,wrapInList:T8});const mx=bt.create({name:"commands",addCommands(){return{...D8}}}),gx=bt.create({name:"drop",addProseMirrorPlugins(){return[new zt({key:new Hn("tiptapDrop"),props:{handleDrop:(n,e,t,r)=>{this.editor.emit("drop",{editor:this.editor,event:e,slice:t,moved:r})}}})]}}),bx=bt.create({name:"editable",addProseMirrorPlugins(){return[new zt({key:new Hn("editable"),props:{editable:()=>this.editor.options.editable}})]}}),yx=new Hn("focusEvents"),vx=bt.create({name:"focusEvents",addProseMirrorPlugins(){const{editor:n}=this;return[new zt({key:yx,props:{handleDOMEvents:{focus:(e,t)=>{n.isFocused=!0;const r=n.state.tr.setMeta("focus",{event:t}).setMeta("addToHistory",!1);return e.dispatch(r),!1},blur:(e,t)=>{n.isFocused=!1;const r=n.state.tr.setMeta("blur",{event:t}).setMeta("addToHistory",!1);return e.dispatch(r),!1}}}})]}}),xx=bt.create({name:"keymap",addKeyboardShortcuts(){const n=()=>this.editor.commands.first(({commands:s})=>[()=>s.undoInputRule(),()=>s.command(({tr:a})=>{const{selection:l,doc:d}=a,{empty:f,$anchor:h}=l,{pos:m,parent:g}=h,b=h.parent.isTextblock&&m>0?a.doc.resolve(m-1):h,v=b.parent.type.spec.isolating,x=h.pos-h.parentOffset,E=v&&b.parent.childCount===1?x===h.pos:Ce.atStart(d).from===m;return!f||!g.type.isTextblock||g.textContent.length||!E||E&&h.parent.type.name==="paragraph"?!1:s.clearNodes()}),()=>s.deleteSelection(),()=>s.joinBackward(),()=>s.selectNodeBackward()]),e=()=>this.editor.commands.first(({commands:s})=>[()=>s.deleteSelection(),()=>s.deleteCurrentNode(),()=>s.joinForward(),()=>s.selectNodeForward()]),r={Enter:()=>this.editor.commands.first(({commands:s})=>[()=>s.newlineInCode(),()=>s.createParagraphNear(),()=>s.liftEmptyBlock(),()=>s.splitBlock()]),"Mod-Enter":()=>this.editor.commands.exitCode(),Backspace:n,"Mod-Backspace":n,"Shift-Backspace":n,Delete:e,"Mod-Delete":e,"Mod-a":()=>this.editor.commands.selectAll()},i={...r},o={...r,"Ctrl-h":n,"Alt-Backspace":n,"Ctrl-d":e,"Ctrl-Alt-Backspace":e,"Alt-Delete":e,"Alt-d":e,"Ctrl-a":()=>this.editor.commands.selectTextblockStart(),"Ctrl-e":()=>this.editor.commands.selectTextblockEnd()};return Ep()||lx()?o:i},addProseMirrorPlugins(){return[new zt({key:new Hn("clearDocument"),appendTransaction:(n,e,t)=>{if(n.some(v=>v.getMeta("composition")))return;const r=n.some(v=>v.docChanged)&&!e.doc.eq(t.doc),i=n.some(v=>v.getMeta("preventClearDocument"));if(!r||i)return;const{empty:o,from:s,to:a}=e.selection,l=Ce.atStart(e.doc).from,d=Ce.atEnd(e.doc).to;if(o||!(s===l&&a===d)||!Ap(t.doc))return;const m=t.tr,g=Pc({state:t,transaction:m}),{commands:b}=new Fc({editor:this.editor,state:g});if(b.clearNodes(),!!m.steps.length)return m}})]}}),wx=bt.create({name:"paste",addProseMirrorPlugins(){return[new zt({key:new Hn("tiptapPaste"),props:{handlePaste:(n,e,t)=>{this.editor.emit("paste",{editor:this.editor,event:e,slice:t})}}})]}}),kx=bt.create({name:"tabindex",addProseMirrorPlugins(){return[new zt({key:new Hn("tabindex"),props:{attributes:()=>this.editor.isEditable?{tabindex:"0"}:{}}})]}});var M8=Object.freeze({__proto__:null,ClipboardTextSerializer:ox,Commands:mx,Drop:gx,Editable:bx,FocusEvents:vx,Keymap:xx,Paste:wx,Tabindex:kx,focusEventsPluginKey:yx});class ko{get name(){return this.node.type.name}constructor(e,t,r=!1,i=null){this.currentNode=null,this.actualDepth=null,this.isBlock=r,this.resolvedPos=e,this.editor=t,this.currentNode=i}get node(){return this.currentNode||this.resolvedPos.node()}get element(){return this.editor.view.domAtPos(this.pos).node}get depth(){var e;return(e=this.actualDepth)!==null&&e!==void 0?e:this.resolvedPos.depth}get pos(){return this.resolvedPos.pos}get content(){return this.node.content}set content(e){let t=this.from,r=this.to;if(this.isBlock){if(this.content.size===0){console.error(`You cant set content on a block node. Tried to set content on ${this.name} at ${this.pos}`);return}t=this.from+1,r=this.to-1}this.editor.commands.insertContentAt({from:t,to:r},e)}get attributes(){return this.node.attrs}get textContent(){return this.node.textContent}get size(){return this.node.nodeSize}get from(){return this.isBlock?this.pos:this.resolvedPos.start(this.resolvedPos.depth)}get range(){return{from:this.from,to:this.to}}get to(){return this.isBlock?this.pos+this.size:this.resolvedPos.end(this.resolvedPos.depth)+(this.node.isText?0:1)}get parent(){if(this.depth===0)return null;const e=this.resolvedPos.start(this.resolvedPos.depth-1),t=this.resolvedPos.doc.resolve(e);return new ko(t,this.editor)}get before(){let e=this.resolvedPos.doc.resolve(this.from-(this.isBlock?1:2));return e.depth!==this.depth&&(e=this.resolvedPos.doc.resolve(this.from-3)),new ko(e,this.editor)}get after(){let e=this.resolvedPos.doc.resolve(this.to+(this.isBlock?2:1));return e.depth!==this.depth&&(e=this.resolvedPos.doc.resolve(this.to+3)),new ko(e,this.editor)}get children(){const e=[];return this.node.content.forEach((t,r)=>{const i=t.isBlock&&!t.isTextblock,o=t.isAtom&&!t.isText,s=this.pos+r+(o?0:1);if(s<0||s>this.resolvedPos.doc.nodeSize-2)return;const a=this.resolvedPos.doc.resolve(s);if(!i&&a.depth<=this.depth)return;const l=new ko(a,this.editor,i,i?t:null);i&&(l.actualDepth=this.depth+1),e.push(new ko(a,this.editor,i,i?t:null))}),e}get firstChild(){return this.children[0]||null}get lastChild(){const e=this.children;return e[e.length-1]||null}closest(e,t={}){let r=null,i=this.parent;for(;i&&!r;){if(i.node.type.name===e)if(Object.keys(t).length>0){const o=i.node.attrs,s=Object.keys(t);for(let a=0;a<s.length;a+=1){const l=s[a];if(o[l]!==t[l])break}}else r=i;i=i.parent}return r}querySelector(e,t={}){return this.querySelectorAll(e,t,!0)[0]||null}querySelectorAll(e,t={},r=!1){let i=[];if(!this.children||this.children.length===0)return i;const o=Object.keys(t);return this.children.forEach(s=>{r&&i.length>0||(s.node.type.name===e&&o.every(l=>t[l]===s.node.attrs[l])&&i.push(s),!(r&&i.length>0)&&(i=i.concat(s.querySelectorAll(e,t,r))))}),i}setAttribute(e){const{tr:t}=this.editor.state;t.setNodeMarkup(this.from,void 0,{...this.node.attrs,...e}),this.editor.view.dispatch(t)}}const O8=`.ProseMirror {
  position: relative;
}

.ProseMirror {
  word-wrap: break-word;
  white-space: pre-wrap;
  white-space: break-spaces;
  -webkit-font-variant-ligatures: none;
  font-variant-ligatures: none;
  font-feature-settings: "liga" 0; /* the above doesn't seem to work in Edge */
}

.ProseMirror [contenteditable="false"] {
  white-space: normal;
}

.ProseMirror [contenteditable="false"] [contenteditable="true"] {
  white-space: pre-wrap;
}

.ProseMirror pre {
  white-space: pre-wrap;
}

img.ProseMirror-separator {
  display: inline !important;
  border: none !important;
  margin: 0 !important;
  width: 0 !important;
  height: 0 !important;
}

.ProseMirror-gapcursor {
  display: none;
  pointer-events: none;
  position: absolute;
  margin: 0;
}

.ProseMirror-gapcursor:after {
  content: "";
  display: block;
  position: absolute;
  top: -2px;
  width: 20px;
  border-top: 1px solid black;
  animation: ProseMirror-cursor-blink 1.1s steps(2, start) infinite;
}

@keyframes ProseMirror-cursor-blink {
  to {
    visibility: hidden;
  }
}

.ProseMirror-hideselection *::selection {
  background: transparent;
}

.ProseMirror-hideselection *::-moz-selection {
  background: transparent;
}

.ProseMirror-hideselection * {
  caret-color: transparent;
}

.ProseMirror-focused .ProseMirror-gapcursor {
  display: block;
}

.tippy-box[data-animation=fade][data-state=hidden] {
  opacity: 0
}`;function I8(n,e,t){const r=document.querySelector("style[data-tiptap-style]");if(r!==null)return r;const i=document.createElement("style");return e&&i.setAttribute("nonce",e),i.setAttribute("data-tiptap-style",""),i.innerHTML=n,document.getElementsByTagName("head")[0].appendChild(i),i}class Y1 extends e4{constructor(e={}){super(),this.isFocused=!1,this.isInitialized=!1,this.extensionStorage={},this.options={element:document.createElement("div"),content:"",injectCSS:!0,injectNonce:void 0,extensions:[],autofocus:!1,editable:!0,editorProps:{},parseOptions:{},coreExtensionOptions:{},enableInputRules:!0,enablePasteRules:!0,enableCoreExtensions:!0,enableContentCheck:!1,emitContentError:!1,onBeforeCreate:()=>null,onCreate:()=>null,onUpdate:()=>null,onSelectionUpdate:()=>null,onTransaction:()=>null,onFocus:()=>null,onBlur:()=>null,onDestroy:()=>null,onContentError:({error:t})=>{throw t},onPaste:()=>null,onDrop:()=>null},this.isCapturingTransaction=!1,this.capturedTransaction=null,this.setOptions(e),this.createExtensionManager(),this.createCommandManager(),this.createSchema(),this.on("beforeCreate",this.options.onBeforeCreate),this.emit("beforeCreate",{editor:this}),this.on("contentError",this.options.onContentError),this.createView(),this.injectCSS(),this.on("create",this.options.onCreate),this.on("update",this.options.onUpdate),this.on("selectionUpdate",this.options.onSelectionUpdate),this.on("transaction",this.options.onTransaction),this.on("focus",this.options.onFocus),this.on("blur",this.options.onBlur),this.on("destroy",this.options.onDestroy),this.on("drop",({event:t,slice:r,moved:i})=>this.options.onDrop(t,r,i)),this.on("paste",({event:t,slice:r})=>this.options.onPaste(t,r)),window.setTimeout(()=>{this.isDestroyed||(this.commands.focus(this.options.autofocus),this.emit("create",{editor:this}),this.isInitialized=!0)},0)}get storage(){return this.extensionStorage}get commands(){return this.commandManager.commands}chain(){return this.commandManager.chain()}can(){return this.commandManager.can()}injectCSS(){this.options.injectCSS&&document&&(this.css=I8(O8,this.options.injectNonce))}setOptions(e={}){this.options={...this.options,...e},!(!this.view||!this.state||this.isDestroyed)&&(this.options.editorProps&&this.view.setProps(this.options.editorProps),this.view.updateState(this.state))}setEditable(e,t=!0){this.setOptions({editable:e}),t&&this.emit("update",{editor:this,transaction:this.state.tr})}get isEditable(){return this.options.editable&&this.view&&this.view.editable}get state(){return this.view.state}registerPlugin(e,t){const r=rx(t)?t(e,[...this.state.plugins]):[...this.state.plugins,e],i=this.state.reconfigure({plugins:r});return this.view.updateState(i),i}unregisterPlugin(e){if(this.isDestroyed)return;const t=this.state.plugins;let r=t;if([].concat(e).forEach(o=>{const s=typeof o=="string"?`${o}$`:o.key;r=r.filter(a=>!a.key.startsWith(s))}),t.length===r.length)return;const i=this.state.reconfigure({plugins:r});return this.view.updateState(i),i}createExtensionManager(){var e,t;const i=[...this.options.enableCoreExtensions?[bx,ox.configure({blockSeparator:(t=(e=this.options.coreExtensionOptions)===null||e===void 0?void 0:e.clipboardTextSerializer)===null||t===void 0?void 0:t.blockSeparator}),mx,vx,xx,kx,gx,wx].filter(o=>typeof this.options.enableCoreExtensions=="object"?this.options.enableCoreExtensions[o.name]!==!1:!0):[],...this.options.extensions].filter(o=>["extension","node","mark"].includes(o==null?void 0:o.type));this.extensionManager=new ks(i,this)}createCommandManager(){this.commandManager=new Fc({editor:this})}createSchema(){this.schema=this.extensionManager.schema}createView(){var e;let t;try{t=Lh(this.options.content,this.schema,this.options.parseOptions,{errorOnInvalidContent:this.options.enableContentCheck})}catch(s){if(!(s instanceof Error)||!["[tiptap error]: Invalid JSON content","[tiptap error]: Invalid HTML content"].includes(s.message))throw s;this.emit("contentError",{editor:this,error:s,disableCollaboration:()=>{this.storage.collaboration&&(this.storage.collaboration.isDisabled=!0),this.options.extensions=this.options.extensions.filter(a=>a.name!=="collaboration"),this.createExtensionManager()}}),t=Lh(this.options.content,this.schema,this.options.parseOptions,{errorOnInvalidContent:!1})}const r=ax(t,this.options.autofocus);this.view=new qv(this.options.element,{...this.options.editorProps,attributes:{role:"textbox",...(e=this.options.editorProps)===null||e===void 0?void 0:e.attributes},dispatchTransaction:this.dispatchTransaction.bind(this),state:ws.create({doc:t,selection:r||void 0})});const i=this.state.reconfigure({plugins:this.extensionManager.plugins});this.view.updateState(i),this.createNodeViews(),this.prependClass();const o=this.view.dom;o.editor=this}createNodeViews(){this.view.isDestroyed||this.view.setProps({nodeViews:this.extensionManager.nodeViews})}prependClass(){this.view.dom.className=`tiptap ${this.view.dom.className}`}captureTransaction(e){this.isCapturingTransaction=!0,e(),this.isCapturingTransaction=!1;const t=this.capturedTransaction;return this.capturedTransaction=null,t}dispatchTransaction(e){if(this.view.isDestroyed)return;if(this.isCapturingTransaction){if(!this.capturedTransaction){this.capturedTransaction=e;return}e.steps.forEach(s=>{var a;return(a=this.capturedTransaction)===null||a===void 0?void 0:a.step(s)});return}const t=this.state.apply(e),r=!this.state.selection.eq(t.selection);this.emit("beforeTransaction",{editor:this,transaction:e,nextState:t}),this.view.updateState(t),this.emit("transaction",{editor:this,transaction:e}),r&&this.emit("selectionUpdate",{editor:this,transaction:e});const i=e.getMeta("focus"),o=e.getMeta("blur");i&&this.emit("focus",{editor:this,event:i.event,transaction:e}),o&&this.emit("blur",{editor:this,event:o.event,transaction:e}),!(!e.docChanged||e.getMeta("preventUpdate"))&&this.emit("update",{editor:this,transaction:e})}getAttributes(e){return u8(this.state,e)}isActive(e,t){const r=typeof e=="string"?e:null,i=typeof e=="string"?t:e;return l8(this.state,r,i)}getJSON(){return this.state.doc.toJSON()}getHTML(){return gu(this.state.doc.content,this.schema)}getText(e){const{blockSeparator:t=`

`,textSerializers:r={}}=e||{};return dx(this.state.doc,{blockSeparator:t,textSerializers:{...kp(this.schema),...r}})}get isEmpty(){return Ap(this.state.doc)}getCharacterCount(){return console.warn('[tiptap warn]: "editor.getCharacterCount()" is deprecated. Please use "editor.storage.characterCount.characters()" instead.'),this.state.doc.content.size-2}destroy(){if(this.emit("destroy"),this.view){const e=this.view.dom;e&&e.editor&&delete e.editor,this.view.destroy()}this.removeAllListeners()}get isDestroyed(){var e;return!(!((e=this.view)===null||e===void 0)&&e.docView)}$node(e,t){var r;return((r=this.$doc)===null||r===void 0?void 0:r.querySelector(e,t))||null}$nodes(e,t){var r;return((r=this.$doc)===null||r===void 0?void 0:r.querySelectorAll(e,t))||null}$pos(e){const t=this.state.doc.resolve(e);return new ko(t,this)}get $doc(){return this.$pos(0)}}function Lo(n){return new Lc({find:n.find,handler:({state:e,range:t,match:r})=>{const i=De(n.getAttributes,void 0,r);if(i===!1||i===null)return null;const{tr:o}=e,s=r[r.length-1],a=r[0];if(s){const l=a.search(/\S/),d=t.from+a.indexOf(s),f=d+s.length;if(fx(t.from,t.to,e.doc).filter(g=>g.mark.type.excluded.find(v=>v===n.type&&v!==g.mark.type)).filter(g=>g.to>d).length)return null;f<t.to&&o.delete(f,t.to),d>t.from&&o.delete(t.from+l,d);const m=t.from+l+s.length;o.addMark(t.from+l,m,n.type.create(i||{})),o.removeStoredMark(n.type)}}})}function N8(n){return new Lc({find:n.find,handler:({state:e,range:t,match:r})=>{const i=De(n.getAttributes,void 0,r)||{},{tr:o}=e,s=t.from;let a=t.to;const l=n.type.create(i);if(r[1]){const d=r[0].lastIndexOf(r[1]);let f=s+d;f>a?f=a:a=f+r[1].length;const h=r[0][r[0].length-1];o.insertText(h,s+r[0].length-1),o.replaceWith(f,a,l)}else if(r[0]){const d=n.type.isInline?s:s-1;o.insert(d,n.type.create(i)).delete(o.mapping.map(s),o.mapping.map(a))}o.scrollIntoView()}})}function $h(n){return new Lc({find:n.find,handler:({state:e,range:t,match:r})=>{const i=e.doc.resolve(t.from),o=De(n.getAttributes,void 0,r)||{};if(!i.node(-1).canReplaceWith(i.index(-1),i.indexAfter(-1),n.type))return null;e.tr.delete(t.from,t.to).setBlockType(t.from,t.from,n.type,o)}})}function nu(n){return new Lc({find:n.find,handler:({state:e,range:t,match:r,chain:i})=>{const o=De(n.getAttributes,void 0,r)||{},s=e.tr.delete(t.from,t.to),l=s.doc.resolve(t.from).blockRange(),d=l&&op(l,n.type,o);if(!d)return null;if(s.wrap(l,d),n.keepMarks&&n.editor){const{selection:h,storedMarks:m}=e,{splittableMarks:g}=n.editor.extensionManager,b=m||h.$to.parentOffset&&h.$from.marks();if(b){const v=b.filter(x=>g.includes(x.type.name));s.ensureMarks(v)}}if(n.keepAttributes){const h=n.type.name==="bulletList"||n.type.name==="orderedList"?"listItem":"taskList";i().updateAttributes(h,o).run()}const f=s.doc.resolve(t.from-1).nodeBefore;f&&f.type===n.type&&Ji(s.doc,t.from-1)&&(!n.joinPredicate||n.joinPredicate(r,f))&&s.join(t.from-1)}})}let Ge=class zh{constructor(e={}){this.type="node",this.name="node",this.parent=null,this.child=null,this.config={name:this.name,defaultOptions:{}},this.config={...this.config,...e},this.name=this.config.name,e.defaultOptions&&Object.keys(e.defaultOptions).length>0&&console.warn(`[tiptap warn]: BREAKING CHANGE: "defaultOptions" is deprecated. Please use "addOptions" instead. Found in extension: "${this.name}".`),this.options=this.config.defaultOptions,this.config.addOptions&&(this.options=De(Z(this,"addOptions",{name:this.name}))),this.storage=De(Z(this,"addStorage",{name:this.name,options:this.options}))||{}}static create(e={}){return new zh(e)}configure(e={}){const t=this.extend({...this.config,addOptions:()=>Bc(this.options,e)});return t.name=this.name,t.parent=this.parent,t}extend(e={}){const t=new zh(e);return t.parent=this,this.child=t,t.name=e.name?e.name:t.parent.name,e.defaultOptions&&Object.keys(e.defaultOptions).length>0&&console.warn(`[tiptap warn]: BREAKING CHANGE: "defaultOptions" is deprecated. Please use "addOptions" instead. Found in extension: "${t.name}".`),t.options=De(Z(t,"addOptions",{name:t.name})),t.storage=De(Z(t,"addStorage",{name:t.name,options:t.options})),t}};function Bo(n){return new l4({find:n.find,handler:({state:e,range:t,match:r,pasteEvent:i})=>{const o=De(n.getAttributes,void 0,r,i);if(o===!1||o===null)return null;const{tr:s}=e,a=r[r.length-1],l=r[0];let d=t.to;if(a){const f=l.search(/\S/),h=t.from+l.indexOf(a),m=h+a.length;if(fx(t.from,t.to,e.doc).filter(b=>b.mark.type.excluded.find(x=>x===n.type&&x!==b.mark.type)).filter(b=>b.to>h).length)return null;m<t.to&&s.delete(m,t.to),h>t.from&&s.delete(t.from+f,h),d=t.from+f+a.length,s.addMark(t.from+f,d,n.type.create(o||{})),s.removeStoredMark(n.type)}}})}function P8(n,e){const{selection:t}=n,{$from:r}=t;if(t instanceof re){const o=r.index();return r.parent.canReplaceWith(o,o+1,e)}let i=r.depth;for(;i>=0;){const o=r.index(i);if(r.node(i).contentMatchAt(o).matchType(e))return!0;i-=1}return!1}const J1={};function F8(n){let e=J1[n];if(e)return e;e=J1[n]=[];for(let t=0;t<128;t++){const r=String.fromCharCode(t);e.push(r)}for(let t=0;t<n.length;t++){const r=n.charCodeAt(t);e[r]="%"+("0"+r.toString(16).toUpperCase()).slice(-2)}return e}function Rs(n,e){typeof e!="string"&&(e=Rs.defaultChars);const t=F8(e);return n.replace(/(%[a-f0-9]{2})+/gi,function(r){let i="";for(let o=0,s=r.length;o<s;o+=3){const a=parseInt(r.slice(o+1,o+3),16);if(a<128){i+=t[a];continue}if((a&224)===192&&o+3<s){const l=parseInt(r.slice(o+4,o+6),16);if((l&192)===128){const d=a<<6&1984|l&63;d<128?i+="":i+=String.fromCharCode(d),o+=3;continue}}if((a&240)===224&&o+6<s){const l=parseInt(r.slice(o+4,o+6),16),d=parseInt(r.slice(o+7,o+9),16);if((l&192)===128&&(d&192)===128){const f=a<<12&61440|l<<6&4032|d&63;f<2048||f>=55296&&f<=57343?i+="":i+=String.fromCharCode(f),o+=6;continue}}if((a&248)===240&&o+9<s){const l=parseInt(r.slice(o+4,o+6),16),d=parseInt(r.slice(o+7,o+9),16),f=parseInt(r.slice(o+10,o+12),16);if((l&192)===128&&(d&192)===128&&(f&192)===128){let h=a<<18&1835008|l<<12&258048|d<<6&4032|f&63;h<65536||h>1114111?i+="":(h-=65536,i+=String.fromCharCode(55296+(h>>10),56320+(h&1023))),o+=9;continue}}i+=""}return i})}Rs.defaultChars=";/?:@&=+$,#";Rs.componentChars="";const Z1={};function R8(n){let e=Z1[n];if(e)return e;e=Z1[n]=[];for(let t=0;t<128;t++){const r=String.fromCharCode(t);/^[0-9a-z]$/i.test(r)?e.push(r):e.push("%"+("0"+t.toString(16).toUpperCase()).slice(-2))}for(let t=0;t<n.length;t++)e[n.charCodeAt(t)]=n[t];return e}function bu(n,e,t){typeof e!="string"&&(t=e,e=bu.defaultChars),typeof t>"u"&&(t=!0);const r=R8(e);let i="";for(let o=0,s=n.length;o<s;o++){const a=n.charCodeAt(o);if(t&&a===37&&o+2<s&&/^[0-9a-f]{2}$/i.test(n.slice(o+1,o+3))){i+=n.slice(o,o+3),o+=2;continue}if(a<128){i+=r[a];continue}if(a>=55296&&a<=57343){if(a>=55296&&a<=56319&&o+1<s){const l=n.charCodeAt(o+1);if(l>=56320&&l<=57343){i+=encodeURIComponent(n[o]+n[o+1]),o++;continue}}i+="%EF%BF%BD";continue}i+=encodeURIComponent(n[o])}return i}bu.defaultChars=";/?:@&=+$,-_.!~*'()#";bu.componentChars="-_.!~*'()";function Tp(n){let e="";return e+=n.protocol||"",e+=n.slashes?"//":"",e+=n.auth?n.auth+"@":"",n.hostname&&n.hostname.indexOf(":")!==-1?e+="["+n.hostname+"]":e+=n.hostname||"",e+=n.port?":"+n.port:"",e+=n.pathname||"",e+=n.search||"",e+=n.hash||"",e}function bc(){this.protocol=null,this.slashes=null,this.auth=null,this.port=null,this.hostname=null,this.hash=null,this.search=null,this.pathname=null}const L8=/^([a-z0-9.+-]+:)/i,B8=/:[0-9]*$/,$8=/^(\/\/?(?!\/)[^\?\s]*)(\?[^\s]*)?$/,z8=["<",">",'"',"`"," ","\r",`
`,"	"],H8=["{","}","|","\\","^","`"].concat(z8),q8=["'"].concat(H8),Q1=["%","/","?",";","#"].concat(q8),eb=["/","?","#"],V8=255,tb=/^[+a-z0-9A-Z_-]{0,63}$/,W8=/^([+a-z0-9A-Z_-]{0,63})(.*)$/,nb={javascript:!0,"javascript:":!0},rb={http:!0,https:!0,ftp:!0,gopher:!0,file:!0,"http:":!0,"https:":!0,"ftp:":!0,"gopher:":!0,"file:":!0};function Dp(n,e){if(n&&n instanceof bc)return n;const t=new bc;return t.parse(n,e),t}bc.prototype.parse=function(n,e){let t,r,i,o=n;if(o=o.trim(),!e&&n.split("#").length===1){const d=$8.exec(o);if(d)return this.pathname=d[1],d[2]&&(this.search=d[2]),this}let s=L8.exec(o);if(s&&(s=s[0],t=s.toLowerCase(),this.protocol=s,o=o.substr(s.length)),(e||s||o.match(/^\/\/[^@\/]+@[^@\/]+/))&&(i=o.substr(0,2)==="//",i&&!(s&&nb[s])&&(o=o.substr(2),this.slashes=!0)),!nb[s]&&(i||s&&!rb[s])){let d=-1;for(let b=0;b<eb.length;b++)r=o.indexOf(eb[b]),r!==-1&&(d===-1||r<d)&&(d=r);let f,h;d===-1?h=o.lastIndexOf("@"):h=o.lastIndexOf("@",d),h!==-1&&(f=o.slice(0,h),o=o.slice(h+1),this.auth=f),d=-1;for(let b=0;b<Q1.length;b++)r=o.indexOf(Q1[b]),r!==-1&&(d===-1||r<d)&&(d=r);d===-1&&(d=o.length),o[d-1]===":"&&d--;const m=o.slice(0,d);o=o.slice(d),this.parseHost(m),this.hostname=this.hostname||"";const g=this.hostname[0]==="["&&this.hostname[this.hostname.length-1]==="]";if(!g){const b=this.hostname.split(/\./);for(let v=0,x=b.length;v<x;v++){const E=b[v];if(E&&!E.match(tb)){let A="";for(let M=0,C=E.length;M<C;M++)E.charCodeAt(M)>127?A+="x":A+=E[M];if(!A.match(tb)){const M=b.slice(0,v),C=b.slice(v+1),P=E.match(W8);P&&(M.push(P[1]),C.unshift(P[2])),C.length&&(o=C.join(".")+o),this.hostname=M.join(".");break}}}}this.hostname.length>V8&&(this.hostname=""),g&&(this.hostname=this.hostname.substr(1,this.hostname.length-2))}const a=o.indexOf("#");a!==-1&&(this.hash=o.substr(a),o=o.slice(0,a));const l=o.indexOf("?");return l!==-1&&(this.search=o.substr(l),o=o.slice(0,l)),o&&(this.pathname=o),rb[t]&&this.hostname&&!this.pathname&&(this.pathname=""),this};bc.prototype.parseHost=function(n){let e=B8.exec(n);e&&(e=e[0],e!==":"&&(this.port=e.substr(1)),n=n.substr(0,n.length-e.length)),n&&(this.hostname=n)};const U8=Object.freeze(Object.defineProperty({__proto__:null,decode:Rs,encode:bu,format:Tp,parse:Dp},Symbol.toStringTag,{value:"Module"})),Sx=/[\0-\uD7FF\uE000-\uFFFF]|[\uD800-\uDBFF][\uDC00-\uDFFF]|[\uD800-\uDBFF](?![\uDC00-\uDFFF])|(?:[^\uD800-\uDBFF]|^)[\uDC00-\uDFFF]/,Cx=/[\0-\x1F\x7F-\x9F]/,K8=/[\xAD\u0600-\u0605\u061C\u06DD\u070F\u0890\u0891\u08E2\u180E\u200B-\u200F\u202A-\u202E\u2060-\u2064\u2066-\u206F\uFEFF\uFFF9-\uFFFB]|\uD804[\uDCBD\uDCCD]|\uD80D[\uDC30-\uDC3F]|\uD82F[\uDCA0-\uDCA3]|\uD834[\uDD73-\uDD7A]|\uDB40[\uDC01\uDC20-\uDC7F]/,Mp=/[!-#%-\*,-\/:;\?@\[-\]_\{\}\xA1\xA7\xAB\xB6\xB7\xBB\xBF\u037E\u0387\u055A-\u055F\u0589\u058A\u05BE\u05C0\u05C3\u05C6\u05F3\u05F4\u0609\u060A\u060C\u060D\u061B\u061D-\u061F\u066A-\u066D\u06D4\u0700-\u070D\u07F7-\u07F9\u0830-\u083E\u085E\u0964\u0965\u0970\u09FD\u0A76\u0AF0\u0C77\u0C84\u0DF4\u0E4F\u0E5A\u0E5B\u0F04-\u0F12\u0F14\u0F3A-\u0F3D\u0F85\u0FD0-\u0FD4\u0FD9\u0FDA\u104A-\u104F\u10FB\u1360-\u1368\u1400\u166E\u169B\u169C\u16EB-\u16ED\u1735\u1736\u17D4-\u17D6\u17D8-\u17DA\u1800-\u180A\u1944\u1945\u1A1E\u1A1F\u1AA0-\u1AA6\u1AA8-\u1AAD\u1B5A-\u1B60\u1B7D\u1B7E\u1BFC-\u1BFF\u1C3B-\u1C3F\u1C7E\u1C7F\u1CC0-\u1CC7\u1CD3\u2010-\u2027\u2030-\u2043\u2045-\u2051\u2053-\u205E\u207D\u207E\u208D\u208E\u2308-\u230B\u2329\u232A\u2768-\u2775\u27C5\u27C6\u27E6-\u27EF\u2983-\u2998\u29D8-\u29DB\u29FC\u29FD\u2CF9-\u2CFC\u2CFE\u2CFF\u2D70\u2E00-\u2E2E\u2E30-\u2E4F\u2E52-\u2E5D\u3001-\u3003\u3008-\u3011\u3014-\u301F\u3030\u303D\u30A0\u30FB\uA4FE\uA4FF\uA60D-\uA60F\uA673\uA67E\uA6F2-\uA6F7\uA874-\uA877\uA8CE\uA8CF\uA8F8-\uA8FA\uA8FC\uA92E\uA92F\uA95F\uA9C1-\uA9CD\uA9DE\uA9DF\uAA5C-\uAA5F\uAADE\uAADF\uAAF0\uAAF1\uABEB\uFD3E\uFD3F\uFE10-\uFE19\uFE30-\uFE52\uFE54-\uFE61\uFE63\uFE68\uFE6A\uFE6B\uFF01-\uFF03\uFF05-\uFF0A\uFF0C-\uFF0F\uFF1A\uFF1B\uFF1F\uFF20\uFF3B-\uFF3D\uFF3F\uFF5B\uFF5D\uFF5F-\uFF65]|\uD800[\uDD00-\uDD02\uDF9F\uDFD0]|\uD801\uDD6F|\uD802[\uDC57\uDD1F\uDD3F\uDE50-\uDE58\uDE7F\uDEF0-\uDEF6\uDF39-\uDF3F\uDF99-\uDF9C]|\uD803[\uDEAD\uDF55-\uDF59\uDF86-\uDF89]|\uD804[\uDC47-\uDC4D\uDCBB\uDCBC\uDCBE-\uDCC1\uDD40-\uDD43\uDD74\uDD75\uDDC5-\uDDC8\uDDCD\uDDDB\uDDDD-\uDDDF\uDE38-\uDE3D\uDEA9]|\uD805[\uDC4B-\uDC4F\uDC5A\uDC5B\uDC5D\uDCC6\uDDC1-\uDDD7\uDE41-\uDE43\uDE60-\uDE6C\uDEB9\uDF3C-\uDF3E]|\uD806[\uDC3B\uDD44-\uDD46\uDDE2\uDE3F-\uDE46\uDE9A-\uDE9C\uDE9E-\uDEA2\uDF00-\uDF09]|\uD807[\uDC41-\uDC45\uDC70\uDC71\uDEF7\uDEF8\uDF43-\uDF4F\uDFFF]|\uD809[\uDC70-\uDC74]|\uD80B[\uDFF1\uDFF2]|\uD81A[\uDE6E\uDE6F\uDEF5\uDF37-\uDF3B\uDF44]|\uD81B[\uDE97-\uDE9A\uDFE2]|\uD82F\uDC9F|\uD836[\uDE87-\uDE8B]|\uD83A[\uDD5E\uDD5F]/,Ex=/[\$\+<->\^`\|~\xA2-\xA6\xA8\xA9\xAC\xAE-\xB1\xB4\xB8\xD7\xF7\u02C2-\u02C5\u02D2-\u02DF\u02E5-\u02EB\u02ED\u02EF-\u02FF\u0375\u0384\u0385\u03F6\u0482\u058D-\u058F\u0606-\u0608\u060B\u060E\u060F\u06DE\u06E9\u06FD\u06FE\u07F6\u07FE\u07FF\u0888\u09F2\u09F3\u09FA\u09FB\u0AF1\u0B70\u0BF3-\u0BFA\u0C7F\u0D4F\u0D79\u0E3F\u0F01-\u0F03\u0F13\u0F15-\u0F17\u0F1A-\u0F1F\u0F34\u0F36\u0F38\u0FBE-\u0FC5\u0FC7-\u0FCC\u0FCE\u0FCF\u0FD5-\u0FD8\u109E\u109F\u1390-\u1399\u166D\u17DB\u1940\u19DE-\u19FF\u1B61-\u1B6A\u1B74-\u1B7C\u1FBD\u1FBF-\u1FC1\u1FCD-\u1FCF\u1FDD-\u1FDF\u1FED-\u1FEF\u1FFD\u1FFE\u2044\u2052\u207A-\u207C\u208A-\u208C\u20A0-\u20C0\u2100\u2101\u2103-\u2106\u2108\u2109\u2114\u2116-\u2118\u211E-\u2123\u2125\u2127\u2129\u212E\u213A\u213B\u2140-\u2144\u214A-\u214D\u214F\u218A\u218B\u2190-\u2307\u230C-\u2328\u232B-\u2426\u2440-\u244A\u249C-\u24E9\u2500-\u2767\u2794-\u27C4\u27C7-\u27E5\u27F0-\u2982\u2999-\u29D7\u29DC-\u29FB\u29FE-\u2B73\u2B76-\u2B95\u2B97-\u2BFF\u2CE5-\u2CEA\u2E50\u2E51\u2E80-\u2E99\u2E9B-\u2EF3\u2F00-\u2FD5\u2FF0-\u2FFF\u3004\u3012\u3013\u3020\u3036\u3037\u303E\u303F\u309B\u309C\u3190\u3191\u3196-\u319F\u31C0-\u31E3\u31EF\u3200-\u321E\u322A-\u3247\u3250\u3260-\u327F\u328A-\u32B0\u32C0-\u33FF\u4DC0-\u4DFF\uA490-\uA4C6\uA700-\uA716\uA720\uA721\uA789\uA78A\uA828-\uA82B\uA836-\uA839\uAA77-\uAA79\uAB5B\uAB6A\uAB6B\uFB29\uFBB2-\uFBC2\uFD40-\uFD4F\uFDCF\uFDFC-\uFDFF\uFE62\uFE64-\uFE66\uFE69\uFF04\uFF0B\uFF1C-\uFF1E\uFF3E\uFF40\uFF5C\uFF5E\uFFE0-\uFFE6\uFFE8-\uFFEE\uFFFC\uFFFD]|\uD800[\uDD37-\uDD3F\uDD79-\uDD89\uDD8C-\uDD8E\uDD90-\uDD9C\uDDA0\uDDD0-\uDDFC]|\uD802[\uDC77\uDC78\uDEC8]|\uD805\uDF3F|\uD807[\uDFD5-\uDFF1]|\uD81A[\uDF3C-\uDF3F\uDF45]|\uD82F\uDC9C|\uD833[\uDF50-\uDFC3]|\uD834[\uDC00-\uDCF5\uDD00-\uDD26\uDD29-\uDD64\uDD6A-\uDD6C\uDD83\uDD84\uDD8C-\uDDA9\uDDAE-\uDDEA\uDE00-\uDE41\uDE45\uDF00-\uDF56]|\uD835[\uDEC1\uDEDB\uDEFB\uDF15\uDF35\uDF4F\uDF6F\uDF89\uDFA9\uDFC3]|\uD836[\uDC00-\uDDFF\uDE37-\uDE3A\uDE6D-\uDE74\uDE76-\uDE83\uDE85\uDE86]|\uD838[\uDD4F\uDEFF]|\uD83B[\uDCAC\uDCB0\uDD2E\uDEF0\uDEF1]|\uD83C[\uDC00-\uDC2B\uDC30-\uDC93\uDCA0-\uDCAE\uDCB1-\uDCBF\uDCC1-\uDCCF\uDCD1-\uDCF5\uDD0D-\uDDAD\uDDE6-\uDE02\uDE10-\uDE3B\uDE40-\uDE48\uDE50\uDE51\uDE60-\uDE65\uDF00-\uDFFF]|\uD83D[\uDC00-\uDED7\uDEDC-\uDEEC\uDEF0-\uDEFC\uDF00-\uDF76\uDF7B-\uDFD9\uDFE0-\uDFEB\uDFF0]|\uD83E[\uDC00-\uDC0B\uDC10-\uDC47\uDC50-\uDC59\uDC60-\uDC87\uDC90-\uDCAD\uDCB0\uDCB1\uDD00-\uDE53\uDE60-\uDE6D\uDE70-\uDE7C\uDE80-\uDE88\uDE90-\uDEBD\uDEBF-\uDEC5\uDECE-\uDEDB\uDEE0-\uDEE8\uDEF0-\uDEF8\uDF00-\uDF92\uDF94-\uDFCA]/,_x=/[ \xA0\u1680\u2000-\u200A\u2028\u2029\u202F\u205F\u3000]/,j8=Object.freeze(Object.defineProperty({__proto__:null,Any:Sx,Cc:Cx,Cf:K8,P:Mp,S:Ex,Z:_x},Symbol.toStringTag,{value:"Module"})),G8=new Uint16Array('<\0\0\0\0\0\0EMabcfglmnoprstu\\bfmsligP&cutereve;iyx}rc;r;ravepha;acr;d;gpon;f;plyFunction;ingcsr;ign;ildemlaceforsucrkslash;;ed;y;crtause;noullis;a;r;pf;eve;cmpeq;HOacdefhilorsucy;PYcpyute;;italDifferentialD;leys;aeioron;dilrc;nint;ot;dnilla;terDot;i;rcleDMPTot;inus;lus;imes;ocskwiseContourIntegral;eCurlyDQoubleQuote;uote;lnpuon;e;gitruent;nt;ourIntegral;fr;oduct;nterClockwiseContourIntegral;oss;cr;p;Cap;DJSZacefios;otrahd;cy;cy;cy;grsger;r;hv;ayron;;l;ta;r;afcmriticalADGTcute;o;bleAcute;rave;ilde;ond;ferentialD;\0\0\0\0f;;DEot;qual;bleCDLRUVontourIntegrao\0\0nArrow;eoftARTrrow;ightArrow;engLReftARrrow;ightArrow;ightArrow;ightATrrow;ee;p\0\0rrow;ownArrow;erticalBar;nABLRTarrow;BUar;pArrow;reve;eft\0\0ightVector;eeVector;ector;Bar;ight\0eeVector;ector;Bar;ee;Arrow;ctr;rok;NTacdfglmopqstuxG;Hcuteaiyron;rc;ot;r;raveement;apcr;ty\0\0mallSquare;erySmallSquare;gpon;f;silon;uail;Tilde;librium;cir;m;a;mlipsts;onentialE;cfiosy;r;lled\0\0mallSquare;erySmallSquare;\0\0\0f;All;riertrf;cJTabcdfgorstcy;>mma;d;reve;eiydil;rc;;ot;r;;pf;eaterEFGLSTqual;Less;ullEqual;reater;ess;lantEqual;ilde;cr;;AacfiosuRDcy;ctek;;irc;r;lbertSpace;\0f;izontalLine;ctrok;mpownHumqual;EJOacdfgmnostucy;lig;cy;cuteiyrc;ot;r;rave;apcgr;inaryI;lie\0;egrral;section;isibleCTomma;imes;gpton;f;a;cr;ilde;\0cy;lcfosuiyrc;;r;pf;\0r;rcy;kcy;HJacfoscy;cy;ppa;eydil;;r;pf;cr;JTaceflmostcy;<cmnprute;bda;g;lacetrf;r;aeyron;dil;;fstACDFRTUVarnrgleBracket;row;BRar;ightArrow;eiling;o\0bleBracket;n\0eeVector;ector;Bar;loor;ightAVrrow;ector;ere;AVrrow;ector;iangle;BEar;qual;pDTVownVector;eeVector;ector;Bar;ector;Bar;ightsEFGLSTqualGreater;ullEqual;reater;ess;lantEqual;ilde;r;;eftarrow;idot;npwgLRlreftARrrow;ightArrow;ightArrow;eftarightightf;erLReftArrow;ightArrow;cht;rok;;acefiosup;y;dliumSpace;lintrf;r;nusPlus;pf;c;Jacefostucy;cute;aeyron;dil;;gswativeMTVediumSpace;hicneryThitedGLreaterGreateessLesLine;r;Bnptreak;BreakingSpace;f;;CDEGHLNPRSTVoungruent;pCap;oubleVerticalBar;lqxement;ual;Tilde;ists;reater;EFGLSTqual;ullEqual;reater;ess;lantEqual;ilde;umpownHump;qual;efstTriangle;BEar;qual;s;EGLSTqual;reater;ess;lantEqual;ilde;estedGLreaterGreater;essLess;recedes;ESqual;lantEqual;eiverseElement;ghtTriangle;BEar;qual;quuareSubpset;Equal;erset;Equal;bcpset;Equal;ceeds;ESTqual;lantEqual;ilde;erset;Equal;ilde;EFTqual;ullEqual;ilde;erticalBar;cr;ilde;Eacdfgmoprstuvlig;cuteiyrc;blac;r;raveaeicr;ga;cron;pf;enCurlyDQoubleQuote;uote;;clr;ashidees;mlerBParr;acek;et;arenthesis;acfhilorsrtialD;y;r;i;;usMinus;ipncareplanf;;eiocedes;ESTqual;lantEqual;ilde;me;dpuct;ortion;al;cir;;UfosOT"r;pf;cr;BEacefhiorsuarr;Gcnrute;g;r;tl;aeyron;dil;;;verseEUlqement;uilibrium;pEquilibrium;ro;ghtACDFTUVanrgleBracket;row;BLar;eftArrow;eiling;o\0bleBracket;n\0eeVector;ector;Bar;loor;ere;AVrrow;ector;iangle;BEar;qual;pDTVownVector;eeVector;ector;Bar;ector;Bar;puf;ndImplies;ightarrow;chr;;leDelayed;HOacfhimoqstuCcHcy;y;FTcy;cute;;aeiyron;dil;rc;;r;ortDLRUownArroweftArrowightArrowpArrow;gma;allCircle;pf;\0\0t;are;ISUntersection;ubpset;Equal;erset;Equal;nion;cr;ar;bcmp;set;Equal;cheeds;ESTqual;lantEqual;ilde;Th;;esrset;Equal;etHRSacfhiorsORNADE;Hccy;y;bu;;aeyron;dil;;r;ei\0efore;a;cnkSpace;Space;lde;EFTqual;ullEqual;ilde;pf;ipleDot;ctr;rok;\0\0\0\0\0\0\0cruter;ocir;r\0y;ve;iyrc;blac;r;raveacr;dierBParr;acek;et;arenthesis;on;Plus;gpon;f;ADETadpsrrow;BDar;ownArrow;ownArrow;quilibrium;ee;Arrow;ownerLReftArrow;ightArrow;i;lon;ing;cr;ilde;mlDbcdefosvash;ar;y;ash;l;er;btyar;;icalBLSTar;ine;eparator;ilde;ThinSpace;r;pf;cr;dash;cefosirc;dge;r;pf;cr;fiosr;;pf;cr;AIUacfosucy;cy;cy;cuteiyrc;;r;pf;cr;ml;Hacdefoscy;cute;ayron;;ot;\0oWidta;r;pf;cr;\0\0\0\0\0\0\0cutereve;;Ediuy;;rcte;lig;r;raveepfpsym;ha;apcclr;g;\0\0;adsvnd;;lope;;;elmrsz;esd;a;;;;;;;;t;vb;d;pth;arr;gpon;f;;Eaeiop;cir;;d;s;rox;eingctyr;;mp;eildemlcioninnt;Nabcdefiklnoprsuot;crkcepsong;psilon;rime;im;eq;ee;ed;gerk;tbrk;oy;quo;cmprtaus;eptyv;snoahw;;een;r;gcostuvwaiurc;pdptot;lus;imes;\0\0cup;ar;riangleduown;p;plus;earow;akocnklstozenge;riangle;dlrown;eft;ight;k;\0\0;;4;ck;eo;q=uiv;t;ptwxf;;tomtie;DHUVbdhmptuvLRlr;;;;;DUdu;;;;LRlr;;;;;HLRhlr;;;;;;ox;LRlr;;;;;DUdu;;;;inus;lus;imes;LRlr;;;;;HLRhlr;;;;;;evbarceior;mi;m;el;bh;sub;l;etp;Ee;;q\0\0\0\0\0\0\0\0\0\0cprute;;abcdsnd;rcup;aup;p;ot;;eot;aeiu\0s;on;dilrc;ps;sm;ot;dmnilptyv;t;err;ceiy;ck;mark;r;Ecefms;;elq;e\0\0rrowlreft;ight;RSacd;st;irc;ash;nint;id;cir;ubs;uit\0on;e;q\0\0a;t;;flemxente\0;dot;nfry;o;sr;aorr;ss;cur;bp;e;;e;dot;delprvwarrlr;;\0\0r;c;arr;p;;bcdosrcap;aup;p;ot;r;;alrvrr;m;yevwq\0\0reuee;edge;enearrowlreftightecioninnt;lcty;AHabcdefhijlorstuwzrar;glrsger;eth;h;varow;aayron;;;aogrr;tseq;glmta;ptyv;irsht;;arlraegsvm;osnd;suit;amma;in;;iode;ontimes;ncy;c\0\0rn;op;lptuwlar;f;;empsq;dot;inus;lus;quare;blebarwedgnadhownarrowarpoonlrefighkaro\0\0rn;op;cotry;;l;rok;drot;i;fahraangle;ciy;grarr;DacdefglmnopqrstuxDoocsuteter;aioyron;r;clon;;ot;Drot;;;rsave;dot;;ilsnters;;;dot;apscr;ty;svetp1;;;gs;p;gpon;f;alsr;sl;us;i;lvon;csuviorc\0\0antgltressaeils;st;v;DD;parsl;Daot;rr;cdir;oah;mrlo;cipl;seoctationential\0\0\0\0\0\0\0llingdotsey;male;ilrlig;\0\0g;ig;;lig;lig;fjaltt;ig;ns;of;\0f;ak;v;artint;aocs\0\0;;;;\0;;\0\0;;5;\0;;8;l;wn;cr;Eabcdefgijlnorstv;l;cmpute;ma;d;reve;iyrc;;ot;;lqs;qslan;cdlc;ot;o;l;;es;r;;gmel;cy;;Eaj;;;Eaes;p;prox;q;qim;pf;cir;m;el;;>;cdlqrci;r;ot;Par;uest;adels\0pror;qlqlesienrtneqq;Aabcefkosyrilmrrsfildrcy;;cwir;;ar;irc;alrrts;uitlip;con;r;sewarow;arow;amoprrr;tht;klreftarrow;ightarrow;f;bar;cltr;asrok;bpull;hen\0\0\0\0\0\0cute;iyrc;cxy;clfr;rave;inoinnt;t;fin;ta;lig;aopcgtr;elpinarh;f;ed;;cfotare;in;tie;do;celpal;grerarhk;rod;cgpty;on;f;a;uestcir;n;Edsv;ot;;v;;ilde;\0cy;lcfmosuiyrc;;r;ath;pf;\0r;rcy;kcy;acfghjosppa;v;eydil;;r;reen;cy;cy;pf;cr;ABEHabcdefghjlmnoprstuvartrail;arr;;g;ar;\0\0\0\0\0\0\0\0\0ute;mptyv;rabda;g;dl;;uor;bfhlpst;fs;s;p;l;im;l;;aeil;;s;abrrr;rk;akcek;;es;ldu;;aeuyron;diil;;cqrsa;uo;rduhar;shar;h;;fgqstahlrtrrow;taarpoonduownpeftarrows;ightahsrrow;sarpoonquigarrohreetimes;;qslan;cdgsc;ot;o;r;;es;adegspproot;qgqgtiilrsht;;;E;rdu;l;lk;cy;;achtrorneard;ri;iodot;ust;acheEaes;p;prox;q;qim;abnoptwznrg;r;rglmreftarightapsto;ightparrowlrefight;aflr;;us;imes;st;;efngear;lt;achmtrornear;d;;ri;achiqtquo;r;m;eg;;buo;r;rok;<;cdhilqrci;r;remes;arr;uest;Piar;;efrdushar;har;enrtneqq;DacdefhilnopsuDot;clprret;;ese;sto;dluowefker;oymma;;ash;asuredangler;o;cdnro;acdsir;otus;bd;u;p;dpels;f;ctr;pos;lmtimap;GLRVabcdefghijlmoprstuvwgt;;veltftarrrow;ightarrow;;;vightarrow;Ddash;ash;bcnptlaute;g;;Eiop;d;s;rour;al;s\0pmp;eaeouy\0;on;dil;ng;dot;p;;ash;;Aadqsxrr;rhrk;;oot;uieiar;ist;sr;Eest;qs;qslani;rAaprrr;ar;;sv;d;cy;AEadestr;rr;r;;fqstarrroightarro;qslan;si;ri;eiptf;;inn;Edv;ot;;;i;v;;aorr;astllel;;lint;;ceu;c;eAaitrrr;cw;;ghtarrowri;echimpqu;ceru;ort\0\0arm;e;qsubpbcp;Ees;et;eq;qc;e;Ees;et;eq;qgilrldeianglelreft;eight;e;m;esro;p;DHadgilrsash;arr;p;ash;et;;>nfin;Aetrr;;;r<ie;Atrr;rie;im;Aanrr;rhrk;;oear;\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0csuteiyr;c;abioslac;v;old;lig;crir;;\0\0\0n;ave;bmar;acitrirr;oss;n;aeicr;ga;cdnron;;pf;aelr;rp;;adiosvr;efmr;ofgof;r;lope;;cloashl;idees;as;mlbar;\0\0\0\0\0\0\0\0\0r;ast;lle\0\0m;;y;rcimptnt;od;il;enk;r;imo;v;mane;;tvchfork;aunckk;h;s;abcdemstcir;ir;ou;;nim;wo;ipuntint;f;nd;Eaceinosu;p;u;c;acenspprourlyeaespprox;qq;im;ime;sEasdfpalslar;ine;urf;;trel;cir;;ncsp;fiopsur;pf;rime;cr;aeoteirnionnt;st;eABHabcdefhilmnoprstuxartrail;arar;cdenqrteu;te;imptyv;g;del;;uor;abcfhlpstwp;;fs;;s;l;im;l;;aiil;o;nalabrrrk;akcek;;es;ldu;;aeuyron;diil;;clqsa;dhar;uo;rh;acgl;ipsnart;ilrsht;;aordu;l;;v;gnshtahlrstrrow;taarpoonduowpeftahrrowarpoonightarrows;quigarrohreetimes;g;ingdotseahmra;oust;achemid;abptnrg;r;raflr;;us;imes;apr;gt;olint;arachqquo;r;buo;rhirremes;i;efltri;luhar;;\0\0\0\0\0\0\0cute;qu;Eaceinpsy;\0;on;u;dil;rc;Eas;p;im;olint;i;ot;be;Aacmstxrr;rhr;oti;war;minnut;r;oacoyrp;hycy;;rt\0\0iaragmma;fv;;deglnprot;;q;E;;E;e;lus;arr;araeitlslsetmhp;parsl;dle;;e;s;flptcy;;b;ar;f;adres;uitcsuaup;s;p;s;ubp;eset;e;eset;e;afrarcemtr;tmiararr;fanighteppsilohsbcmnp;Edemnprs;ot;;dot;ult;Ee;;lus;arr;eiut;enq;qeq;qm;bp;;c;acenspprourlyeaespproqg;123;Edehlmnps;ost;ub;;dot;soul;b;arr;ult;Ee;;lus;eiut;enq;qeq;qm;bp;;Aanrr;rhr;owar;lig\0\0\0\0\0\0\0\0\0\0\0\0get;;raeyron;dil;;lrec;r;eiko\0e4fa;svym;cnkaspproimsasrnes;bd;ar;;eps;bcfot;ir;;ork;rime;aipdadempstngle;dlqrowneft;e;ight;eot;inus;lus;b;ime;ezium;chtry;;cy;rok;ioxheadlreftarroightarrowAHabcdfghlmoprstuwrar;cruter\0y;ve;iyrc;abhrlac;airsht;;raverlrlk;ct\0\0rn;erop;ri;alcr;gpon;f;adhlsuownarpoonlrefighi;hlonparrows;cit\0\0rn;erop;ng;ri;cr;dirot;lde;i;famrlangle;ABDacdeflnoprszrar;v;asnrgrt;eknprstappothinhirop;hiugmbpsetneq;q;setneq;q;hretianglelreftighty;ashelr;bear;q;lip;btar;trsubppf;rotrcur;bpnEenEeigzag;cefoprsirc;dibgar;e;q;erp;r;pf;;eatcr;\0\0\0\0\0\0\0trr;Aarr;Aarrais;dptfl;imAarrcqr;ptracefiosucuyte;iyrc;;nr;cy;pf;cr;cmy;lacdefhioswcute;ayron;;ot;ettra;r;cy;grarr;pf;cr;jn;j;'.split("").map(n=>n.charCodeAt(0))),X8=new Uint16Array("aglq	\x1B\0\0p;os;t;t;uot;".split("").map(n=>n.charCodeAt(0)));var Wf;const Y8=new Map([[0,65533],[128,8364],[130,8218],[131,402],[132,8222],[133,8230],[134,8224],[135,8225],[136,710],[137,8240],[138,352],[139,8249],[140,338],[142,381],[145,8216],[146,8217],[147,8220],[148,8221],[149,8226],[150,8211],[151,8212],[152,732],[153,8482],[154,353],[155,8250],[156,339],[158,382],[159,376]]),J8=(Wf=String.fromCodePoint)!==null&&Wf!==void 0?Wf:function(n){let e="";return n>65535&&(n-=65536,e+=String.fromCharCode(n>>>10&1023|55296),n=56320|n&1023),e+=String.fromCharCode(n),e};function Z8(n){var e;return n>=55296&&n<=57343||n>1114111?65533:(e=Y8.get(n))!==null&&e!==void 0?e:n}var Et;(function(n){n[n.NUM=35]="NUM",n[n.SEMI=59]="SEMI",n[n.EQUALS=61]="EQUALS",n[n.ZERO=48]="ZERO",n[n.NINE=57]="NINE",n[n.LOWER_A=97]="LOWER_A",n[n.LOWER_F=102]="LOWER_F",n[n.LOWER_X=120]="LOWER_X",n[n.LOWER_Z=122]="LOWER_Z",n[n.UPPER_A=65]="UPPER_A",n[n.UPPER_F=70]="UPPER_F",n[n.UPPER_Z=90]="UPPER_Z"})(Et||(Et={}));const Q8=32;var Wi;(function(n){n[n.VALUE_LENGTH=49152]="VALUE_LENGTH",n[n.BRANCH_LENGTH=16256]="BRANCH_LENGTH",n[n.JUMP_TABLE=127]="JUMP_TABLE"})(Wi||(Wi={}));function Hh(n){return n>=Et.ZERO&&n<=Et.NINE}function eO(n){return n>=Et.UPPER_A&&n<=Et.UPPER_F||n>=Et.LOWER_A&&n<=Et.LOWER_F}function tO(n){return n>=Et.UPPER_A&&n<=Et.UPPER_Z||n>=Et.LOWER_A&&n<=Et.LOWER_Z||Hh(n)}function nO(n){return n===Et.EQUALS||tO(n)}var St;(function(n){n[n.EntityStart=0]="EntityStart",n[n.NumericStart=1]="NumericStart",n[n.NumericDecimal=2]="NumericDecimal",n[n.NumericHex=3]="NumericHex",n[n.NamedEntity=4]="NamedEntity"})(St||(St={}));var Bi;(function(n){n[n.Legacy=0]="Legacy",n[n.Strict=1]="Strict",n[n.Attribute=2]="Attribute"})(Bi||(Bi={}));class rO{constructor(e,t,r){this.decodeTree=e,this.emitCodePoint=t,this.errors=r,this.state=St.EntityStart,this.consumed=1,this.result=0,this.treeIndex=0,this.excess=1,this.decodeMode=Bi.Strict}startEntity(e){this.decodeMode=e,this.state=St.EntityStart,this.result=0,this.treeIndex=0,this.excess=1,this.consumed=1}write(e,t){switch(this.state){case St.EntityStart:return e.charCodeAt(t)===Et.NUM?(this.state=St.NumericStart,this.consumed+=1,this.stateNumericStart(e,t+1)):(this.state=St.NamedEntity,this.stateNamedEntity(e,t));case St.NumericStart:return this.stateNumericStart(e,t);case St.NumericDecimal:return this.stateNumericDecimal(e,t);case St.NumericHex:return this.stateNumericHex(e,t);case St.NamedEntity:return this.stateNamedEntity(e,t)}}stateNumericStart(e,t){return t>=e.length?-1:(e.charCodeAt(t)|Q8)===Et.LOWER_X?(this.state=St.NumericHex,this.consumed+=1,this.stateNumericHex(e,t+1)):(this.state=St.NumericDecimal,this.stateNumericDecimal(e,t))}addToNumericResult(e,t,r,i){if(t!==r){const o=r-t;this.result=this.result*Math.pow(i,o)+parseInt(e.substr(t,o),i),this.consumed+=o}}stateNumericHex(e,t){const r=t;for(;t<e.length;){const i=e.charCodeAt(t);if(Hh(i)||eO(i))t+=1;else return this.addToNumericResult(e,r,t,16),this.emitNumericEntity(i,3)}return this.addToNumericResult(e,r,t,16),-1}stateNumericDecimal(e,t){const r=t;for(;t<e.length;){const i=e.charCodeAt(t);if(Hh(i))t+=1;else return this.addToNumericResult(e,r,t,10),this.emitNumericEntity(i,2)}return this.addToNumericResult(e,r,t,10),-1}emitNumericEntity(e,t){var r;if(this.consumed<=t)return(r=this.errors)===null||r===void 0||r.absenceOfDigitsInNumericCharacterReference(this.consumed),0;if(e===Et.SEMI)this.consumed+=1;else if(this.decodeMode===Bi.Strict)return 0;return this.emitCodePoint(Z8(this.result),this.consumed),this.errors&&(e!==Et.SEMI&&this.errors.missingSemicolonAfterCharacterReference(),this.errors.validateNumericCharacterReference(this.result)),this.consumed}stateNamedEntity(e,t){const{decodeTree:r}=this;let i=r[this.treeIndex],o=(i&Wi.VALUE_LENGTH)>>14;for(;t<e.length;t++,this.excess++){const s=e.charCodeAt(t);if(this.treeIndex=iO(r,i,this.treeIndex+Math.max(1,o),s),this.treeIndex<0)return this.result===0||this.decodeMode===Bi.Attribute&&(o===0||nO(s))?0:this.emitNotTerminatedNamedEntity();if(i=r[this.treeIndex],o=(i&Wi.VALUE_LENGTH)>>14,o!==0){if(s===Et.SEMI)return this.emitNamedEntityData(this.treeIndex,o,this.consumed+this.excess);this.decodeMode!==Bi.Strict&&(this.result=this.treeIndex,this.consumed+=this.excess,this.excess=0)}}return-1}emitNotTerminatedNamedEntity(){var e;const{result:t,decodeTree:r}=this,i=(r[t]&Wi.VALUE_LENGTH)>>14;return this.emitNamedEntityData(t,i,this.consumed),(e=this.errors)===null||e===void 0||e.missingSemicolonAfterCharacterReference(),this.consumed}emitNamedEntityData(e,t,r){const{decodeTree:i}=this;return this.emitCodePoint(t===1?i[e]&~Wi.VALUE_LENGTH:i[e+1],r),t===3&&this.emitCodePoint(i[e+2],r),r}end(){var e;switch(this.state){case St.NamedEntity:return this.result!==0&&(this.decodeMode!==Bi.Attribute||this.result===this.treeIndex)?this.emitNotTerminatedNamedEntity():0;case St.NumericDecimal:return this.emitNumericEntity(0,2);case St.NumericHex:return this.emitNumericEntity(0,3);case St.NumericStart:return(e=this.errors)===null||e===void 0||e.absenceOfDigitsInNumericCharacterReference(this.consumed),0;case St.EntityStart:return 0}}}function Ax(n){let e="";const t=new rO(n,r=>e+=J8(r));return function(i,o){let s=0,a=0;for(;(a=i.indexOf("&",a))>=0;){e+=i.slice(s,a),t.startEntity(o);const d=t.write(i,a+1);if(d<0){s=a+t.end();break}s=a+d,a=d===0?s+1:s}const l=e+i.slice(s);return e="",l}}function iO(n,e,t,r){const i=(e&Wi.BRANCH_LENGTH)>>7,o=e&Wi.JUMP_TABLE;if(i===0)return o!==0&&r===o?t:-1;if(o){const l=r-o;return l<0||l>=i?-1:n[t+l]-1}let s=t,a=s+i-1;for(;s<=a;){const l=s+a>>>1,d=n[l];if(d<r)s=l+1;else if(d>r)a=l-1;else return n[l+i]}return-1}const oO=Ax(G8);Ax(X8);function Tx(n,e=Bi.Legacy){return oO(n,e)}function sO(n){return Object.prototype.toString.call(n)}function Op(n){return sO(n)==="[object String]"}const aO=Object.prototype.hasOwnProperty;function uO(n,e){return aO.call(n,e)}function zc(n){return Array.prototype.slice.call(arguments,1).forEach(function(t){if(t){if(typeof t!="object")throw new TypeError(t+"must be object");Object.keys(t).forEach(function(r){n[r]=t[r]})}}),n}function Dx(n,e,t){return[].concat(n.slice(0,e),t,n.slice(e+1))}function Ip(n){return!(n>=55296&&n<=57343||n>=64976&&n<=65007||(n&65535)===65535||(n&65535)===65534||n>=0&&n<=8||n===11||n>=14&&n<=31||n>=127&&n<=159||n>1114111)}function yc(n){if(n>65535){n-=65536;const e=55296+(n>>10),t=56320+(n&1023);return String.fromCharCode(e,t)}return String.fromCharCode(n)}const Mx=/\\([!"#$%&'()*+,\-./:;<=>?@[\\\]^_`{|}~])/g,lO=/&([a-z#][a-z0-9]{1,31});/gi,cO=new RegExp(Mx.source+"|"+lO.source,"gi"),dO=/^#((?:x[a-f0-9]{1,8}|[0-9]{1,8}))$/i;function fO(n,e){if(e.charCodeAt(0)===35&&dO.test(e)){const r=e[1].toLowerCase()==="x"?parseInt(e.slice(2),16):parseInt(e.slice(1),10);return Ip(r)?yc(r):n}const t=Tx(n);return t!==n?t:n}function hO(n){return n.indexOf("\\")<0?n:n.replace(Mx,"$1")}function Ls(n){return n.indexOf("\\")<0&&n.indexOf("&")<0?n:n.replace(cO,function(e,t,r){return t||fO(e,r)})}const pO=/[&<>"]/,mO=/[&<>"]/g,gO={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;"};function bO(n){return gO[n]}function Yi(n){return pO.test(n)?n.replace(mO,bO):n}const yO=/[.?*+^$[\]\\(){}|-]/g;function vO(n){return n.replace(yO,"\\$&")}function je(n){switch(n){case 9:case 32:return!0}return!1}function ru(n){if(n>=8192&&n<=8202)return!0;switch(n){case 9:case 10:case 11:case 12:case 13:case 32:case 160:case 5760:case 8239:case 8287:case 12288:return!0}return!1}function iu(n){return Mp.test(n)||Ex.test(n)}function ou(n){switch(n){case 33:case 34:case 35:case 36:case 37:case 38:case 39:case 40:case 41:case 42:case 43:case 44:case 45:case 46:case 47:case 58:case 59:case 60:case 61:case 62:case 63:case 64:case 91:case 92:case 93:case 94:case 95:case 96:case 123:case 124:case 125:case 126:return!0;default:return!1}}function Hc(n){return n=n.trim().replace(/\s+/g," "),"".toLowerCase()===""&&(n=n.replace(//g,"")),n.toLowerCase().toUpperCase()}const xO={mdurl:U8,ucmicro:j8},wO=Object.freeze(Object.defineProperty({__proto__:null,arrayReplaceAt:Dx,assign:zc,escapeHtml:Yi,escapeRE:vO,fromCodePoint:yc,has:uO,isMdAsciiPunct:ou,isPunctChar:iu,isSpace:je,isString:Op,isValidEntityCode:Ip,isWhiteSpace:ru,lib:xO,normalizeReference:Hc,unescapeAll:Ls,unescapeMd:hO},Symbol.toStringTag,{value:"Module"}));function kO(n,e,t){let r,i,o,s;const a=n.posMax,l=n.pos;for(n.pos=e+1,r=1;n.pos<a;){if(o=n.src.charCodeAt(n.pos),o===93&&(r--,r===0)){i=!0;break}if(s=n.pos,n.md.inline.skipToken(n),o===91){if(s===n.pos-1)r++;else if(t)return n.pos=l,-1}}let d=-1;return i&&(d=n.pos),n.pos=l,d}function SO(n,e,t){let r,i=e;const o={ok:!1,pos:0,str:""};if(n.charCodeAt(i)===60){for(i++;i<t;){if(r=n.charCodeAt(i),r===10||r===60)return o;if(r===62)return o.pos=i+1,o.str=Ls(n.slice(e+1,i)),o.ok=!0,o;if(r===92&&i+1<t){i+=2;continue}i++}return o}let s=0;for(;i<t&&(r=n.charCodeAt(i),!(r===32||r<32||r===127));){if(r===92&&i+1<t){if(n.charCodeAt(i+1)===32)break;i+=2;continue}if(r===40&&(s++,s>32))return o;if(r===41){if(s===0)break;s--}i++}return e===i||s!==0||(o.str=Ls(n.slice(e,i)),o.pos=i,o.ok=!0),o}function CO(n,e,t,r){let i,o=e;const s={ok:!1,can_continue:!1,pos:0,str:"",marker:0};if(r)s.str=r.str,s.marker=r.marker;else{if(o>=t)return s;let a=n.charCodeAt(o);if(a!==34&&a!==39&&a!==40)return s;e++,o++,a===40&&(a=41),s.marker=a}for(;o<t;){if(i=n.charCodeAt(o),i===s.marker)return s.pos=o+1,s.str+=Ls(n.slice(e,o)),s.ok=!0,s;if(i===40&&s.marker===41)return s;i===92&&o+1<t&&o++,o++}return s.can_continue=!0,s.str+=Ls(n.slice(e,o)),s}const EO=Object.freeze(Object.defineProperty({__proto__:null,parseLinkDestination:SO,parseLinkLabel:kO,parseLinkTitle:CO},Symbol.toStringTag,{value:"Module"})),Vr={};Vr.code_inline=function(n,e,t,r,i){const o=n[e];return"<code"+i.renderAttrs(o)+">"+Yi(o.content)+"</code>"};Vr.code_block=function(n,e,t,r,i){const o=n[e];return"<pre"+i.renderAttrs(o)+"><code>"+Yi(n[e].content)+`</code></pre>
`};Vr.fence=function(n,e,t,r,i){const o=n[e],s=o.info?Ls(o.info).trim():"";let a="",l="";if(s){const f=s.split(/(\s+)/g);a=f[0],l=f.slice(2).join("")}let d;if(t.highlight?d=t.highlight(o.content,a,l)||Yi(o.content):d=Yi(o.content),d.indexOf("<pre")===0)return d+`
`;if(s){const f=o.attrIndex("class"),h=o.attrs?o.attrs.slice():[];f<0?h.push(["class",t.langPrefix+a]):(h[f]=h[f].slice(),h[f][1]+=" "+t.langPrefix+a);const m={attrs:h};return`<pre><code${i.renderAttrs(m)}>${d}</code></pre>
`}return`<pre><code${i.renderAttrs(o)}>${d}</code></pre>
`};Vr.image=function(n,e,t,r,i){const o=n[e];return o.attrs[o.attrIndex("alt")][1]=i.renderInlineAsText(o.children,t,r),i.renderToken(n,e,t)};Vr.hardbreak=function(n,e,t){return t.xhtmlOut?`<br />
`:`<br>
`};Vr.softbreak=function(n,e,t){return t.breaks?t.xhtmlOut?`<br />
`:`<br>
`:`
`};Vr.text=function(n,e){return Yi(n[e].content)};Vr.html_block=function(n,e){return n[e].content};Vr.html_inline=function(n,e){return n[e].content};function Vs(){this.rules=zc({},Vr)}Vs.prototype.renderAttrs=function(e){let t,r,i;if(!e.attrs)return"";for(i="",t=0,r=e.attrs.length;t<r;t++)i+=" "+Yi(e.attrs[t][0])+'="'+Yi(e.attrs[t][1])+'"';return i};Vs.prototype.renderToken=function(e,t,r){const i=e[t];let o="";if(i.hidden)return"";i.block&&i.nesting!==-1&&t&&e[t-1].hidden&&(o+=`
`),o+=(i.nesting===-1?"</":"<")+i.tag,o+=this.renderAttrs(i),i.nesting===0&&r.xhtmlOut&&(o+=" /");let s=!1;if(i.block&&(s=!0,i.nesting===1&&t+1<e.length)){const a=e[t+1];(a.type==="inline"||a.hidden||a.nesting===-1&&a.tag===i.tag)&&(s=!1)}return o+=s?`>
`:">",o};Vs.prototype.renderInline=function(n,e,t){let r="";const i=this.rules;for(let o=0,s=n.length;o<s;o++){const a=n[o].type;typeof i[a]<"u"?r+=i[a](n,o,e,t,this):r+=this.renderToken(n,o,e)}return r};Vs.prototype.renderInlineAsText=function(n,e,t){let r="";for(let i=0,o=n.length;i<o;i++)switch(n[i].type){case"text":r+=n[i].content;break;case"image":r+=this.renderInlineAsText(n[i].children,e,t);break;case"html_inline":case"html_block":r+=n[i].content;break;case"softbreak":case"hardbreak":r+=`
`;break}return r};Vs.prototype.render=function(n,e,t){let r="";const i=this.rules;for(let o=0,s=n.length;o<s;o++){const a=n[o].type;a==="inline"?r+=this.renderInline(n[o].children,e,t):typeof i[a]<"u"?r+=i[a](n,o,e,t,this):r+=this.renderToken(n,o,e,t)}return r};function Sn(){this.__rules__=[],this.__cache__=null}Sn.prototype.__find__=function(n){for(let e=0;e<this.__rules__.length;e++)if(this.__rules__[e].name===n)return e;return-1};Sn.prototype.__compile__=function(){const n=this,e=[""];n.__rules__.forEach(function(t){t.enabled&&t.alt.forEach(function(r){e.indexOf(r)<0&&e.push(r)})}),n.__cache__={},e.forEach(function(t){n.__cache__[t]=[],n.__rules__.forEach(function(r){r.enabled&&(t&&r.alt.indexOf(t)<0||n.__cache__[t].push(r.fn))})})};Sn.prototype.at=function(n,e,t){const r=this.__find__(n),i=t||{};if(r===-1)throw new Error("Parser rule not found: "+n);this.__rules__[r].fn=e,this.__rules__[r].alt=i.alt||[],this.__cache__=null};Sn.prototype.before=function(n,e,t,r){const i=this.__find__(n),o=r||{};if(i===-1)throw new Error("Parser rule not found: "+n);this.__rules__.splice(i,0,{name:e,enabled:!0,fn:t,alt:o.alt||[]}),this.__cache__=null};Sn.prototype.after=function(n,e,t,r){const i=this.__find__(n),o=r||{};if(i===-1)throw new Error("Parser rule not found: "+n);this.__rules__.splice(i+1,0,{name:e,enabled:!0,fn:t,alt:o.alt||[]}),this.__cache__=null};Sn.prototype.push=function(n,e,t){const r=t||{};this.__rules__.push({name:n,enabled:!0,fn:e,alt:r.alt||[]}),this.__cache__=null};Sn.prototype.enable=function(n,e){Array.isArray(n)||(n=[n]);const t=[];return n.forEach(function(r){const i=this.__find__(r);if(i<0){if(e)return;throw new Error("Rules manager: invalid rule name "+r)}this.__rules__[i].enabled=!0,t.push(r)},this),this.__cache__=null,t};Sn.prototype.enableOnly=function(n,e){Array.isArray(n)||(n=[n]),this.__rules__.forEach(function(t){t.enabled=!1}),this.enable(n,e)};Sn.prototype.disable=function(n,e){Array.isArray(n)||(n=[n]);const t=[];return n.forEach(function(r){const i=this.__find__(r);if(i<0){if(e)return;throw new Error("Rules manager: invalid rule name "+r)}this.__rules__[i].enabled=!1,t.push(r)},this),this.__cache__=null,t};Sn.prototype.getRules=function(n){return this.__cache__===null&&this.__compile__(),this.__cache__[n]||[]};function kr(n,e,t){this.type=n,this.tag=e,this.attrs=null,this.map=null,this.nesting=t,this.level=0,this.children=null,this.content="",this.markup="",this.info="",this.meta=null,this.block=!1,this.hidden=!1}kr.prototype.attrIndex=function(e){if(!this.attrs)return-1;const t=this.attrs;for(let r=0,i=t.length;r<i;r++)if(t[r][0]===e)return r;return-1};kr.prototype.attrPush=function(e){this.attrs?this.attrs.push(e):this.attrs=[e]};kr.prototype.attrSet=function(e,t){const r=this.attrIndex(e),i=[e,t];r<0?this.attrPush(i):this.attrs[r]=i};kr.prototype.attrGet=function(e){const t=this.attrIndex(e);let r=null;return t>=0&&(r=this.attrs[t][1]),r};kr.prototype.attrJoin=function(e,t){const r=this.attrIndex(e);r<0?this.attrPush([e,t]):this.attrs[r][1]=this.attrs[r][1]+" "+t};function Ox(n,e,t){this.src=n,this.env=t,this.tokens=[],this.inlineMode=!1,this.md=e}Ox.prototype.Token=kr;const _O=/\r\n?|\n/g,AO=/\0/g;function TO(n){let e;e=n.src.replace(_O,`
`),e=e.replace(AO,""),n.src=e}function DO(n){let e;n.inlineMode?(e=new n.Token("inline","",0),e.content=n.src,e.map=[0,1],e.children=[],n.tokens.push(e)):n.md.block.parse(n.src,n.md,n.env,n.tokens)}function MO(n){const e=n.tokens;for(let t=0,r=e.length;t<r;t++){const i=e[t];i.type==="inline"&&n.md.inline.parse(i.content,n.md,n.env,i.children)}}function OO(n){return/^<a[>\s]/i.test(n)}function IO(n){return/^<\/a\s*>/i.test(n)}function NO(n){const e=n.tokens;if(n.md.options.linkify)for(let t=0,r=e.length;t<r;t++){if(e[t].type!=="inline"||!n.md.linkify.pretest(e[t].content))continue;let i=e[t].children,o=0;for(let s=i.length-1;s>=0;s--){const a=i[s];if(a.type==="link_close"){for(s--;i[s].level!==a.level&&i[s].type!=="link_open";)s--;continue}if(a.type==="html_inline"&&(OO(a.content)&&o>0&&o--,IO(a.content)&&o++),!(o>0)&&a.type==="text"&&n.md.linkify.test(a.content)){const l=a.content;let d=n.md.linkify.match(l);const f=[];let h=a.level,m=0;d.length>0&&d[0].index===0&&s>0&&i[s-1].type==="text_special"&&(d=d.slice(1));for(let g=0;g<d.length;g++){const b=d[g].url,v=n.md.normalizeLink(b);if(!n.md.validateLink(v))continue;let x=d[g].text;d[g].schema?d[g].schema==="mailto:"&&!/^mailto:/i.test(x)?x=n.md.normalizeLinkText("mailto:"+x).replace(/^mailto:/,""):x=n.md.normalizeLinkText(x):x=n.md.normalizeLinkText("http://"+x).replace(/^http:\/\//,"");const E=d[g].index;if(E>m){const P=new n.Token("text","",0);P.content=l.slice(m,E),P.level=h,f.push(P)}const A=new n.Token("link_open","a",1);A.attrs=[["href",v]],A.level=h++,A.markup="linkify",A.info="auto",f.push(A);const M=new n.Token("text","",0);M.content=x,M.level=h,f.push(M);const C=new n.Token("link_close","a",-1);C.level=--h,C.markup="linkify",C.info="auto",f.push(C),m=d[g].lastIndex}if(m<l.length){const g=new n.Token("text","",0);g.content=l.slice(m),g.level=h,f.push(g)}e[t].children=i=Dx(i,s,f)}}}}const Ix=/\+-|\.\.|\?\?\?\?|!!!!|,,|--/,PO=/\((c|tm|r)\)/i,FO=/\((c|tm|r)\)/ig,RO={c:"",r:"",tm:""};function LO(n,e){return RO[e.toLowerCase()]}function BO(n){let e=0;for(let t=n.length-1;t>=0;t--){const r=n[t];r.type==="text"&&!e&&(r.content=r.content.replace(FO,LO)),r.type==="link_open"&&r.info==="auto"&&e--,r.type==="link_close"&&r.info==="auto"&&e++}}function $O(n){let e=0;for(let t=n.length-1;t>=0;t--){const r=n[t];r.type==="text"&&!e&&Ix.test(r.content)&&(r.content=r.content.replace(/\+-/g,"").replace(/\.{2,}/g,"").replace(/([?!])/g,"$1..").replace(/([?!]){4,}/g,"$1$1$1").replace(/,{2,}/g,",").replace(/(^|[^-])---(?=[^-]|$)/mg,"$1").replace(/(^|\s)--(?=\s|$)/mg,"$1").replace(/(^|[^-\s])--(?=[^-\s]|$)/mg,"$1")),r.type==="link_open"&&r.info==="auto"&&e--,r.type==="link_close"&&r.info==="auto"&&e++}}function zO(n){let e;if(n.md.options.typographer)for(e=n.tokens.length-1;e>=0;e--)n.tokens[e].type==="inline"&&(PO.test(n.tokens[e].content)&&BO(n.tokens[e].children),Ix.test(n.tokens[e].content)&&$O(n.tokens[e].children))}const HO=/['"]/,ib=/['"]/g,ob="";function Tl(n,e,t){return n.slice(0,e)+t+n.slice(e+1)}function qO(n,e){let t;const r=[];for(let i=0;i<n.length;i++){const o=n[i],s=n[i].level;for(t=r.length-1;t>=0&&!(r[t].level<=s);t--);if(r.length=t+1,o.type!=="text")continue;let a=o.content,l=0,d=a.length;e:for(;l<d;){ib.lastIndex=l;const f=ib.exec(a);if(!f)break;let h=!0,m=!0;l=f.index+1;const g=f[0]==="'";let b=32;if(f.index-1>=0)b=a.charCodeAt(f.index-1);else for(t=i-1;t>=0&&!(n[t].type==="softbreak"||n[t].type==="hardbreak");t--)if(n[t].content){b=n[t].content.charCodeAt(n[t].content.length-1);break}let v=32;if(l<d)v=a.charCodeAt(l);else for(t=i+1;t<n.length&&!(n[t].type==="softbreak"||n[t].type==="hardbreak");t++)if(n[t].content){v=n[t].content.charCodeAt(0);break}const x=ou(b)||iu(String.fromCharCode(b)),E=ou(v)||iu(String.fromCharCode(v)),A=ru(b),M=ru(v);if(M?h=!1:E&&(A||x||(h=!1)),A?m=!1:x&&(M||E||(m=!1)),v===34&&f[0]==='"'&&b>=48&&b<=57&&(m=h=!1),h&&m&&(h=x,m=E),!h&&!m){g&&(o.content=Tl(o.content,f.index,ob));continue}if(m)for(t=r.length-1;t>=0;t--){let C=r[t];if(r[t].level<s)break;if(C.single===g&&r[t].level===s){C=r[t];let P,N;g?(P=e.md.options.quotes[2],N=e.md.options.quotes[3]):(P=e.md.options.quotes[0],N=e.md.options.quotes[1]),o.content=Tl(o.content,f.index,N),n[C.token].content=Tl(n[C.token].content,C.pos,P),l+=N.length-1,C.token===i&&(l+=P.length-1),a=o.content,d=a.length,r.length=t;continue e}}h?r.push({token:i,pos:f.index,single:g,level:s}):m&&g&&(o.content=Tl(o.content,f.index,ob))}}}function VO(n){if(n.md.options.typographer)for(let e=n.tokens.length-1;e>=0;e--)n.tokens[e].type!=="inline"||!HO.test(n.tokens[e].content)||qO(n.tokens[e].children,n)}function WO(n){let e,t;const r=n.tokens,i=r.length;for(let o=0;o<i;o++){if(r[o].type!=="inline")continue;const s=r[o].children,a=s.length;for(e=0;e<a;e++)s[e].type==="text_special"&&(s[e].type="text");for(e=t=0;e<a;e++)s[e].type==="text"&&e+1<a&&s[e+1].type==="text"?s[e+1].content=s[e].content+s[e+1].content:(e!==t&&(s[t]=s[e]),t++);e!==t&&(s.length=t)}}const Uf=[["normalize",TO],["block",DO],["inline",MO],["linkify",NO],["replacements",zO],["smartquotes",VO],["text_join",WO]];function Np(){this.ruler=new Sn;for(let n=0;n<Uf.length;n++)this.ruler.push(Uf[n][0],Uf[n][1])}Np.prototype.process=function(n){const e=this.ruler.getRules("");for(let t=0,r=e.length;t<r;t++)e[t](n)};Np.prototype.State=Ox;function Wr(n,e,t,r){this.src=n,this.md=e,this.env=t,this.tokens=r,this.bMarks=[],this.eMarks=[],this.tShift=[],this.sCount=[],this.bsCount=[],this.blkIndent=0,this.line=0,this.lineMax=0,this.tight=!1,this.ddIndent=-1,this.listIndent=-1,this.parentType="root",this.level=0;const i=this.src;for(let o=0,s=0,a=0,l=0,d=i.length,f=!1;s<d;s++){const h=i.charCodeAt(s);if(!f)if(je(h)){a++,h===9?l+=4-l%4:l++;continue}else f=!0;(h===10||s===d-1)&&(h!==10&&s++,this.bMarks.push(o),this.eMarks.push(s),this.tShift.push(a),this.sCount.push(l),this.bsCount.push(0),f=!1,a=0,l=0,o=s+1)}this.bMarks.push(i.length),this.eMarks.push(i.length),this.tShift.push(0),this.sCount.push(0),this.bsCount.push(0),this.lineMax=this.bMarks.length-1}Wr.prototype.push=function(n,e,t){const r=new kr(n,e,t);return r.block=!0,t<0&&this.level--,r.level=this.level,t>0&&this.level++,this.tokens.push(r),r};Wr.prototype.isEmpty=function(e){return this.bMarks[e]+this.tShift[e]>=this.eMarks[e]};Wr.prototype.skipEmptyLines=function(e){for(let t=this.lineMax;e<t&&!(this.bMarks[e]+this.tShift[e]<this.eMarks[e]);e++);return e};Wr.prototype.skipSpaces=function(e){for(let t=this.src.length;e<t;e++){const r=this.src.charCodeAt(e);if(!je(r))break}return e};Wr.prototype.skipSpacesBack=function(e,t){if(e<=t)return e;for(;e>t;)if(!je(this.src.charCodeAt(--e)))return e+1;return e};Wr.prototype.skipChars=function(e,t){for(let r=this.src.length;e<r&&this.src.charCodeAt(e)===t;e++);return e};Wr.prototype.skipCharsBack=function(e,t,r){if(e<=r)return e;for(;e>r;)if(t!==this.src.charCodeAt(--e))return e+1;return e};Wr.prototype.getLines=function(e,t,r,i){if(e>=t)return"";const o=new Array(t-e);for(let s=0,a=e;a<t;a++,s++){let l=0;const d=this.bMarks[a];let f=d,h;for(a+1<t||i?h=this.eMarks[a]+1:h=this.eMarks[a];f<h&&l<r;){const m=this.src.charCodeAt(f);if(je(m))m===9?l+=4-(l+this.bsCount[a])%4:l++;else if(f-d<this.tShift[a])l++;else break;f++}l>r?o[s]=new Array(l-r+1).join(" ")+this.src.slice(f,h):o[s]=this.src.slice(f,h)}return o.join("")};Wr.prototype.Token=kr;const UO=65536;function Kf(n,e){const t=n.bMarks[e]+n.tShift[e],r=n.eMarks[e];return n.src.slice(t,r)}function sb(n){const e=[],t=n.length;let r=0,i=n.charCodeAt(r),o=!1,s=0,a="";for(;r<t;)i===124&&(o?(a+=n.substring(s,r-1),s=r):(e.push(a+n.substring(s,r)),a="",s=r+1)),o=i===92,r++,i=n.charCodeAt(r);return e.push(a+n.substring(s)),e}function KO(n,e,t,r){if(e+2>t)return!1;let i=e+1;if(n.sCount[i]<n.blkIndent||n.sCount[i]-n.blkIndent>=4)return!1;let o=n.bMarks[i]+n.tShift[i];if(o>=n.eMarks[i])return!1;const s=n.src.charCodeAt(o++);if(s!==124&&s!==45&&s!==58||o>=n.eMarks[i])return!1;const a=n.src.charCodeAt(o++);if(a!==124&&a!==45&&a!==58&&!je(a)||s===45&&je(a))return!1;for(;o<n.eMarks[i];){const C=n.src.charCodeAt(o);if(C!==124&&C!==45&&C!==58&&!je(C))return!1;o++}let l=Kf(n,e+1),d=l.split("|");const f=[];for(let C=0;C<d.length;C++){const P=d[C].trim();if(!P){if(C===0||C===d.length-1)continue;return!1}if(!/^:?-+:?$/.test(P))return!1;P.charCodeAt(P.length-1)===58?f.push(P.charCodeAt(0)===58?"center":"right"):P.charCodeAt(0)===58?f.push("left"):f.push("")}if(l=Kf(n,e).trim(),l.indexOf("|")===-1||n.sCount[e]-n.blkIndent>=4)return!1;d=sb(l),d.length&&d[0]===""&&d.shift(),d.length&&d[d.length-1]===""&&d.pop();const h=d.length;if(h===0||h!==f.length)return!1;if(r)return!0;const m=n.parentType;n.parentType="table";const g=n.md.block.ruler.getRules("blockquote"),b=n.push("table_open","table",1),v=[e,0];b.map=v;const x=n.push("thead_open","thead",1);x.map=[e,e+1];const E=n.push("tr_open","tr",1);E.map=[e,e+1];for(let C=0;C<d.length;C++){const P=n.push("th_open","th",1);f[C]&&(P.attrs=[["style","text-align:"+f[C]]]);const N=n.push("inline","",0);N.content=d[C].trim(),N.children=[],n.push("th_close","th",-1)}n.push("tr_close","tr",-1),n.push("thead_close","thead",-1);let A,M=0;for(i=e+2;i<t&&!(n.sCount[i]<n.blkIndent);i++){let C=!1;for(let N=0,W=g.length;N<W;N++)if(g[N](n,i,t,!0)){C=!0;break}if(C||(l=Kf(n,i).trim(),!l)||n.sCount[i]-n.blkIndent>=4||(d=sb(l),d.length&&d[0]===""&&d.shift(),d.length&&d[d.length-1]===""&&d.pop(),M+=h-d.length,M>UO))break;if(i===e+2){const N=n.push("tbody_open","tbody",1);N.map=A=[e+2,0]}const P=n.push("tr_open","tr",1);P.map=[i,i+1];for(let N=0;N<h;N++){const W=n.push("td_open","td",1);f[N]&&(W.attrs=[["style","text-align:"+f[N]]]);const V=n.push("inline","",0);V.content=d[N]?d[N].trim():"",V.children=[],n.push("td_close","td",-1)}n.push("tr_close","tr",-1)}return A&&(n.push("tbody_close","tbody",-1),A[1]=i),n.push("table_close","table",-1),v[1]=i,n.parentType=m,n.line=i,!0}function jO(n,e,t){if(n.sCount[e]-n.blkIndent<4)return!1;let r=e+1,i=r;for(;r<t;){if(n.isEmpty(r)){r++;continue}if(n.sCount[r]-n.blkIndent>=4){r++,i=r;continue}break}n.line=i;const o=n.push("code_block","code",0);return o.content=n.getLines(e,i,4+n.blkIndent,!1)+`
`,o.map=[e,n.line],!0}function GO(n,e,t,r){let i=n.bMarks[e]+n.tShift[e],o=n.eMarks[e];if(n.sCount[e]-n.blkIndent>=4||i+3>o)return!1;const s=n.src.charCodeAt(i);if(s!==126&&s!==96)return!1;let a=i;i=n.skipChars(i,s);let l=i-a;if(l<3)return!1;const d=n.src.slice(a,i),f=n.src.slice(i,o);if(s===96&&f.indexOf(String.fromCharCode(s))>=0)return!1;if(r)return!0;let h=e,m=!1;for(;h++,!(h>=t||(i=a=n.bMarks[h]+n.tShift[h],o=n.eMarks[h],i<o&&n.sCount[h]<n.blkIndent));)if(n.src.charCodeAt(i)===s&&!(n.sCount[h]-n.blkIndent>=4)&&(i=n.skipChars(i,s),!(i-a<l)&&(i=n.skipSpaces(i),!(i<o)))){m=!0;break}l=n.sCount[e],n.line=h+(m?1:0);const g=n.push("fence","code",0);return g.info=f,g.content=n.getLines(e+1,h,l,!0),g.markup=d,g.map=[e,n.line],!0}function XO(n,e,t,r){let i=n.bMarks[e]+n.tShift[e],o=n.eMarks[e];const s=n.lineMax;if(n.sCount[e]-n.blkIndent>=4||n.src.charCodeAt(i)!==62)return!1;if(r)return!0;const a=[],l=[],d=[],f=[],h=n.md.block.ruler.getRules("blockquote"),m=n.parentType;n.parentType="blockquote";let g=!1,b;for(b=e;b<t;b++){const M=n.sCount[b]<n.blkIndent;if(i=n.bMarks[b]+n.tShift[b],o=n.eMarks[b],i>=o)break;if(n.src.charCodeAt(i++)===62&&!M){let P=n.sCount[b]+1,N,W;n.src.charCodeAt(i)===32?(i++,P++,W=!1,N=!0):n.src.charCodeAt(i)===9?(N=!0,(n.bsCount[b]+P)%4===3?(i++,P++,W=!1):W=!0):N=!1;let V=P;for(a.push(n.bMarks[b]),n.bMarks[b]=i;i<o;){const U=n.src.charCodeAt(i);if(je(U))U===9?V+=4-(V+n.bsCount[b]+(W?1:0))%4:V++;else break;i++}g=i>=o,l.push(n.bsCount[b]),n.bsCount[b]=n.sCount[b]+1+(N?1:0),d.push(n.sCount[b]),n.sCount[b]=V-P,f.push(n.tShift[b]),n.tShift[b]=i-n.bMarks[b];continue}if(g)break;let C=!1;for(let P=0,N=h.length;P<N;P++)if(h[P](n,b,t,!0)){C=!0;break}if(C){n.lineMax=b,n.blkIndent!==0&&(a.push(n.bMarks[b]),l.push(n.bsCount[b]),f.push(n.tShift[b]),d.push(n.sCount[b]),n.sCount[b]-=n.blkIndent);break}a.push(n.bMarks[b]),l.push(n.bsCount[b]),f.push(n.tShift[b]),d.push(n.sCount[b]),n.sCount[b]=-1}const v=n.blkIndent;n.blkIndent=0;const x=n.push("blockquote_open","blockquote",1);x.markup=">";const E=[e,0];x.map=E,n.md.block.tokenize(n,e,b);const A=n.push("blockquote_close","blockquote",-1);A.markup=">",n.lineMax=s,n.parentType=m,E[1]=n.line;for(let M=0;M<f.length;M++)n.bMarks[M+e]=a[M],n.tShift[M+e]=f[M],n.sCount[M+e]=d[M],n.bsCount[M+e]=l[M];return n.blkIndent=v,!0}function YO(n,e,t,r){const i=n.eMarks[e];if(n.sCount[e]-n.blkIndent>=4)return!1;let o=n.bMarks[e]+n.tShift[e];const s=n.src.charCodeAt(o++);if(s!==42&&s!==45&&s!==95)return!1;let a=1;for(;o<i;){const d=n.src.charCodeAt(o++);if(d!==s&&!je(d))return!1;d===s&&a++}if(a<3)return!1;if(r)return!0;n.line=e+1;const l=n.push("hr","hr",0);return l.map=[e,n.line],l.markup=Array(a+1).join(String.fromCharCode(s)),!0}function ab(n,e){const t=n.eMarks[e];let r=n.bMarks[e]+n.tShift[e];const i=n.src.charCodeAt(r++);if(i!==42&&i!==45&&i!==43)return-1;if(r<t){const o=n.src.charCodeAt(r);if(!je(o))return-1}return r}function ub(n,e){const t=n.bMarks[e]+n.tShift[e],r=n.eMarks[e];let i=t;if(i+1>=r)return-1;let o=n.src.charCodeAt(i++);if(o<48||o>57)return-1;for(;;){if(i>=r)return-1;if(o=n.src.charCodeAt(i++),o>=48&&o<=57){if(i-t>=10)return-1;continue}if(o===41||o===46)break;return-1}return i<r&&(o=n.src.charCodeAt(i),!je(o))?-1:i}function JO(n,e){const t=n.level+2;for(let r=e+2,i=n.tokens.length-2;r<i;r++)n.tokens[r].level===t&&n.tokens[r].type==="paragraph_open"&&(n.tokens[r+2].hidden=!0,n.tokens[r].hidden=!0,r+=2)}function ZO(n,e,t,r){let i,o,s,a,l=e,d=!0;if(n.sCount[l]-n.blkIndent>=4||n.listIndent>=0&&n.sCount[l]-n.listIndent>=4&&n.sCount[l]<n.blkIndent)return!1;let f=!1;r&&n.parentType==="paragraph"&&n.sCount[l]>=n.blkIndent&&(f=!0);let h,m,g;if((g=ub(n,l))>=0){if(h=!0,s=n.bMarks[l]+n.tShift[l],m=Number(n.src.slice(s,g-1)),f&&m!==1)return!1}else if((g=ab(n,l))>=0)h=!1;else return!1;if(f&&n.skipSpaces(g)>=n.eMarks[l])return!1;if(r)return!0;const b=n.src.charCodeAt(g-1),v=n.tokens.length;h?(a=n.push("ordered_list_open","ol",1),m!==1&&(a.attrs=[["start",m]])):a=n.push("bullet_list_open","ul",1);const x=[l,0];a.map=x,a.markup=String.fromCharCode(b);let E=!1;const A=n.md.block.ruler.getRules("list"),M=n.parentType;for(n.parentType="list";l<t;){o=g,i=n.eMarks[l];const C=n.sCount[l]+g-(n.bMarks[l]+n.tShift[l]);let P=C;for(;o<i;){const Me=n.src.charCodeAt(o);if(Me===9)P+=4-(P+n.bsCount[l])%4;else if(Me===32)P++;else break;o++}const N=o;let W;N>=i?W=1:W=P-C,W>4&&(W=1);const V=C+W;a=n.push("list_item_open","li",1),a.markup=String.fromCharCode(b);const U=[l,0];a.map=U,h&&(a.info=n.src.slice(s,g-1));const Q=n.tight,oe=n.tShift[l],me=n.sCount[l],se=n.listIndent;if(n.listIndent=n.blkIndent,n.blkIndent=V,n.tight=!0,n.tShift[l]=N-n.bMarks[l],n.sCount[l]=P,N>=i&&n.isEmpty(l+1)?n.line=Math.min(n.line+2,t):n.md.block.tokenize(n,l,t,!0),(!n.tight||E)&&(d=!1),E=n.line-l>1&&n.isEmpty(n.line-1),n.blkIndent=n.listIndent,n.listIndent=se,n.tShift[l]=oe,n.sCount[l]=me,n.tight=Q,a=n.push("list_item_close","li",-1),a.markup=String.fromCharCode(b),l=n.line,U[1]=l,l>=t||n.sCount[l]<n.blkIndent||n.sCount[l]-n.blkIndent>=4)break;let Ee=!1;for(let Me=0,he=A.length;Me<he;Me++)if(A[Me](n,l,t,!0)){Ee=!0;break}if(Ee)break;if(h){if(g=ub(n,l),g<0)break;s=n.bMarks[l]+n.tShift[l]}else if(g=ab(n,l),g<0)break;if(b!==n.src.charCodeAt(g-1))break}return h?a=n.push("ordered_list_close","ol",-1):a=n.push("bullet_list_close","ul",-1),a.markup=String.fromCharCode(b),x[1]=l,n.line=l,n.parentType=M,d&&JO(n,v),!0}function QO(n,e,t,r){let i=n.bMarks[e]+n.tShift[e],o=n.eMarks[e],s=e+1;if(n.sCount[e]-n.blkIndent>=4||n.src.charCodeAt(i)!==91)return!1;function a(A){const M=n.lineMax;if(A>=M||n.isEmpty(A))return null;let C=!1;if(n.sCount[A]-n.blkIndent>3&&(C=!0),n.sCount[A]<0&&(C=!0),!C){const W=n.md.block.ruler.getRules("reference"),V=n.parentType;n.parentType="reference";let U=!1;for(let Q=0,oe=W.length;Q<oe;Q++)if(W[Q](n,A,M,!0)){U=!0;break}if(n.parentType=V,U)return null}const P=n.bMarks[A]+n.tShift[A],N=n.eMarks[A];return n.src.slice(P,N+1)}let l=n.src.slice(i,o+1);o=l.length;let d=-1;for(i=1;i<o;i++){const A=l.charCodeAt(i);if(A===91)return!1;if(A===93){d=i;break}else if(A===10){const M=a(s);M!==null&&(l+=M,o=l.length,s++)}else if(A===92&&(i++,i<o&&l.charCodeAt(i)===10)){const M=a(s);M!==null&&(l+=M,o=l.length,s++)}}if(d<0||l.charCodeAt(d+1)!==58)return!1;for(i=d+2;i<o;i++){const A=l.charCodeAt(i);if(A===10){const M=a(s);M!==null&&(l+=M,o=l.length,s++)}else if(!je(A))break}const f=n.md.helpers.parseLinkDestination(l,i,o);if(!f.ok)return!1;const h=n.md.normalizeLink(f.str);if(!n.md.validateLink(h))return!1;i=f.pos;const m=i,g=s,b=i;for(;i<o;i++){const A=l.charCodeAt(i);if(A===10){const M=a(s);M!==null&&(l+=M,o=l.length,s++)}else if(!je(A))break}let v=n.md.helpers.parseLinkTitle(l,i,o);for(;v.can_continue;){const A=a(s);if(A===null)break;l+=A,i=o,o=l.length,s++,v=n.md.helpers.parseLinkTitle(l,i,o,v)}let x;for(i<o&&b!==i&&v.ok?(x=v.str,i=v.pos):(x="",i=m,s=g);i<o;){const A=l.charCodeAt(i);if(!je(A))break;i++}if(i<o&&l.charCodeAt(i)!==10&&x)for(x="",i=m,s=g;i<o;){const A=l.charCodeAt(i);if(!je(A))break;i++}if(i<o&&l.charCodeAt(i)!==10)return!1;const E=Hc(l.slice(1,d));return E?(r||(typeof n.env.references>"u"&&(n.env.references={}),typeof n.env.references[E]>"u"&&(n.env.references[E]={title:x,href:h}),n.line=s),!0):!1}const e5=["address","article","aside","base","basefont","blockquote","body","caption","center","col","colgroup","dd","details","dialog","dir","div","dl","dt","fieldset","figcaption","figure","footer","form","frame","frameset","h1","h2","h3","h4","h5","h6","head","header","hr","html","iframe","legend","li","link","main","menu","menuitem","nav","noframes","ol","optgroup","option","p","param","search","section","summary","table","tbody","td","tfoot","th","thead","title","tr","track","ul"],t5="[a-zA-Z_:][a-zA-Z0-9:._-]*",n5="[^\"'=<>`\\x00-\\x20]+",r5="'[^']*'",i5='"[^"]*"',o5="(?:"+n5+"|"+r5+"|"+i5+")",s5="(?:\\s+"+t5+"(?:\\s*=\\s*"+o5+")?)",Nx="<[A-Za-z][A-Za-z0-9\\-]*"+s5+"*\\s*\\/?>",Px="<\\/[A-Za-z][A-Za-z0-9\\-]*\\s*>",a5="<!---?>|<!--(?:[^-]|-[^-]|--[^>])*-->",u5="<[?][\\s\\S]*?[?]>",l5="<![A-Za-z][^>]*>",c5="<!\\[CDATA\\[[\\s\\S]*?\\]\\]>",d5=new RegExp("^(?:"+Nx+"|"+Px+"|"+a5+"|"+u5+"|"+l5+"|"+c5+")"),f5=new RegExp("^(?:"+Nx+"|"+Px+")"),hs=[[/^<(script|pre|style|textarea)(?=(\s|>|$))/i,/<\/(script|pre|style|textarea)>/i,!0],[/^<!--/,/-->/,!0],[/^<\?/,/\?>/,!0],[/^<![A-Z]/,/>/,!0],[/^<!\[CDATA\[/,/\]\]>/,!0],[new RegExp("^</?("+e5.join("|")+")(?=(\\s|/?>|$))","i"),/^$/,!0],[new RegExp(f5.source+"\\s*$"),/^$/,!1]];function h5(n,e,t,r){let i=n.bMarks[e]+n.tShift[e],o=n.eMarks[e];if(n.sCount[e]-n.blkIndent>=4||!n.md.options.html||n.src.charCodeAt(i)!==60)return!1;let s=n.src.slice(i,o),a=0;for(;a<hs.length&&!hs[a][0].test(s);a++);if(a===hs.length)return!1;if(r)return hs[a][2];let l=e+1;if(!hs[a][1].test(s)){for(;l<t&&!(n.sCount[l]<n.blkIndent);l++)if(i=n.bMarks[l]+n.tShift[l],o=n.eMarks[l],s=n.src.slice(i,o),hs[a][1].test(s)){s.length!==0&&l++;break}}n.line=l;const d=n.push("html_block","",0);return d.map=[e,l],d.content=n.getLines(e,l,n.blkIndent,!0),!0}function p5(n,e,t,r){let i=n.bMarks[e]+n.tShift[e],o=n.eMarks[e];if(n.sCount[e]-n.blkIndent>=4)return!1;let s=n.src.charCodeAt(i);if(s!==35||i>=o)return!1;let a=1;for(s=n.src.charCodeAt(++i);s===35&&i<o&&a<=6;)a++,s=n.src.charCodeAt(++i);if(a>6||i<o&&!je(s))return!1;if(r)return!0;o=n.skipSpacesBack(o,i);const l=n.skipCharsBack(o,35,i);l>i&&je(n.src.charCodeAt(l-1))&&(o=l),n.line=e+1;const d=n.push("heading_open","h"+String(a),1);d.markup="########".slice(0,a),d.map=[e,n.line];const f=n.push("inline","",0);f.content=n.src.slice(i,o).trim(),f.map=[e,n.line],f.children=[];const h=n.push("heading_close","h"+String(a),-1);return h.markup="########".slice(0,a),!0}function m5(n,e,t){const r=n.md.block.ruler.getRules("paragraph");if(n.sCount[e]-n.blkIndent>=4)return!1;const i=n.parentType;n.parentType="paragraph";let o=0,s,a=e+1;for(;a<t&&!n.isEmpty(a);a++){if(n.sCount[a]-n.blkIndent>3)continue;if(n.sCount[a]>=n.blkIndent){let g=n.bMarks[a]+n.tShift[a];const b=n.eMarks[a];if(g<b&&(s=n.src.charCodeAt(g),(s===45||s===61)&&(g=n.skipChars(g,s),g=n.skipSpaces(g),g>=b))){o=s===61?1:2;break}}if(n.sCount[a]<0)continue;let m=!1;for(let g=0,b=r.length;g<b;g++)if(r[g](n,a,t,!0)){m=!0;break}if(m)break}if(!o)return!1;const l=n.getLines(e,a,n.blkIndent,!1).trim();n.line=a+1;const d=n.push("heading_open","h"+String(o),1);d.markup=String.fromCharCode(s),d.map=[e,n.line];const f=n.push("inline","",0);f.content=l,f.map=[e,n.line-1],f.children=[];const h=n.push("heading_close","h"+String(o),-1);return h.markup=String.fromCharCode(s),n.parentType=i,!0}function g5(n,e,t){const r=n.md.block.ruler.getRules("paragraph"),i=n.parentType;let o=e+1;for(n.parentType="paragraph";o<t&&!n.isEmpty(o);o++){if(n.sCount[o]-n.blkIndent>3||n.sCount[o]<0)continue;let d=!1;for(let f=0,h=r.length;f<h;f++)if(r[f](n,o,t,!0)){d=!0;break}if(d)break}const s=n.getLines(e,o,n.blkIndent,!1).trim();n.line=o;const a=n.push("paragraph_open","p",1);a.map=[e,n.line];const l=n.push("inline","",0);return l.content=s,l.map=[e,n.line],l.children=[],n.push("paragraph_close","p",-1),n.parentType=i,!0}const Dl=[["table",KO,["paragraph","reference"]],["code",jO],["fence",GO,["paragraph","reference","blockquote","list"]],["blockquote",XO,["paragraph","reference","blockquote","list"]],["hr",YO,["paragraph","reference","blockquote","list"]],["list",ZO,["paragraph","reference","blockquote"]],["reference",QO],["html_block",h5,["paragraph","reference","blockquote"]],["heading",p5,["paragraph","reference","blockquote"]],["lheading",m5],["paragraph",g5]];function qc(){this.ruler=new Sn;for(let n=0;n<Dl.length;n++)this.ruler.push(Dl[n][0],Dl[n][1],{alt:(Dl[n][2]||[]).slice()})}qc.prototype.tokenize=function(n,e,t){const r=this.ruler.getRules(""),i=r.length,o=n.md.options.maxNesting;let s=e,a=!1;for(;s<t&&(n.line=s=n.skipEmptyLines(s),!(s>=t||n.sCount[s]<n.blkIndent));){if(n.level>=o){n.line=t;break}const l=n.line;let d=!1;for(let f=0;f<i;f++)if(d=r[f](n,s,t,!1),d){if(l>=n.line)throw new Error("block rule didn't increment state.line");break}if(!d)throw new Error("none of the block rules matched");n.tight=!a,n.isEmpty(n.line-1)&&(a=!0),s=n.line,s<t&&n.isEmpty(s)&&(a=!0,s++,n.line=s)}};qc.prototype.parse=function(n,e,t,r){if(!n)return;const i=new this.State(n,e,t,r);this.tokenize(i,i.line,i.lineMax)};qc.prototype.State=Wr;function yu(n,e,t,r){this.src=n,this.env=t,this.md=e,this.tokens=r,this.tokens_meta=Array(r.length),this.pos=0,this.posMax=this.src.length,this.level=0,this.pending="",this.pendingLevel=0,this.cache={},this.delimiters=[],this._prev_delimiters=[],this.backticks={},this.backticksScanned=!1,this.linkLevel=0}yu.prototype.pushPending=function(){const n=new kr("text","",0);return n.content=this.pending,n.level=this.pendingLevel,this.tokens.push(n),this.pending="",n};yu.prototype.push=function(n,e,t){this.pending&&this.pushPending();const r=new kr(n,e,t);let i=null;return t<0&&(this.level--,this.delimiters=this._prev_delimiters.pop()),r.level=this.level,t>0&&(this.level++,this._prev_delimiters.push(this.delimiters),this.delimiters=[],i={delimiters:this.delimiters}),this.pendingLevel=this.level,this.tokens.push(r),this.tokens_meta.push(i),r};yu.prototype.scanDelims=function(n,e){const t=this.posMax,r=this.src.charCodeAt(n),i=n>0?this.src.charCodeAt(n-1):32;let o=n;for(;o<t&&this.src.charCodeAt(o)===r;)o++;const s=o-n,a=o<t?this.src.charCodeAt(o):32,l=ou(i)||iu(String.fromCharCode(i)),d=ou(a)||iu(String.fromCharCode(a)),f=ru(i),h=ru(a),m=!h&&(!d||f||l),g=!f&&(!l||h||d);return{can_open:m&&(e||!g||l),can_close:g&&(e||!m||d),length:s}};yu.prototype.Token=kr;function b5(n){switch(n){case 10:case 33:case 35:case 36:case 37:case 38:case 42:case 43:case 45:case 58:case 60:case 61:case 62:case 64:case 91:case 92:case 93:case 94:case 95:case 96:case 123:case 125:case 126:return!0;default:return!1}}function y5(n,e){let t=n.pos;for(;t<n.posMax&&!b5(n.src.charCodeAt(t));)t++;return t===n.pos?!1:(e||(n.pending+=n.src.slice(n.pos,t)),n.pos=t,!0)}const v5=/(?:^|[^a-z0-9.+-])([a-z][a-z0-9.+-]*)$/i;function x5(n,e){if(!n.md.options.linkify||n.linkLevel>0)return!1;const t=n.pos,r=n.posMax;if(t+3>r||n.src.charCodeAt(t)!==58||n.src.charCodeAt(t+1)!==47||n.src.charCodeAt(t+2)!==47)return!1;const i=n.pending.match(v5);if(!i)return!1;const o=i[1],s=n.md.linkify.matchAtStart(n.src.slice(t-o.length));if(!s)return!1;let a=s.url;if(a.length<=o.length)return!1;a=a.replace(/\*+$/,"");const l=n.md.normalizeLink(a);if(!n.md.validateLink(l))return!1;if(!e){n.pending=n.pending.slice(0,-o.length);const d=n.push("link_open","a",1);d.attrs=[["href",l]],d.markup="linkify",d.info="auto";const f=n.push("text","",0);f.content=n.md.normalizeLinkText(a);const h=n.push("link_close","a",-1);h.markup="linkify",h.info="auto"}return n.pos+=a.length-o.length,!0}function w5(n,e){let t=n.pos;if(n.src.charCodeAt(t)!==10)return!1;const r=n.pending.length-1,i=n.posMax;if(!e)if(r>=0&&n.pending.charCodeAt(r)===32)if(r>=1&&n.pending.charCodeAt(r-1)===32){let o=r-1;for(;o>=1&&n.pending.charCodeAt(o-1)===32;)o--;n.pending=n.pending.slice(0,o),n.push("hardbreak","br",0)}else n.pending=n.pending.slice(0,-1),n.push("softbreak","br",0);else n.push("softbreak","br",0);for(t++;t<i&&je(n.src.charCodeAt(t));)t++;return n.pos=t,!0}const Pp=[];for(let n=0;n<256;n++)Pp.push(0);"\\!\"#$%&'()*+,./:;<=>?@[]^_`{|}~-".split("").forEach(function(n){Pp[n.charCodeAt(0)]=1});function k5(n,e){let t=n.pos;const r=n.posMax;if(n.src.charCodeAt(t)!==92||(t++,t>=r))return!1;let i=n.src.charCodeAt(t);if(i===10){for(e||n.push("hardbreak","br",0),t++;t<r&&(i=n.src.charCodeAt(t),!!je(i));)t++;return n.pos=t,!0}let o=n.src[t];if(i>=55296&&i<=56319&&t+1<r){const a=n.src.charCodeAt(t+1);a>=56320&&a<=57343&&(o+=n.src[t+1],t++)}const s="\\"+o;if(!e){const a=n.push("text_special","",0);i<256&&Pp[i]!==0?a.content=o:a.content=s,a.markup=s,a.info="escape"}return n.pos=t+1,!0}function S5(n,e){let t=n.pos;if(n.src.charCodeAt(t)!==96)return!1;const i=t;t++;const o=n.posMax;for(;t<o&&n.src.charCodeAt(t)===96;)t++;const s=n.src.slice(i,t),a=s.length;if(n.backticksScanned&&(n.backticks[a]||0)<=i)return e||(n.pending+=s),n.pos+=a,!0;let l=t,d;for(;(d=n.src.indexOf("`",l))!==-1;){for(l=d+1;l<o&&n.src.charCodeAt(l)===96;)l++;const f=l-d;if(f===a){if(!e){const h=n.push("code_inline","code",0);h.markup=s,h.content=n.src.slice(t,d).replace(/\n/g," ").replace(/^ (.+) $/,"$1")}return n.pos=l,!0}n.backticks[f]=d}return n.backticksScanned=!0,e||(n.pending+=s),n.pos+=a,!0}function C5(n,e){const t=n.pos,r=n.src.charCodeAt(t);if(e||r!==126)return!1;const i=n.scanDelims(n.pos,!0);let o=i.length;const s=String.fromCharCode(r);if(o<2)return!1;let a;o%2&&(a=n.push("text","",0),a.content=s,o--);for(let l=0;l<o;l+=2)a=n.push("text","",0),a.content=s+s,n.delimiters.push({marker:r,length:0,token:n.tokens.length-1,end:-1,open:i.can_open,close:i.can_close});return n.pos+=i.length,!0}function lb(n,e){let t;const r=[],i=e.length;for(let o=0;o<i;o++){const s=e[o];if(s.marker!==126||s.end===-1)continue;const a=e[s.end];t=n.tokens[s.token],t.type="s_open",t.tag="s",t.nesting=1,t.markup="~~",t.content="",t=n.tokens[a.token],t.type="s_close",t.tag="s",t.nesting=-1,t.markup="~~",t.content="",n.tokens[a.token-1].type==="text"&&n.tokens[a.token-1].content==="~"&&r.push(a.token-1)}for(;r.length;){const o=r.pop();let s=o+1;for(;s<n.tokens.length&&n.tokens[s].type==="s_close";)s++;s--,o!==s&&(t=n.tokens[s],n.tokens[s]=n.tokens[o],n.tokens[o]=t)}}function E5(n){const e=n.tokens_meta,t=n.tokens_meta.length;lb(n,n.delimiters);for(let r=0;r<t;r++)e[r]&&e[r].delimiters&&lb(n,e[r].delimiters)}const Fx={tokenize:C5,postProcess:E5};function _5(n,e){const t=n.pos,r=n.src.charCodeAt(t);if(e||r!==95&&r!==42)return!1;const i=n.scanDelims(n.pos,r===42);for(let o=0;o<i.length;o++){const s=n.push("text","",0);s.content=String.fromCharCode(r),n.delimiters.push({marker:r,length:i.length,token:n.tokens.length-1,end:-1,open:i.can_open,close:i.can_close})}return n.pos+=i.length,!0}function cb(n,e){const t=e.length;for(let r=t-1;r>=0;r--){const i=e[r];if(i.marker!==95&&i.marker!==42||i.end===-1)continue;const o=e[i.end],s=r>0&&e[r-1].end===i.end+1&&e[r-1].marker===i.marker&&e[r-1].token===i.token-1&&e[i.end+1].token===o.token+1,a=String.fromCharCode(i.marker),l=n.tokens[i.token];l.type=s?"strong_open":"em_open",l.tag=s?"strong":"em",l.nesting=1,l.markup=s?a+a:a,l.content="";const d=n.tokens[o.token];d.type=s?"strong_close":"em_close",d.tag=s?"strong":"em",d.nesting=-1,d.markup=s?a+a:a,d.content="",s&&(n.tokens[e[r-1].token].content="",n.tokens[e[i.end+1].token].content="",r--)}}function A5(n){const e=n.tokens_meta,t=n.tokens_meta.length;cb(n,n.delimiters);for(let r=0;r<t;r++)e[r]&&e[r].delimiters&&cb(n,e[r].delimiters)}const Rx={tokenize:_5,postProcess:A5};function T5(n,e){let t,r,i,o,s="",a="",l=n.pos,d=!0;if(n.src.charCodeAt(n.pos)!==91)return!1;const f=n.pos,h=n.posMax,m=n.pos+1,g=n.md.helpers.parseLinkLabel(n,n.pos,!0);if(g<0)return!1;let b=g+1;if(b<h&&n.src.charCodeAt(b)===40){for(d=!1,b++;b<h&&(t=n.src.charCodeAt(b),!(!je(t)&&t!==10));b++);if(b>=h)return!1;if(l=b,i=n.md.helpers.parseLinkDestination(n.src,b,n.posMax),i.ok){for(s=n.md.normalizeLink(i.str),n.md.validateLink(s)?b=i.pos:s="",l=b;b<h&&(t=n.src.charCodeAt(b),!(!je(t)&&t!==10));b++);if(i=n.md.helpers.parseLinkTitle(n.src,b,n.posMax),b<h&&l!==b&&i.ok)for(a=i.str,b=i.pos;b<h&&(t=n.src.charCodeAt(b),!(!je(t)&&t!==10));b++);}(b>=h||n.src.charCodeAt(b)!==41)&&(d=!0),b++}if(d){if(typeof n.env.references>"u")return!1;if(b<h&&n.src.charCodeAt(b)===91?(l=b+1,b=n.md.helpers.parseLinkLabel(n,b),b>=0?r=n.src.slice(l,b++):b=g+1):b=g+1,r||(r=n.src.slice(m,g)),o=n.env.references[Hc(r)],!o)return n.pos=f,!1;s=o.href,a=o.title}if(!e){n.pos=m,n.posMax=g;const v=n.push("link_open","a",1),x=[["href",s]];v.attrs=x,a&&x.push(["title",a]),n.linkLevel++,n.md.inline.tokenize(n),n.linkLevel--,n.push("link_close","a",-1)}return n.pos=b,n.posMax=h,!0}function D5(n,e){let t,r,i,o,s,a,l,d,f="";const h=n.pos,m=n.posMax;if(n.src.charCodeAt(n.pos)!==33||n.src.charCodeAt(n.pos+1)!==91)return!1;const g=n.pos+2,b=n.md.helpers.parseLinkLabel(n,n.pos+1,!1);if(b<0)return!1;if(o=b+1,o<m&&n.src.charCodeAt(o)===40){for(o++;o<m&&(t=n.src.charCodeAt(o),!(!je(t)&&t!==10));o++);if(o>=m)return!1;for(d=o,a=n.md.helpers.parseLinkDestination(n.src,o,n.posMax),a.ok&&(f=n.md.normalizeLink(a.str),n.md.validateLink(f)?o=a.pos:f=""),d=o;o<m&&(t=n.src.charCodeAt(o),!(!je(t)&&t!==10));o++);if(a=n.md.helpers.parseLinkTitle(n.src,o,n.posMax),o<m&&d!==o&&a.ok)for(l=a.str,o=a.pos;o<m&&(t=n.src.charCodeAt(o),!(!je(t)&&t!==10));o++);else l="";if(o>=m||n.src.charCodeAt(o)!==41)return n.pos=h,!1;o++}else{if(typeof n.env.references>"u")return!1;if(o<m&&n.src.charCodeAt(o)===91?(d=o+1,o=n.md.helpers.parseLinkLabel(n,o),o>=0?i=n.src.slice(d,o++):o=b+1):o=b+1,i||(i=n.src.slice(g,b)),s=n.env.references[Hc(i)],!s)return n.pos=h,!1;f=s.href,l=s.title}if(!e){r=n.src.slice(g,b);const v=[];n.md.inline.parse(r,n.md,n.env,v);const x=n.push("image","img",0),E=[["src",f],["alt",""]];x.attrs=E,x.children=v,x.content=r,l&&E.push(["title",l])}return n.pos=o,n.posMax=m,!0}const M5=/^([a-zA-Z0-9.!#$%&'*+/=?^_`{|}~-]+@[a-zA-Z0-9](?:[a-zA-Z0-9-]{0,61}[a-zA-Z0-9])?(?:\.[a-zA-Z0-9](?:[a-zA-Z0-9-]{0,61}[a-zA-Z0-9])?)*)$/,O5=/^([a-zA-Z][a-zA-Z0-9+.-]{1,31}):([^<>\x00-\x20]*)$/;function I5(n,e){let t=n.pos;if(n.src.charCodeAt(t)!==60)return!1;const r=n.pos,i=n.posMax;for(;;){if(++t>=i)return!1;const s=n.src.charCodeAt(t);if(s===60)return!1;if(s===62)break}const o=n.src.slice(r+1,t);if(O5.test(o)){const s=n.md.normalizeLink(o);if(!n.md.validateLink(s))return!1;if(!e){const a=n.push("link_open","a",1);a.attrs=[["href",s]],a.markup="autolink",a.info="auto";const l=n.push("text","",0);l.content=n.md.normalizeLinkText(o);const d=n.push("link_close","a",-1);d.markup="autolink",d.info="auto"}return n.pos+=o.length+2,!0}if(M5.test(o)){const s=n.md.normalizeLink("mailto:"+o);if(!n.md.validateLink(s))return!1;if(!e){const a=n.push("link_open","a",1);a.attrs=[["href",s]],a.markup="autolink",a.info="auto";const l=n.push("text","",0);l.content=n.md.normalizeLinkText(o);const d=n.push("link_close","a",-1);d.markup="autolink",d.info="auto"}return n.pos+=o.length+2,!0}return!1}function N5(n){return/^<a[>\s]/i.test(n)}function P5(n){return/^<\/a\s*>/i.test(n)}function F5(n){const e=n|32;return e>=97&&e<=122}function R5(n,e){if(!n.md.options.html)return!1;const t=n.posMax,r=n.pos;if(n.src.charCodeAt(r)!==60||r+2>=t)return!1;const i=n.src.charCodeAt(r+1);if(i!==33&&i!==63&&i!==47&&!F5(i))return!1;const o=n.src.slice(r).match(d5);if(!o)return!1;if(!e){const s=n.push("html_inline","",0);s.content=o[0],N5(s.content)&&n.linkLevel++,P5(s.content)&&n.linkLevel--}return n.pos+=o[0].length,!0}const L5=/^&#((?:x[a-f0-9]{1,6}|[0-9]{1,7}));/i,B5=/^&([a-z][a-z0-9]{1,31});/i;function $5(n,e){const t=n.pos,r=n.posMax;if(n.src.charCodeAt(t)!==38||t+1>=r)return!1;if(n.src.charCodeAt(t+1)===35){const o=n.src.slice(t).match(L5);if(o){if(!e){const s=o[1][0].toLowerCase()==="x"?parseInt(o[1].slice(1),16):parseInt(o[1],10),a=n.push("text_special","",0);a.content=Ip(s)?yc(s):yc(65533),a.markup=o[0],a.info="entity"}return n.pos+=o[0].length,!0}}else{const o=n.src.slice(t).match(B5);if(o){const s=Tx(o[0]);if(s!==o[0]){if(!e){const a=n.push("text_special","",0);a.content=s,a.markup=o[0],a.info="entity"}return n.pos+=o[0].length,!0}}}return!1}function db(n){const e={},t=n.length;if(!t)return;let r=0,i=-2;const o=[];for(let s=0;s<t;s++){const a=n[s];if(o.push(0),(n[r].marker!==a.marker||i!==a.token-1)&&(r=s),i=a.token,a.length=a.length||0,!a.close)continue;e.hasOwnProperty(a.marker)||(e[a.marker]=[-1,-1,-1,-1,-1,-1]);const l=e[a.marker][(a.open?3:0)+a.length%3];let d=r-o[r]-1,f=d;for(;d>l;d-=o[d]+1){const h=n[d];if(h.marker===a.marker&&h.open&&h.end<0){let m=!1;if((h.close||a.open)&&(h.length+a.length)%3===0&&(h.length%3!==0||a.length%3!==0)&&(m=!0),!m){const g=d>0&&!n[d-1].open?o[d-1]+1:0;o[s]=s-d+g,o[d]=g,a.open=!1,h.end=s,h.close=!1,f=-1,i=-2;break}}}f!==-1&&(e[a.marker][(a.open?3:0)+(a.length||0)%3]=f)}}function z5(n){const e=n.tokens_meta,t=n.tokens_meta.length;db(n.delimiters);for(let r=0;r<t;r++)e[r]&&e[r].delimiters&&db(e[r].delimiters)}function H5(n){let e,t,r=0;const i=n.tokens,o=n.tokens.length;for(e=t=0;e<o;e++)i[e].nesting<0&&r--,i[e].level=r,i[e].nesting>0&&r++,i[e].type==="text"&&e+1<o&&i[e+1].type==="text"?i[e+1].content=i[e].content+i[e+1].content:(e!==t&&(i[t]=i[e]),t++);e!==t&&(i.length=t)}const jf=[["text",y5],["linkify",x5],["newline",w5],["escape",k5],["backticks",S5],["strikethrough",Fx.tokenize],["emphasis",Rx.tokenize],["link",T5],["image",D5],["autolink",I5],["html_inline",R5],["entity",$5]],Gf=[["balance_pairs",z5],["strikethrough",Fx.postProcess],["emphasis",Rx.postProcess],["fragments_join",H5]];function vu(){this.ruler=new Sn;for(let n=0;n<jf.length;n++)this.ruler.push(jf[n][0],jf[n][1]);this.ruler2=new Sn;for(let n=0;n<Gf.length;n++)this.ruler2.push(Gf[n][0],Gf[n][1])}vu.prototype.skipToken=function(n){const e=n.pos,t=this.ruler.getRules(""),r=t.length,i=n.md.options.maxNesting,o=n.cache;if(typeof o[e]<"u"){n.pos=o[e];return}let s=!1;if(n.level<i){for(let a=0;a<r;a++)if(n.level++,s=t[a](n,!0),n.level--,s){if(e>=n.pos)throw new Error("inline rule didn't increment state.pos");break}}else n.pos=n.posMax;s||n.pos++,o[e]=n.pos};vu.prototype.tokenize=function(n){const e=this.ruler.getRules(""),t=e.length,r=n.posMax,i=n.md.options.maxNesting;for(;n.pos<r;){const o=n.pos;let s=!1;if(n.level<i){for(let a=0;a<t;a++)if(s=e[a](n,!1),s){if(o>=n.pos)throw new Error("inline rule didn't increment state.pos");break}}if(s){if(n.pos>=r)break;continue}n.pending+=n.src[n.pos++]}n.pending&&n.pushPending()};vu.prototype.parse=function(n,e,t,r){const i=new this.State(n,e,t,r);this.tokenize(i);const o=this.ruler2.getRules(""),s=o.length;for(let a=0;a<s;a++)o[a](i)};vu.prototype.State=yu;function q5(n){const e={};n=n||{},e.src_Any=Sx.source,e.src_Cc=Cx.source,e.src_Z=_x.source,e.src_P=Mp.source,e.src_ZPCc=[e.src_Z,e.src_P,e.src_Cc].join("|"),e.src_ZCc=[e.src_Z,e.src_Cc].join("|");const t="[><]";return e.src_pseudo_letter="(?:(?!"+t+"|"+e.src_ZPCc+")"+e.src_Any+")",e.src_ip4="(?:(25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)\\.){3}(25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)",e.src_auth="(?:(?:(?!"+e.src_ZCc+"|[@/\\[\\]()]).)+@)?",e.src_port="(?::(?:6(?:[0-4]\\d{3}|5(?:[0-4]\\d{2}|5(?:[0-2]\\d|3[0-5])))|[1-5]?\\d{1,4}))?",e.src_host_terminator="(?=$|"+t+"|"+e.src_ZPCc+")(?!"+(n["---"]?"-(?!--)|":"-|")+"_|:\\d|\\.-|\\.(?!$|"+e.src_ZPCc+"))",e.src_path="(?:[/?#](?:(?!"+e.src_ZCc+"|"+t+`|[()[\\]{}.,"'?!\\-;]).|\\[(?:(?!`+e.src_ZCc+"|\\]).)*\\]|\\((?:(?!"+e.src_ZCc+"|[)]).)*\\)|\\{(?:(?!"+e.src_ZCc+'|[}]).)*\\}|\\"(?:(?!'+e.src_ZCc+`|["]).)+\\"|\\'(?:(?!`+e.src_ZCc+"|[']).)+\\'|\\'(?="+e.src_pseudo_letter+"|[-])|\\.{2,}[a-zA-Z0-9%/&]|\\.(?!"+e.src_ZCc+"|[.]|$)|"+(n["---"]?"\\-(?!--(?:[^-]|$))(?:-*)|":"\\-+|")+",(?!"+e.src_ZCc+"|$)|;(?!"+e.src_ZCc+"|$)|\\!+(?!"+e.src_ZCc+"|[!]|$)|\\?(?!"+e.src_ZCc+"|[?]|$))+|\\/)?",e.src_email_name='[\\-;:&=\\+\\$,\\.a-zA-Z0-9_][\\-;:&=\\+\\$,\\"\\.a-zA-Z0-9_]*',e.src_xn="xn--[a-z0-9\\-]{1,59}",e.src_domain_root="(?:"+e.src_xn+"|"+e.src_pseudo_letter+"{1,63})",e.src_domain="(?:"+e.src_xn+"|(?:"+e.src_pseudo_letter+")|(?:"+e.src_pseudo_letter+"(?:-|"+e.src_pseudo_letter+"){0,61}"+e.src_pseudo_letter+"))",e.src_host="(?:(?:(?:(?:"+e.src_domain+")\\.)*"+e.src_domain+"))",e.tpl_host_fuzzy="(?:"+e.src_ip4+"|(?:(?:(?:"+e.src_domain+")\\.)+(?:%TLDS%)))",e.tpl_host_no_ip_fuzzy="(?:(?:(?:"+e.src_domain+")\\.)+(?:%TLDS%))",e.src_host_strict=e.src_host+e.src_host_terminator,e.tpl_host_fuzzy_strict=e.tpl_host_fuzzy+e.src_host_terminator,e.src_host_port_strict=e.src_host+e.src_port+e.src_host_terminator,e.tpl_host_port_fuzzy_strict=e.tpl_host_fuzzy+e.src_port+e.src_host_terminator,e.tpl_host_port_no_ip_fuzzy_strict=e.tpl_host_no_ip_fuzzy+e.src_port+e.src_host_terminator,e.tpl_host_fuzzy_test="localhost|www\\.|\\.\\d{1,3}\\.|(?:\\.(?:%TLDS%)(?:"+e.src_ZPCc+"|>|$))",e.tpl_email_fuzzy="(^|"+t+'|"|\\(|'+e.src_ZCc+")("+e.src_email_name+"@"+e.tpl_host_fuzzy_strict+")",e.tpl_link_fuzzy="(^|(?![.:/\\-_@])(?:[$+<=>^`|]|"+e.src_ZPCc+"))((?![$+<=>^`|])"+e.tpl_host_port_fuzzy_strict+e.src_path+")",e.tpl_link_no_ip_fuzzy="(^|(?![.:/\\-_@])(?:[$+<=>^`|]|"+e.src_ZPCc+"))((?![$+<=>^`|])"+e.tpl_host_port_no_ip_fuzzy_strict+e.src_path+")",e}function qh(n){return Array.prototype.slice.call(arguments,1).forEach(function(t){t&&Object.keys(t).forEach(function(r){n[r]=t[r]})}),n}function Vc(n){return Object.prototype.toString.call(n)}function V5(n){return Vc(n)==="[object String]"}function W5(n){return Vc(n)==="[object Object]"}function U5(n){return Vc(n)==="[object RegExp]"}function fb(n){return Vc(n)==="[object Function]"}function K5(n){return n.replace(/[.?*+^$[\]\\(){}|-]/g,"\\$&")}const Lx={fuzzyLink:!0,fuzzyEmail:!0,fuzzyIP:!1};function j5(n){return Object.keys(n||{}).reduce(function(e,t){return e||Lx.hasOwnProperty(t)},!1)}const G5={"http:":{validate:function(n,e,t){const r=n.slice(e);return t.re.http||(t.re.http=new RegExp("^\\/\\/"+t.re.src_auth+t.re.src_host_port_strict+t.re.src_path,"i")),t.re.http.test(r)?r.match(t.re.http)[0].length:0}},"https:":"http:","ftp:":"http:","//":{validate:function(n,e,t){const r=n.slice(e);return t.re.no_http||(t.re.no_http=new RegExp("^"+t.re.src_auth+"(?:localhost|(?:(?:"+t.re.src_domain+")\\.)+"+t.re.src_domain_root+")"+t.re.src_port+t.re.src_host_terminator+t.re.src_path,"i")),t.re.no_http.test(r)?e>=3&&n[e-3]===":"||e>=3&&n[e-3]==="/"?0:r.match(t.re.no_http)[0].length:0}},"mailto:":{validate:function(n,e,t){const r=n.slice(e);return t.re.mailto||(t.re.mailto=new RegExp("^"+t.re.src_email_name+"@"+t.re.src_host_strict,"i")),t.re.mailto.test(r)?r.match(t.re.mailto)[0].length:0}}},X5="a[cdefgilmnoqrstuwxz]|b[abdefghijmnorstvwyz]|c[acdfghiklmnoruvwxyz]|d[ejkmoz]|e[cegrstu]|f[ijkmor]|g[abdefghilmnpqrstuwy]|h[kmnrtu]|i[delmnoqrst]|j[emop]|k[eghimnprwyz]|l[abcikrstuvy]|m[acdeghklmnopqrstuvwxyz]|n[acefgilopruz]|om|p[aefghklmnrstwy]|qa|r[eosuw]|s[abcdeghijklmnortuvxyz]|t[cdfghjklmnortvwz]|u[agksyz]|v[aceginu]|w[fs]|y[et]|z[amw]",Y5="biz|com|edu|gov|net|org|pro|web|xxx|aero|asia|coop|info|museum|name|shop|".split("|");function J5(n){n.__index__=-1,n.__text_cache__=""}function Z5(n){return function(e,t){const r=e.slice(t);return n.test(r)?r.match(n)[0].length:0}}function hb(){return function(n,e){e.normalize(n)}}function vc(n){const e=n.re=q5(n.__opts__),t=n.__tlds__.slice();n.onCompile(),n.__tlds_replaced__||t.push(X5),t.push(e.src_xn),e.src_tlds=t.join("|");function r(a){return a.replace("%TLDS%",e.src_tlds)}e.email_fuzzy=RegExp(r(e.tpl_email_fuzzy),"i"),e.link_fuzzy=RegExp(r(e.tpl_link_fuzzy),"i"),e.link_no_ip_fuzzy=RegExp(r(e.tpl_link_no_ip_fuzzy),"i"),e.host_fuzzy_test=RegExp(r(e.tpl_host_fuzzy_test),"i");const i=[];n.__compiled__={};function o(a,l){throw new Error('(LinkifyIt) Invalid schema "'+a+'": '+l)}Object.keys(n.__schemas__).forEach(function(a){const l=n.__schemas__[a];if(l===null)return;const d={validate:null,link:null};if(n.__compiled__[a]=d,W5(l)){U5(l.validate)?d.validate=Z5(l.validate):fb(l.validate)?d.validate=l.validate:o(a,l),fb(l.normalize)?d.normalize=l.normalize:l.normalize?o(a,l):d.normalize=hb();return}if(V5(l)){i.push(a);return}o(a,l)}),i.forEach(function(a){n.__compiled__[n.__schemas__[a]]&&(n.__compiled__[a].validate=n.__compiled__[n.__schemas__[a]].validate,n.__compiled__[a].normalize=n.__compiled__[n.__schemas__[a]].normalize)}),n.__compiled__[""]={validate:null,normalize:hb()};const s=Object.keys(n.__compiled__).filter(function(a){return a.length>0&&n.__compiled__[a]}).map(K5).join("|");n.re.schema_test=RegExp("(^|(?!_)(?:[><]|"+e.src_ZPCc+"))("+s+")","i"),n.re.schema_search=RegExp("(^|(?!_)(?:[><]|"+e.src_ZPCc+"))("+s+")","ig"),n.re.schema_at_start=RegExp("^"+n.re.schema_search.source,"i"),n.re.pretest=RegExp("("+n.re.schema_test.source+")|("+n.re.host_fuzzy_test.source+")|@","i"),J5(n)}function Q5(n,e){const t=n.__index__,r=n.__last_index__,i=n.__text_cache__.slice(t,r);this.schema=n.__schema__.toLowerCase(),this.index=t+e,this.lastIndex=r+e,this.raw=i,this.text=i,this.url=i}function Vh(n,e){const t=new Q5(n,e);return n.__compiled__[t.schema].normalize(t,n),t}function $n(n,e){if(!(this instanceof $n))return new $n(n,e);e||j5(n)&&(e=n,n={}),this.__opts__=qh({},Lx,e),this.__index__=-1,this.__last_index__=-1,this.__schema__="",this.__text_cache__="",this.__schemas__=qh({},G5,n),this.__compiled__={},this.__tlds__=Y5,this.__tlds_replaced__=!1,this.re={},vc(this)}$n.prototype.add=function(e,t){return this.__schemas__[e]=t,vc(this),this};$n.prototype.set=function(e){return this.__opts__=qh(this.__opts__,e),this};$n.prototype.test=function(e){if(this.__text_cache__=e,this.__index__=-1,!e.length)return!1;let t,r,i,o,s,a,l,d,f;if(this.re.schema_test.test(e)){for(l=this.re.schema_search,l.lastIndex=0;(t=l.exec(e))!==null;)if(o=this.testSchemaAt(e,t[2],l.lastIndex),o){this.__schema__=t[2],this.__index__=t.index+t[1].length,this.__last_index__=t.index+t[0].length+o;break}}return this.__opts__.fuzzyLink&&this.__compiled__["http:"]&&(d=e.search(this.re.host_fuzzy_test),d>=0&&(this.__index__<0||d<this.__index__)&&(r=e.match(this.__opts__.fuzzyIP?this.re.link_fuzzy:this.re.link_no_ip_fuzzy))!==null&&(s=r.index+r[1].length,(this.__index__<0||s<this.__index__)&&(this.__schema__="",this.__index__=s,this.__last_index__=r.index+r[0].length))),this.__opts__.fuzzyEmail&&this.__compiled__["mailto:"]&&(f=e.indexOf("@"),f>=0&&(i=e.match(this.re.email_fuzzy))!==null&&(s=i.index+i[1].length,a=i.index+i[0].length,(this.__index__<0||s<this.__index__||s===this.__index__&&a>this.__last_index__)&&(this.__schema__="mailto:",this.__index__=s,this.__last_index__=a))),this.__index__>=0};$n.prototype.pretest=function(e){return this.re.pretest.test(e)};$n.prototype.testSchemaAt=function(e,t,r){return this.__compiled__[t.toLowerCase()]?this.__compiled__[t.toLowerCase()].validate(e,r,this):0};$n.prototype.match=function(e){const t=[];let r=0;this.__index__>=0&&this.__text_cache__===e&&(t.push(Vh(this,r)),r=this.__last_index__);let i=r?e.slice(r):e;for(;this.test(i);)t.push(Vh(this,r)),i=i.slice(this.__last_index__),r+=this.__last_index__;return t.length?t:null};$n.prototype.matchAtStart=function(e){if(this.__text_cache__=e,this.__index__=-1,!e.length)return null;const t=this.re.schema_at_start.exec(e);if(!t)return null;const r=this.testSchemaAt(e,t[2],t[0].length);return r?(this.__schema__=t[2],this.__index__=t.index+t[1].length,this.__last_index__=t.index+t[0].length+r,Vh(this,0)):null};$n.prototype.tlds=function(e,t){return e=Array.isArray(e)?e:[e],t?(this.__tlds__=this.__tlds__.concat(e).sort().filter(function(r,i,o){return r!==o[i-1]}).reverse(),vc(this),this):(this.__tlds__=e.slice(),this.__tlds_replaced__=!0,vc(this),this)};$n.prototype.normalize=function(e){e.schema||(e.url="http://"+e.url),e.schema==="mailto:"&&!/^mailto:/i.test(e.url)&&(e.url="mailto:"+e.url)};$n.prototype.onCompile=function(){};const Ds=2147483647,Nr=36,Fp=1,su=26,eI=38,tI=700,Bx=72,$x=128,zx="-",nI=/^xn--/,rI=/[^\0-\x7F]/,iI=/[\x2E\u3002\uFF0E\uFF61]/g,oI={overflow:"Overflow: input needs wider integers to process","not-basic":"Illegal input >= 0x80 (not a basic code point)","invalid-input":"Invalid input"},Xf=Nr-Fp,Pr=Math.floor,Yf=String.fromCharCode;function Ni(n){throw new RangeError(oI[n])}function sI(n,e){const t=[];let r=n.length;for(;r--;)t[r]=e(n[r]);return t}function Hx(n,e){const t=n.split("@");let r="";t.length>1&&(r=t[0]+"@",n=t[1]),n=n.replace(iI,".");const i=n.split("."),o=sI(i,e).join(".");return r+o}function qx(n){const e=[];let t=0;const r=n.length;for(;t<r;){const i=n.charCodeAt(t++);if(i>=55296&&i<=56319&&t<r){const o=n.charCodeAt(t++);(o&64512)==56320?e.push(((i&1023)<<10)+(o&1023)+65536):(e.push(i),t--)}else e.push(i)}return e}const aI=n=>String.fromCodePoint(...n),uI=function(n){return n>=48&&n<58?26+(n-48):n>=65&&n<91?n-65:n>=97&&n<123?n-97:Nr},pb=function(n,e){return n+22+75*(n<26)-((e!=0)<<5)},Vx=function(n,e,t){let r=0;for(n=t?Pr(n/tI):n>>1,n+=Pr(n/e);n>Xf*su>>1;r+=Nr)n=Pr(n/Xf);return Pr(r+(Xf+1)*n/(n+eI))},Wx=function(n){const e=[],t=n.length;let r=0,i=$x,o=Bx,s=n.lastIndexOf(zx);s<0&&(s=0);for(let a=0;a<s;++a)n.charCodeAt(a)>=128&&Ni("not-basic"),e.push(n.charCodeAt(a));for(let a=s>0?s+1:0;a<t;){const l=r;for(let f=1,h=Nr;;h+=Nr){a>=t&&Ni("invalid-input");const m=uI(n.charCodeAt(a++));m>=Nr&&Ni("invalid-input"),m>Pr((Ds-r)/f)&&Ni("overflow"),r+=m*f;const g=h<=o?Fp:h>=o+su?su:h-o;if(m<g)break;const b=Nr-g;f>Pr(Ds/b)&&Ni("overflow"),f*=b}const d=e.length+1;o=Vx(r-l,d,l==0),Pr(r/d)>Ds-i&&Ni("overflow"),i+=Pr(r/d),r%=d,e.splice(r++,0,i)}return String.fromCodePoint(...e)},Ux=function(n){const e=[];n=qx(n);const t=n.length;let r=$x,i=0,o=Bx;for(const l of n)l<128&&e.push(Yf(l));const s=e.length;let a=s;for(s&&e.push(zx);a<t;){let l=Ds;for(const f of n)f>=r&&f<l&&(l=f);const d=a+1;l-r>Pr((Ds-i)/d)&&Ni("overflow"),i+=(l-r)*d,r=l;for(const f of n)if(f<r&&++i>Ds&&Ni("overflow"),f===r){let h=i;for(let m=Nr;;m+=Nr){const g=m<=o?Fp:m>=o+su?su:m-o;if(h<g)break;const b=h-g,v=Nr-g;e.push(Yf(pb(g+b%v,0))),h=Pr(b/v)}e.push(Yf(pb(h,0))),o=Vx(i,d,a===s),i=0,++a}++i,++r}return e.join("")},lI=function(n){return Hx(n,function(e){return nI.test(e)?Wx(e.slice(4).toLowerCase()):e})},cI=function(n){return Hx(n,function(e){return rI.test(e)?"xn--"+Ux(e):e})},Kx={version:"2.3.1",ucs2:{decode:qx,encode:aI},decode:Wx,encode:Ux,toASCII:cI,toUnicode:lI},dI={options:{html:!1,xhtmlOut:!1,breaks:!1,langPrefix:"language-",linkify:!1,typographer:!1,quotes:"",highlight:null,maxNesting:100},components:{core:{},block:{},inline:{}}},fI={options:{html:!1,xhtmlOut:!1,breaks:!1,langPrefix:"language-",linkify:!1,typographer:!1,quotes:"",highlight:null,maxNesting:20},components:{core:{rules:["normalize","block","inline","text_join"]},block:{rules:["paragraph"]},inline:{rules:["text"],rules2:["balance_pairs","fragments_join"]}}},hI={options:{html:!0,xhtmlOut:!0,breaks:!1,langPrefix:"language-",linkify:!1,typographer:!1,quotes:"",highlight:null,maxNesting:20},components:{core:{rules:["normalize","block","inline","text_join"]},block:{rules:["blockquote","code","fence","heading","hr","html_block","lheading","list","reference","paragraph"]},inline:{rules:["autolink","backticks","emphasis","entity","escape","html_inline","image","link","newline","text"],rules2:["balance_pairs","emphasis","fragments_join"]}}},pI={default:dI,zero:fI,commonmark:hI},mI=/^(vbscript|javascript|file|data):/,gI=/^data:image\/(gif|png|jpeg|webp);/;function bI(n){const e=n.trim().toLowerCase();return mI.test(e)?gI.test(e):!0}const jx=["http:","https:","mailto:"];function yI(n){const e=Dp(n,!0);if(e.hostname&&(!e.protocol||jx.indexOf(e.protocol)>=0))try{e.hostname=Kx.toASCII(e.hostname)}catch{}return bu(Tp(e))}function vI(n){const e=Dp(n,!0);if(e.hostname&&(!e.protocol||jx.indexOf(e.protocol)>=0))try{e.hostname=Kx.toUnicode(e.hostname)}catch{}return Rs(Tp(e),Rs.defaultChars+"%")}function Cn(n,e){if(!(this instanceof Cn))return new Cn(n,e);e||Op(n)||(e=n||{},n="default"),this.inline=new vu,this.block=new qc,this.core=new Np,this.renderer=new Vs,this.linkify=new $n,this.validateLink=bI,this.normalizeLink=yI,this.normalizeLinkText=vI,this.utils=wO,this.helpers=zc({},EO),this.options={},this.configure(n),e&&this.set(e)}Cn.prototype.set=function(n){return zc(this.options,n),this};Cn.prototype.configure=function(n){const e=this;if(Op(n)){const t=n;if(n=pI[t],!n)throw new Error('Wrong `markdown-it` preset "'+t+'", check name')}if(!n)throw new Error("Wrong `markdown-it` preset, can't be empty");return n.options&&e.set(n.options),n.components&&Object.keys(n.components).forEach(function(t){n.components[t].rules&&e[t].ruler.enableOnly(n.components[t].rules),n.components[t].rules2&&e[t].ruler2.enableOnly(n.components[t].rules2)}),this};Cn.prototype.enable=function(n,e){let t=[];Array.isArray(n)||(n=[n]),["core","block","inline"].forEach(function(i){t=t.concat(this[i].ruler.enable(n,!0))},this),t=t.concat(this.inline.ruler2.enable(n,!0));const r=n.filter(function(i){return t.indexOf(i)<0});if(r.length&&!e)throw new Error("MarkdownIt. Failed to enable unknown rule(s): "+r);return this};Cn.prototype.disable=function(n,e){let t=[];Array.isArray(n)||(n=[n]),["core","block","inline"].forEach(function(i){t=t.concat(this[i].ruler.disable(n,!0))},this),t=t.concat(this.inline.ruler2.disable(n,!0));const r=n.filter(function(i){return t.indexOf(i)<0});if(r.length&&!e)throw new Error("MarkdownIt. Failed to disable unknown rule(s): "+r);return this};Cn.prototype.use=function(n){const e=[this].concat(Array.prototype.slice.call(arguments,1));return n.apply(n,e),this};Cn.prototype.parse=function(n,e){if(typeof n!="string")throw new Error("Input data should be a String");const t=new this.core.State(n,this,e);return this.core.process(t),t.tokens};Cn.prototype.render=function(n,e){return e=e||{},this.renderer.render(this.parse(n,e),this.options,e)};Cn.prototype.parseInline=function(n,e){const t=new this.core.State(n,this,e);return t.inlineMode=!0,this.core.process(t),t.tokens};Cn.prototype.renderInline=function(n,e){return e=e||{},this.renderer.render(this.parseInline(n,e),this.options,e)};const xI=new np({nodes:{doc:{content:"block+"},paragraph:{content:"inline*",group:"block",parseDOM:[{tag:"p"}],toDOM(){return["p",0]}},blockquote:{content:"block+",group:"block",parseDOM:[{tag:"blockquote"}],toDOM(){return["blockquote",0]}},horizontal_rule:{group:"block",parseDOM:[{tag:"hr"}],toDOM(){return["div",["hr"]]}},heading:{attrs:{level:{default:1}},content:"(text | image)*",group:"block",defining:!0,parseDOM:[{tag:"h1",attrs:{level:1}},{tag:"h2",attrs:{level:2}},{tag:"h3",attrs:{level:3}},{tag:"h4",attrs:{level:4}},{tag:"h5",attrs:{level:5}},{tag:"h6",attrs:{level:6}}],toDOM(n){return["h"+n.attrs.level,0]}},code_block:{content:"text*",group:"block",code:!0,defining:!0,marks:"",attrs:{params:{default:""}},parseDOM:[{tag:"pre",preserveWhitespace:"full",getAttrs:n=>({params:n.getAttribute("data-params")||""})}],toDOM(n){return["pre",n.attrs.params?{"data-params":n.attrs.params}:{},["code",0]]}},ordered_list:{content:"list_item+",group:"block",attrs:{order:{default:1},tight:{default:!1}},parseDOM:[{tag:"ol",getAttrs(n){return{order:n.hasAttribute("start")?+n.getAttribute("start"):1,tight:n.hasAttribute("data-tight")}}}],toDOM(n){return["ol",{start:n.attrs.order==1?null:n.attrs.order,"data-tight":n.attrs.tight?"true":null},0]}},bullet_list:{content:"list_item+",group:"block",attrs:{tight:{default:!1}},parseDOM:[{tag:"ul",getAttrs:n=>({tight:n.hasAttribute("data-tight")})}],toDOM(n){return["ul",{"data-tight":n.attrs.tight?"true":null},0]}},list_item:{content:"block+",defining:!0,parseDOM:[{tag:"li"}],toDOM(){return["li",0]}},text:{group:"inline"},image:{inline:!0,attrs:{src:{},alt:{default:null},title:{default:null}},group:"inline",draggable:!0,parseDOM:[{tag:"img[src]",getAttrs(n){return{src:n.getAttribute("src"),title:n.getAttribute("title"),alt:n.getAttribute("alt")}}}],toDOM(n){return["img",n.attrs]}},hard_break:{inline:!0,group:"inline",selectable:!1,parseDOM:[{tag:"br"}],toDOM(){return["br"]}}},marks:{em:{parseDOM:[{tag:"i"},{tag:"em"},{style:"font-style=italic"},{style:"font-style=normal",clearMark:n=>n.type.name=="em"}],toDOM(){return["em"]}},strong:{parseDOM:[{tag:"strong"},{tag:"b",getAttrs:n=>n.style.fontWeight!="normal"&&null},{style:"font-weight=400",clearMark:n=>n.type.name=="strong"},{style:"font-weight",getAttrs:n=>/^(bold(er)?|[5-9]\d{2,})$/.test(n)&&null}],toDOM(){return["strong"]}},link:{attrs:{href:{},title:{default:null}},inclusive:!1,parseDOM:[{tag:"a[href]",getAttrs(n){return{href:n.getAttribute("href"),title:n.getAttribute("title")}}}],toDOM(n){return["a",n.attrs]}},code:{code:!0,parseDOM:[{tag:"code"}],toDOM(){return["code"]}}}});function wI(n,e){if(n.isText&&e.isText&&qe.sameSet(n.marks,e.marks))return n.withText(n.text+e.text)}class kI{constructor(e,t){this.schema=e,this.tokenHandlers=t,this.stack=[{type:e.topNodeType,attrs:null,content:[],marks:qe.none}]}top(){return this.stack[this.stack.length-1]}push(e){this.stack.length&&this.top().content.push(e)}addText(e){if(!e)return;let t=this.top(),r=t.content,i=r[r.length-1],o=this.schema.text(e,t.marks),s;i&&(s=wI(i,o))?r[r.length-1]=s:r.push(o)}openMark(e){let t=this.top();t.marks=e.addToSet(t.marks)}closeMark(e){let t=this.top();t.marks=e.removeFromSet(t.marks)}parseTokens(e){for(let t=0;t<e.length;t++){let r=e[t],i=this.tokenHandlers[r.type];if(!i)throw new Error("Token type `"+r.type+"` not supported by Markdown parser");i(this,r,e,t)}}addNode(e,t,r){let i=this.top(),o=e.createAndFill(t,r,i?i.marks:[]);return o?(this.push(o),o):null}openNode(e,t){this.stack.push({type:e,attrs:t,content:[],marks:qe.none})}closeNode(){let e=this.stack.pop();return this.addNode(e.type,e.attrs,e.content)}}function ya(n,e,t,r){return n.getAttrs?n.getAttrs(e,t,r):n.attrs instanceof Function?n.attrs(e):n.attrs}function Jf(n,e){return n.noCloseToken||e=="code_inline"||e=="code_block"||e=="fence"}function mb(n){return n[n.length-1]==`
`?n.slice(0,n.length-1):n}function Zf(){}function SI(n,e){let t=Object.create(null);for(let r in e){let i=e[r];if(i.block){let o=n.nodeType(i.block);Jf(i,r)?t[r]=(s,a,l,d)=>{s.openNode(o,ya(i,a,l,d)),s.addText(mb(a.content)),s.closeNode()}:(t[r+"_open"]=(s,a,l,d)=>s.openNode(o,ya(i,a,l,d)),t[r+"_close"]=s=>s.closeNode())}else if(i.node){let o=n.nodeType(i.node);t[r]=(s,a,l,d)=>s.addNode(o,ya(i,a,l,d))}else if(i.mark){let o=n.marks[i.mark];Jf(i,r)?t[r]=(s,a,l,d)=>{s.openMark(o.create(ya(i,a,l,d))),s.addText(mb(a.content)),s.closeMark(o)}:(t[r+"_open"]=(s,a,l,d)=>s.openMark(o.create(ya(i,a,l,d))),t[r+"_close"]=s=>s.closeMark(o))}else if(i.ignore)Jf(i,r)?t[r]=Zf:(t[r+"_open"]=Zf,t[r+"_close"]=Zf);else throw new RangeError("Unrecognized parsing spec "+JSON.stringify(i))}return t.text=(r,i)=>r.addText(i.content),t.inline=(r,i)=>r.parseTokens(i.children),t.softbreak=t.softbreak||(r=>r.addText(" ")),t}let CI=class{constructor(e,t,r){this.schema=e,this.tokenizer=t,this.tokens=r,this.tokenHandlers=SI(e,r)}parse(e,t={}){let r=new kI(this.schema,this.tokenHandlers),i;r.parseTokens(this.tokenizer.parse(e,t));do i=r.closeNode();while(r.stack.length);return i||this.schema.topNodeType.createAndFill()}};function gb(n,e){for(;++e<n.length;)if(n[e].type!="list_item_open")return n[e].hidden;return!1}new CI(xI,Cn("commonmark",{html:!1}),{blockquote:{block:"blockquote"},paragraph:{block:"paragraph"},list_item:{block:"list_item"},bullet_list:{block:"bullet_list",getAttrs:(n,e,t)=>({tight:gb(e,t)})},ordered_list:{block:"ordered_list",getAttrs:(n,e,t)=>({order:+n.attrGet("start")||1,tight:gb(e,t)})},heading:{block:"heading",getAttrs:n=>({level:+n.tag.slice(1)})},code_block:{block:"code_block",noCloseToken:!0},fence:{block:"code_block",getAttrs:n=>({params:n.info||""}),noCloseToken:!0},hr:{node:"horizontal_rule"},image:{node:"image",getAttrs:n=>({src:n.attrGet("src"),title:n.attrGet("title")||null,alt:n.children[0]&&n.children[0].content||null})},hardbreak:{node:"hard_break"},em:{mark:"em"},strong:{mark:"strong"},link:{mark:"link",getAttrs:n=>({href:n.attrGet("href"),title:n.attrGet("title")||null})},code_inline:{mark:"code",noCloseToken:!0}});const EI={open:"",close:"",mixable:!0};let _I=class{constructor(e,t,r={}){this.nodes=e,this.marks=t,this.options=r}serialize(e,t={}){t=Object.assign({},this.options,t);let r=new Gx(this.nodes,this.marks,t);return r.renderContent(e),r.out}};const Ur=new _I({blockquote(n,e){n.wrapBlock("> ",null,e,()=>n.renderContent(e))},code_block(n,e){const t=e.textContent.match(/`{3,}/gm),r=t?t.sort().slice(-1)[0]+"`":"```";n.write(r+(e.attrs.params||"")+`
`),n.text(e.textContent,!1),n.write(`
`),n.write(r),n.closeBlock(e)},heading(n,e){n.write(n.repeat("#",e.attrs.level)+" "),n.renderInline(e,!1),n.closeBlock(e)},horizontal_rule(n,e){n.write(e.attrs.markup||"---"),n.closeBlock(e)},bullet_list(n,e){n.renderList(e,"  ",()=>(e.attrs.bullet||"*")+" ")},ordered_list(n,e){let t=e.attrs.order||1,r=String(t+e.childCount-1).length,i=n.repeat(" ",r+2);n.renderList(e,i,o=>{let s=String(t+o);return n.repeat(" ",r-s.length)+s+". "})},list_item(n,e){n.renderContent(e)},paragraph(n,e){n.renderInline(e),n.closeBlock(e)},image(n,e){n.write("!["+n.esc(e.attrs.alt||"")+"]("+e.attrs.src.replace(/[\(\)]/g,"\\$&")+(e.attrs.title?' "'+e.attrs.title.replace(/"/g,'\\"')+'"':"")+")")},hard_break(n,e,t,r){for(let i=r+1;i<t.childCount;i++)if(t.child(i).type!=e.type){n.write(`\\
`);return}},text(n,e){n.text(e.text,!n.inAutolink)}},{em:{open:"*",close:"*",mixable:!0,expelEnclosingWhitespace:!0},strong:{open:"**",close:"**",mixable:!0,expelEnclosingWhitespace:!0},link:{open(n,e,t,r){return n.inAutolink=AI(e,t,r),n.inAutolink?"<":"["},close(n,e,t,r){let{inAutolink:i}=n;return n.inAutolink=void 0,i?">":"]("+e.attrs.href.replace(/[\(\)"]/g,"\\$&")+(e.attrs.title?` "${e.attrs.title.replace(/"/g,'\\"')}"`:"")+")"},mixable:!0},code:{open(n,e,t,r){return bb(t.child(r),-1)},close(n,e,t,r){return bb(t.child(r-1),1)},escape:!1}});function bb(n,e){let t=/`+/g,r,i=0;if(n.isText)for(;r=t.exec(n.text);)i=Math.max(i,r[0].length);let o=i>0&&e>0?" `":"`";for(let s=0;s<i;s++)o+="`";return i>0&&e<0&&(o+=" "),o}function AI(n,e,t){if(n.attrs.title||!/^\w+:/.test(n.attrs.href))return!1;let r=e.child(t);return!r.isText||r.text!=n.attrs.href||r.marks[r.marks.length-1]!=n?!1:t==e.childCount-1||!n.isInSet(e.child(t+1).marks)}let Gx=class{constructor(e,t,r){this.nodes=e,this.marks=t,this.options=r,this.delim="",this.out="",this.closed=null,this.inAutolink=void 0,this.atBlockStart=!1,this.inTightList=!1,typeof this.options.tightLists>"u"&&(this.options.tightLists=!1),typeof this.options.hardBreakNodeName>"u"&&(this.options.hardBreakNodeName="hard_break")}flushClose(e=2){if(this.closed){if(this.atBlank()||(this.out+=`
`),e>1){let t=this.delim,r=/\s+$/.exec(t);r&&(t=t.slice(0,t.length-r[0].length));for(let i=1;i<e;i++)this.out+=t+`
`}this.closed=null}}getMark(e){let t=this.marks[e];if(!t){if(this.options.strict!==!1)throw new Error(`Mark type \`${e}\` not supported by Markdown renderer`);t=EI}return t}wrapBlock(e,t,r,i){let o=this.delim;this.write(t??e),this.delim+=e,i(),this.delim=o,this.closeBlock(r)}atBlank(){return/(^|\n)$/.test(this.out)}ensureNewLine(){this.atBlank()||(this.out+=`
`)}write(e){this.flushClose(),this.delim&&this.atBlank()&&(this.out+=this.delim),e&&(this.out+=e)}closeBlock(e){this.closed=e}text(e,t=!0){let r=e.split(`
`);for(let i=0;i<r.length;i++)this.write(),!t&&r[i][0]=="["&&/(^|[^\\])\!$/.test(this.out)&&(this.out=this.out.slice(0,this.out.length-1)+"\\!"),this.out+=t?this.esc(r[i],this.atBlockStart):r[i],i!=r.length-1&&(this.out+=`
`)}render(e,t,r){if(this.nodes[e.type.name])this.nodes[e.type.name](this,e,t,r);else{if(this.options.strict!==!1)throw new Error("Token type `"+e.type.name+"` not supported by Markdown renderer");e.type.isLeaf||(e.type.inlineContent?this.renderInline(e):this.renderContent(e),e.isBlock&&this.closeBlock(e))}}renderContent(e){e.forEach((t,r,i)=>this.render(t,e,i))}renderInline(e,t=!0){this.atBlockStart=t;let r=[],i="",o=(s,a,l)=>{let d=s?s.marks:[];s&&s.type.name===this.options.hardBreakNodeName&&(d=d.filter(v=>{if(l+1==e.childCount)return!1;let x=e.child(l+1);return v.isInSet(x.marks)&&(!x.isText||/\S/.test(x.text))}));let f=i;if(i="",s&&s.isText&&d.some(v=>{let x=this.getMark(v.type.name);return x&&x.expelEnclosingWhitespace&&!v.isInSet(r)})){let[v,x,E]=/^(\s*)(.*)$/m.exec(s.text);x&&(f+=x,s=E?s.withText(E):null,s||(d=r))}if(s&&s.isText&&d.some(v=>{let x=this.getMark(v.type.name);return x&&x.expelEnclosingWhitespace&&(l==e.childCount-1||!v.isInSet(e.child(l+1).marks))})){let[v,x,E]=/^(.*?)(\s*)$/m.exec(s.text);E&&(i=E,s=x?s.withText(x):null,s||(d=r))}let h=d.length?d[d.length-1]:null,m=h&&this.getMark(h.type.name).escape===!1,g=d.length-(m?1:0);e:for(let v=0;v<g;v++){let x=d[v];if(!this.getMark(x.type.name).mixable)break;for(let E=0;E<r.length;E++){let A=r[E];if(!this.getMark(A.type.name).mixable)break;if(x.eq(A)){v>E?d=d.slice(0,E).concat(x).concat(d.slice(E,v)).concat(d.slice(v+1,g)):E>v&&(d=d.slice(0,v).concat(d.slice(v+1,E)).concat(x).concat(d.slice(E,g)));continue e}}}let b=0;for(;b<Math.min(r.length,g)&&d[b].eq(r[b]);)++b;for(;b<r.length;)this.text(this.markString(r.pop(),!1,e,l),!1);if(f&&this.text(f),s){for(;r.length<g;){let v=d[r.length];r.push(v),this.text(this.markString(v,!0,e,l),!1),this.atBlockStart=!1}m&&s.isText?this.text(this.markString(h,!0,e,l)+s.text+this.markString(h,!1,e,l+1),!1):this.render(s,e,l),this.atBlockStart=!1}s!=null&&s.isText&&s.nodeSize>0&&(this.atBlockStart=!1)};e.forEach(o),o(null,0,e.childCount),this.atBlockStart=!1}renderList(e,t,r){this.closed&&this.closed.type==e.type?this.flushClose(3):this.inTightList&&this.flushClose(1);let i=typeof e.attrs.tight<"u"?e.attrs.tight:this.options.tightLists,o=this.inTightList;this.inTightList=i,e.forEach((s,a,l)=>{l&&i&&this.flushClose(1),this.wrapBlock(t,r(l),e,()=>this.render(s,e,l))}),this.inTightList=o}esc(e,t=!1){return e=e.replace(/[`*\\~\[\]_]/g,(r,i)=>r=="_"&&i>0&&i+1<e.length&&e[i-1].match(/\w/)&&e[i+1].match(/\w/)?r:"\\"+r),t&&(e=e.replace(/^(\+[ ]|[\-*>])/,"\\$&").replace(/^(\s*)(#{1,6})(\s|$)/,"$1\\$2$3").replace(/^(\s*\d+)\.\s/,"$1\\. ")),this.options.escapeExtraCharacters&&(e=e.replace(this.options.escapeExtraCharacters,"\\$&")),e}quote(e){let t=e.indexOf('"')==-1?'""':e.indexOf("'")==-1?"''":"()";return t[0]+e+t[1]}repeat(e,t){let r="";for(let i=0;i<t;i++)r+=e;return r}markString(e,t,r,i){let o=this.getMark(e.type.name),s=t?o.open:o.close;return typeof s=="string"?s:s(this,e,r,i)}getEnclosingWhitespace(e){return{leading:(e.match(/^(\s+)/)||[void 0])[0],trailing:(e.match(/(\s+)$/)||[void 0])[0]}}};var Qf,yb;function TI(){if(yb)return Qf;yb=1;var n=!0,e=!1,t=!1;Qf=function(v,x){x&&(n=!x.enabled,e=!!x.label,t=!!x.labelAfter),v.core.ruler.after("inline","github-task-lists",function(E){for(var A=E.tokens,M=2;M<A.length;M++)o(A,M)&&(s(A[M],E.Token),r(A[M-2],"class","task-list-item"+(n?"":" enabled")),r(A[i(A,M-2)],"class","contains-task-list"))})};function r(v,x,E){var A=v.attrIndex(x),M=[x,E];A<0?v.attrPush(M):v.attrs[A]=M}function i(v,x){for(var E=v[x].level-1,A=x-1;A>=0;A--)if(v[A].level===E)return A;return-1}function o(v,x){return h(v[x])&&m(v[x-1])&&g(v[x-2])&&b(v[x])}function s(v,x){if(v.children.unshift(a(v,x)),v.children[1].content=v.children[1].content.slice(3),v.content=v.content.slice(3),e)if(t){v.children.pop();var E="task-item-"+Math.ceil(Math.random()*(1e4*1e3)-1e3);v.children[0].content=v.children[0].content.slice(0,-1)+' id="'+E+'">',v.children.push(f(v.content,E,x))}else v.children.unshift(l(x)),v.children.push(d(x))}function a(v,x){var E=new x("html_inline","",0),A=n?' disabled="" ':"";return v.content.indexOf("[ ] ")===0?E.content='<input class="task-list-item-checkbox"'+A+'type="checkbox">':(v.content.indexOf("[x] ")===0||v.content.indexOf("[X] ")===0)&&(E.content='<input class="task-list-item-checkbox" checked=""'+A+'type="checkbox">'),E}function l(v){var x=new v("html_inline","",0);return x.content="<label>",x}function d(v){var x=new v("html_inline","",0);return x.content="</label>",x}function f(v,x,E){var A=new E("html_inline","",0);return A.content='<label class="task-list-item-label" for="'+x+'">'+v+"</label>",A.attrs=[{for:x}],A}function h(v){return v.type==="inline"}function m(v){return v.type==="paragraph_open"}function g(v){return v.type==="list_item_open"}function b(v){return v.content.indexOf("[ ] ")===0||v.content.indexOf("[x] ")===0||v.content.indexOf("[X] ")===0}return Qf}var DI=TI();const MI=P6(DI);var OI=Object.defineProperty,II=(n,e,t)=>e in n?OI(n,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):n[e]=t,xc=(n,e,t)=>(II(n,typeof e!="symbol"?e+"":e,t),t);const NI=bt.create({name:"markdownTightLists",addOptions:()=>({tight:!0,tightClass:"tight",listTypes:["bulletList","orderedList"]}),addGlobalAttributes(){return[{types:this.options.listTypes,attributes:{tight:{default:this.options.tight,parseHTML:n=>n.getAttribute("data-tight")==="true"||!n.querySelector("p"),renderHTML:n=>({class:n.tight?this.options.tightClass:null,"data-tight":n.tight?"true":null})}}}]},addCommands(){var n=this;return{toggleTight:function(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:null;return t=>{let{editor:r,commands:i}=t;function o(s){if(!r.isActive(s))return!1;const a=r.getAttributes(s);return i.updateAttributes(s,{tight:e??!(a!=null&&a.tight)})}return n.options.listTypes.some(s=>o(s))}}}}}),vb=Cn();function Xx(n,e){return vb.inline.State.prototype.scanDelims.call({src:n,posMax:n.length}),new vb.inline.State(n,null,null,[]).scanDelims(e,!0)}function Yx(n,e,t,r){let i=n.substring(0,t)+n.substring(t+e.length);return i=i.substring(0,t+r)+e+i.substring(t+r),i}function PI(n,e,t,r){let i=t,o=n;for(;i<r&&!Xx(o,i).can_open;)o=Yx(o,e,i,1),i++;return{text:o,from:i,to:r}}function FI(n,e,t,r){let i=r,o=n;for(;i>t&&!Xx(o,i).can_close;)o=Yx(o,e,i,-1),i--;return{text:o,from:t,to:i}}function RI(n,e,t,r){let i={text:n,from:t,to:r};return i=PI(i.text,e,i.from,i.to),i=FI(i.text,e,i.from,i.to),i.to-i.from<e.length+1&&(i.text=i.text.substring(0,i.from)+i.text.substring(i.to+e.length)),i.text}class LI extends Gx{constructor(e,t,r){super(e,t,r??{}),xc(this,"inTable",!1),this.inlines=[]}render(e,t,r){super.render(e,t,r);const i=this.inlines[this.inlines.length-1];if(i!=null&&i.start&&i!==null&&i!==void 0&&i.end){const{delimiter:o,start:s,end:a}=this.normalizeInline(i);this.out=RI(this.out,o,s,a),this.inlines.pop()}}markString(e,t,r,i){const o=this.marks[e.type.name];if(o.expelEnclosingWhitespace)if(t)this.inlines.push({start:this.out.length,delimiter:o.open});else{const s=this.inlines.pop();this.inlines.push({...s,end:this.out.length})}return super.markString(e,t,r,i)}normalizeInline(e){let{start:t,end:r}=e;for(;this.out.charAt(t).match(/\s/);)t++;return{...e,start:t}}}const Jx=Yt.create({name:"markdownHTMLMark",addStorage(){return{markdown:{serialize:{open(n,e){var t,r;return this.editor.storage.markdown.options.html?(t=(r=xb(e))===null||r===void 0?void 0:r[0])!==null&&t!==void 0?t:"":(console.warn(`Tiptap Markdown: "${e.type.name}" mark is only available in html mode`),"")},close(n,e){var t,r;return this.editor.storage.markdown.options.html&&(t=(r=xb(e))===null||r===void 0?void 0:r[1])!==null&&t!==void 0?t:""}},parse:{}}}}});function xb(n){const e=n.type.schema,t=e.text(" ",[n]),i=gu(q.from(t),e).match(/^(<.*?>) (<\/.*?>)$/);return i?[i[1],i[2]]:null}function Rp(n){const e=`<body>${n}</body>`;return new window.DOMParser().parseFromString(e,"text/html").body}function BI(n){return n==null?void 0:n.replace(/</g,"&lt;").replace(/>/g,"&gt;")}function $I(n){const e=n.parentElement,t=e.cloneNode();for(;e.firstChild&&e.firstChild!==n;)t.appendChild(e.firstChild);t.childNodes.length>0&&e.parentElement.insertBefore(t,e),e.parentElement.insertBefore(n,e),e.childNodes.length===0&&e.remove()}function zI(n){const e=n.parentNode;for(;n.firstChild;)e.insertBefore(n.firstChild,n);e.removeChild(n)}const Wc=Ge.create({name:"markdownHTMLNode",addStorage(){return{markdown:{serialize(n,e,t){this.editor.storage.markdown.options.html?n.write(HI(e,t)):(console.warn(`Tiptap Markdown: "${e.type.name}" node is only available in html mode`),n.write(`[${e.type.name}]`)),e.isBlock&&n.closeBlock(e)},parse:{}}}}});function HI(n,e){const t=n.type.schema,r=gu(q.from(n),t);return n.isBlock&&(e instanceof q||e.type.name===t.topNodeType.name)?qI(r):r}function qI(n){const t=Rp(n).firstElementChild;return t.innerHTML=t.innerHTML.trim()?`
${t.innerHTML}
`:`
`,t.outerHTML}const VI=Ge.create({name:"blockquote"}),WI=VI.extend({addStorage(){return{markdown:{serialize:Ur.nodes.blockquote,parse:{}}}}}),UI=Ge.create({name:"bulletList"}),Zx=UI.extend({addStorage(){return{markdown:{serialize(n,e){return n.renderList(e,"  ",()=>(this.editor.storage.markdown.options.bulletListMarker||"-")+" ")},parse:{}}}}}),KI=Ge.create({name:"codeBlock"}),jI=KI.extend({addStorage(){return{markdown:{serialize(n,e){n.write("```"+(e.attrs.language||"")+`
`),n.text(e.textContent,!1),n.ensureNewLine(),n.write("```"),n.closeBlock(e)},parse:{setup(n){var e;n.set({langPrefix:(e=this.options.languageClassPrefix)!==null&&e!==void 0?e:"language-"})},updateDOM(n){n.innerHTML=n.innerHTML.replace(/\n<\/code><\/pre>/g,"</code></pre>")}}}}}}),GI=Ge.create({name:"hardBreak"}),Qx=GI.extend({addStorage(){return{markdown:{serialize(n,e,t,r){for(let i=r+1;i<t.childCount;i++)if(t.child(i).type!=e.type){n.write(n.inTable?Wc.storage.markdown.serialize.call(this,n,e,t):`\\
`);return}},parse:{}}}}}),XI=Ge.create({name:"heading"}),YI=XI.extend({addStorage(){return{markdown:{serialize:Ur.nodes.heading,parse:{}}}}}),JI=Ge.create({name:"horizontalRule"}),ZI=JI.extend({addStorage(){return{markdown:{serialize:Ur.nodes.horizontal_rule,parse:{}}}}}),QI=Ge.create({name:"image"}),eN=QI.extend({addStorage(){return{markdown:{serialize:Ur.nodes.image,parse:{}}}}}),tN=Ge.create({name:"listItem"}),nN=tN.extend({addStorage(){return{markdown:{serialize:Ur.nodes.list_item,parse:{}}}}}),rN=Ge.create({name:"orderedList"});function iN(n,e,t){let r=0;for(;t-r>0&&e.child(t-r-1).type.name===n.type.name;r++);return r}const oN=rN.extend({addStorage(){return{markdown:{serialize(n,e,t,r){const i=e.attrs.start||1,o=String(i+e.childCount-1).length,s=n.repeat(" ",o+2),l=iN(e,t,r)%2?") ":". ";n.renderList(e,s,d=>{const f=String(i+d);return n.repeat(" ",o-f.length)+f+l})},parse:{}}}}}),sN=Ge.create({name:"paragraph"}),aN=sN.extend({addStorage(){return{markdown:{serialize:Ur.nodes.paragraph,parse:{}}}}});function eh(n){var e,t;return(e=n==null||(t=n.content)===null||t===void 0?void 0:t.content)!==null&&e!==void 0?e:[]}const uN=Ge.create({name:"table"}),lN=uN.extend({addStorage(){return{markdown:{serialize(n,e,t){if(!cN(e)){Wc.storage.markdown.serialize.call(this,n,e,t);return}n.inTable=!0,e.forEach((r,i,o)=>{if(n.write("| "),r.forEach((s,a,l)=>{l&&n.write(" | ");const d=s.firstChild;d.textContent.trim()&&n.renderInline(d)}),n.write(" |"),n.ensureNewLine(),!o){const s=Array.from({length:r.childCount}).map(()=>"---").join(" | ");n.write(`| ${s} |`),n.ensureNewLine()}}),n.closeBlock(e),n.inTable=!1},parse:{}}}}});function wb(n){return n.attrs.colspan>1||n.attrs.rowspan>1}function cN(n){const e=eh(n),t=e[0],r=e.slice(1);return!(eh(t).some(i=>i.type.name!=="tableHeader"||wb(i)||i.childCount>1)||r.some(i=>eh(i).some(o=>o.type.name==="tableHeader"||wb(o)||o.childCount>1)))}const dN=Ge.create({name:"taskItem"}),fN=dN.extend({addStorage(){return{markdown:{serialize(n,e){const t=e.attrs.checked?"[x]":"[ ]";n.write(`${t} `),n.renderContent(e)},parse:{updateDOM(n){[...n.querySelectorAll(".task-list-item")].forEach(e=>{const t=e.querySelector("input");e.setAttribute("data-type","taskItem"),t&&(e.setAttribute("data-checked",t.checked),t.remove())})}}}}}}),hN=Ge.create({name:"taskList"}),pN=hN.extend({addStorage(){return{markdown:{serialize:Zx.storage.markdown.serialize,parse:{setup(n){n.use(MI)},updateDOM(n){[...n.querySelectorAll(".contains-task-list")].forEach(e=>{e.setAttribute("data-type","taskList")})}}}}}}),mN=Ge.create({name:"text"}),gN=mN.extend({addStorage(){return{markdown:{serialize(n,e){n.text(BI(e.text))},parse:{}}}}}),bN=Yt.create({name:"bold"}),yN=bN.extend({addStorage(){return{markdown:{serialize:Ur.marks.strong,parse:{}}}}}),vN=Yt.create({name:"code"}),xN=vN.extend({addStorage(){return{markdown:{serialize:Ur.marks.code,parse:{}}}}}),wN=Yt.create({name:"italic"}),kN=wN.extend({addStorage(){return{markdown:{serialize:Ur.marks.em,parse:{}}}}}),SN=Yt.create({name:"link"}),CN=SN.extend({addStorage(){return{markdown:{serialize:Ur.marks.link,parse:{}}}}}),EN=Yt.create({name:"strike"}),_N=EN.extend({addStorage(){return{markdown:{serialize:{open:"~~",close:"~~",expelEnclosingWhitespace:!0},parse:{}}}}}),AN=[WI,Zx,jI,Qx,YI,ZI,Wc,eN,nN,oN,aN,lN,fN,pN,gN,yN,xN,Jx,kN,CN,_N];function wc(n){var e,t;const r=(e=n.storage)===null||e===void 0?void 0:e.markdown,i=(t=AN.find(o=>o.name===n.name))===null||t===void 0?void 0:t.storage.markdown;return r||i?{...i,...r}:null}class TN{constructor(e){xc(this,"editor",null),this.editor=e}serialize(e){const t=new LI(this.nodes,this.marks,{hardBreakNodeName:Qx.name});return t.renderContent(e),t.out}get nodes(){var e;return{...Object.fromEntries(Object.keys(this.editor.schema.nodes).map(t=>[t,this.serializeNode(Wc)])),...Object.fromEntries((e=this.editor.extensionManager.extensions.filter(t=>t.type==="node"&&this.serializeNode(t)).map(t=>[t.name,this.serializeNode(t)]))!==null&&e!==void 0?e:[])}}get marks(){var e;return{...Object.fromEntries(Object.keys(this.editor.schema.marks).map(t=>[t,this.serializeMark(Jx)])),...Object.fromEntries((e=this.editor.extensionManager.extensions.filter(t=>t.type==="mark"&&this.serializeMark(t)).map(t=>[t.name,this.serializeMark(t)]))!==null&&e!==void 0?e:[])}}serializeNode(e){var t;return(t=wc(e))===null||t===void 0||(t=t.serialize)===null||t===void 0?void 0:t.bind({editor:this.editor,options:e.options})}serializeMark(e){var t;const r=(t=wc(e))===null||t===void 0?void 0:t.serialize;return r?{...r,open:typeof r.open=="function"?r.open.bind({editor:this.editor,options:e.options}):r.open,close:typeof r.close=="function"?r.close.bind({editor:this.editor,options:e.options}):r.close}:null}}class DN{constructor(e,t){xc(this,"editor",null),xc(this,"md",null);let{html:r,linkify:i,breaks:o}=t;this.editor=e,this.md=this.withPatchedRenderer(Cn({html:r,linkify:i,breaks:o}))}parse(e){let{inline:t}=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};if(typeof e=="string"){this.editor.extensionManager.extensions.forEach(o=>{var s;return(s=wc(o))===null||s===void 0||(s=s.parse)===null||s===void 0||(s=s.setup)===null||s===void 0?void 0:s.call({editor:this.editor,options:o.options},this.md)});const r=this.md.render(e),i=Rp(r);return this.editor.extensionManager.extensions.forEach(o=>{var s;return(s=wc(o))===null||s===void 0||(s=s.parse)===null||s===void 0||(s=s.updateDOM)===null||s===void 0?void 0:s.call({editor:this.editor,options:o.options},i)}),this.normalizeDOM(i,{inline:t,content:e}),i.innerHTML}return e}normalizeDOM(e,t){let{inline:r,content:i}=t;return this.normalizeBlocks(e),e.querySelectorAll("*").forEach(o=>{var s;((s=o.nextSibling)===null||s===void 0?void 0:s.nodeType)===Node.TEXT_NODE&&!o.closest("pre")&&(o.nextSibling.textContent=o.nextSibling.textContent.replace(/^\n/,""))}),r&&this.normalizeInline(e,i),e}normalizeBlocks(e){const r=Object.values(this.editor.schema.nodes).filter(i=>i.isBlock).map(i=>{var o;return(o=i.spec.parseDOM)===null||o===void 0?void 0:o.map(s=>s.tag)}).flat().filter(Boolean).join(",");r&&[...e.querySelectorAll(r)].forEach(i=>{i.parentElement.matches("p")&&$I(i)})}normalizeInline(e,t){var r;if((r=e.firstElementChild)!==null&&r!==void 0&&r.matches("p")){var i,o,s,a;const l=e.firstElementChild,{nextElementSibling:d}=l,f=(i=(o=t.match(/^\s+/))===null||o===void 0?void 0:o[0])!==null&&i!==void 0?i:"",h=d?"":(s=(a=t.match(/\s+$/))===null||a===void 0?void 0:a[0])!==null&&s!==void 0?s:"";if(t.match(/^\n\n/)){l.innerHTML=`${l.innerHTML}${h}`;return}zI(l),e.innerHTML=`${f}${e.innerHTML}${h}`}}withPatchedRenderer(e){const t=r=>function(){const i=r(...arguments);return i===`
`?i:i[i.length-1]===`
`?i.slice(0,-1):i};return e.renderer.rules.hardbreak=t(e.renderer.rules.hardbreak),e.renderer.rules.softbreak=t(e.renderer.rules.softbreak),e.renderer.rules.fence=t(e.renderer.rules.fence),e.renderer.rules.code_block=t(e.renderer.rules.code_block),e.renderer.renderToken=t(e.renderer.renderToken.bind(e.renderer)),e}}const MN=bt.create({name:"markdownClipboard",addOptions(){return{transformPastedText:!1,transformCopiedText:!1}},addProseMirrorPlugins(){return[new zt({key:new Hn("markdownClipboard"),props:{clipboardTextParser:(n,e,t)=>{if(t||!this.options.transformPastedText)return null;const r=this.editor.storage.markdown.parser.parse(n,{inline:!0});return _s.fromSchema(this.editor.schema).parseSlice(Rp(r),{preserveWhitespace:!0,context:e})},clipboardTextSerializer:n=>this.options.transformCopiedText?this.editor.storage.markdown.serializer.serialize(n.content):null}})]}}),kb=bt.create({name:"markdown",priority:50,addOptions(){return{html:!0,tightLists:!0,tightListClass:"tight",bulletListMarker:"-",linkify:!1,breaks:!1,transformPastedText:!1,transformCopiedText:!1}},addCommands(){const n=M8.Commands.config.addCommands();return{setContent:(e,t,r)=>i=>n.setContent(i.editor.storage.markdown.parser.parse(e),t,r)(i),insertContentAt:(e,t,r)=>i=>n.insertContentAt(e,i.editor.storage.markdown.parser.parse(t,{inline:!0}),r)(i)}},onBeforeCreate(){this.editor.storage.markdown={options:{...this.options},parser:new DN(this.editor,this.options),serializer:new TN(this.editor),getMarkdown:()=>this.editor.storage.markdown.serializer.serialize(this.editor.state.doc)},this.editor.options.initialContent=this.editor.options.content,this.editor.options.content=this.editor.storage.markdown.parser.parse(this.editor.options.content)},onCreate(){this.editor.options.content=this.editor.options.initialContent,delete this.editor.options.initialContent},addStorage(){return{}},addExtensions(){return[NI.configure({tight:this.options.tightLists,tightClass:this.options.tightListClass}),MN.configure({transformPastedText:this.options.transformPastedText,transformCopiedText:this.options.transformCopiedText})]}}),ON=/^\s*>\s$/,IN=Ge.create({name:"blockquote",addOptions(){return{HTMLAttributes:{}}},content:"block+",group:"block",defining:!0,parseHTML(){return[{tag:"blockquote"}]},renderHTML({HTMLAttributes:n}){return["blockquote",$t(this.options.HTMLAttributes,n),0]},addCommands(){return{setBlockquote:()=>({commands:n})=>n.wrapIn(this.name),toggleBlockquote:()=>({commands:n})=>n.toggleWrap(this.name),unsetBlockquote:()=>({commands:n})=>n.lift(this.name)}},addKeyboardShortcuts(){return{"Mod-Shift-b":()=>this.editor.commands.toggleBlockquote()}},addInputRules(){return[nu({find:ON,type:this.type})]}}),NN=/(?:^|\s)(\*\*(?!\s+\*\*)((?:[^*]+))\*\*(?!\s+\*\*))$/,PN=/(?:^|\s)(\*\*(?!\s+\*\*)((?:[^*]+))\*\*(?!\s+\*\*))/g,FN=/(?:^|\s)(__(?!\s+__)((?:[^_]+))__(?!\s+__))$/,RN=/(?:^|\s)(__(?!\s+__)((?:[^_]+))__(?!\s+__))/g,LN=Yt.create({name:"bold",addOptions(){return{HTMLAttributes:{}}},parseHTML(){return[{tag:"strong"},{tag:"b",getAttrs:n=>n.style.fontWeight!=="normal"&&null},{style:"font-weight=400",clearMark:n=>n.type.name===this.name},{style:"font-weight",getAttrs:n=>/^(bold(er)?|[5-9]\d{2,})$/.test(n)&&null}]},renderHTML({HTMLAttributes:n}){return["strong",$t(this.options.HTMLAttributes,n),0]},addCommands(){return{setBold:()=>({commands:n})=>n.setMark(this.name),toggleBold:()=>({commands:n})=>n.toggleMark(this.name),unsetBold:()=>({commands:n})=>n.unsetMark(this.name)}},addKeyboardShortcuts(){return{"Mod-b":()=>this.editor.commands.toggleBold(),"Mod-B":()=>this.editor.commands.toggleBold()}},addInputRules(){return[Lo({find:NN,type:this.type}),Lo({find:FN,type:this.type})]},addPasteRules(){return[Bo({find:PN,type:this.type}),Bo({find:RN,type:this.type})]}}),BN="listItem",Sb="textStyle",Cb=/^\s*([-+*])\s$/,$N=Ge.create({name:"bulletList",addOptions(){return{itemTypeName:"listItem",HTMLAttributes:{},keepMarks:!1,keepAttributes:!1}},group:"block list",content(){return`${this.options.itemTypeName}+`},parseHTML(){return[{tag:"ul"}]},renderHTML({HTMLAttributes:n}){return["ul",$t(this.options.HTMLAttributes,n),0]},addCommands(){return{toggleBulletList:()=>({commands:n,chain:e})=>this.options.keepAttributes?e().toggleList(this.name,this.options.itemTypeName,this.options.keepMarks).updateAttributes(BN,this.editor.getAttributes(Sb)).run():n.toggleList(this.name,this.options.itemTypeName,this.options.keepMarks)}},addKeyboardShortcuts(){return{"Mod-Shift-8":()=>this.editor.commands.toggleBulletList()}},addInputRules(){let n=nu({find:Cb,type:this.type});return(this.options.keepMarks||this.options.keepAttributes)&&(n=nu({find:Cb,type:this.type,keepMarks:this.options.keepMarks,keepAttributes:this.options.keepAttributes,getAttributes:()=>this.editor.getAttributes(Sb),editor:this.editor})),[n]}}),zN=/(^|[^`])`([^`]+)`(?!`)/,HN=/(^|[^`])`([^`]+)`(?!`)/g,qN=Yt.create({name:"code",addOptions(){return{HTMLAttributes:{}}},excludes:"_",code:!0,exitable:!0,parseHTML(){return[{tag:"code"}]},renderHTML({HTMLAttributes:n}){return["code",$t(this.options.HTMLAttributes,n),0]},addCommands(){return{setCode:()=>({commands:n})=>n.setMark(this.name),toggleCode:()=>({commands:n})=>n.toggleMark(this.name),unsetCode:()=>({commands:n})=>n.unsetMark(this.name)}},addKeyboardShortcuts(){return{"Mod-e":()=>this.editor.commands.toggleCode()}},addInputRules(){return[Lo({find:zN,type:this.type})]},addPasteRules(){return[Bo({find:HN,type:this.type})]}}),VN=/^```([a-z]+)?[\s\n]$/,WN=/^~~~([a-z]+)?[\s\n]$/,UN=Ge.create({name:"codeBlock",addOptions(){return{languageClassPrefix:"language-",exitOnTripleEnter:!0,exitOnArrowDown:!0,defaultLanguage:null,HTMLAttributes:{}}},content:"text*",marks:"",group:"block",code:!0,defining:!0,addAttributes(){return{language:{default:this.options.defaultLanguage,parseHTML:n=>{var e;const{languageClassPrefix:t}=this.options,o=[...((e=n.firstElementChild)===null||e===void 0?void 0:e.classList)||[]].filter(s=>s.startsWith(t)).map(s=>s.replace(t,""))[0];return o||null},rendered:!1}}},parseHTML(){return[{tag:"pre",preserveWhitespace:"full"}]},renderHTML({node:n,HTMLAttributes:e}){return["pre",$t(this.options.HTMLAttributes,e),["code",{class:n.attrs.language?this.options.languageClassPrefix+n.attrs.language:null},0]]},addCommands(){return{setCodeBlock:n=>({commands:e})=>e.setNode(this.name,n),toggleCodeBlock:n=>({commands:e})=>e.toggleNode(this.name,"paragraph",n)}},addKeyboardShortcuts(){return{"Mod-Alt-c":()=>this.editor.commands.toggleCodeBlock(),Backspace:()=>{const{empty:n,$anchor:e}=this.editor.state.selection,t=e.pos===1;return!n||e.parent.type.name!==this.name?!1:t||!e.parent.textContent.length?this.editor.commands.clearNodes():!1},Enter:({editor:n})=>{if(!this.options.exitOnTripleEnter)return!1;const{state:e}=n,{selection:t}=e,{$from:r,empty:i}=t;if(!i||r.parent.type!==this.type)return!1;const o=r.parentOffset===r.parent.nodeSize-2,s=r.parent.textContent.endsWith(`

`);return!o||!s?!1:n.chain().command(({tr:a})=>(a.delete(r.pos-2,r.pos),!0)).exitCode().run()},ArrowDown:({editor:n})=>{if(!this.options.exitOnArrowDown)return!1;const{state:e}=n,{selection:t,doc:r}=e,{$from:i,empty:o}=t;if(!o||i.parent.type!==this.type||!(i.parentOffset===i.parent.nodeSize-2))return!1;const a=i.after();return a===void 0?!1:r.nodeAt(a)?n.commands.command(({tr:d})=>(d.setSelection(Ce.near(r.resolve(a))),!0)):n.commands.exitCode()}}},addInputRules(){return[$h({find:VN,type:this.type,getAttributes:n=>({language:n[1]})}),$h({find:WN,type:this.type,getAttributes:n=>({language:n[1]})})]},addProseMirrorPlugins(){return[new zt({key:new Hn("codeBlockVSCodeHandler"),props:{handlePaste:(n,e)=>{if(!e.clipboardData||this.editor.isActive(this.type.name))return!1;const t=e.clipboardData.getData("text/plain"),r=e.clipboardData.getData("vscode-editor-data"),i=r?JSON.parse(r):void 0,o=i==null?void 0:i.mode;if(!t||!o)return!1;const{tr:s,schema:a}=n.state,l=a.text(t.replace(/\r\n?/g,`
`));return s.replaceSelectionWith(this.type.create({language:o},l)),s.selection.$from.parent.type!==this.type&&s.setSelection(pe.near(s.doc.resolve(Math.max(0,s.selection.from-2)))),s.setMeta("paste",!0),n.dispatch(s),!0}}})]}}),KN=Ge.create({name:"doc",topNode:!0,content:"block+"});function jN(n={}){return new zt({view(e){return new GN(e,n)}})}class GN{constructor(e,t){var r;this.editorView=e,this.cursorPos=null,this.element=null,this.timeout=-1,this.width=(r=t.width)!==null&&r!==void 0?r:1,this.color=t.color===!1?void 0:t.color||"black",this.class=t.class,this.handlers=["dragover","dragend","drop","dragleave"].map(i=>{let o=s=>{this[i](s)};return e.dom.addEventListener(i,o),{name:i,handler:o}})}destroy(){this.handlers.forEach(({name:e,handler:t})=>this.editorView.dom.removeEventListener(e,t))}update(e,t){this.cursorPos!=null&&t.doc!=e.state.doc&&(this.cursorPos>e.state.doc.content.size?this.setCursor(null):this.updateOverlay())}setCursor(e){e!=this.cursorPos&&(this.cursorPos=e,e==null?(this.element.parentNode.removeChild(this.element),this.element=null):this.updateOverlay())}updateOverlay(){let e=this.editorView.state.doc.resolve(this.cursorPos),t=!e.parent.inlineContent,r,i=this.editorView.dom,o=i.getBoundingClientRect(),s=o.width/i.offsetWidth,a=o.height/i.offsetHeight;if(t){let h=e.nodeBefore,m=e.nodeAfter;if(h||m){let g=this.editorView.nodeDOM(this.cursorPos-(h?h.nodeSize:0));if(g){let b=g.getBoundingClientRect(),v=h?b.bottom:b.top;h&&m&&(v=(v+this.editorView.nodeDOM(this.cursorPos).getBoundingClientRect().top)/2);let x=this.width/2*a;r={left:b.left,right:b.right,top:v-x,bottom:v+x}}}}if(!r){let h=this.editorView.coordsAtPos(this.cursorPos),m=this.width/2*s;r={left:h.left-m,right:h.left+m,top:h.top,bottom:h.bottom}}let l=this.editorView.dom.offsetParent;this.element||(this.element=l.appendChild(document.createElement("div")),this.class&&(this.element.className=this.class),this.element.style.cssText="position: absolute; z-index: 50; pointer-events: none;",this.color&&(this.element.style.backgroundColor=this.color)),this.element.classList.toggle("prosemirror-dropcursor-block",t),this.element.classList.toggle("prosemirror-dropcursor-inline",!t);let d,f;if(!l||l==document.body&&getComputedStyle(l).position=="static")d=-pageXOffset,f=-pageYOffset;else{let h=l.getBoundingClientRect(),m=h.width/l.offsetWidth,g=h.height/l.offsetHeight;d=h.left-l.scrollLeft*m,f=h.top-l.scrollTop*g}this.element.style.left=(r.left-d)/s+"px",this.element.style.top=(r.top-f)/a+"px",this.element.style.width=(r.right-r.left)/s+"px",this.element.style.height=(r.bottom-r.top)/a+"px"}scheduleRemoval(e){clearTimeout(this.timeout),this.timeout=setTimeout(()=>this.setCursor(null),e)}dragover(e){if(!this.editorView.editable)return;let t=this.editorView.posAtCoords({left:e.clientX,top:e.clientY}),r=t&&t.inside>=0&&this.editorView.state.doc.nodeAt(t.inside),i=r&&r.type.spec.disableDropCursor,o=typeof i=="function"?i(this.editorView,t,e):i;if(t&&!o){let s=t.pos;if(this.editorView.dragging&&this.editorView.dragging.slice){let a=nv(this.editorView.state.doc,s,this.editorView.dragging.slice);a!=null&&(s=a)}this.setCursor(s),this.scheduleRemoval(5e3)}}dragend(){this.scheduleRemoval(20)}drop(){this.scheduleRemoval(20)}dragleave(e){this.editorView.dom.contains(e.relatedTarget)||this.setCursor(null)}}const XN=bt.create({name:"dropCursor",addOptions(){return{color:"currentColor",width:1,class:void 0}},addProseMirrorPlugins(){return[jN(this.options)]}});class at extends Ce{constructor(e){super(e,e)}map(e,t){let r=e.resolve(t.map(this.head));return at.valid(r)?new at(r):Ce.near(r)}content(){return X.empty}eq(e){return e instanceof at&&e.head==this.head}toJSON(){return{type:"gapcursor",pos:this.head}}static fromJSON(e,t){if(typeof t.pos!="number")throw new RangeError("Invalid input for GapCursor.fromJSON");return new at(e.resolve(t.pos))}getBookmark(){return new Lp(this.anchor)}static valid(e){let t=e.parent;if(t.isTextblock||!YN(e)||!JN(e))return!1;let r=t.type.spec.allowGapCursor;if(r!=null)return r;let i=t.contentMatchAt(e.index()).defaultType;return i&&i.isTextblock}static findGapCursorFrom(e,t,r=!1){e:for(;;){if(!r&&at.valid(e))return e;let i=e.pos,o=null;for(let s=e.depth;;s--){let a=e.node(s);if(t>0?e.indexAfter(s)<a.childCount:e.index(s)>0){o=a.child(t>0?e.indexAfter(s):e.index(s)-1);break}else if(s==0)return null;i+=t;let l=e.doc.resolve(i);if(at.valid(l))return l}for(;;){let s=t>0?o.firstChild:o.lastChild;if(!s){if(o.isAtom&&!o.isText&&!re.isSelectable(o)){e=e.doc.resolve(i+o.nodeSize*t),r=!1;continue e}break}o=s,i+=t;let a=e.doc.resolve(i);if(at.valid(a))return a}return null}}}at.prototype.visible=!1;at.findFrom=at.findGapCursorFrom;Ce.jsonID("gapcursor",at);class Lp{constructor(e){this.pos=e}map(e){return new Lp(e.map(this.pos))}resolve(e){let t=e.resolve(this.pos);return at.valid(t)?new at(t):Ce.near(t)}}function YN(n){for(let e=n.depth;e>=0;e--){let t=n.index(e),r=n.node(e);if(t==0){if(r.type.spec.isolating)return!0;continue}for(let i=r.child(t-1);;i=i.lastChild){if(i.childCount==0&&!i.inlineContent||i.isAtom||i.type.spec.isolating)return!0;if(i.inlineContent)return!1}}return!0}function JN(n){for(let e=n.depth;e>=0;e--){let t=n.indexAfter(e),r=n.node(e);if(t==r.childCount){if(r.type.spec.isolating)return!0;continue}for(let i=r.child(t);;i=i.firstChild){if(i.childCount==0&&!i.inlineContent||i.isAtom||i.type.spec.isolating)return!0;if(i.inlineContent)return!1}}return!0}function ZN(){return new zt({props:{decorations:nP,createSelectionBetween(n,e,t){return e.pos==t.pos&&at.valid(t)?new at(t):null},handleClick:eP,handleKeyDown:QN,handleDOMEvents:{beforeinput:tP}}})}const QN=Vv({ArrowLeft:Ml("horiz",-1),ArrowRight:Ml("horiz",1),ArrowUp:Ml("vert",-1),ArrowDown:Ml("vert",1)});function Ml(n,e){const t=n=="vert"?e>0?"down":"up":e>0?"right":"left";return function(r,i,o){let s=r.selection,a=e>0?s.$to:s.$from,l=s.empty;if(s instanceof pe){if(!o.endOfTextblock(t)||a.depth==0)return!1;l=!1,a=r.doc.resolve(e>0?a.after():a.before())}let d=at.findGapCursorFrom(a,e,l);return d?(i&&i(r.tr.setSelection(new at(d))),!0):!1}}function eP(n,e,t){if(!n||!n.editable)return!1;let r=n.state.doc.resolve(e);if(!at.valid(r))return!1;let i=n.posAtCoords({left:t.clientX,top:t.clientY});return i&&i.inside>-1&&re.isSelectable(n.state.doc.nodeAt(i.inside))?!1:(n.dispatch(n.state.tr.setSelection(new at(r))),!0)}function tP(n,e){if(e.inputType!="insertCompositionText"||!(n.state.selection instanceof at))return!1;let{$from:t}=n.state.selection,r=t.parent.contentMatchAt(t.index()).findWrapping(n.state.schema.nodes.text);if(!r)return!1;let i=q.empty;for(let s=r.length-1;s>=0;s--)i=q.from(r[s].createAndFill(null,i));let o=n.state.tr.replace(t.pos,t.pos,new X(i,0,0));return o.setSelection(pe.near(o.doc.resolve(t.pos+1))),n.dispatch(o),!1}function nP(n){if(!(n.selection instanceof at))return null;let e=document.createElement("div");return e.className="ProseMirror-gapcursor",xt.create(n.doc,[tr.widget(n.selection.head,e,{key:"gapcursor"})])}const rP=bt.create({name:"gapCursor",addProseMirrorPlugins(){return[ZN()]},extendNodeSchema(n){var e;const t={name:n.name,options:n.options,storage:n.storage};return{allowGapCursor:(e=De(Z(n,"allowGapCursor",t)))!==null&&e!==void 0?e:null}}}),iP=Ge.create({name:"hardBreak",addOptions(){return{keepMarks:!0,HTMLAttributes:{}}},inline:!0,group:"inline",selectable:!1,linebreakReplacement:!0,parseHTML(){return[{tag:"br"}]},renderHTML({HTMLAttributes:n}){return["br",$t(this.options.HTMLAttributes,n)]},renderText(){return`
`},addCommands(){return{setHardBreak:()=>({commands:n,chain:e,state:t,editor:r})=>n.first([()=>n.exitCode(),()=>n.command(()=>{const{selection:i,storedMarks:o}=t;if(i.$from.parent.type.spec.isolating)return!1;const{keepMarks:s}=this.options,{splittableMarks:a}=r.extensionManager,l=o||i.$to.parentOffset&&i.$from.marks();return e().insertContent({type:this.name}).command(({tr:d,dispatch:f})=>{if(f&&l&&s){const h=l.filter(m=>a.includes(m.type.name));d.ensureMarks(h)}return!0}).run()})])}},addKeyboardShortcuts(){return{"Mod-Enter":()=>this.editor.commands.setHardBreak(),"Shift-Enter":()=>this.editor.commands.setHardBreak()}}}),oP=Ge.create({name:"heading",addOptions(){return{levels:[1,2,3,4,5,6],HTMLAttributes:{}}},content:"inline*",group:"block",defining:!0,addAttributes(){return{level:{default:1,rendered:!1}}},parseHTML(){return this.options.levels.map(n=>({tag:`h${n}`,attrs:{level:n}}))},renderHTML({node:n,HTMLAttributes:e}){return[`h${this.options.levels.includes(n.attrs.level)?n.attrs.level:this.options.levels[0]}`,$t(this.options.HTMLAttributes,e),0]},addCommands(){return{setHeading:n=>({commands:e})=>this.options.levels.includes(n.level)?e.setNode(this.name,n):!1,toggleHeading:n=>({commands:e})=>this.options.levels.includes(n.level)?e.toggleNode(this.name,"paragraph",n):!1}},addKeyboardShortcuts(){return this.options.levels.reduce((n,e)=>({...n,[`Mod-Alt-${e}`]:()=>this.editor.commands.toggleHeading({level:e})}),{})},addInputRules(){return this.options.levels.map(n=>$h({find:new RegExp(`^(#{${Math.min(...this.options.levels)},${n}})\\s$`),type:this.type,getAttributes:{level:n}}))}});var kc=200,At=function(){};At.prototype.append=function(e){return e.length?(e=At.from(e),!this.length&&e||e.length<kc&&this.leafAppend(e)||this.length<kc&&e.leafPrepend(this)||this.appendInner(e)):this};At.prototype.prepend=function(e){return e.length?At.from(e).append(this):this};At.prototype.appendInner=function(e){return new sP(this,e)};At.prototype.slice=function(e,t){return e===void 0&&(e=0),t===void 0&&(t=this.length),e>=t?At.empty:this.sliceInner(Math.max(0,e),Math.min(this.length,t))};At.prototype.get=function(e){if(!(e<0||e>=this.length))return this.getInner(e)};At.prototype.forEach=function(e,t,r){t===void 0&&(t=0),r===void 0&&(r=this.length),t<=r?this.forEachInner(e,t,r,0):this.forEachInvertedInner(e,t,r,0)};At.prototype.map=function(e,t,r){t===void 0&&(t=0),r===void 0&&(r=this.length);var i=[];return this.forEach(function(o,s){return i.push(e(o,s))},t,r),i};At.from=function(e){return e instanceof At?e:e&&e.length?new e2(e):At.empty};var e2=function(n){function e(r){n.call(this),this.values=r}n&&(e.__proto__=n),e.prototype=Object.create(n&&n.prototype),e.prototype.constructor=e;var t={length:{configurable:!0},depth:{configurable:!0}};return e.prototype.flatten=function(){return this.values},e.prototype.sliceInner=function(i,o){return i==0&&o==this.length?this:new e(this.values.slice(i,o))},e.prototype.getInner=function(i){return this.values[i]},e.prototype.forEachInner=function(i,o,s,a){for(var l=o;l<s;l++)if(i(this.values[l],a+l)===!1)return!1},e.prototype.forEachInvertedInner=function(i,o,s,a){for(var l=o-1;l>=s;l--)if(i(this.values[l],a+l)===!1)return!1},e.prototype.leafAppend=function(i){if(this.length+i.length<=kc)return new e(this.values.concat(i.flatten()))},e.prototype.leafPrepend=function(i){if(this.length+i.length<=kc)return new e(i.flatten().concat(this.values))},t.length.get=function(){return this.values.length},t.depth.get=function(){return 0},Object.defineProperties(e.prototype,t),e}(At);At.empty=new e2([]);var sP=function(n){function e(t,r){n.call(this),this.left=t,this.right=r,this.length=t.length+r.length,this.depth=Math.max(t.depth,r.depth)+1}return n&&(e.__proto__=n),e.prototype=Object.create(n&&n.prototype),e.prototype.constructor=e,e.prototype.flatten=function(){return this.left.flatten().concat(this.right.flatten())},e.prototype.getInner=function(r){return r<this.left.length?this.left.get(r):this.right.get(r-this.left.length)},e.prototype.forEachInner=function(r,i,o,s){var a=this.left.length;if(i<a&&this.left.forEachInner(r,i,Math.min(o,a),s)===!1||o>a&&this.right.forEachInner(r,Math.max(i-a,0),Math.min(this.length,o)-a,s+a)===!1)return!1},e.prototype.forEachInvertedInner=function(r,i,o,s){var a=this.left.length;if(i>a&&this.right.forEachInvertedInner(r,i-a,Math.max(o,a)-a,s+a)===!1||o<a&&this.left.forEachInvertedInner(r,Math.min(i,a),o,s)===!1)return!1},e.prototype.sliceInner=function(r,i){if(r==0&&i==this.length)return this;var o=this.left.length;return i<=o?this.left.slice(r,i):r>=o?this.right.slice(r-o,i-o):this.left.slice(r,o).append(this.right.slice(0,i-o))},e.prototype.leafAppend=function(r){var i=this.right.leafAppend(r);if(i)return new e(this.left,i)},e.prototype.leafPrepend=function(r){var i=this.left.leafPrepend(r);if(i)return new e(i,this.right)},e.prototype.appendInner=function(r){return this.left.depth>=Math.max(this.right.depth,r.depth)+1?new e(this.left,new e(this.right,r)):new e(this,r)},e}(At);const aP=500;class yr{constructor(e,t){this.items=e,this.eventCount=t}popEvent(e,t){if(this.eventCount==0)return null;let r=this.items.length;for(;;r--)if(this.items.get(r-1).selection){--r;break}let i,o;t&&(i=this.remapping(r,this.items.length),o=i.maps.length);let s=e.tr,a,l,d=[],f=[];return this.items.forEach((h,m)=>{if(!h.step){i||(i=this.remapping(r,m+1),o=i.maps.length),o--,f.push(h);return}if(i){f.push(new Mr(h.map));let g=h.step.map(i.slice(o)),b;g&&s.maybeStep(g).doc&&(b=s.mapping.maps[s.mapping.maps.length-1],d.push(new Mr(b,void 0,void 0,d.length+f.length))),o--,b&&i.appendMap(b,o)}else s.maybeStep(h.step);if(h.selection)return a=i?h.selection.map(i.slice(o)):h.selection,l=new yr(this.items.slice(0,r).append(f.reverse().concat(d)),this.eventCount-1),!1},this.items.length,0),{remaining:l,transform:s,selection:a}}addTransform(e,t,r,i){let o=[],s=this.eventCount,a=this.items,l=!i&&a.length?a.get(a.length-1):null;for(let f=0;f<e.steps.length;f++){let h=e.steps[f].invert(e.docs[f]),m=new Mr(e.mapping.maps[f],h,t),g;(g=l&&l.merge(m))&&(m=g,f?o.pop():a=a.slice(0,a.length-1)),o.push(m),t&&(s++,t=void 0),i||(l=m)}let d=s-r.depth;return d>lP&&(a=uP(a,d),s-=d),new yr(a.append(o),s)}remapping(e,t){let r=new Xa;return this.items.forEach((i,o)=>{let s=i.mirrorOffset!=null&&o-i.mirrorOffset>=e?r.maps.length-i.mirrorOffset:void 0;r.appendMap(i.map,s)},e,t),r}addMaps(e){return this.eventCount==0?this:new yr(this.items.append(e.map(t=>new Mr(t))),this.eventCount)}rebased(e,t){if(!this.eventCount)return this;let r=[],i=Math.max(0,this.items.length-t),o=e.mapping,s=e.steps.length,a=this.eventCount;this.items.forEach(m=>{m.selection&&a--},i);let l=t;this.items.forEach(m=>{let g=o.getMirror(--l);if(g==null)return;s=Math.min(s,g);let b=o.maps[g];if(m.step){let v=e.steps[g].invert(e.docs[g]),x=m.selection&&m.selection.map(o.slice(l+1,g));x&&a++,r.push(new Mr(b,v,x))}else r.push(new Mr(b))},i);let d=[];for(let m=t;m<s;m++)d.push(new Mr(o.maps[m]));let f=this.items.slice(0,i).append(d).append(r),h=new yr(f,a);return h.emptyItemCount()>aP&&(h=h.compress(this.items.length-r.length)),h}emptyItemCount(){let e=0;return this.items.forEach(t=>{t.step||e++}),e}compress(e=this.items.length){let t=this.remapping(0,e),r=t.maps.length,i=[],o=0;return this.items.forEach((s,a)=>{if(a>=e)i.push(s),s.selection&&o++;else if(s.step){let l=s.step.map(t.slice(r)),d=l&&l.getMap();if(r--,d&&t.appendMap(d,r),l){let f=s.selection&&s.selection.map(t.slice(r));f&&o++;let h=new Mr(d.invert(),l,f),m,g=i.length-1;(m=i.length&&i[g].merge(h))?i[g]=m:i.push(h)}}else s.map&&r--},this.items.length,0),new yr(At.from(i.reverse()),o)}}yr.empty=new yr(At.empty,0);function uP(n,e){let t;return n.forEach((r,i)=>{if(r.selection&&e--==0)return t=i,!1}),n.slice(t)}class Mr{constructor(e,t,r,i){this.map=e,this.step=t,this.selection=r,this.mirrorOffset=i}merge(e){if(this.step&&e.step&&!e.selection){let t=e.step.merge(this.step);if(t)return new Mr(t.getMap().invert(),t,this.selection)}}}class Pi{constructor(e,t,r,i,o){this.done=e,this.undone=t,this.prevRanges=r,this.prevTime=i,this.prevComposition=o}}const lP=20;function cP(n,e,t,r){let i=t.getMeta(Oo),o;if(i)return i.historyState;t.getMeta(hP)&&(n=new Pi(n.done,n.undone,null,0,-1));let s=t.getMeta("appendedTransaction");if(t.steps.length==0)return n;if(s&&s.getMeta(Oo))return s.getMeta(Oo).redo?new Pi(n.done.addTransform(t,void 0,r,jl(e)),n.undone,Eb(t.mapping.maps),n.prevTime,n.prevComposition):new Pi(n.done,n.undone.addTransform(t,void 0,r,jl(e)),null,n.prevTime,n.prevComposition);if(t.getMeta("addToHistory")!==!1&&!(s&&s.getMeta("addToHistory")===!1)){let a=t.getMeta("composition"),l=n.prevTime==0||!s&&n.prevComposition!=a&&(n.prevTime<(t.time||0)-r.newGroupDelay||!dP(t,n.prevRanges)),d=s?th(n.prevRanges,t.mapping):Eb(t.mapping.maps);return new Pi(n.done.addTransform(t,l?e.selection.getBookmark():void 0,r,jl(e)),yr.empty,d,t.time,a??n.prevComposition)}else return(o=t.getMeta("rebased"))?new Pi(n.done.rebased(t,o),n.undone.rebased(t,o),th(n.prevRanges,t.mapping),n.prevTime,n.prevComposition):new Pi(n.done.addMaps(t.mapping.maps),n.undone.addMaps(t.mapping.maps),th(n.prevRanges,t.mapping),n.prevTime,n.prevComposition)}function dP(n,e){if(!e)return!1;if(!n.docChanged)return!0;let t=!1;return n.mapping.maps[0].forEach((r,i)=>{for(let o=0;o<e.length;o+=2)r<=e[o+1]&&i>=e[o]&&(t=!0)}),t}function Eb(n){let e=[];for(let t=n.length-1;t>=0&&e.length==0;t--)n[t].forEach((r,i,o,s)=>e.push(o,s));return e}function th(n,e){if(!n)return null;let t=[];for(let r=0;r<n.length;r+=2){let i=e.map(n[r],1),o=e.map(n[r+1],-1);i<=o&&t.push(i,o)}return t}function fP(n,e,t){let r=jl(e),i=Oo.get(e).spec.config,o=(t?n.undone:n.done).popEvent(e,r);if(!o)return null;let s=o.selection.resolve(o.transform.doc),a=(t?n.done:n.undone).addTransform(o.transform,e.selection.getBookmark(),i,r),l=new Pi(t?a:o.remaining,t?o.remaining:a,null,0,-1);return o.transform.setSelection(s).setMeta(Oo,{redo:t,historyState:l})}let nh=!1,_b=null;function jl(n){let e=n.plugins;if(_b!=e){nh=!1,_b=e;for(let t=0;t<e.length;t++)if(e[t].spec.historyPreserveItems){nh=!0;break}}return nh}const Oo=new Hn("history"),hP=new Hn("closeHistory");function pP(n={}){return n={depth:n.depth||100,newGroupDelay:n.newGroupDelay||500},new zt({key:Oo,state:{init(){return new Pi(yr.empty,yr.empty,null,0,-1)},apply(e,t,r){return cP(t,r,e,n)}},config:n,props:{handleDOMEvents:{beforeinput(e,t){let r=t.inputType,i=r=="historyUndo"?n2:r=="historyRedo"?r2:null;return i?(t.preventDefault(),i(e.state,e.dispatch)):!1}}}})}function t2(n,e){return(t,r)=>{let i=Oo.getState(t);if(!i||(n?i.undone:i.done).eventCount==0)return!1;if(r){let o=fP(i,t,n);o&&r(e?o.scrollIntoView():o)}return!0}}const n2=t2(!1,!0),r2=t2(!0,!0),mP=bt.create({name:"history",addOptions(){return{depth:100,newGroupDelay:500}},addCommands(){return{undo:()=>({state:n,dispatch:e})=>n2(n,e),redo:()=>({state:n,dispatch:e})=>r2(n,e)}},addProseMirrorPlugins(){return[pP(this.options)]},addKeyboardShortcuts(){return{"Mod-z":()=>this.editor.commands.undo(),"Shift-Mod-z":()=>this.editor.commands.redo(),"Mod-y":()=>this.editor.commands.redo(),"Mod-":()=>this.editor.commands.undo(),"Shift-Mod-":()=>this.editor.commands.redo()}}}),gP=Ge.create({name:"horizontalRule",addOptions(){return{HTMLAttributes:{}}},group:"block",parseHTML(){return[{tag:"hr"}]},renderHTML({HTMLAttributes:n}){return["hr",$t(this.options.HTMLAttributes,n)]},addCommands(){return{setHorizontalRule:()=>({chain:n,state:e})=>{if(!P8(e,e.schema.nodes[this.name]))return!1;const{selection:t}=e,{$from:r,$to:i}=t,o=n();return r.parentOffset===0?o.insertContentAt({from:Math.max(r.pos-1,0),to:i.pos},{type:this.name}):hx(t)?o.insertContentAt(i.pos,{type:this.name}):o.insertContent({type:this.name}),o.command(({tr:s,dispatch:a})=>{var l;if(a){const{$to:d}=s.selection,f=d.end();if(d.nodeAfter)d.nodeAfter.isTextblock?s.setSelection(pe.create(s.doc,d.pos+1)):d.nodeAfter.isBlock?s.setSelection(re.create(s.doc,d.pos)):s.setSelection(pe.create(s.doc,d.pos));else{const h=(l=d.parent.type.contentMatch.defaultType)===null||l===void 0?void 0:l.create();h&&(s.insert(f,h),s.setSelection(pe.create(s.doc,f+1)))}s.scrollIntoView()}return!0}).run()}}},addInputRules(){return[N8({find:/^(?:---|-|___\s|\*\*\*\s)$/,type:this.type})]}}),bP=/(?:^|\s)(\*(?!\s+\*)((?:[^*]+))\*(?!\s+\*))$/,yP=/(?:^|\s)(\*(?!\s+\*)((?:[^*]+))\*(?!\s+\*))/g,vP=/(?:^|\s)(_(?!\s+_)((?:[^_]+))_(?!\s+_))$/,xP=/(?:^|\s)(_(?!\s+_)((?:[^_]+))_(?!\s+_))/g,wP=Yt.create({name:"italic",addOptions(){return{HTMLAttributes:{}}},parseHTML(){return[{tag:"em"},{tag:"i",getAttrs:n=>n.style.fontStyle!=="normal"&&null},{style:"font-style=normal",clearMark:n=>n.type.name===this.name},{style:"font-style=italic"}]},renderHTML({HTMLAttributes:n}){return["em",$t(this.options.HTMLAttributes,n),0]},addCommands(){return{setItalic:()=>({commands:n})=>n.setMark(this.name),toggleItalic:()=>({commands:n})=>n.toggleMark(this.name),unsetItalic:()=>({commands:n})=>n.unsetMark(this.name)}},addKeyboardShortcuts(){return{"Mod-i":()=>this.editor.commands.toggleItalic(),"Mod-I":()=>this.editor.commands.toggleItalic()}},addInputRules(){return[Lo({find:bP,type:this.type}),Lo({find:vP,type:this.type})]},addPasteRules(){return[Bo({find:yP,type:this.type}),Bo({find:xP,type:this.type})]}}),kP=Ge.create({name:"listItem",addOptions(){return{HTMLAttributes:{},bulletListTypeName:"bulletList",orderedListTypeName:"orderedList"}},content:"paragraph block*",defining:!0,parseHTML(){return[{tag:"li"}]},renderHTML({HTMLAttributes:n}){return["li",$t(this.options.HTMLAttributes,n),0]},addKeyboardShortcuts(){return{Enter:()=>this.editor.commands.splitListItem(this.name),Tab:()=>this.editor.commands.sinkListItem(this.name),"Shift-Tab":()=>this.editor.commands.liftListItem(this.name)}}}),SP="listItem",Ab="textStyle",Tb=/^(\d+)\.\s$/,CP=Ge.create({name:"orderedList",addOptions(){return{itemTypeName:"listItem",HTMLAttributes:{},keepMarks:!1,keepAttributes:!1}},group:"block list",content(){return`${this.options.itemTypeName}+`},addAttributes(){return{start:{default:1,parseHTML:n=>n.hasAttribute("start")?parseInt(n.getAttribute("start")||"",10):1},type:{default:null,parseHTML:n=>n.getAttribute("type")}}},parseHTML(){return[{tag:"ol"}]},renderHTML({HTMLAttributes:n}){const{start:e,...t}=n;return e===1?["ol",$t(this.options.HTMLAttributes,t),0]:["ol",$t(this.options.HTMLAttributes,n),0]},addCommands(){return{toggleOrderedList:()=>({commands:n,chain:e})=>this.options.keepAttributes?e().toggleList(this.name,this.options.itemTypeName,this.options.keepMarks).updateAttributes(SP,this.editor.getAttributes(Ab)).run():n.toggleList(this.name,this.options.itemTypeName,this.options.keepMarks)}},addKeyboardShortcuts(){return{"Mod-Shift-7":()=>this.editor.commands.toggleOrderedList()}},addInputRules(){let n=nu({find:Tb,type:this.type,getAttributes:e=>({start:+e[1]}),joinPredicate:(e,t)=>t.childCount+t.attrs.start===+e[1]});return(this.options.keepMarks||this.options.keepAttributes)&&(n=nu({find:Tb,type:this.type,keepMarks:this.options.keepMarks,keepAttributes:this.options.keepAttributes,getAttributes:e=>({start:+e[1],...this.editor.getAttributes(Ab)}),joinPredicate:(e,t)=>t.childCount+t.attrs.start===+e[1],editor:this.editor})),[n]}}),EP=Ge.create({name:"paragraph",priority:1e3,addOptions(){return{HTMLAttributes:{}}},group:"block",content:"inline*",parseHTML(){return[{tag:"p"}]},renderHTML({HTMLAttributes:n}){return["p",$t(this.options.HTMLAttributes,n),0]},addCommands(){return{setParagraph:()=>({commands:n})=>n.setNode(this.name)}},addKeyboardShortcuts(){return{"Mod-Alt-0":()=>this.editor.commands.setParagraph()}}}),_P=/(?:^|\s)(~~(?!\s+~~)((?:[^~]+))~~(?!\s+~~))$/,AP=/(?:^|\s)(~~(?!\s+~~)((?:[^~]+))~~(?!\s+~~))/g,TP=Yt.create({name:"strike",addOptions(){return{HTMLAttributes:{}}},parseHTML(){return[{tag:"s"},{tag:"del"},{tag:"strike"},{style:"text-decoration",consuming:!1,getAttrs:n=>n.includes("line-through")?{}:!1}]},renderHTML({HTMLAttributes:n}){return["s",$t(this.options.HTMLAttributes,n),0]},addCommands(){return{setStrike:()=>({commands:n})=>n.setMark(this.name),toggleStrike:()=>({commands:n})=>n.toggleMark(this.name),unsetStrike:()=>({commands:n})=>n.unsetMark(this.name)}},addKeyboardShortcuts(){return{"Mod-Shift-s":()=>this.editor.commands.toggleStrike()}},addInputRules(){return[Lo({find:_P,type:this.type})]},addPasteRules(){return[Bo({find:AP,type:this.type})]}}),DP=Ge.create({name:"text",group:"inline"}),Db=bt.create({name:"starterKit",addExtensions(){const n=[];return this.options.bold!==!1&&n.push(LN.configure(this.options.bold)),this.options.blockquote!==!1&&n.push(IN.configure(this.options.blockquote)),this.options.bulletList!==!1&&n.push($N.configure(this.options.bulletList)),this.options.code!==!1&&n.push(qN.configure(this.options.code)),this.options.codeBlock!==!1&&n.push(UN.configure(this.options.codeBlock)),this.options.document!==!1&&n.push(KN.configure(this.options.document)),this.options.dropcursor!==!1&&n.push(XN.configure(this.options.dropcursor)),this.options.gapcursor!==!1&&n.push(rP.configure(this.options.gapcursor)),this.options.hardBreak!==!1&&n.push(iP.configure(this.options.hardBreak)),this.options.heading!==!1&&n.push(oP.configure(this.options.heading)),this.options.history!==!1&&n.push(mP.configure(this.options.history)),this.options.horizontalRule!==!1&&n.push(gP.configure(this.options.horizontalRule)),this.options.italic!==!1&&n.push(wP.configure(this.options.italic)),this.options.listItem!==!1&&n.push(kP.configure(this.options.listItem)),this.options.orderedList!==!1&&n.push(CP.configure(this.options.orderedList)),this.options.paragraph!==!1&&n.push(EP.configure(this.options.paragraph)),this.options.strike!==!1&&n.push(TP.configure(this.options.strike)),this.options.text!==!1&&n.push(DP.configure(this.options.text)),n}});var wn="top",ir="bottom",or="right",kn="left",Bp="auto",xu=[wn,ir,or,kn],Bs="start",au="end",MP="clippingParents",i2="viewport",va="popper",OP="reference",Mb=xu.reduce(function(n,e){return n.concat([e+"-"+Bs,e+"-"+au])},[]),o2=[].concat(xu,[Bp]).reduce(function(n,e){return n.concat([e,e+"-"+Bs,e+"-"+au])},[]),IP="beforeRead",NP="read",PP="afterRead",FP="beforeMain",RP="main",LP="afterMain",BP="beforeWrite",$P="write",zP="afterWrite",HP=[IP,NP,PP,FP,RP,LP,BP,$P,zP];function qr(n){return n?(n.nodeName||"").toLowerCase():null}function zn(n){if(n==null)return window;if(n.toString()!=="[object Window]"){var e=n.ownerDocument;return e&&e.defaultView||window}return n}function $o(n){var e=zn(n).Element;return n instanceof e||n instanceof Element}function rr(n){var e=zn(n).HTMLElement;return n instanceof e||n instanceof HTMLElement}function $p(n){if(typeof ShadowRoot>"u")return!1;var e=zn(n).ShadowRoot;return n instanceof e||n instanceof ShadowRoot}function qP(n){var e=n.state;Object.keys(e.elements).forEach(function(t){var r=e.styles[t]||{},i=e.attributes[t]||{},o=e.elements[t];!rr(o)||!qr(o)||(Object.assign(o.style,r),Object.keys(i).forEach(function(s){var a=i[s];a===!1?o.removeAttribute(s):o.setAttribute(s,a===!0?"":a)}))})}function VP(n){var e=n.state,t={popper:{position:e.options.strategy,left:"0",top:"0",margin:"0"},arrow:{position:"absolute"},reference:{}};return Object.assign(e.elements.popper.style,t.popper),e.styles=t,e.elements.arrow&&Object.assign(e.elements.arrow.style,t.arrow),function(){Object.keys(e.elements).forEach(function(r){var i=e.elements[r],o=e.attributes[r]||{},s=Object.keys(e.styles.hasOwnProperty(r)?e.styles[r]:t[r]),a=s.reduce(function(l,d){return l[d]="",l},{});!rr(i)||!qr(i)||(Object.assign(i.style,a),Object.keys(o).forEach(function(l){i.removeAttribute(l)}))})}}const s2={name:"applyStyles",enabled:!0,phase:"write",fn:qP,effect:VP,requires:["computeStyles"]};function Lr(n){return n.split("-")[0]}var Io=Math.max,Sc=Math.min,$s=Math.round;function Wh(){var n=navigator.userAgentData;return n!=null&&n.brands&&Array.isArray(n.brands)?n.brands.map(function(e){return e.brand+"/"+e.version}).join(" "):navigator.userAgent}function a2(){return!/^((?!chrome|android).)*safari/i.test(Wh())}function zs(n,e,t){e===void 0&&(e=!1),t===void 0&&(t=!1);var r=n.getBoundingClientRect(),i=1,o=1;e&&rr(n)&&(i=n.offsetWidth>0&&$s(r.width)/n.offsetWidth||1,o=n.offsetHeight>0&&$s(r.height)/n.offsetHeight||1);var s=$o(n)?zn(n):window,a=s.visualViewport,l=!a2()&&t,d=(r.left+(l&&a?a.offsetLeft:0))/i,f=(r.top+(l&&a?a.offsetTop:0))/o,h=r.width/i,m=r.height/o;return{width:h,height:m,top:f,right:d+h,bottom:f+m,left:d,x:d,y:f}}function zp(n){var e=zs(n),t=n.offsetWidth,r=n.offsetHeight;return Math.abs(e.width-t)<=1&&(t=e.width),Math.abs(e.height-r)<=1&&(r=e.height),{x:n.offsetLeft,y:n.offsetTop,width:t,height:r}}function u2(n,e){var t=e.getRootNode&&e.getRootNode();if(n.contains(e))return!0;if(t&&$p(t)){var r=e;do{if(r&&n.isSameNode(r))return!0;r=r.parentNode||r.host}while(r)}return!1}function pi(n){return zn(n).getComputedStyle(n)}function WP(n){return["table","td","th"].indexOf(qr(n))>=0}function eo(n){return(($o(n)?n.ownerDocument:n.document)||window.document).documentElement}function Uc(n){return qr(n)==="html"?n:n.assignedSlot||n.parentNode||($p(n)?n.host:null)||eo(n)}function Ob(n){return!rr(n)||pi(n).position==="fixed"?null:n.offsetParent}function UP(n){var e=/firefox/i.test(Wh()),t=/Trident/i.test(Wh());if(t&&rr(n)){var r=pi(n);if(r.position==="fixed")return null}var i=Uc(n);for($p(i)&&(i=i.host);rr(i)&&["html","body"].indexOf(qr(i))<0;){var o=pi(i);if(o.transform!=="none"||o.perspective!=="none"||o.contain==="paint"||["transform","perspective"].indexOf(o.willChange)!==-1||e&&o.willChange==="filter"||e&&o.filter&&o.filter!=="none")return i;i=i.parentNode}return null}function wu(n){for(var e=zn(n),t=Ob(n);t&&WP(t)&&pi(t).position==="static";)t=Ob(t);return t&&(qr(t)==="html"||qr(t)==="body"&&pi(t).position==="static")?e:t||UP(n)||e}function Hp(n){return["top","bottom"].indexOf(n)>=0?"x":"y"}function Wa(n,e,t){return Io(n,Sc(e,t))}function KP(n,e,t){var r=Wa(n,e,t);return r>t?t:r}function l2(){return{top:0,right:0,bottom:0,left:0}}function c2(n){return Object.assign({},l2(),n)}function d2(n,e){return e.reduce(function(t,r){return t[r]=n,t},{})}var jP=function(e,t){return e=typeof e=="function"?e(Object.assign({},t.rects,{placement:t.placement})):e,c2(typeof e!="number"?e:d2(e,xu))};function GP(n){var e,t=n.state,r=n.name,i=n.options,o=t.elements.arrow,s=t.modifiersData.popperOffsets,a=Lr(t.placement),l=Hp(a),d=[kn,or].indexOf(a)>=0,f=d?"height":"width";if(!(!o||!s)){var h=jP(i.padding,t),m=zp(o),g=l==="y"?wn:kn,b=l==="y"?ir:or,v=t.rects.reference[f]+t.rects.reference[l]-s[l]-t.rects.popper[f],x=s[l]-t.rects.reference[l],E=wu(o),A=E?l==="y"?E.clientHeight||0:E.clientWidth||0:0,M=v/2-x/2,C=h[g],P=A-m[f]-h[b],N=A/2-m[f]/2+M,W=Wa(C,N,P),V=l;t.modifiersData[r]=(e={},e[V]=W,e.centerOffset=W-N,e)}}function XP(n){var e=n.state,t=n.options,r=t.element,i=r===void 0?"[data-popper-arrow]":r;i!=null&&(typeof i=="string"&&(i=e.elements.popper.querySelector(i),!i)||u2(e.elements.popper,i)&&(e.elements.arrow=i))}const YP={name:"arrow",enabled:!0,phase:"main",fn:GP,effect:XP,requires:["popperOffsets"],requiresIfExists:["preventOverflow"]};function Hs(n){return n.split("-")[1]}var JP={top:"auto",right:"auto",bottom:"auto",left:"auto"};function ZP(n,e){var t=n.x,r=n.y,i=e.devicePixelRatio||1;return{x:$s(t*i)/i||0,y:$s(r*i)/i||0}}function Ib(n){var e,t=n.popper,r=n.popperRect,i=n.placement,o=n.variation,s=n.offsets,a=n.position,l=n.gpuAcceleration,d=n.adaptive,f=n.roundOffsets,h=n.isFixed,m=s.x,g=m===void 0?0:m,b=s.y,v=b===void 0?0:b,x=typeof f=="function"?f({x:g,y:v}):{x:g,y:v};g=x.x,v=x.y;var E=s.hasOwnProperty("x"),A=s.hasOwnProperty("y"),M=kn,C=wn,P=window;if(d){var N=wu(t),W="clientHeight",V="clientWidth";if(N===zn(t)&&(N=eo(t),pi(N).position!=="static"&&a==="absolute"&&(W="scrollHeight",V="scrollWidth")),N=N,i===wn||(i===kn||i===or)&&o===au){C=ir;var U=h&&N===P&&P.visualViewport?P.visualViewport.height:N[W];v-=U-r.height,v*=l?1:-1}if(i===kn||(i===wn||i===ir)&&o===au){M=or;var Q=h&&N===P&&P.visualViewport?P.visualViewport.width:N[V];g-=Q-r.width,g*=l?1:-1}}var oe=Object.assign({position:a},d&&JP),me=f===!0?ZP({x:g,y:v},zn(t)):{x:g,y:v};if(g=me.x,v=me.y,l){var se;return Object.assign({},oe,(se={},se[C]=A?"0":"",se[M]=E?"0":"",se.transform=(P.devicePixelRatio||1)<=1?"translate("+g+"px, "+v+"px)":"translate3d("+g+"px, "+v+"px, 0)",se))}return Object.assign({},oe,(e={},e[C]=A?v+"px":"",e[M]=E?g+"px":"",e.transform="",e))}function QP(n){var e=n.state,t=n.options,r=t.gpuAcceleration,i=r===void 0?!0:r,o=t.adaptive,s=o===void 0?!0:o,a=t.roundOffsets,l=a===void 0?!0:a,d={placement:Lr(e.placement),variation:Hs(e.placement),popper:e.elements.popper,popperRect:e.rects.popper,gpuAcceleration:i,isFixed:e.options.strategy==="fixed"};e.modifiersData.popperOffsets!=null&&(e.styles.popper=Object.assign({},e.styles.popper,Ib(Object.assign({},d,{offsets:e.modifiersData.popperOffsets,position:e.options.strategy,adaptive:s,roundOffsets:l})))),e.modifiersData.arrow!=null&&(e.styles.arrow=Object.assign({},e.styles.arrow,Ib(Object.assign({},d,{offsets:e.modifiersData.arrow,position:"absolute",adaptive:!1,roundOffsets:l})))),e.attributes.popper=Object.assign({},e.attributes.popper,{"data-popper-placement":e.placement})}const e9={name:"computeStyles",enabled:!0,phase:"beforeWrite",fn:QP,data:{}};var Ol={passive:!0};function t9(n){var e=n.state,t=n.instance,r=n.options,i=r.scroll,o=i===void 0?!0:i,s=r.resize,a=s===void 0?!0:s,l=zn(e.elements.popper),d=[].concat(e.scrollParents.reference,e.scrollParents.popper);return o&&d.forEach(function(f){f.addEventListener("scroll",t.update,Ol)}),a&&l.addEventListener("resize",t.update,Ol),function(){o&&d.forEach(function(f){f.removeEventListener("scroll",t.update,Ol)}),a&&l.removeEventListener("resize",t.update,Ol)}}const n9={name:"eventListeners",enabled:!0,phase:"write",fn:function(){},effect:t9,data:{}};var r9={left:"right",right:"left",bottom:"top",top:"bottom"};function Gl(n){return n.replace(/left|right|bottom|top/g,function(e){return r9[e]})}var i9={start:"end",end:"start"};function Nb(n){return n.replace(/start|end/g,function(e){return i9[e]})}function qp(n){var e=zn(n),t=e.pageXOffset,r=e.pageYOffset;return{scrollLeft:t,scrollTop:r}}function Vp(n){return zs(eo(n)).left+qp(n).scrollLeft}function o9(n,e){var t=zn(n),r=eo(n),i=t.visualViewport,o=r.clientWidth,s=r.clientHeight,a=0,l=0;if(i){o=i.width,s=i.height;var d=a2();(d||!d&&e==="fixed")&&(a=i.offsetLeft,l=i.offsetTop)}return{width:o,height:s,x:a+Vp(n),y:l}}function s9(n){var e,t=eo(n),r=qp(n),i=(e=n.ownerDocument)==null?void 0:e.body,o=Io(t.scrollWidth,t.clientWidth,i?i.scrollWidth:0,i?i.clientWidth:0),s=Io(t.scrollHeight,t.clientHeight,i?i.scrollHeight:0,i?i.clientHeight:0),a=-r.scrollLeft+Vp(n),l=-r.scrollTop;return pi(i||t).direction==="rtl"&&(a+=Io(t.clientWidth,i?i.clientWidth:0)-o),{width:o,height:s,x:a,y:l}}function Wp(n){var e=pi(n),t=e.overflow,r=e.overflowX,i=e.overflowY;return/auto|scroll|overlay|hidden/.test(t+i+r)}function f2(n){return["html","body","#document"].indexOf(qr(n))>=0?n.ownerDocument.body:rr(n)&&Wp(n)?n:f2(Uc(n))}function Ua(n,e){var t;e===void 0&&(e=[]);var r=f2(n),i=r===((t=n.ownerDocument)==null?void 0:t.body),o=zn(r),s=i?[o].concat(o.visualViewport||[],Wp(r)?r:[]):r,a=e.concat(s);return i?a:a.concat(Ua(Uc(s)))}function Uh(n){return Object.assign({},n,{left:n.x,top:n.y,right:n.x+n.width,bottom:n.y+n.height})}function a9(n,e){var t=zs(n,!1,e==="fixed");return t.top=t.top+n.clientTop,t.left=t.left+n.clientLeft,t.bottom=t.top+n.clientHeight,t.right=t.left+n.clientWidth,t.width=n.clientWidth,t.height=n.clientHeight,t.x=t.left,t.y=t.top,t}function Pb(n,e,t){return e===i2?Uh(o9(n,t)):$o(e)?a9(e,t):Uh(s9(eo(n)))}function u9(n){var e=Ua(Uc(n)),t=["absolute","fixed"].indexOf(pi(n).position)>=0,r=t&&rr(n)?wu(n):n;return $o(r)?e.filter(function(i){return $o(i)&&u2(i,r)&&qr(i)!=="body"}):[]}function l9(n,e,t,r){var i=e==="clippingParents"?u9(n):[].concat(e),o=[].concat(i,[t]),s=o[0],a=o.reduce(function(l,d){var f=Pb(n,d,r);return l.top=Io(f.top,l.top),l.right=Sc(f.right,l.right),l.bottom=Sc(f.bottom,l.bottom),l.left=Io(f.left,l.left),l},Pb(n,s,r));return a.width=a.right-a.left,a.height=a.bottom-a.top,a.x=a.left,a.y=a.top,a}function h2(n){var e=n.reference,t=n.element,r=n.placement,i=r?Lr(r):null,o=r?Hs(r):null,s=e.x+e.width/2-t.width/2,a=e.y+e.height/2-t.height/2,l;switch(i){case wn:l={x:s,y:e.y-t.height};break;case ir:l={x:s,y:e.y+e.height};break;case or:l={x:e.x+e.width,y:a};break;case kn:l={x:e.x-t.width,y:a};break;default:l={x:e.x,y:e.y}}var d=i?Hp(i):null;if(d!=null){var f=d==="y"?"height":"width";switch(o){case Bs:l[d]=l[d]-(e[f]/2-t[f]/2);break;case au:l[d]=l[d]+(e[f]/2-t[f]/2);break}}return l}function uu(n,e){e===void 0&&(e={});var t=e,r=t.placement,i=r===void 0?n.placement:r,o=t.strategy,s=o===void 0?n.strategy:o,a=t.boundary,l=a===void 0?MP:a,d=t.rootBoundary,f=d===void 0?i2:d,h=t.elementContext,m=h===void 0?va:h,g=t.altBoundary,b=g===void 0?!1:g,v=t.padding,x=v===void 0?0:v,E=c2(typeof x!="number"?x:d2(x,xu)),A=m===va?OP:va,M=n.rects.popper,C=n.elements[b?A:m],P=l9($o(C)?C:C.contextElement||eo(n.elements.popper),l,f,s),N=zs(n.elements.reference),W=h2({reference:N,element:M,placement:i}),V=Uh(Object.assign({},M,W)),U=m===va?V:N,Q={top:P.top-U.top+E.top,bottom:U.bottom-P.bottom+E.bottom,left:P.left-U.left+E.left,right:U.right-P.right+E.right},oe=n.modifiersData.offset;if(m===va&&oe){var me=oe[i];Object.keys(Q).forEach(function(se){var Ee=[or,ir].indexOf(se)>=0?1:-1,Me=[wn,ir].indexOf(se)>=0?"y":"x";Q[se]+=me[Me]*Ee})}return Q}function c9(n,e){e===void 0&&(e={});var t=e,r=t.placement,i=t.boundary,o=t.rootBoundary,s=t.padding,a=t.flipVariations,l=t.allowedAutoPlacements,d=l===void 0?o2:l,f=Hs(r),h=f?a?Mb:Mb.filter(function(b){return Hs(b)===f}):xu,m=h.filter(function(b){return d.indexOf(b)>=0});m.length===0&&(m=h);var g=m.reduce(function(b,v){return b[v]=uu(n,{placement:v,boundary:i,rootBoundary:o,padding:s})[Lr(v)],b},{});return Object.keys(g).sort(function(b,v){return g[b]-g[v]})}function d9(n){if(Lr(n)===Bp)return[];var e=Gl(n);return[Nb(n),e,Nb(e)]}function f9(n){var e=n.state,t=n.options,r=n.name;if(!e.modifiersData[r]._skip){for(var i=t.mainAxis,o=i===void 0?!0:i,s=t.altAxis,a=s===void 0?!0:s,l=t.fallbackPlacements,d=t.padding,f=t.boundary,h=t.rootBoundary,m=t.altBoundary,g=t.flipVariations,b=g===void 0?!0:g,v=t.allowedAutoPlacements,x=e.options.placement,E=Lr(x),A=E===x,M=l||(A||!b?[Gl(x)]:d9(x)),C=[x].concat(M).reduce(function(sr,wt){return sr.concat(Lr(wt)===Bp?c9(e,{placement:wt,boundary:f,rootBoundary:h,padding:d,flipVariations:b,allowedAutoPlacements:v}):wt)},[]),P=e.rects.reference,N=e.rects.popper,W=new Map,V=!0,U=C[0],Q=0;Q<C.length;Q++){var oe=C[Q],me=Lr(oe),se=Hs(oe)===Bs,Ee=[wn,ir].indexOf(me)>=0,Me=Ee?"width":"height",he=uu(e,{placement:oe,boundary:f,rootBoundary:h,altBoundary:m,padding:d}),we=Ee?se?or:kn:se?ir:wn;P[Me]>N[Me]&&(we=Gl(we));var Oe=Gl(we),Ht=[];if(o&&Ht.push(he[me]<=0),a&&Ht.push(he[we]<=0,he[Oe]<=0),Ht.every(function(sr){return sr})){U=oe,V=!1;break}W.set(oe,Ht)}if(V)for(var Dt=b?3:1,Je=function(wt){var cn=C.find(function(bi){var Zt=W.get(bi);if(Zt)return Zt.slice(0,wt).every(function(qn){return qn})});if(cn)return U=cn,"break"},qt=Dt;qt>0;qt--){var Kr=Je(qt);if(Kr==="break")break}e.placement!==U&&(e.modifiersData[r]._skip=!0,e.placement=U,e.reset=!0)}}const h9={name:"flip",enabled:!0,phase:"main",fn:f9,requiresIfExists:["offset"],data:{_skip:!1}};function Fb(n,e,t){return t===void 0&&(t={x:0,y:0}),{top:n.top-e.height-t.y,right:n.right-e.width+t.x,bottom:n.bottom-e.height+t.y,left:n.left-e.width-t.x}}function Rb(n){return[wn,or,ir,kn].some(function(e){return n[e]>=0})}function p9(n){var e=n.state,t=n.name,r=e.rects.reference,i=e.rects.popper,o=e.modifiersData.preventOverflow,s=uu(e,{elementContext:"reference"}),a=uu(e,{altBoundary:!0}),l=Fb(s,r),d=Fb(a,i,o),f=Rb(l),h=Rb(d);e.modifiersData[t]={referenceClippingOffsets:l,popperEscapeOffsets:d,isReferenceHidden:f,hasPopperEscaped:h},e.attributes.popper=Object.assign({},e.attributes.popper,{"data-popper-reference-hidden":f,"data-popper-escaped":h})}const m9={name:"hide",enabled:!0,phase:"main",requiresIfExists:["preventOverflow"],fn:p9};function g9(n,e,t){var r=Lr(n),i=[kn,wn].indexOf(r)>=0?-1:1,o=typeof t=="function"?t(Object.assign({},e,{placement:n})):t,s=o[0],a=o[1];return s=s||0,a=(a||0)*i,[kn,or].indexOf(r)>=0?{x:a,y:s}:{x:s,y:a}}function b9(n){var e=n.state,t=n.options,r=n.name,i=t.offset,o=i===void 0?[0,0]:i,s=o2.reduce(function(f,h){return f[h]=g9(h,e.rects,o),f},{}),a=s[e.placement],l=a.x,d=a.y;e.modifiersData.popperOffsets!=null&&(e.modifiersData.popperOffsets.x+=l,e.modifiersData.popperOffsets.y+=d),e.modifiersData[r]=s}const y9={name:"offset",enabled:!0,phase:"main",requires:["popperOffsets"],fn:b9};function v9(n){var e=n.state,t=n.name;e.modifiersData[t]=h2({reference:e.rects.reference,element:e.rects.popper,placement:e.placement})}const x9={name:"popperOffsets",enabled:!0,phase:"read",fn:v9,data:{}};function w9(n){return n==="x"?"y":"x"}function k9(n){var e=n.state,t=n.options,r=n.name,i=t.mainAxis,o=i===void 0?!0:i,s=t.altAxis,a=s===void 0?!1:s,l=t.boundary,d=t.rootBoundary,f=t.altBoundary,h=t.padding,m=t.tether,g=m===void 0?!0:m,b=t.tetherOffset,v=b===void 0?0:b,x=uu(e,{boundary:l,rootBoundary:d,padding:h,altBoundary:f}),E=Lr(e.placement),A=Hs(e.placement),M=!A,C=Hp(E),P=w9(C),N=e.modifiersData.popperOffsets,W=e.rects.reference,V=e.rects.popper,U=typeof v=="function"?v(Object.assign({},e.rects,{placement:e.placement})):v,Q=typeof U=="number"?{mainAxis:U,altAxis:U}:Object.assign({mainAxis:0,altAxis:0},U),oe=e.modifiersData.offset?e.modifiersData.offset[e.placement]:null,me={x:0,y:0};if(N){if(o){var se,Ee=C==="y"?wn:kn,Me=C==="y"?ir:or,he=C==="y"?"height":"width",we=N[C],Oe=we+x[Ee],Ht=we-x[Me],Dt=g?-V[he]/2:0,Je=A===Bs?W[he]:V[he],qt=A===Bs?-V[he]:-W[he],Kr=e.elements.arrow,sr=g&&Kr?zp(Kr):{width:0,height:0},wt=e.modifiersData["arrow#persistent"]?e.modifiersData["arrow#persistent"].padding:l2(),cn=wt[Ee],bi=wt[Me],Zt=Wa(0,W[he],sr[he]),qn=M?W[he]/2-Dt-Zt-cn-Q.mainAxis:Je-Zt-cn-Q.mainAxis,Sr=M?-W[he]/2+Dt+Zt+bi+Q.mainAxis:qt+Zt+bi+Q.mainAxis,ar=e.elements.arrow&&wu(e.elements.arrow),jr=ar?C==="y"?ar.clientTop||0:ar.clientLeft||0:0,yi=(se=oe==null?void 0:oe[C])!=null?se:0,Vt=we+qn-yi-jr,Cr=we+Sr-yi,to=Wa(g?Sc(Oe,Vt):Oe,we,g?Io(Ht,Cr):Ht);N[C]=to,me[C]=to-we}if(a){var Qt,no=C==="x"?wn:kn,Ho=C==="x"?ir:or,en=N[P],ct=P==="y"?"height":"width",ur=en+x[no],Vn=en-x[Ho],ro=[wn,kn].indexOf(E)!==-1,Er=(Qt=oe==null?void 0:oe[P])!=null?Qt:0,qo=ro?ur:en-W[ct]-V[ct]-Er+Q.altAxis,_r=ro?en+W[ct]+V[ct]-Er-Q.altAxis:Vn,lr=g&&ro?KP(qo,en,_r):Wa(g?qo:ur,en,g?_r:Vn);N[P]=lr,me[P]=lr-en}e.modifiersData[r]=me}}const S9={name:"preventOverflow",enabled:!0,phase:"main",fn:k9,requiresIfExists:["offset"]};function C9(n){return{scrollLeft:n.scrollLeft,scrollTop:n.scrollTop}}function E9(n){return n===zn(n)||!rr(n)?qp(n):C9(n)}function _9(n){var e=n.getBoundingClientRect(),t=$s(e.width)/n.offsetWidth||1,r=$s(e.height)/n.offsetHeight||1;return t!==1||r!==1}function A9(n,e,t){t===void 0&&(t=!1);var r=rr(e),i=rr(e)&&_9(e),o=eo(e),s=zs(n,i,t),a={scrollLeft:0,scrollTop:0},l={x:0,y:0};return(r||!r&&!t)&&((qr(e)!=="body"||Wp(o))&&(a=E9(e)),rr(e)?(l=zs(e,!0),l.x+=e.clientLeft,l.y+=e.clientTop):o&&(l.x=Vp(o))),{x:s.left+a.scrollLeft-l.x,y:s.top+a.scrollTop-l.y,width:s.width,height:s.height}}function T9(n){var e=new Map,t=new Set,r=[];n.forEach(function(o){e.set(o.name,o)});function i(o){t.add(o.name);var s=[].concat(o.requires||[],o.requiresIfExists||[]);s.forEach(function(a){if(!t.has(a)){var l=e.get(a);l&&i(l)}}),r.push(o)}return n.forEach(function(o){t.has(o.name)||i(o)}),r}function D9(n){var e=T9(n);return HP.reduce(function(t,r){return t.concat(e.filter(function(i){return i.phase===r}))},[])}function M9(n){var e;return function(){return e||(e=new Promise(function(t){Promise.resolve().then(function(){e=void 0,t(n())})})),e}}function O9(n){var e=n.reduce(function(t,r){var i=t[r.name];return t[r.name]=i?Object.assign({},i,r,{options:Object.assign({},i.options,r.options),data:Object.assign({},i.data,r.data)}):r,t},{});return Object.keys(e).map(function(t){return e[t]})}var Lb={placement:"bottom",modifiers:[],strategy:"absolute"};function Bb(){for(var n=arguments.length,e=new Array(n),t=0;t<n;t++)e[t]=arguments[t];return!e.some(function(r){return!(r&&typeof r.getBoundingClientRect=="function")})}function I9(n){n===void 0&&(n={});var e=n,t=e.defaultModifiers,r=t===void 0?[]:t,i=e.defaultOptions,o=i===void 0?Lb:i;return function(a,l,d){d===void 0&&(d=o);var f={placement:"bottom",orderedModifiers:[],options:Object.assign({},Lb,o),modifiersData:{},elements:{reference:a,popper:l},attributes:{},styles:{}},h=[],m=!1,g={state:f,setOptions:function(E){var A=typeof E=="function"?E(f.options):E;v(),f.options=Object.assign({},o,f.options,A),f.scrollParents={reference:$o(a)?Ua(a):a.contextElement?Ua(a.contextElement):[],popper:Ua(l)};var M=D9(O9([].concat(r,f.options.modifiers)));return f.orderedModifiers=M.filter(function(C){return C.enabled}),b(),g.update()},forceUpdate:function(){if(!m){var E=f.elements,A=E.reference,M=E.popper;if(Bb(A,M)){f.rects={reference:A9(A,wu(M),f.options.strategy==="fixed"),popper:zp(M)},f.reset=!1,f.placement=f.options.placement,f.orderedModifiers.forEach(function(Q){return f.modifiersData[Q.name]=Object.assign({},Q.data)});for(var C=0;C<f.orderedModifiers.length;C++){if(f.reset===!0){f.reset=!1,C=-1;continue}var P=f.orderedModifiers[C],N=P.fn,W=P.options,V=W===void 0?{}:W,U=P.name;typeof N=="function"&&(f=N({state:f,options:V,name:U,instance:g})||f)}}}},update:M9(function(){return new Promise(function(x){g.forceUpdate(),x(f)})}),destroy:function(){v(),m=!0}};if(!Bb(a,l))return g;g.setOptions(d).then(function(x){!m&&d.onFirstUpdate&&d.onFirstUpdate(x)});function b(){f.orderedModifiers.forEach(function(x){var E=x.name,A=x.options,M=A===void 0?{}:A,C=x.effect;if(typeof C=="function"){var P=C({state:f,name:E,instance:g,options:M}),N=function(){};h.push(P||N)}})}function v(){h.forEach(function(x){return x()}),h=[]}return g}}var N9=[n9,x9,e9,s2,y9,h9,S9,YP,m9],P9=I9({defaultModifiers:N9}),F9="tippy-box",p2="tippy-content",R9="tippy-backdrop",m2="tippy-arrow",g2="tippy-svg-arrow",xo={passive:!0,capture:!0},b2=function(){return document.body};function rh(n,e,t){if(Array.isArray(n)){var r=n[e];return r??(Array.isArray(t)?t[e]:t)}return n}function Up(n,e){var t={}.toString.call(n);return t.indexOf("[object")===0&&t.indexOf(e+"]")>-1}function y2(n,e){return typeof n=="function"?n.apply(void 0,e):n}function $b(n,e){if(e===0)return n;var t;return function(r){clearTimeout(t),t=setTimeout(function(){n(r)},e)}}function L9(n){return n.split(/\s+/).filter(Boolean)}function ys(n){return[].concat(n)}function zb(n,e){n.indexOf(e)===-1&&n.push(e)}function B9(n){return n.filter(function(e,t){return n.indexOf(e)===t})}function $9(n){return n.split("-")[0]}function Cc(n){return[].slice.call(n)}function Hb(n){return Object.keys(n).reduce(function(e,t){return n[t]!==void 0&&(e[t]=n[t]),e},{})}function Ka(){return document.createElement("div")}function Kc(n){return["Element","Fragment"].some(function(e){return Up(n,e)})}function z9(n){return Up(n,"NodeList")}function H9(n){return Up(n,"MouseEvent")}function q9(n){return!!(n&&n._tippy&&n._tippy.reference===n)}function V9(n){return Kc(n)?[n]:z9(n)?Cc(n):Array.isArray(n)?n:Cc(document.querySelectorAll(n))}function ih(n,e){n.forEach(function(t){t&&(t.style.transitionDuration=e+"ms")})}function qb(n,e){n.forEach(function(t){t&&t.setAttribute("data-state",e)})}function W9(n){var e,t=ys(n),r=t[0];return r!=null&&(e=r.ownerDocument)!=null&&e.body?r.ownerDocument:document}function U9(n,e){var t=e.clientX,r=e.clientY;return n.every(function(i){var o=i.popperRect,s=i.popperState,a=i.props,l=a.interactiveBorder,d=$9(s.placement),f=s.modifiersData.offset;if(!f)return!0;var h=d==="bottom"?f.top.y:0,m=d==="top"?f.bottom.y:0,g=d==="right"?f.left.x:0,b=d==="left"?f.right.x:0,v=o.top-r+h>l,x=r-o.bottom-m>l,E=o.left-t+g>l,A=t-o.right-b>l;return v||x||E||A})}function oh(n,e,t){var r=e+"EventListener";["transitionend","webkitTransitionEnd"].forEach(function(i){n[r](i,t)})}function Vb(n,e){for(var t=e;t;){var r;if(n.contains(t))return!0;t=t.getRootNode==null||(r=t.getRootNode())==null?void 0:r.host}return!1}var Or={isTouch:!1},Wb=0;function K9(){Or.isTouch||(Or.isTouch=!0,window.performance&&document.addEventListener("mousemove",v2))}function v2(){var n=performance.now();n-Wb<20&&(Or.isTouch=!1,document.removeEventListener("mousemove",v2)),Wb=n}function j9(){var n=document.activeElement;if(q9(n)){var e=n._tippy;n.blur&&!e.state.isVisible&&n.blur()}}function G9(){document.addEventListener("touchstart",K9,xo),window.addEventListener("blur",j9)}var X9=typeof window<"u"&&typeof document<"u",Y9=X9?!!window.msCrypto:!1,J9={animateFill:!1,followCursor:!1,inlinePositioning:!1,sticky:!1},Z9={allowHTML:!1,animation:"fade",arrow:!0,content:"",inertia:!1,maxWidth:350,role:"tooltip",theme:"",zIndex:9999},vr=Object.assign({appendTo:b2,aria:{content:"auto",expanded:"auto"},delay:0,duration:[300,250],getReferenceClientRect:null,hideOnClick:!0,ignoreAttributes:!1,interactive:!1,interactiveBorder:2,interactiveDebounce:0,moveTransition:"",offset:[0,10],onAfterUpdate:function(){},onBeforeUpdate:function(){},onCreate:function(){},onDestroy:function(){},onHidden:function(){},onHide:function(){},onMount:function(){},onShow:function(){},onShown:function(){},onTrigger:function(){},onUntrigger:function(){},onClickOutside:function(){},placement:"top",plugins:[],popperOptions:{},render:null,showOnCreate:!1,touch:!0,trigger:"mouseenter focus",triggerTarget:null},J9,Z9),Q9=Object.keys(vr),eF=function(e){var t=Object.keys(e);t.forEach(function(r){vr[r]=e[r]})};function x2(n){var e=n.plugins||[],t=e.reduce(function(r,i){var o=i.name,s=i.defaultValue;if(o){var a;r[o]=n[o]!==void 0?n[o]:(a=vr[o])!=null?a:s}return r},{});return Object.assign({},n,t)}function tF(n,e){var t=e?Object.keys(x2(Object.assign({},vr,{plugins:e}))):Q9,r=t.reduce(function(i,o){var s=(n.getAttribute("data-tippy-"+o)||"").trim();if(!s)return i;if(o==="content")i[o]=s;else try{i[o]=JSON.parse(s)}catch{i[o]=s}return i},{});return r}function Ub(n,e){var t=Object.assign({},e,{content:y2(e.content,[n])},e.ignoreAttributes?{}:tF(n,e.plugins));return t.aria=Object.assign({},vr.aria,t.aria),t.aria={expanded:t.aria.expanded==="auto"?e.interactive:t.aria.expanded,content:t.aria.content==="auto"?e.interactive?null:"describedby":t.aria.content},t}var nF=function(){return"innerHTML"};function Kh(n,e){n[nF()]=e}function Kb(n){var e=Ka();return n===!0?e.className=m2:(e.className=g2,Kc(n)?e.appendChild(n):Kh(e,n)),e}function jb(n,e){Kc(e.content)?(Kh(n,""),n.appendChild(e.content)):typeof e.content!="function"&&(e.allowHTML?Kh(n,e.content):n.textContent=e.content)}function jh(n){var e=n.firstElementChild,t=Cc(e.children);return{box:e,content:t.find(function(r){return r.classList.contains(p2)}),arrow:t.find(function(r){return r.classList.contains(m2)||r.classList.contains(g2)}),backdrop:t.find(function(r){return r.classList.contains(R9)})}}function w2(n){var e=Ka(),t=Ka();t.className=F9,t.setAttribute("data-state","hidden"),t.setAttribute("tabindex","-1");var r=Ka();r.className=p2,r.setAttribute("data-state","hidden"),jb(r,n.props),e.appendChild(t),t.appendChild(r),i(n.props,n.props);function i(o,s){var a=jh(e),l=a.box,d=a.content,f=a.arrow;s.theme?l.setAttribute("data-theme",s.theme):l.removeAttribute("data-theme"),typeof s.animation=="string"?l.setAttribute("data-animation",s.animation):l.removeAttribute("data-animation"),s.inertia?l.setAttribute("data-inertia",""):l.removeAttribute("data-inertia"),l.style.maxWidth=typeof s.maxWidth=="number"?s.maxWidth+"px":s.maxWidth,s.role?l.setAttribute("role",s.role):l.removeAttribute("role"),(o.content!==s.content||o.allowHTML!==s.allowHTML)&&jb(d,n.props),s.arrow?f?o.arrow!==s.arrow&&(l.removeChild(f),l.appendChild(Kb(s.arrow))):l.appendChild(Kb(s.arrow)):f&&l.removeChild(f)}return{popper:e,onUpdate:i}}w2.$$tippy=!0;var rF=1,Il=[],sh=[];function iF(n,e){var t=Ub(n,Object.assign({},vr,x2(Hb(e)))),r,i,o,s=!1,a=!1,l=!1,d=!1,f,h,m,g=[],b=$b(Vt,t.interactiveDebounce),v,x=rF++,E=null,A=B9(t.plugins),M={isEnabled:!0,isVisible:!1,isDestroyed:!1,isMounted:!1,isShown:!1},C={id:x,reference:n,popper:Ka(),popperInstance:E,props:t,state:M,plugins:A,clearDelayTimeouts:qo,setProps:_r,setContent:lr,show:Us,hide:Ks,hideWithInteractivity:js,enable:ro,disable:Er,unmount:Gs,destroy:Xs};if(!t.render)return C;var P=t.render(C),N=P.popper,W=P.onUpdate;N.setAttribute("data-tippy-root",""),N.id="tippy-"+C.id,C.popper=N,n._tippy=C,N._tippy=C;var V=A.map(function(R){return R.fn(C)}),U=n.hasAttribute("aria-expanded");return ar(),Dt(),we(),Oe("onCreate",[C]),t.showOnCreate&&ur(),N.addEventListener("mouseenter",function(){C.props.interactive&&C.state.isVisible&&C.clearDelayTimeouts()}),N.addEventListener("mouseleave",function(){C.props.interactive&&C.props.trigger.indexOf("mouseenter")>=0&&Ee().addEventListener("mousemove",b)}),C;function Q(){var R=C.props.touch;return Array.isArray(R)?R:[R,0]}function oe(){return Q()[0]==="hold"}function me(){var R;return!!((R=C.props.render)!=null&&R.$$tippy)}function se(){return v||n}function Ee(){var R=se().parentNode;return R?W9(R):document}function Me(){return jh(N)}function he(R){return C.state.isMounted&&!C.state.isVisible||Or.isTouch||f&&f.type==="focus"?0:rh(C.props.delay,R?0:1,vr.delay)}function we(R){R===void 0&&(R=!1),N.style.pointerEvents=C.props.interactive&&!R?"":"none",N.style.zIndex=""+C.props.zIndex}function Oe(R,J,ae){if(ae===void 0&&(ae=!0),V.forEach(function(Pe){Pe[R]&&Pe[R].apply(Pe,J)}),ae){var Re;(Re=C.props)[R].apply(Re,J)}}function Ht(){var R=C.props.aria;if(R.content){var J="aria-"+R.content,ae=N.id,Re=ys(C.props.triggerTarget||n);Re.forEach(function(Pe){var Mt=Pe.getAttribute(J);if(C.state.isVisible)Pe.setAttribute(J,Mt?Mt+" "+ae:ae);else{var dn=Mt&&Mt.replace(ae,"").trim();dn?Pe.setAttribute(J,dn):Pe.removeAttribute(J)}})}}function Dt(){if(!(U||!C.props.aria.expanded)){var R=ys(C.props.triggerTarget||n);R.forEach(function(J){C.props.interactive?J.setAttribute("aria-expanded",C.state.isVisible&&J===se()?"true":"false"):J.removeAttribute("aria-expanded")})}}function Je(){Ee().removeEventListener("mousemove",b),Il=Il.filter(function(R){return R!==b})}function qt(R){if(!(Or.isTouch&&(l||R.type==="mousedown"))){var J=R.composedPath&&R.composedPath()[0]||R.target;if(!(C.props.interactive&&Vb(N,J))){if(ys(C.props.triggerTarget||n).some(function(ae){return Vb(ae,J)})){if(Or.isTouch||C.state.isVisible&&C.props.trigger.indexOf("click")>=0)return}else Oe("onClickOutside",[C,R]);C.props.hideOnClick===!0&&(C.clearDelayTimeouts(),C.hide(),a=!0,setTimeout(function(){a=!1}),C.state.isMounted||cn())}}}function Kr(){l=!0}function sr(){l=!1}function wt(){var R=Ee();R.addEventListener("mousedown",qt,!0),R.addEventListener("touchend",qt,xo),R.addEventListener("touchstart",sr,xo),R.addEventListener("touchmove",Kr,xo)}function cn(){var R=Ee();R.removeEventListener("mousedown",qt,!0),R.removeEventListener("touchend",qt,xo),R.removeEventListener("touchstart",sr,xo),R.removeEventListener("touchmove",Kr,xo)}function bi(R,J){qn(R,function(){!C.state.isVisible&&N.parentNode&&N.parentNode.contains(N)&&J()})}function Zt(R,J){qn(R,J)}function qn(R,J){var ae=Me().box;function Re(Pe){Pe.target===ae&&(oh(ae,"remove",Re),J())}if(R===0)return J();oh(ae,"remove",h),oh(ae,"add",Re),h=Re}function Sr(R,J,ae){ae===void 0&&(ae=!1);var Re=ys(C.props.triggerTarget||n);Re.forEach(function(Pe){Pe.addEventListener(R,J,ae),g.push({node:Pe,eventType:R,handler:J,options:ae})})}function ar(){oe()&&(Sr("touchstart",yi,{passive:!0}),Sr("touchend",Cr,{passive:!0})),L9(C.props.trigger).forEach(function(R){if(R!=="manual")switch(Sr(R,yi),R){case"mouseenter":Sr("mouseleave",Cr);break;case"focus":Sr(Y9?"focusout":"blur",to);break;case"focusin":Sr("focusout",to);break}})}function jr(){g.forEach(function(R){var J=R.node,ae=R.eventType,Re=R.handler,Pe=R.options;J.removeEventListener(ae,Re,Pe)}),g=[]}function yi(R){var J,ae=!1;if(!(!C.state.isEnabled||Qt(R)||a)){var Re=((J=f)==null?void 0:J.type)==="focus";f=R,v=R.currentTarget,Dt(),!C.state.isVisible&&H9(R)&&Il.forEach(function(Pe){return Pe(R)}),R.type==="click"&&(C.props.trigger.indexOf("mouseenter")<0||s)&&C.props.hideOnClick!==!1&&C.state.isVisible?ae=!0:ur(R),R.type==="click"&&(s=!ae),ae&&!Re&&Vn(R)}}function Vt(R){var J=R.target,ae=se().contains(J)||N.contains(J);if(!(R.type==="mousemove"&&ae)){var Re=ct().concat(N).map(function(Pe){var Mt,dn=Pe._tippy,Gr=(Mt=dn.popperInstance)==null?void 0:Mt.state;return Gr?{popperRect:Pe.getBoundingClientRect(),popperState:Gr,props:t}:null}).filter(Boolean);U9(Re,R)&&(Je(),Vn(R))}}function Cr(R){var J=Qt(R)||C.props.trigger.indexOf("click")>=0&&s;if(!J){if(C.props.interactive){C.hideWithInteractivity(R);return}Vn(R)}}function to(R){C.props.trigger.indexOf("focusin")<0&&R.target!==se()||C.props.interactive&&R.relatedTarget&&N.contains(R.relatedTarget)||Vn(R)}function Qt(R){return Or.isTouch?oe()!==R.type.indexOf("touch")>=0:!1}function no(){Ho();var R=C.props,J=R.popperOptions,ae=R.placement,Re=R.offset,Pe=R.getReferenceClientRect,Mt=R.moveTransition,dn=me()?jh(N).arrow:null,Gr=Pe?{getBoundingClientRect:Pe,contextElement:Pe.contextElement||se()}:n,Ys={name:"$$tippy",enabled:!0,phase:"beforeWrite",requires:["computeStyles"],fn:function(Vo){var vi=Vo.state;if(me()){var ku=Me(),Zs=ku.box;["placement","reference-hidden","escaped"].forEach(function(Wo){Wo==="placement"?Zs.setAttribute("data-placement",vi.placement):vi.attributes.popper["data-popper-"+Wo]?Zs.setAttribute("data-"+Wo,""):Zs.removeAttribute("data-"+Wo)}),vi.attributes.popper={}}}},Xr=[{name:"offset",options:{offset:Re}},{name:"preventOverflow",options:{padding:{top:2,bottom:2,left:5,right:5}}},{name:"flip",options:{padding:5}},{name:"computeStyles",options:{adaptive:!Mt}},Ys];me()&&dn&&Xr.push({name:"arrow",options:{element:dn,padding:3}}),Xr.push.apply(Xr,(J==null?void 0:J.modifiers)||[]),C.popperInstance=P9(Gr,N,Object.assign({},J,{placement:ae,onFirstUpdate:m,modifiers:Xr}))}function Ho(){C.popperInstance&&(C.popperInstance.destroy(),C.popperInstance=null)}function en(){var R=C.props.appendTo,J,ae=se();C.props.interactive&&R===b2||R==="parent"?J=ae.parentNode:J=y2(R,[ae]),J.contains(N)||J.appendChild(N),C.state.isMounted=!0,no()}function ct(){return Cc(N.querySelectorAll("[data-tippy-root]"))}function ur(R){C.clearDelayTimeouts(),R&&Oe("onTrigger",[C,R]),wt();var J=he(!0),ae=Q(),Re=ae[0],Pe=ae[1];Or.isTouch&&Re==="hold"&&Pe&&(J=Pe),J?r=setTimeout(function(){C.show()},J):C.show()}function Vn(R){if(C.clearDelayTimeouts(),Oe("onUntrigger",[C,R]),!C.state.isVisible){cn();return}if(!(C.props.trigger.indexOf("mouseenter")>=0&&C.props.trigger.indexOf("click")>=0&&["mouseleave","mousemove"].indexOf(R.type)>=0&&s)){var J=he(!1);J?i=setTimeout(function(){C.state.isVisible&&C.hide()},J):o=requestAnimationFrame(function(){C.hide()})}}function ro(){C.state.isEnabled=!0}function Er(){C.hide(),C.state.isEnabled=!1}function qo(){clearTimeout(r),clearTimeout(i),cancelAnimationFrame(o)}function _r(R){if(!C.state.isDestroyed){Oe("onBeforeUpdate",[C,R]),jr();var J=C.props,ae=Ub(n,Object.assign({},J,Hb(R),{ignoreAttributes:!0}));C.props=ae,ar(),J.interactiveDebounce!==ae.interactiveDebounce&&(Je(),b=$b(Vt,ae.interactiveDebounce)),J.triggerTarget&&!ae.triggerTarget?ys(J.triggerTarget).forEach(function(Re){Re.removeAttribute("aria-expanded")}):ae.triggerTarget&&n.removeAttribute("aria-expanded"),Dt(),we(),W&&W(J,ae),C.popperInstance&&(no(),ct().forEach(function(Re){requestAnimationFrame(Re._tippy.popperInstance.forceUpdate)})),Oe("onAfterUpdate",[C,R])}}function lr(R){C.setProps({content:R})}function Us(){var R=C.state.isVisible,J=C.state.isDestroyed,ae=!C.state.isEnabled,Re=Or.isTouch&&!C.props.touch,Pe=rh(C.props.duration,0,vr.duration);if(!(R||J||ae||Re)&&!se().hasAttribute("disabled")&&(Oe("onShow",[C],!1),C.props.onShow(C)!==!1)){if(C.state.isVisible=!0,me()&&(N.style.visibility="visible"),we(),wt(),C.state.isMounted||(N.style.transition="none"),me()){var Mt=Me(),dn=Mt.box,Gr=Mt.content;ih([dn,Gr],0)}m=function(){var Xr;if(!(!C.state.isVisible||d)){if(d=!0,N.offsetHeight,N.style.transition=C.props.moveTransition,me()&&C.props.animation){var Js=Me(),Vo=Js.box,vi=Js.content;ih([Vo,vi],Pe),qb([Vo,vi],"visible")}Ht(),Dt(),zb(sh,C),(Xr=C.popperInstance)==null||Xr.forceUpdate(),Oe("onMount",[C]),C.props.animation&&me()&&Zt(Pe,function(){C.state.isShown=!0,Oe("onShown",[C])})}},en()}}function Ks(){var R=!C.state.isVisible,J=C.state.isDestroyed,ae=!C.state.isEnabled,Re=rh(C.props.duration,1,vr.duration);if(!(R||J||ae)&&(Oe("onHide",[C],!1),C.props.onHide(C)!==!1)){if(C.state.isVisible=!1,C.state.isShown=!1,d=!1,s=!1,me()&&(N.style.visibility="hidden"),Je(),cn(),we(!0),me()){var Pe=Me(),Mt=Pe.box,dn=Pe.content;C.props.animation&&(ih([Mt,dn],Re),qb([Mt,dn],"hidden"))}Ht(),Dt(),C.props.animation?me()&&bi(Re,C.unmount):C.unmount()}}function js(R){Ee().addEventListener("mousemove",b),zb(Il,b),b(R)}function Gs(){C.state.isVisible&&C.hide(),C.state.isMounted&&(Ho(),ct().forEach(function(R){R._tippy.unmount()}),N.parentNode&&N.parentNode.removeChild(N),sh=sh.filter(function(R){return R!==C}),C.state.isMounted=!1,Oe("onHidden",[C]))}function Xs(){C.state.isDestroyed||(C.clearDelayTimeouts(),C.unmount(),jr(),delete n._tippy,C.state.isDestroyed=!0,Oe("onDestroy",[C]))}}function Ws(n,e){e===void 0&&(e={});var t=vr.plugins.concat(e.plugins||[]);G9();var r=Object.assign({},e,{plugins:t}),i=V9(n),o=i.reduce(function(s,a){var l=a&&iF(a,r);return l&&s.push(l),s},[]);return Kc(n)?o[0]:o}Ws.defaultProps=vr;Ws.setDefaultProps=eF;Ws.currentInput=Or;Object.assign({},s2,{effect:function(e){var t=e.state,r={popper:{position:t.options.strategy,left:"0",top:"0",margin:"0"},arrow:{position:"absolute"},reference:{}};Object.assign(t.elements.popper.style,r.popper),t.styles=r,t.elements.arrow&&Object.assign(t.elements.arrow.style,r.arrow)}});Ws.setDefaultProps({render:w2});class oF{getTextContent(e){return dx(e,{textSerializers:kp(this.editor.schema)})}constructor({editor:e,element:t,view:r,tippyOptions:i={},shouldShow:o}){this.preventHide=!1,this.shouldShow=({view:s,state:a})=>{const{selection:l}=a,{$anchor:d,empty:f}=l,h=d.depth===1,m=d.parent.isTextblock&&!d.parent.type.spec.code&&!d.parent.textContent&&d.parent.childCount===0&&!this.getTextContent(d.parent);return!(!s.hasFocus()||!f||!h||!m||!this.editor.isEditable)},this.mousedownHandler=()=>{this.preventHide=!0},this.focusHandler=()=>{setTimeout(()=>this.update(this.editor.view))},this.blurHandler=({event:s})=>{var a;if(this.preventHide){this.preventHide=!1;return}s!=null&&s.relatedTarget&&(!((a=this.element.parentNode)===null||a===void 0)&&a.contains(s.relatedTarget))||(s==null?void 0:s.relatedTarget)!==this.editor.view.dom&&this.hide()},this.tippyBlurHandler=s=>{this.blurHandler({event:s})},this.editor=e,this.element=t,this.view=r,o&&(this.shouldShow=o),this.element.addEventListener("mousedown",this.mousedownHandler,{capture:!0}),this.editor.on("focus",this.focusHandler),this.editor.on("blur",this.blurHandler),this.tippyOptions=i,this.element.remove(),this.element.style.visibility="visible"}createTooltip(){const{element:e}=this.editor.options,t=!!e.parentElement;this.tippy||!t||(this.tippy=Ws(e,{duration:0,getReferenceClientRect:null,content:this.element,interactive:!0,trigger:"manual",placement:"right",hideOnClick:"toggle",...this.tippyOptions}),this.tippy.popper.firstChild&&this.tippy.popper.firstChild.addEventListener("blur",this.tippyBlurHandler))}update(e,t){var r,i,o;const{state:s}=e,{doc:a,selection:l}=s,{from:d,to:f}=l;if(t&&t.doc.eq(a)&&t.selection.eq(l))return;if(this.createTooltip(),!((r=this.shouldShow)===null||r===void 0?void 0:r.call(this,{editor:this.editor,view:e,state:s,oldState:t}))){this.hide();return}(i=this.tippy)===null||i===void 0||i.setProps({getReferenceClientRect:((o=this.tippyOptions)===null||o===void 0?void 0:o.getReferenceClientRect)||(()=>px(e,d,f))}),this.show()}show(){var e;(e=this.tippy)===null||e===void 0||e.show()}hide(){var e;(e=this.tippy)===null||e===void 0||e.hide()}destroy(){var e,t;!((e=this.tippy)===null||e===void 0)&&e.popper.firstChild&&this.tippy.popper.firstChild.removeEventListener("blur",this.tippyBlurHandler),(t=this.tippy)===null||t===void 0||t.destroy(),this.element.removeEventListener("mousedown",this.mousedownHandler,{capture:!0}),this.editor.off("focus",this.focusHandler),this.editor.off("blur",this.blurHandler)}}const sF=n=>new zt({key:typeof n.pluginKey=="string"?new Hn(n.pluginKey):n.pluginKey,view:e=>new oF({view:e,...n})}),aF=bt.create({name:"floatingMenu",addOptions(){return{element:null,tippyOptions:{},pluginKey:"floatingMenu",shouldShow:null}},addProseMirrorPlugins(){return this.options.element?[sF({pluginKey:this.options.pluginKey,editor:this.editor,element:this.options.element,tippyOptions:this.options.tippyOptions,shouldShow:this.options.shouldShow})]:[]}});class uF{constructor({editor:e,element:t,view:r,tippyOptions:i={},updateDelay:o=250,shouldShow:s}){this.preventHide=!1,this.shouldShow=({view:a,state:l,from:d,to:f})=>{const{doc:h,selection:m}=l,{empty:g}=m,b=!h.textBetween(d,f).length&&Cp(l.selection),v=this.element.contains(document.activeElement);return!(!(a.hasFocus()||v)||g||b||!this.editor.isEditable)},this.mousedownHandler=()=>{this.preventHide=!0},this.dragstartHandler=()=>{this.hide()},this.focusHandler=()=>{setTimeout(()=>this.update(this.editor.view))},this.blurHandler=({event:a})=>{var l;if(this.preventHide){this.preventHide=!1;return}a!=null&&a.relatedTarget&&(!((l=this.element.parentNode)===null||l===void 0)&&l.contains(a.relatedTarget))||(a==null?void 0:a.relatedTarget)!==this.editor.view.dom&&this.hide()},this.tippyBlurHandler=a=>{this.blurHandler({event:a})},this.handleDebouncedUpdate=(a,l)=>{const d=!(l!=null&&l.selection.eq(a.state.selection)),f=!(l!=null&&l.doc.eq(a.state.doc));!d&&!f||(this.updateDebounceTimer&&clearTimeout(this.updateDebounceTimer),this.updateDebounceTimer=window.setTimeout(()=>{this.updateHandler(a,d,f,l)},this.updateDelay))},this.updateHandler=(a,l,d,f)=>{var h,m,g;const{state:b,composing:v}=a,{selection:x}=b;if(v||!l&&!d)return;this.createTooltip();const{ranges:A}=x,M=Math.min(...A.map(N=>N.$from.pos)),C=Math.max(...A.map(N=>N.$to.pos));if(!((h=this.shouldShow)===null||h===void 0?void 0:h.call(this,{editor:this.editor,element:this.element,view:a,state:b,oldState:f,from:M,to:C}))){this.hide();return}(m=this.tippy)===null||m===void 0||m.setProps({getReferenceClientRect:((g=this.tippyOptions)===null||g===void 0?void 0:g.getReferenceClientRect)||(()=>{if(hx(b.selection)){let N=a.nodeDOM(M);if(N){const W=N.dataset.nodeViewWrapper?N:N.querySelector("[data-node-view-wrapper]");if(W&&(N=W.firstChild),N)return N.getBoundingClientRect()}}return px(a,M,C)})}),this.show()},this.editor=e,this.element=t,this.view=r,this.updateDelay=o,s&&(this.shouldShow=s),this.element.addEventListener("mousedown",this.mousedownHandler,{capture:!0}),this.view.dom.addEventListener("dragstart",this.dragstartHandler),this.editor.on("focus",this.focusHandler),this.editor.on("blur",this.blurHandler),this.tippyOptions=i,this.element.remove(),this.element.style.visibility="visible"}createTooltip(){const{element:e}=this.editor.options,t=!!e.parentElement;this.tippy||!t||(this.tippy=Ws(e,{duration:0,getReferenceClientRect:null,content:this.element,interactive:!0,trigger:"manual",placement:"top",hideOnClick:"toggle",...this.tippyOptions}),this.tippy.popper.firstChild&&this.tippy.popper.firstChild.addEventListener("blur",this.tippyBlurHandler))}update(e,t){const{state:r}=e,i=r.selection.from!==r.selection.to;if(this.updateDelay>0&&i){this.handleDebouncedUpdate(e,t);return}const o=!(t!=null&&t.selection.eq(e.state.selection)),s=!(t!=null&&t.doc.eq(e.state.doc));this.updateHandler(e,o,s,t)}show(){var e;(e=this.tippy)===null||e===void 0||e.show()}hide(){var e;(e=this.tippy)===null||e===void 0||e.hide()}destroy(){var e,t;!((e=this.tippy)===null||e===void 0)&&e.popper.firstChild&&this.tippy.popper.firstChild.removeEventListener("blur",this.tippyBlurHandler),(t=this.tippy)===null||t===void 0||t.destroy(),this.element.removeEventListener("mousedown",this.mousedownHandler,{capture:!0}),this.view.dom.removeEventListener("dragstart",this.dragstartHandler),this.editor.off("focus",this.focusHandler),this.editor.off("blur",this.blurHandler)}}const lF=n=>new zt({key:typeof n.pluginKey=="string"?new Hn(n.pluginKey):n.pluginKey,view:e=>new uF({view:e,...n})}),cF=bt.create({name:"bubbleMenu",addOptions(){return{element:null,tippyOptions:{},pluginKey:"bubbleMenu",updateDelay:void 0,shouldShow:null}},addProseMirrorPlugins(){return this.options.element?[lF({pluginKey:this.options.pluginKey,editor:this.editor,element:this.options.element,tippyOptions:this.options.tippyOptions,updateDelay:this.options.updateDelay,shouldShow:this.options.shouldShow})]:[]}}),dF=/(?:^|\s)(==(?!\s+==)((?:[^=]+))==(?!\s+==))$/,fF=/(?:^|\s)(==(?!\s+==)((?:[^=]+))==(?!\s+==))/g,Gb=Yt.create({name:"highlight",addOptions(){return{multicolor:!1,HTMLAttributes:{}}},addAttributes(){return this.options.multicolor?{color:{default:null,parseHTML:n=>n.getAttribute("data-color")||n.style.backgroundColor,renderHTML:n=>n.color?{"data-color":n.color,style:`background-color: ${n.color}; color: inherit`}:{}}}:{}},parseHTML(){return[{tag:"mark"}]},renderHTML({HTMLAttributes:n}){return["mark",$t(this.options.HTMLAttributes,n),0]},addCommands(){return{setHighlight:n=>({commands:e})=>e.setMark(this.name,n),toggleHighlight:n=>({commands:e})=>e.toggleMark(this.name,n),unsetHighlight:()=>({commands:n})=>n.unsetMark(this.name)}},addKeyboardShortcuts(){return{"Mod-Shift-h":()=>this.editor.commands.toggleHighlight()}},addInputRules(){return[Lo({find:dF,type:this.type})]},addPasteRules(){return[Bo({find:fF,type:this.type})]}}),Xb=Yt.create({name:"underline",addOptions(){return{HTMLAttributes:{}}},parseHTML(){return[{tag:"u"},{style:"text-decoration",consuming:!1,getAttrs:n=>n.includes("underline")?{}:!1}]},renderHTML({HTMLAttributes:n}){return["u",$t(this.options.HTMLAttributes,n),0]},addCommands(){return{setUnderline:()=>({commands:n})=>n.setMark(this.name),toggleUnderline:()=>({commands:n})=>n.toggleMark(this.name),unsetUnderline:()=>({commands:n})=>n.unsetMark(this.name)}},addKeyboardShortcuts(){return{"Mod-u":()=>this.editor.commands.toggleUnderline(),"Mod-U":()=>this.editor.commands.toggleUnderline()}}}),hF=({element:n,content:e="",type:t="edit"})=>{let r;return{_updated_at:null,init(){t=="edit"&&Alpine.store("tiptapEditor",this),this.initEditor()},initEditor(){const i=this;r=new Y1({element:n,extensions:[Db,aF.configure({element:document.querySelector(".tiptap-floating-menu"),tippyOptions:{duration:300}}),cF.configure({element:document.querySelector(".tiptap-bubble-menu"),tippyOptions:{duration:300}}),Gb,Xb,kb],content:e,onUpdate({editor:o}){i._updated_at=Date.now()},onSelectionUpdate({editor:o}){i._updated_at=Date.now()}})},displaySavedData(i,o=""){return new Y1({element:i,extensions:[Db,Gb,Xb,kb],editable:!1,content:o})},toggleBold(){r==null||r.chain().focus().toggleBold().run()},toggleItalic(){r==null||r.chain().focus().toggleItalic().run()},toggleHighlight(){r==null||r.chain().focus().toggleHighlight().run()},toggleCode(){r==null||r.chain().focus().toggleCode().run()},toggleStrike(){r==null||r.chain().focus().toggleStrike().run()},toggleUnderline(){r==null||r.chain().focus().toggleUnderline().run()},toggleBlockquote(){r==null||r.chain().focus().toggleBlockquote().run()},toggleBulletList(){var i;(i=r.commands)==null||i.toggleBulletList()},toggleOrderedList(){var i;(i=r.commands)==null||i.toggleOrderedList()},toggleHeading(i={level:1}){r.chain().focus().toggleHeading(i).run()},toggleCodeBlock(){r.chain().focus().toggleCodeBlock().run()},setParagraph(){r==null||r.commands.setParagraph()},setHeading(i={level:1}){r==null||r.commands.setHeading(i)},setCodeBlock(){r==null||r.chain().focus().setCodeBlock().run()},redo(){r==null||r.chain().focus().redo().run()},canRedo(i){return r==null?void 0:r.can().redo()},undo(){r==null||r.chain().focus().undo().run()},canUndo(i){return r==null?void 0:r.can().undo()},getTextContent(){return r==null?void 0:r.getText()},getHtmlContent(){return r==null?void 0:r.getHTML()},setContent(i){r==null||r.commands.setContent(i)},isActive(i,o={}){return o!=null?r.isActive(i,o):r.isActive(i)},download(i){const o=i.currentTarget,s=o.dataset.docType,a=o.dataset.docName||"document";let l=r==null?void 0:r.getHTML();const d=window.location.origin,h=new DOMParser().parseFromString(l,"text/html");if(["a","img","video","audio","source"].forEach(x=>{h.querySelectorAll(x).forEach(E=>{const A=x==="a"?"href":"src",M=E.getAttribute(A);M&&!M.startsWith("http")&&E.setAttribute(A,new URL(M,d).href)})}),l=h.documentElement.outerHTML,s==="pdf"){const x=`<div style="margin: 20px;">${l}</div>`;return html2pdf().set({filename:a}).from(x).toPdf().save()}const g=`
					<html ${this.doctype==="doc"?'xmlns:o="urn:schemas-microsoft-com:office:office" xmlns:w="urn:schemas-microsoft-com:office:word" xmlns="http://www.w3.org/TR/REC-html40"':""}>
					<head>
						<meta charset="utf-8" />
						<title>${a}</title>
					</head>
					<body style="margin: 20px;">
						${l}
					</body>
					</html>`,b=`${s==="doc"?"data:application/vnd.ms-word;charset=utf-8":"data:text/plain;charset=utf-8"},${encodeURIComponent(g)}`,v=document.createElement("a");document.body.appendChild(v),v.href=b,v.download=`${a}.${s}`,v.click(),document.body.removeChild(v)},getSelectedContent(){const{view:i,state:o}=r,{from:s,to:a}=i.state.selection;return o.doc.textBetween(s,a,"")},replaceSelectedContent(i,o){r.commands.insertContentAt(i,o)},getSelectedRange(){const{view:i,state:o}=r;return i.state.selection}}};window.fetchEventSource=G_;const pF=localStorage.getItem("lqdDarkMode"),mF=localStorage.getItem("docsViewMode"),gF=localStorage.getItem("socialMediaPostsViewMode"),bF=localStorage.getItem("lqdNavbarShrinked"),k2=document.querySelector("body").getAttribute("data-theme"),yF=localStorage.getItem(k2+":lqdFocusModeEnabled");window.collectCreditsToFormData=function(n){document.querySelectorAll('input[name^="entities"]').forEach(t=>{const r=t.name,i=t.type==="checkbox"||t.type==="radio"?t.checked:t.value;n.append(r,i)})};window.Alpine=ee;ee.plugin(X_);ee.plugin(NA);ee.plugin(BA);ce.mount(new p6);document.addEventListener("alpine:init",()=>{const n=ee.$persist;ee.data("modal",e=>g6(e)),ee.data("clipboard",e=>Y_(e)),ee.data("assignViewCredits",e=>b6(e)),ee.store("navbarShrink",{active:n(!!bF).as("lqdNavbarShrinked"),toggle(e){this.active=e?e==="shrink":!this.active,document.body.classList.toggle("navbar-shrinked",this.active)}}),ee.data("navbarItem",()=>({dropdownOpen:!1,toggleDropdownOpen(e){this.dropdownOpen=e?e==="collapse":!this.dropdownOpen},item:{"x-ref":"item","@mouseenter"(){if(!ee.store("navbarShrink").active)return;const e=this.$el.getBoundingClientRect(),t=this.$refs.item.querySelector(".lqd-navbar-dropdown");if(["y","height","bottom"].forEach(r=>this.$refs.item.style.setProperty(`--item-${r}`,`${e[r]}px`)),t){const r=t.getBoundingClientRect();["height"].forEach(i=>this.$refs.item.style.setProperty(`--dropdown-${i}`,`${r[i]}px`))}}}})),ee.data("navbarLink",({isDemo:e=!1})=>({isDemo:e,isActive:!1,dropdown:null,dropdownItems:[],dropdownLinks:[],init(){const t=this.$el.closest(".lqd-navbar-inner");this.dropdown=this.$el.nextElementSibling&&this.$el.nextElementSibling.classList.contains("lqd-navbar-dropdown")&&this.$el.nextElementSibling,this.dropdownItems=this.dropdown?this.dropdown.querySelectorAll(".lqd-navbar-dropdown-link"):[],this.dropdownItems.forEach(r=>this.dropdownLinks.push(r.href)),this.isActive=this.$el.href===window.location.href||this.dropdownLinks.includes(window.location.href),this.$el.classList.toggle("active",this.isActive),this.$nextTick(()=>{var r,i;(i=(r=this.dropdown)==null?void 0:r.classList)==null||i.toggle("hidden",!this.isActive),t&&!this.isDemo&&this.isActive&&this.$el.parentElement.offsetTop+this.$el.parentElement.offsetHeight>window.innerHeight&&t.scrollTo({top:this.$el.parentElement.offsetTop-window.innerHeight/2})})}})),ee.store("mobileNav",{navCollapse:!0,toggleNav(e){this.navCollapse=e?e==="collapse":!this.navCollapse},templatesCollapse:!0,toggleTemplates(e){this.templatesCollapse=e?e==="collapse":!this.templatesCollapse},searchCollapse:!0,toggleSearch(e){this.searchCollapse=e?e==="collapse":!this.searchCollapse}}),ee.store("darkMode",{on:n(!!pF).as("lqdDarkMode"),toggle(){this.on=!this.on,document.body.classList.toggle("theme-dark",this.on),document.body.classList.toggle("theme-light",!this.on)}}),ee.store("appLoadingIndicator",{showing:!1,show(){this.showing=!0},hide(){this.showing=!1},toggle(){this.showing=!this.showing}}),ee.data("liquidHeaderSearch",()=>({modalOpen:!1,searchTerm:"",isSearching:!1,doneSearching:!1,pending:!1,inputFocused:!1,timer:null,searchResults:"",recentSearchKeys:[],recentLunchedDocs:"",shortcutKey:navigator.userAgent.indexOf("Mac OS X")!=-1?"cmd":"ctrl",init(){this.applyRecentSearch=this.applyRecentSearch.bind(this),sessionStorage.removeItem("headear-recent-lunch"),sessionStorage.removeItem("headear-recent-search-keys"),this.fetchRecentSearchKeys(),this.fetchRecentLunchedDocs(),this.addKeyboardShortcuts()},toggleModal(e){if(e!=null)return this.modalOpen=e;this.modalOpen=!this.modalOpen},handleFocus(){this.inputFocused=!0,this.onlySpaces(this.searchTerm)?(this.pending=!0,this.doneSearching=!1):(this.doneSearching=!0,this.pending=!1)},handleBlur(){this.inputFocused=!1},handleSearch(){this.onlySpaces(this.searchTerm)?(clearTimeout(this.timer),this.isSearching=!1,this.doneSearching=!1,this.pending=!0):(this.isSearching=!0,this.pending=!1,this.doneSearching=!1,clearTimeout(this.timer),this.timer=setTimeout(()=>this.performSearch(),1e3))},addKeyboardShortcuts(){window.addEventListener("keydown",e=>{if((e.ctrlKey||e.shiftKey||e.altKey||e.metaKey)&&e.key==="k"){if(e.preventDefault(),e.stopPropagation(),this.inputFocused)return;this.$el.querySelector(".header-search-input").focus(),this.inputFocused=!0,this.onlySpaces(this.searchTerm)||(this.doneSearching=!0)}if(e.key==="Escape"){if(!this.inputFocused)return;this.$el.querySelector(".header-search-input").blur(),this.inputFocused=!1,this.doneSearching=!1}})},onlySpaces(e){return e.trim().length===0||e===""},async performSearch(){var t;const e=new FormData;e.append("_token",(t=document.querySelector("input[name=_token]"))==null?void 0:t.value),e.append("search",this.searchTerm);try{const i=await(await fetch("/dashboard/api/search",{method:"POST",body:e})).json();this.searchResults=i.html,this.doneSearching=!0,this.pending=!1,this.isSearching=!1,sessionStorage.setItem("headear-recent-search-keys",JSON.stringify(i.keywords)),this.recentSearchKeys=i.keywords}catch(r){console.error("Search error:",r),this.isSearching=!1}},async fetchRecentSearchKeys(){if(sessionStorage.getItem("headear-recent-search-keys")===null)try{const t=await(await fetch("/dashboard/api/search/recent-search-keys")).json();sessionStorage.setItem("headear-recent-search-keys",JSON.stringify(t.keys)),this.recentSearchKeys=t.keys}catch(e){console.error("Error fetching recent search keys:",e)}else this.recentSearchKeys=JSON.parse(sessionStorage.getItem("headear-recent-search-keys"))},async fetchRecentLunchedDocs(){if(sessionStorage.getItem("headear-recent-lunch")===null)try{const t=await(await fetch("/dashboard/api/search/recent-lunch")).json();sessionStorage.setItem("headear-recent-lunch",t.html),this.recentLunchedDocs=t.html}catch(e){console.error("Error fetching recent launched docs:",e)}else this.recentLunchedDocs=sessionStorage.getItem("headear-recent-lunch")},applyRecentSearch(e){this.searchTerm=e.keyword||e,this.$el.querySelector(".header-search-input").focus(),this.handleSearch()},async deleteRecentSearchKey(e){const t=e.keyword||e;this.recentSearchKeys=this.recentSearchKeys.filter(r=>(r.keyword||r)!==t),sessionStorage.setItem("headear-recent-search-keys",JSON.stringify(this.recentSearchKeys));try{await fetch(`/dashboard/api/search/delete-search-key/${encodeURIComponent(t)}`,{method:"DELETE"})}catch(r){console.error("Error deleting search key:",r)}}})),ee.store("docsViewMode",{docsViewMode:n(mF||"list").as("docsViewMode"),change(e){this.docsViewMode=e}}),ee.store("generatorsFilter",{init(){const e=new URLSearchParams(window.location.search);this.filter=e.get("filter")||"all"},filter:"all",changeFilter(e){if(this.filter!==e){if(!document.startViewTransition)return this.filter=e;document.startViewTransition(()=>this.filter=e)}}}),ee.data("generatorItem",()=>({get isHidden(){return this.$store.generatorsFilter.filter!=="all"&&this.$el.getAttribute("data-filter").search(this.$store.generatorsFilter.filter)<0},updateDataFilter(e,t){const r=this.$el.getAttribute("data-filter"),i=new Set(r.split(","));t?i.add("favorite"):i.delete("favorite"),this.$el.setAttribute("data-filter",Array.from(i).join(","))}})),ee.store("documentsFilter",{init(){const e=new URLSearchParams(window.location.search);this.sort=e.get("sort")||"created_at",this.sortAscDesc=e.get("sortAscDesc")||"desc",this.filter=e.get("filter")||"all",this.page=e.get("page")||"1"},sort:"created_at",sortAscDesc:"desc",filter:"all",page:"1",changeSort(e){e===this.sort?this.sortAscDesc=this.sortAscDesc==="desc"?"asc":"desc":this.sortAscDesc="desc",this.sort=e},changeAscDesc(e){this.ascDesc!==e&&(this.ascDesc=e)},changeFilter(e){this.filter!==e&&(this.filter=e)},changePage(e){(e===">"||e==="<")&&(e=e===">"?Number(this.page)+1:Number(this.page)-1),this.page!==e&&(this.page=e)}}),ee.store("socialMediaPostsViewMode",{socialMediaPostsViewMode:n(gF||"list").as("socialMediaPostsViewMode"),change(e){this.socialMediaPostsViewMode=e}}),ee.store("socialMediaPostsFilter",{init(){const e=new URLSearchParams(window.location.search);this.sort=e.get("sort")||"created_at",this.sortAscDesc=e.get("sortAscDesc")||"desc",this.filter=e.get("filter")||"all",this.page=e.get("page")||"1"},sort:"created_at",sortAscDesc:"desc",filter:"all",page:"1",changeSort(e){e===this.sort?this.sortAscDesc=this.sortAscDesc==="desc"?"asc":"desc":this.sortAscDesc="desc",this.sort=e},changeAscDesc(e){this.ascDesc!==e&&(this.ascDesc=e)},changeFilter(e){this.filter!==e&&(this.filter=e)},changePage(e){(e===">"||e==="<")&&(e=e===">"?Number(this.page)+1:Number(this.page)-1),this.page!==e&&(this.page=e)}}),ee.store("chatsFilter",{init(){const e=new URLSearchParams(window.location.search);this.filter=e.get("filter")||"all",this.setSearchStr(e.get("search")||"")},searchStr:"",setSearchStr(e){this.searchStr=e.trim().toLowerCase()},filter:"all",changeFilter(e){if(this.filter!==e){if(!document.startViewTransition)return this.filter=e;document.startViewTransition(()=>this.filter=e)}}}),ee.data("generatorV2",()=>({itemsSearchStr:"",setItemsSearchStr(e){this.itemsSearchStr=e.trim().toLowerCase(),this.itemsSearchStr!==""?this.$el.closest(".lqd-generator-sidebar").classList.add("lqd-showing-search-results"):this.$el.closest(".lqd-generator-sidebar").classList.remove("lqd-showing-search-results")},sideNavCollapsed:!1,toggleSideNavCollapse(e){var t,r;this.sideNavCollapsed=e?e==="collapse":!this.sideNavCollapsed,this.sideNavCollapsed&&(typeof tinymce<"u"&&(tinymce!=null&&tinymce.activeEditor)?(t=tinymce==null?void 0:tinymce.activeEditor)==null||t.focus():(r=window.editorJS)==null||r.focus())},generatorStep:0,setGeneratorStep(e){if(e!==this.generatorStep){if(!document.startViewTransition)return this.generatorStep=Number(e);document.startViewTransition(()=>this.generatorStep=Number(e))}},selectedGenerator:null})),ee.store("mobileChat",{sidebarOpen:!1,toggleSidebar(e){this.sidebarOpen=e?!1:!this.sidebarOpen}}),ee.data("dropdown",({triggerType:e="hover"})=>({open:!1,toggle(t){this.open=t?t!=="collapse":!this.open,this.$refs.parent.classList.toggle("lqd-is-active",this.open)},parent:{"@mouseenter"(){e==="hover"&&this.toggle("expand")},"@mouseleave"(){e==="hover"&&this.toggle("collapse")},"@click.outside"(){this.toggle("collapse")}},trigger:{"@click.prevent"(){this.toggle()}},dropdown:{}})),ee.store("notifications",{notifications:[],loading:!1,add(e){this.notifications.unshift(e)},remove(e){this.notifications.splice(e,1)},markThenHref(e){const t=this.notifications.indexOf(e);if(t!==-1){var r=new FormData;r.append("id",e.id),this.loading=!0,$.ajax({url:"/dashboard/notifications/mark-as-read",type:"POST",data:r,cache:!1,contentType:!1,processData:!1,success:i=>{},error:i=>{console.error(i)},complete:()=>{this.markAsRead(t),window.location=e.link,this.loading=!1}})}},markAsRead(e){this.notifications=this.notifications.map((t,r)=>(r===e&&(t.unread=!1),t))},markAllAsRead(){this.loading=!0,$.ajax({url:"/dashboard/notifications/mark-as-read",type:"POST",success:e=>{e.success&&this.notifications.forEach((t,r)=>{this.markAsRead(r)})},error:e=>{console.error(e)},complete:()=>{this.loading=!1}})},setNotifications(e){this.notifications=e},hasUnread:function(){return this.notifications.some(e=>e.unread)}}),ee.data("notifications",e=>({notifications:e||[]})),ee.store("focusMode",{active:ee.$persist(!!yF).as(k2+":lqdFocusModeEnabled"),toggle(e){this.active=e?e==="activate":!this.active,document.body.classList.toggle("focus-mode",this.active)}}),ee.data("numberCounter",({value:e=0,options:t={}})=>({value:e,options:{delay:0,...t},io:null,numberWrappers:[],numberCols:[],numberAnimators:[],init(){this.$el.innerHTML="",this.buildMarkup(),this.setupIO()},updateValue({value:r,options:i={}}){this.value!==r&&(this.value=r,this.options={...this.options,...i},this.buildMarkup(),this.setupIO())},buildMarkup(){const r=this.value.toString().split(""),i=this.$el.querySelectorAll(".lqd-number-counter-numbers-wrap");function o(){return Array.from({length:10},(a,l)=>`<span class="lqd-number-counter-number inline-flex h-full justify-center">${l}</span>`).join("")}if(r.map((a,l)=>{const d=!isNaN(a);return`<span class="lqd-number-counter-numbers-wrap relative inline-flex h-full w-[1ch]" data-index="${l}" data-value="${a}"><span class="lqd-number-counter-numbers-col absolute start-0 top-[-0.25lh] inline-flex h-[1.5lh] w-full flex-col overflow-hidden py-[0.25lh]"><span class="lqd-number-counter-numbers-animator inline-flex w-full h-full flex-col" data-is-number="${d}" data-value="${a}">${d?o():a}</span></span></span>`}).forEach((a,l)=>{const d=r[l],f=i[l],h=!isNaN(d);if(f){const m=f.querySelector(".lqd-number-counter-numbers-animator");f.setAttribute("data-value",d),m.setAttribute("data-value",d),m.setAttribute("data-is-number",h),m.getAttribute("data-is-number")==="true"&&h?m.innerHTML!==o()&&(m.innerHTML=o()):m.innerHTML!==d&&(m.innerHTML=d);return}this.$el.insertAdjacentHTML("beforeend",a),i.length&&this.$el.querySelector(`.lqd-number-counter-numbers-wrap[data-index="${l}"]`).animate([{translate:"0 0.25lh",opacity:0},{translate:"0 0",opacity:1}],{duration:250,easing:"ease",fill:"both"})}),i.length>r.length)for(let a=r.length;a<i.length;a++)i[a].animate([{translate:"0 -0.25lh",opacity:0}],{duration:250,easing:"ease",fill:"both"}).onfinish=()=>{i[a].remove()};this.numberWrappers=this.$el.querySelectorAll(".lqd-number-counter-numbers-wrap"),this.numberCols=this.$el.querySelectorAll(".lqd-number-counter-numbers-col"),this.numberAnimators=this.$el.querySelectorAll(".lqd-number-counter-numbers-animator")},setupIO(){this.io=new IntersectionObserver(([r],i)=>{r.isIntersecting&&(i.disconnect(),this.animate())}),this.io.observe(this.$el)},animate(){this.numberAnimators.forEach(r=>{if(!(r.getAttribute("data-is-number")==="true"))return;const o=r.getAttribute("data-value");r.animate([{translate:`0 ${o*100*-1}%`}],{duration:800,delay:this.options.delay,easing:"cubic-bezier(.47,1.09,.69,1.07)",fill:"both"})})}})),ee.data("shapeCutout",()=>({init(){this.onResize=this.onResize.bind(this),this.afterResize=Fn.debounce(this.afterResize.bind(this),1),this.svgEl=this.$el.querySelector("svg"),this.svgEl&&(this.svgObjects=this.svgEl.querySelectorAll("rect, circle, path, polygon"),this.events())},events(){$(window).on("resize",this.onResize),this.resizeObserver=new ResizeObserver(()=>{this.onResize()}),this.resizeObserver.observe(this.svgEl)},onResize(){this.changeObjAttr("-"),this.afterResize()},afterResize(){this.changeObjAttr("+")},changeObjAttr(e){this.svgObjects.forEach(t=>{t.hasAttribute("x")?t.setAttribute("x",parseFloat(parseFloat(t.getAttribute("x"))+e+"1")):t.hasAttribute("width")?t.setAttribute("width",parseFloat(parseFloat(t.getAttribute("width"))+e+"1")):t.hasAttribute("cx")?t.setAttribute("cx",parseFloat(parseFloat(t.getAttribute("cx"))+e+"1")):t.hasAttribute("r")&&t.setAttribute("r",parseFloat(parseFloat(t.getAttribute("r"))+e+"1"))})}})),ee.data("marquee",(e={})=>({maxWidth:0,position:0,options:{direction:-1,speed:.5,pauseOnHover:!1,...e},async init(){this.direction=this.options.direction,this.cellWidths=[],this.cellHeights=[],this.viewportEl=this.$el.querySelector(".lqd-marquee-viewport"),this.sliderEl=this.$el.querySelector(".lqd-marquee-slider"),this.cells=this.sliderEl.querySelectorAll(".lqd-marquee-cell"),this.sliderElStyles=window.getComputedStyle(this.sliderEl),this.maxWidth=0,this.maxHeight=0,this.onResize=Fn.debounce(this.onResize.bind(this),450),await document.fonts.ready,this.sizing(),this.startAnimation()},sizing(){for(let t=0;t<this.cells.length;t++)this.cellHeights.push(this.cells[t].offsetHeight),this.cellWidths.push(this.cells[t].offsetWidth);this.maxHeight=Math.max(...this.cellHeights),this.maxWidth=this.cellWidths.reduce((t,r)=>t+r,0),this.maxWidth+=parseInt(this.sliderElStyles.paddingLeft)+parseInt(this.sliderElStyles.paddingRight),this.maxWidth+=parseInt(this.sliderElStyles.gap)*(this.cells.length-1),this.viewportEl.style.height=`${this.maxHeight+parseInt(this.sliderElStyles.paddingTop)+parseInt(this.sliderElStyles.paddingBottom)}px`,this.sliderEl.classList.add("absolute","top-0","left-0","w-full","h-full"),this.maxWidth-=this.viewportEl.offsetWidth},startAnimation(){this.isAnimating=!0,this.options.pauseOnHover&&(this.sliderEl.addEventListener("pointerenter",()=>{this.isAnimating=!1}),this.sliderEl.addEventListener("pointerleave",()=>{this.isAnimating=!0}));const t=()=>{this.isAnimating&&(this.position+=this.options.speed*this.direction,this.position<=-this.maxWidth?this.direction=1:this.position>=0&&(this.direction=-1),this.sliderEl.style.transform=`translateX(${this.position}px)`),requestAnimationFrame(t)};requestAnimationFrame(t)},onResize(){this.sizing()}})),ee.data("marqueev2",(e={})=>({cells:[],timeline:null,IO:null,active:!1,options:{cellsSelector:".lqd-marquee-cell",...e},init(){this.cells=this.$el.querySelectorAll(this.options.cellsSelector),this.timeline=this.horizontalLoop(this.cells,{repeat:-1,paddingRight:24}),this.IO=new IntersectionObserver(([t])=>{this.active=t.isIntersecting,this.cells.forEach(r=>{r.style.willChange=this.active?"transform":"auto"})}).observe(this.$el),this.createObserver()},createObserver(){Observer.create({onChangeY:t=>{let r=1.5;t.deltaY<0&&(r*=-1),gsap.timeline({defaults:{ease:"none"}}).to(this.timeline,{timeScale:r*2.5,duration:.2,overwrite:!0}).to(this.timeline,{timeScale:r/2.5,duration:1},"+=0.3")}})},horizontalLoop(t,r){t=gsap.utils.toArray(t),r=r||{};let i=gsap.timeline({repeat:r.repeat,paused:r.paused,defaults:{ease:"none"},onReverseComplete:()=>i.totalTime(i.rawTime()+i.duration()*100)}),o=t.length,s=t[0].offsetLeft,a=[],l=[],d=[],f=0,h=(r.speed||1)*100,m=r.snap===!1?C=>C:gsap.utils.snap(r.snap||1),g,b,v,x,E,A;for(gsap.set(t,{xPercent:(C,P)=>{let N=l[C]=parseFloat(gsap.getProperty(P,"width","px"));return d[C]=m(parseFloat(gsap.getProperty(P,"x","px"))/N*100+gsap.getProperty(P,"xPercent")),d[C]}}),gsap.set(t,{x:0}),g=t[o-1].offsetLeft+d[o-1]/100*l[o-1]-s+t[o-1].offsetWidth*gsap.getProperty(t[o-1],"scaleX")+(parseFloat(r.paddingRight)||0),A=0;A<o;A++)E=t[A],b=d[A]/100*l[A],v=E.offsetLeft+b-s,x=v+l[A]*gsap.getProperty(E,"scaleX"),i.to(E,{xPercent:m((b-x)/l[A]*100),duration:x/h},0).fromTo(E,{xPercent:m((b-x+g)/l[A]*100)},{xPercent:d[A],duration:(b-x+g-b)/h,immediateRender:!1},x/h).add("label"+A,v/h),a[A]=v/h;function M(C,P){P=P||{},Math.abs(C-f)>o/2&&(C+=C>f?-o:o);let N=gsap.utils.wrap(0,o,C),W=a[N];return W>i.time()!=C>f&&(P.modifiers={time:gsap.utils.wrap(0,i.duration())},W+=i.duration()*(C>f?1:-1)),f=N,P.overwrite=!0,i.tweenTo(W,P)}return i.next=C=>M(f+1,C),i.previous=C=>M(f-1,C),i.current=()=>f,i.toIndex=(C,P)=>M(C,P),i.times=a,i.progress(1,!0).progress(0,!0),r.reversed&&(i.vars.onReverseComplete(),i.reverse()),i}})),ee.data("curtain",(e="curtain",t={})=>({id:e,activeCurtain:0,options:{itemsSelector:".lqd-curtain-item",contentSelector:".lqd-curtain-item-content",contentWidthOuter:".lqd-curtain-item-content-width-outer",contentWidthInner:".lqd-curtain-item-content-width-inner",activeClassname:"lqd-curtain-item-active",inactiveClassname:"lqd-curtain-item-inactive",duration:.65,ease:"cubic-bezier(0.23, 1, 0.320, 1)",trigger:"pointerenter",...t},init(){this.items=[...this.$el.querySelectorAll(this.options.itemsSelector)],this.items.length&&(this.onElementActive=this.onElementActive.bind(this),this.onWindowResize=Fn.debounce(this.onWindowResize.bind(this),450),this.setActiveCurtain(),this.setActiveElement(),this.setActiveContentWidth(),this.events())},events(){const{trigger:r}=this.options,i=Fn.throttle(this.onElementActive,50,{leading:!0,trailing:!1});this.items.forEach(o=>{o.addEventListener(r,i)}),window.addEventListener("resize",this.onWindowResize)},setActiveCurtain(){this.activeCurtain=this.items.findIndex(r=>r.classList.contains(this.options.activeClassname)),this.$dispatch(`curtain-changed-${this.id}`,{activeCurtain:this.activeCurtain})},setActiveElement(){this.activeElement=this.items[this.activeCurtain]},setActiveContentWidth(){if(!this.getElDirection().includes("row"))return;const i=this.activeElement.querySelector(this.options.contentWidthOuter).offsetWidth;this.$el.style.setProperty("--active-width",`${i}px`)},onElementActive(r){const{activeClassname:i,inactiveClassname:o}=this.options,s=r.currentTarget;this.items.forEach(a=>{a.classList.remove(i),a.classList.add(o)}),s.classList.remove(o),s.classList.add(i),this.setActiveCurtain(),this.setActiveElement()},getElDirection(){return window.getComputedStyle(this.activeElement).flexDirection},onWindowResize(){this.setActiveContentWidth()}})),ee.data("slideshow",(e="slideshow",t=0,r={})=>({activeSlide:0,totalSlides:t,id:e,options:{...r},init(){this.setActiveSlide=this.setActiveSlide.bind(this)},setActiveSlide(i){i===">"?i=this.activeSlide+1:i==="<"&&(i=this.activeSlide-1),i<0?i=this.totalSlides-1:i>=this.totalSlides&&(i=0),this.activeSlide=i,this.$dispatch(`slide-changed-${this.id}`,{activeSlide:this.activeSlide})}})),ee.data("dynamicInput",(e={relativeValue:!1,value:0,min:null,max:null,step:1,onInput:null})=>({value:e.value??0,_relativeValue:e.relativeValue,originalRelativeValue:null,min:e.min,max:e.max,step:e.step??1,onInputFn:e.onInput,prevMouseX:null,overlay:null,mouseDown:!1,changingDelta:0,prevVal:null,get relativeValue(){const t=this._relativeValue;return typeof t=="function"?t():t},set relativeValue(t){this._relativeValue=t},init(){this.onMouseDown=this.onMouseDown.bind(this),this.onMouseMove=this.onMouseMove.bind(this),this.onMouseUp=this.onMouseUp.bind(this),this.onKeyDown=this.onKeyDown.bind(this),this.onInput=this.onInput.bind(this),this.revertBackRelativeValue=_.throttle(this.revertBackRelativeValue.bind(this),150,{leading:!1}),this.value!=null&&this.updateValue(this.value),this.events(),this.$watch("mouseDown",t=>{this.$el.classList.toggle("dragging",t)})},events(){const t=this.$refs.dynamicLabel,r=this.$refs.dynamicInput;!t||!r||(t.addEventListener("mousedown",this.onMouseDown),window.addEventListener("mousemove",this.onMouseMove),window.addEventListener("mouseup",this.onMouseUp),r.addEventListener("keydown",this.onKeyDown),r.addEventListener("input",this.onInput))},updateInputValue(t,r=!0){const i=this.$refs.dynamicInput;if(i){if(!isNaN(t)){let o=0;const s=this.step.toString(),a=t.toString();s.includes(".")&&(o=Math.min(2,s.split(".")[1].length)),a.includes(".")&&(o=Math.min(2,a.split(".")[1].length)),o>0&&(t=parseFloat(t).toFixed(o))}i.value=t,r&&i.dispatchEvent(new Event("input",{bubbles:!0}))}},updateValue(t,r=!0,i=!0){if(t==null||!this.$refs.dynamicInput)return;if(this.relativeValue&&isNaN(t)){this.value=t,this.updateInputValue(this.value,!1);return}let s=parseFloat(t);!this.relativeValue&&this.min!=null&&s<this.min&&(s=this.min),!this.relativeValue&&this.max!=null&&s>this.max&&(s=this.max),this.value=s,r&&this.updateInputValue(this.value,i)},onMouseDown(t){const r=this.$refs.dynamicInput;this.mouseDown=!0,this.prevVal=r.value,t.preventDefault(),this.overlay||(this.overlay=document.createElement("div"),this.overlay.classList.add("fixed","top-0","start-0","w-screen","h-screen","z-10"),this.overlay.style.cursor="ew-resize",document.body.appendChild(this.overlay))},onMouseMove(t){if(!this.mouseDown)return;if(!this.prevMouseX&&this.prevMouseX!==0){this.prevMouseX=t.clientX;return}const r=t.clientX,i=r-this.prevMouseX,o=t.shiftKey,s=t.metaKey||t.ctrlKey,a=this.step*(o?10:s?.1:1);if(i!==0){const l=(i>0?1:-1)*a;let f=(!isNaN(parseFloat(this.value))?parseFloat(this.value):0)+l;this.relativeValue&&(f=l),this.changingDelta+=l,this.updateValue(f),this.prevMouseX=r}},onMouseUp(){this.mouseDown&&(this.relativeValue&&this.updateValue(isNaN(this.prevVal)?this.prevVal:parseFloat(this.prevVal||0)+this.changingDelta,!0,!1),this.mouseDown=!1,this.prevMouseX=null,this.changingDelta=0,this.prevVal=null,this.overlay&&(document.body.removeChild(this.overlay),this.overlay=null))},onKeyDown(t){if(t.key==="Enter"||t.key==="Tab"){if(this.updateValue(this.calculateExpression()),t.key==="Tab")return!0;t.preventDefault()}else if(t.key==="ArrowUp"||t.key==="ArrowDown"){t.preventDefault();const r=t.shiftKey,i=t.metaKey||t.ctrlKey,o=this.step*(r?10:i?.1:1),s=t.key==="ArrowUp"?o:-o,a=t.target.value;let d=(!isNaN(parseFloat(a))?parseFloat(a):0)+s;this.relativeValue&&(d=s),this.updateValue(d)}},onInput(t){this.updateValue(t.target.value,!1),typeof this.onInputFn=="function"&&this.onInputFn.call(this,this.value)},calculateExpression(){const t=this.$refs.dynamicInput.value.trim();let r=t;if(t){if(/[-+*/().]/.test(t)&&/[\d)]$/.test(t))try{if(this.isValidExpression(t)){const i=Function('"use strict"; return ('+t+")")();if(!isNaN(i)&&isFinite(i)){r=i;return}}}catch(i){console.log("Invalid expression:",i)}return r}},isValidExpression(t){let r=0;for(let i=0;i<t.length;i++)if(t[i]==="("&&r++,t[i]===")"&&r--,r<0)return!1;return!(r!==0||/[+\-*/]{2,}/.test(t)||/^[+*/]/.test(t)||/[+\-*/]$/.test(t))},revertBackRelativeValue(){this.originalRelativeValue&&(this.relativeValue=this.originalRelativeValue,this.originalRelativeValue=null)}})),ee.data("splitText",(e={})=>({splitText:null,options:{type:"words",tag:"span",charsClass:"lqd-split-unit lqd-split-char",wordsClass:"lqd-split-unit lqd-split-word",linesClass:"lqd-split-unit lqd-split-line",...e},init(){this.splitText=new SplitText(this.$el,this.options);const t=this.splitText.words.length;this.splitText.words.forEach((r,i)=>{r.setAttribute("data-index",i),r.setAttribute("data-last-index",t-1-i),r.style.setProperty("--word-index",i),r.style.setProperty("--word-last-index",t-1-i)}),this.$dispatch("split-text-done",{splitText:this.splitText})}})),ee.data("liquidColorPicker",(e={colorVal:null,onPick:null})=>({_colorVal:e.colorVal,picker:null,onPick:e.onPick,get colorVal(){return this._colorVal},set colorVal(t){this._colorVal=t},init(){this.checkDarkMode=this.checkDarkMode.bind(this),this.checkDarkMode(),this.initColorPicker(),this.events()},initColorPicker(){this.$refs.colorInput.setAttribute("type","text"),this.picker=new ColorPicker(this.$refs.colorInputWrap??this.$el,{color:this.colorVal,submitMode:"instant",showClearButton:!0})},events(){this.$watch("$store.darkMode.on",()=>{this.checkDarkMode()}),this.picker.on("pick",t=>{this.colorVal=t,typeof this.onPick=="function"&&this.onPick.call(this,t),this.$refs.colorInput&&(this.$refs.colorInput.value=t,this.$refs.colorInput.dispatchEvent(new Event("input",{bubbles:!0})))})},checkDarkMode(){const t=localStorage.getItem("lqdDarkMode")=="true";document.documentElement.setAttribute("data-cp-theme",t?"dark":"light"),document.documentElement.setAttribute("data-bs-theme",t?"dark":"light")}})),ee.data("liquidTextReveal",({splitEl:e=null,splitType:t="chars",start:r="top bottom",end:i="center 65%",animateFrom:o={opacity:.2},animateTo:s={opacity:1}})=>({splitType:t==="chars"?"chars,words":t,start:r,end:i,animateFrom:o,animateTo:s,splittedText:null,splitEl:null,getSplitEl(){return e??this.$el},init(){this.onTextSplitted=this.onTextSplitted.bind(this),this.initSplitText()},initSplitText(){SplitText.create(this.getSplitEl(),{autoSplit:!0,onSplit:this.onTextSplitted})},getAnimations(){const a=this.splittedText[this.splitType==="chars,words"?"chars":this.splitType];return gsap.fromTo(a,{...this.animateFrom},{stagger:.1,...this.animateTo})},onTextSplitted(a){this.splittedText=a,ScrollTrigger.create({animation:this.getAnimations(),trigger:this.getSplitEl(),scrub:!0,start:this.start,end:this.end})}})),ee.data("liquidScrollSmooth",()=>({init(){ScrollSmoother.create({smooth:1,effects:!0,smoothTouch:.1})}})),ee.data("updateAvailable",({routes:e={}})=>({routes:{...e||{}},route:"#",isAvailable:!1,isVersionUpdateAvailable:!1,isExtensionUpdateAvailable:!1,updateAvailableExtensions:[],init(){this.checkAvailability()},async checkAvailability(){const t=await fetch(this.routes.check);if(!t.ok){console.error("Network error: check update availablity");return}const r=await t.json();this.isVersionUpdateAvailable=r.versionUpdateAvailable,this.isExtensionUpdateAvailable=r.extensionUpdateAvailable,this.updateAvailableExtensions=r.updateAvailableExtensions,this.isAvailable=this.isVersionUpdateAvailable||this.isExtensionUpdateAvailable,this.isVersionUpdateAvailable?this.route=this.routes.appUpdate:this.isExtensionUpdateAvailable&&(this.route=this.routes.extensionUpdate)}})),ee.data("liquidMegamenu",()=>({liEl:null,header:null,posAppliedClassname:"sub-pos-applied",prevMouseX:null,init(){this.onWindowMouseMove=this.onWindowMouseMove.bind(this),this.liEl=this.$el.closest("li"),this.header=this.$el.closest(".site-header"),this.nav=this.$el.closest(".site-header-nav"),this.position()},position(){if(this.liEl.classList.remove(this.posAppliedClassname),window.innerWidth<992)return this.liEl.classList.add(this.posAppliedClassname);const e=this.liEl.getBoundingClientRect(),t=this.$el.getBoundingClientRect(),r=this.nav.getBoundingClientRect(),i=window.innerWidth,o=r.bottom-e.bottom;let s=(i-t.width)/2;s<0&&(s=0),s+t.width>i&&(s=i-t.width),s>e.right&&(s=e.left-20),this.$el.style.left=`${s-e.left}px`,this.liEl.style.setProperty("--sub-offset",`${o}px`),this.liEl.classList.add(this.posAppliedClassname)},onWindowMouseMove(e){window.innerWidth<992||(this.prevMouseX!==void 0&&(e.clientX>this.prevMouseX?this.$el.setAttribute("data-direction","right"):e.clientX<this.prevMouseX&&this.$el.setAttribute("data-direction","left")),this.prevMouseX=e.clientX)}})),ee.data("openaiRealtime",N6),ee.data("elevenlabsRealtime",X6),ee.data("tiptapEditor",hF),ee.data("advancedImageEditor",Hg),ee.data("creativeSuite",L6),ee.data("advancedImageEditor",Hg),ee.data("lqdCustomizer",j6),ee.data("lqdCustomizerFontPicker",G6)});j_.start();export{P6 as g};
